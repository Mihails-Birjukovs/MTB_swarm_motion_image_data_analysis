(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    997584,      22166]
NotebookOptionsPosition[    944723,      21355]
NotebookOutlinePosition[    945197,      21373]
CellTagsIndexPosition[    945154,      21370]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"eaa15933-ff6d-454c-9e36-e34ce6855e99"],

Cell["Milestones/upgrades :", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}},
 FontSize->24,ExpressionUUID->"85a38af9-58c5-43d3-9e34-8120044bb540"],

Cell[CellGroupData[{

Cell["Implement a wrapper for Tianshu\[CloseCurlyQuote]s code", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.889043465537898*^9},
 FontSize->18,ExpressionUUID->"e1a32138-3224-4874-b488-0be1d4a5ddbb"],

Cell["PIV / HOPIV for IWs (need a good reference window system)", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051044094267`*^9, 3.8948051044114213`*^9}},
 FontSize->18,ExpressionUUID->"f96edd96-ab5c-459e-a2fe-f3c7f533a76a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.900088128070409*^9, 
  3.9000881315050774`*^9}},ExpressionUUID->"ca3397bc-5709-49fd-a0ab-\
46d2041d3aff"],

Cell[CellGroupData[{

Cell["\<\
(?) Batch processing for global image filtering and segmentation\
\>", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.894805120163366*^9}, {
   3.8998710810932665`*^9, 3.8998710864944944`*^9}},
 FontSize->18,ExpressionUUID->"06e3f137-27a9-44f4-b0f1-6943497e4690"],

Cell["(?) Batch processing for SW false positive filtering", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.894805141113429*^9}, {
   3.8998710897820225`*^9, 3.899871090774473*^9}},
 FontSize->18,ExpressionUUID->"43844e1a-4b91-43da-901b-4c09a89aeb74"],

Cell["(?) Batch processing for inter-particle distance calculation", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.8948051518462944`*^9}, {
   3.8948051962986565`*^9, 3.894805196299635*^9}, {3.89987109298213*^9, 
   3.899871094861827*^9}},
 FontSize->18,ExpressionUUID->"397d964f-2d0c-4b26-8f90-71384d24e604"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.900088128070409*^9, 
  3.9000881315050774`*^9}},ExpressionUUID->"a62c43ea-4ef4-4a44-9937-\
b9eead14884e"],

Cell[CellGroupData[{

Cell["Trajectories: acceleration, PDFs", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.8948051518462944`*^9}, {
   3.894805197142715*^9, 3.894805252532962*^9}, {3.894805310837208*^9, 
   3.894805341221537*^9}, {3.8948053734362497`*^9, 3.8948053868442745`*^9}, {
   3.8948261564992857`*^9, 3.894826185928544*^9}, {3.8948267472339487`*^9, 
   3.8948268046335187`*^9}, {3.894827080024009*^9, 3.89482710542087*^9}, {
   3.8959855242137623`*^9, 3.8959855553988595`*^9}, {3.8997135040410786`*^9, 
   3.899713504042119*^9}, {3.9000878487814646`*^9, 3.900087907477004*^9}, {
   3.9000879701107597`*^9, 3.900088008871433*^9}, 3.9001589972769394`*^9, {
   3.900159050444524*^9, 3.900159068460389*^9}, {3.9005876306264315`*^9, 
   3.9005876688510046`*^9}, {3.9032031950133553`*^9, 3.903203196012905*^9}, {
   3.9100756697368207`*^9, 3.910075670384469*^9}},
 FontSize->18,ExpressionUUID->"74679866-0d47-47a9-a607-eda88f4398b0"],

Cell["Fail-safes for iterative track refinement", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.8948051518462944`*^9}, {
   3.894805197142715*^9, 3.894805252532962*^9}, {3.894805310837208*^9, 
   3.894805341221537*^9}, {3.8948053734362497`*^9, 3.8948053868442745`*^9}, {
   3.8948261564992857`*^9, 3.894826185928544*^9}, {3.8948267472339487`*^9, 
   3.8948268046335187`*^9}, {3.894827080024009*^9, 3.89482710542087*^9}, {
   3.8959855242137623`*^9, 3.8959855553988595`*^9}, {3.8997135040410786`*^9, 
   3.899713504042119*^9}, {3.9000878487814646`*^9, 3.900087907477004*^9}, {
   3.9000879701107597`*^9, 3.900088008871433*^9}, 3.9001589972769394`*^9, {
   3.900159050444524*^9, 3.900159068460389*^9}, {3.9005876306264315`*^9, 
   3.900587708437815*^9}, {3.9006666842186756`*^9, 3.9006667101433983`*^9}, {
   3.900671353531273*^9, 3.900671353531273*^9}},
 FontSize->18,ExpressionUUID->"b2be387e-8fb0-4471-8282-17aa0f0e0453"],

Cell["Add extra plot legends and group plots where necessary", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.8948051518462944`*^9}, {
   3.894805197142715*^9, 3.894805252532962*^9}, {3.894805310837208*^9, 
   3.894805341221537*^9}, {3.8948053734362497`*^9, 3.8948053868442745`*^9}, {
   3.8948261564992857`*^9, 3.894826185928544*^9}, {3.8948267472339487`*^9, 
   3.8948268046335187`*^9}, {3.894827080024009*^9, 3.89482710542087*^9}, {
   3.8959855242137623`*^9, 3.8959855553988595`*^9}, {3.8997135040410786`*^9, 
   3.899713504042119*^9}, {3.9000878487814646`*^9, 3.900087907477004*^9}, {
   3.9000879701107597`*^9, 3.900088008871433*^9}, 3.9001589972769394`*^9, {
   3.900159050444524*^9, 3.900159068460389*^9}, {3.9005876306264315`*^9, 
   3.900587708437815*^9}, {3.9006666842186756`*^9, 3.9006667101433983`*^9}, {
   3.90067135391821*^9, 3.900671369510331*^9}},
 FontSize->18,ExpressionUUID->"e8a046fd-5a3a-4a08-9cd6-1c2dd48bad12"]
}, Open  ]],

Cell["ALWAYS EVALUATE \[OpenCurlyQuote]Initialization\[CloseCurlyQuote] \
FIRST", "Abstract",
 CellChangeTimes->{{3.888922906196766*^9, 3.8889229194346066`*^9}, {
  3.894804961323394*^9, 3.894804965269334*^9}, {3.930291325113571*^9, 
  3.9302913434852905`*^9}},
 FontSize->24,ExpressionUUID->"c52e37fd-3f2b-4d23-814a-deca0cc62aa9"],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 
   3.890508677778922*^9}},ExpressionUUID->"0a7902ba-3100-4679-9380-\
02b3076e63e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbd", ":=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "packageDirectory", ":=", 
   "\"\<D:\\\\Science\\\\NMI (VTPMML)\\\\MHD Project\\\\Image \
Processing\\\\Mathematica Libraries & Packages\\\\Quantile \
Regression\\\\\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}], "<", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Length", "@", 
           RowBox[{"Kernels", "[", "]"}]}]}], "//", "LaunchKernels"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      "&"}], "@", "useKernels"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mainOutputFolder", "=", 
   RowBox[{"nbd", "<>", "\"\<Output\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "mainOutputFolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCheck", "[", "]"}], ":=", 
   RowBox[{
    RowBox[{"\"\<Memory in use: \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryInUse", "[", "]"}], "/", 
        RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
     "\"\< Gb\>\""}], "//", "Print"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupStart", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Memory in use: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ClearSystemCache", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"memoryCleanupFinalize", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Protect", "@", "Out"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "@", "useKernels"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Memory in use after cleanup: \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemoryInUse", "[", "]"}], "/", 
           RowBox[{"1024", "^", "3"}]}], "//", "N"}], "]"}], "<>", 
        "\"\< Gb\>\""}], "//", "Print"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{"2", "*", "$ProcessorCount"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8169304402015343`*^9, 3.8169304572329664`*^9}, {
   3.817297782007059*^9, 3.81729778360575*^9}, {3.817308232575077*^9, 
   3.8173082329091744`*^9}, {3.8173082654542065`*^9, 
   3.8173082661323175`*^9}, {3.8173083731116056`*^9, 3.817308436969288*^9}, 
   3.8173084714569016`*^9, 3.817308641528023*^9, {3.8215187351516724`*^9, 
   3.8215187451204844`*^9}, {3.8215212453537927`*^9, 
   3.8215212812414527`*^9}, {3.8215217470822363`*^9, 3.821521772298771*^9}, {
   3.821521813453446*^9, 3.821521857595766*^9}, {3.8215222341401415`*^9, 
   3.821522259318509*^9}, {3.82152326402353*^9, 3.8215232643347263`*^9}, {
   3.821530441037798*^9, 3.821530444877508*^9}, {3.821530481189026*^9, 
   3.82153057883045*^9}, {3.821542161396227*^9, 3.821542175551358*^9}, {
   3.8215580973521657`*^9, 3.8215581067121277`*^9}, {3.821605050390068*^9, 
   3.8216050553070993`*^9}, 3.8222976400725813`*^9, {3.8223704281181946`*^9, 
   3.8223704510386715`*^9}, {3.822370484639129*^9, 3.8223706107676973`*^9}, {
   3.8223706477507224`*^9, 3.8223706492089605`*^9}, {3.828688650553396*^9, 
   3.8286886604331484`*^9}, {3.8286887169625216`*^9, 3.82868871879954*^9}, 
   3.837423323092683*^9, {3.8374471631829567`*^9, 3.837447166189891*^9}, 
   3.837482865647195*^9, {3.83748650590446*^9, 3.837486515674389*^9}, {
   3.8374865601047926`*^9, 3.8374865698484826`*^9}, {3.837573800224904*^9, 
   3.837573827721392*^9}, {3.8382948555756283`*^9, 3.8382948875230775`*^9}, {
   3.8392405080734577`*^9, 3.839240509496673*^9}, {3.845908474521624*^9, 
   3.845908486131469*^9}, {3.8460780854049487`*^9, 3.8460780863893166`*^9}, {
   3.8468449093043537`*^9, 3.846844911120497*^9}, 3.846845057328478*^9, {
   3.8468450886410856`*^9, 3.846845088896404*^9}, {3.8468451740330434`*^9, 
   3.8468451944241047`*^9}, {3.847633582605837*^9, 3.847633582957895*^9}, 
   3.8521991480171003`*^9, {3.8542845528223853`*^9, 3.854284566766261*^9}, {
   3.8546067085403414`*^9, 3.854606718740966*^9}, 3.855684893220052*^9, {
   3.88831414352378*^9, 3.8883141487731967`*^9}, {3.8889239447295322`*^9, 
   3.8889239518936615`*^9}, {3.889165761976347*^9, 3.8891657724817114`*^9}, {
   3.889898236868268*^9, 3.8898983075866747`*^9}, 3.889981877139629*^9, {
   3.8901318183226905`*^9, 3.8901318584877768`*^9}, {3.8901319074468603`*^9, 
   3.890131912198653*^9}, {3.890132095418976*^9, 3.8901321015214944`*^9}, 
   3.8901983781346855`*^9, {3.8902093468712406`*^9, 3.89020937629113*^9}, {
   3.8903842578656683`*^9, 3.8903842592897663`*^9}, {3.8907148424415026`*^9, 
   3.890714849790765*^9}, {3.890720681833416*^9, 3.8907206948838787`*^9}, {
   3.8928284198180013`*^9, 3.8928284202993*^9}, 3.892918082467703*^9, {
   3.894826375532895*^9, 3.894826378457651*^9}, {3.896368873022723*^9, 
   3.89636890499323*^9}, {3.896368974004279*^9, 3.8963689769333963`*^9}, {
   3.896437869641526*^9, 3.8964378700893507`*^9}, {3.8964393688238535`*^9, 
   3.8964393869032793`*^9}, 3.9091480231369305`*^9},
 CellLabel->
  "In[2478]:=",ExpressionUUID->"ab188b0e-0b8c-4d83-8dbe-6e47cf17a532"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Images <<", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8474400491164675`*^9, 3.8474400514841356`*^9}, {3.8905086724664745`*^9, 
  3.890508675362257*^9}},ExpressionUUID->"80fd0985-c1c7-4fcd-9f0d-\
048ce9507304"],

Cell["\<\
Pixel sizes / frame durations :\[LineSeparator]

MSR1-20191113_9b :   0.108 \[Mu]m
2019_11_13__8all :   0.108 \[Mu]m
2019_11_13_9all :   0.108 \[Mu]m
2019_11_13_10all :   0.108 \[Mu]m 
2019_11_13_11all :   0.108 \[Mu]m
  --------------------------------------------------
FPS :

MSR1-20191113_9b :   30 fps / 1/3*10^-2 ms
2019_11_13__8all :    20 fps / 50 ms
2019_11_13_9all :   20 fps / 50 ms
2019_11_13_10all :   20 fps / 50 ms
2019_11_13_11all :   20 fps / 50 ms\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, 3.8997981936052575`*^9, {
   3.8998709924898815`*^9, 3.899871054646696*^9}, {3.900665346017703*^9, 
   3.9006653889366684`*^9}, {3.900665534649121*^9, 3.900665534720928*^9}, {
   3.900665585056924*^9, 3.9006656144255533`*^9}, {3.909248679395092*^9, 
   3.90924868919796*^9}},ExpressionUUID->"e17462da-ef85-4e1c-b3d9-\
cfe80af1f5b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pixelSizeMicroMeters", "=", "0.108"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDurationMiliSeconds", "=", "50"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDurationSeconds", "=", 
   RowBox[{
    RowBox[{"frameDurationMiliSeconds", "/", "1000"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameRate", "=", 
   RowBox[{"1000", "/", "frameDurationMiliSeconds"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conversionFactors", "=", 
    RowBox[{"{", 
     RowBox[{"pixelSizeMicroMeters", "^", "2"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"imageFolder", ":=", 
  "\"\<D:\\\\[BIG DATA]\\\\ACTIVE - Data From Experiments\\\\MMML \
Data\\\\Bacteria Swarms - Small\\\\\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "subFolder", "=", "\"\<2019_11_13\\\\2019_11_13_11all_cropped\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileFolder", "=", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"imageFolder", "<>", "subFolder"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "\"\<*.tiff\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mainOutputFolder", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "fileFolder"}], "<>", "$PathnameSeparator"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "output"}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCSVfolder", "=", 
   RowBox[{"output", "<>", "\"\<CSV\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataCSVfolder"}], ";"}], "//", "Quiet"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCompressedfolder", "=", 
   RowBox[{"output", "<>", "\"\<Compressed Data\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "dataCompressedfolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figureSVGfolder", "=", 
   RowBox[{"output", "<>", "\"\<SVG\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "figureSVGfolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testImages", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{"fileFolder", "<>", "$PathnameSeparator", "<>", 
       RowBox[{"files", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}],
     "/@", 
    RowBox[{"{", "1", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223706440166283`*^9, 3.822370655408784*^9}, {
   3.828688415466848*^9, 3.82868842302295*^9}, {3.8374366106307073`*^9, 
   3.837436612730121*^9}, {3.8374366659407735`*^9, 3.837436692066312*^9}, {
   3.8381903902811985`*^9, 3.83819039139227*^9}, {3.8381904680399017`*^9, 
   3.8381904695363336`*^9}, 3.838216530611554*^9, {3.8382191179383373`*^9, 
   3.8382191248648205`*^9}, {3.8382729728363075`*^9, 3.838272996674044*^9}, {
   3.8382863609276934`*^9, 3.8382863610304193`*^9}, {3.838305050105472*^9, 
   3.8383050674773693`*^9}, 3.8383531801353483`*^9, 3.8383552870779576`*^9, 
   3.838355950741046*^9, {3.8383583080979815`*^9, 3.838358320838064*^9}, 
   3.838358642262561*^9, 3.83835938412653*^9, {3.8383596741132855`*^9, 
   3.838359675237794*^9}, 3.8383672241736517`*^9, 3.8383677158146973`*^9, 
   3.8383782172319813`*^9, 3.8383812717115183`*^9, 3.8383919404134965`*^9, {
   3.8383951404896803`*^9, 3.838395141945258*^9}, 3.8383957508263054`*^9, 
   3.8383962092769995`*^9, 3.838440178597614*^9, {3.8384603062397842`*^9, 
   3.83846030632755*^9}, 3.8384874747868905`*^9, 3.8384886340622716`*^9, 
   3.8384898184326525`*^9, 3.8387144349807224`*^9, 3.838718387768408*^9, 
   3.838783672135442*^9, 3.8387855431967335`*^9, 3.8388052155423717`*^9, 
   3.8388052707430196`*^9, 3.8388138451768236`*^9, 3.8388182456485386`*^9, 
   3.839148895384262*^9, 3.8391507672002506`*^9, {3.8392272156353474`*^9, 
   3.8392272162187853`*^9}, 3.8392286941850123`*^9, 3.8392361561605406`*^9, 
   3.839237054370471*^9, 3.8392376434789*^9, 3.839239551639701*^9, {
   3.8392405156909723`*^9, 3.8392405166323752`*^9}, 3.8426915720122404`*^9, 
   3.8426995743483825`*^9, 3.842701441707861*^9, {3.842955349114176*^9, 
   3.842955352410673*^9}, {3.842965903750918*^9, 3.8429659307674704`*^9}, {
   3.8429674715058975`*^9, 3.8429674715916667`*^9}, 3.8429683448606544`*^9, 
   3.843012375014877*^9, 3.8430132360946603`*^9, 3.843014548711771*^9, {
   3.84303679316053*^9, 3.8430368204441023`*^9}, 3.8430372772194633`*^9, 
   3.84303914834064*^9, 3.843041855422675*^9, 3.8430425183085155`*^9, 
   3.8430441409883466`*^9, 3.8430458153123665`*^9, 3.843046434447945*^9, 
   3.8432706623841705`*^9, 3.8458140268217945`*^9, 3.8458142420373936`*^9, {
   3.845814453698887*^9, 3.845814454283103*^9}, 3.8458147898582354`*^9, 
   3.845814918747543*^9, 3.845952924411313*^9, 3.845963521992029*^9, 
   3.8459655352923117`*^9, 3.845976038814541*^9, 3.845994196093089*^9, {
   3.8460477500394373`*^9, 3.8460477510575123`*^9}, 3.8460520665603027`*^9, 
   3.8462449041652713`*^9, {3.8471795139218264`*^9, 3.8471795148409224`*^9}, 
   3.8473576654171953`*^9, 3.8473594101762486`*^9, {3.8473615178251505`*^9, 
   3.847361518712777*^9}, 3.852223868441091*^9, {3.8522241246689367`*^9, 
   3.852224127354022*^9}, 3.854283893172999*^9, 3.854283974123249*^9, {
   3.854284028747675*^9, 3.8542840361945086`*^9}, {3.8546066921224084`*^9, 
   3.8546067913507395`*^9}, 3.860576169449164*^9, 3.860576255705443*^9, 
   3.8605763894079404`*^9, {3.86057685706324*^9, 3.8605768843226213`*^9}, 
   3.8606702712773504`*^9, {3.86073503842074*^9, 3.860735065978959*^9}, 
   3.860920334990741*^9, 3.861468008499719*^9, {3.861549367591876*^9, 
   3.861549369023287*^9}, 3.8615494706474485`*^9, 3.861551661877142*^9, 
   3.8615517295575304`*^9, {3.8615519494698534`*^9, 3.86155195636662*^9}, 
   3.8616140465087533`*^9, 3.861616996296524*^9, 3.8616170617156515`*^9, 
   3.8616172704118323`*^9, 3.861650609512191*^9, 3.8616997318111105`*^9, 
   3.8616998512851644`*^9, 3.861699942200835*^9, 3.8617822044287*^9, 
   3.8617822627454386`*^9, {3.8617920886905766`*^9, 3.8617921010953455`*^9}, {
   3.8617989203499813`*^9, 3.861798928798402*^9}, {3.861799913340885*^9, 
   3.861799927804253*^9}, {3.861800345316432*^9, 3.8618003525178585`*^9}, {
   3.86181483099113*^9, 3.8618148443292217`*^9}, 3.8618688336974387`*^9, {
   3.862045267973294*^9, 3.8620452740683985`*^9}, 3.862478514969168*^9, 
   3.8625042707295294`*^9, 3.8625043084647055`*^9, {3.8626568001531677`*^9, 
   3.8626568092538567`*^9}, {3.8692176956431427`*^9, 3.8692177152949505`*^9}, 
   3.8692365233272886`*^9, 3.8692366194637704`*^9, {3.885294833725152*^9, 
   3.885294841320782*^9}, {3.8854052365747857`*^9, 3.8854052412599115`*^9}, {
   3.8854055922472963`*^9, 3.8854055938157024`*^9}, 3.8854079673340645`*^9, {
   3.8883961500345616`*^9, 3.8883962011787496`*^9}, {3.888396250859366*^9, 
   3.8883963143530865`*^9}, 3.888396982601926*^9, {3.8883970349050303`*^9, 
   3.8883970444570365`*^9}, 3.8883971606172276`*^9, {3.888397212240456*^9, 
   3.8883972183127766`*^9}, {3.8883972487367496`*^9, 
   3.8883972513682947`*^9}, {3.8883973366649513`*^9, 
   3.8883973372631006`*^9}, {3.8889140791658525`*^9, 
   3.8889140800045233`*^9}, {3.88892403175506*^9, 3.8889240614087667`*^9}, {
   3.8890246062319145`*^9, 3.889024620080434*^9}, 3.8898983423873997`*^9, 
   3.890209967495713*^9, {3.8902121628342886`*^9, 3.890212168297205*^9}, 
   3.890212277516303*^9, 3.8908333148567657`*^9, 3.8927990393754654`*^9, 
   3.892811183199755*^9, 3.8929093283190026`*^9, 3.892912004719715*^9, 
   3.8929128126642265`*^9, 3.893483408726311*^9, {3.893483851388729*^9, 
   3.893483892130946*^9}, 3.893595020789238*^9, 3.894132644798708*^9, 
   3.8941331271439743`*^9, 3.894618934796352*^9, 3.894621747010389*^9, 
   3.894699242941082*^9, 3.8947130527156296`*^9, 3.894713678325944*^9, 
   3.8947202441518464`*^9, {3.8963488777532024`*^9, 3.8963489077113276`*^9}, {
   3.8969467868259034`*^9, 3.8969468588509398`*^9}, {3.8982635394601865`*^9, 
   3.898263562949216*^9}, {3.898759769427726*^9, 3.8987598019567976`*^9}, 
   3.8987599933960953`*^9, 3.8987600433399396`*^9, 3.8987679377878556`*^9, 
   3.8987679682261624`*^9, {3.898823609208624*^9, 3.898823614940817*^9}, {
   3.899798135288001*^9, 3.899798141262788*^9}, 3.899798205324564*^9, 
   3.899798260718631*^9, 3.8998653379291897`*^9, 3.8998709288580785`*^9, 
   3.899871219183766*^9, {3.899908295322106*^9, 3.899908302384104*^9}, {
   3.8999098091507807`*^9, 3.8999098173315563`*^9}, 3.8999099102888536`*^9, {
   3.900088828860634*^9, 3.9000888296600113`*^9}, {3.9003115337660246`*^9, 
   3.9003115416709337`*^9}, 3.9003116203091607`*^9, {3.90032528488822*^9, 
   3.900325291613229*^9}, 3.9003269408393583`*^9, 3.9004144707109976`*^9, {
   3.9004145032242146`*^9, 3.9004145235828266`*^9}, 3.900427538647484*^9, {
   3.9004282541571226`*^9, 3.900428254406458*^9}, 3.9004283906832666`*^9, 
   3.9004349807512827`*^9, 3.9005986066269503`*^9, {3.9006153527759433`*^9, 
   3.900615352837524*^9}, {3.900665423386632*^9, 3.90066542342747*^9}, 
   3.9006694508767757`*^9, {3.900670807774931*^9, 3.9006708089656396`*^9}, 
   3.903154027967885*^9, {3.9031540595418916`*^9, 3.903154062553068*^9}, 
   3.9031997278405995`*^9, {3.9032031343679795`*^9, 3.9032031406762657`*^9}, 
   3.9033464216572227`*^9, 3.903363851391332*^9, 3.903366055584881*^9, 
   3.903366761687172*^9, {3.9033671099688177`*^9, 3.9033671150701137`*^9}, 
   3.9091783408393836`*^9, {3.9092486539588633`*^9, 3.909248654632864*^9}, {
   3.9092620580700426`*^9, 3.9092620662639894`*^9}, {3.9092621946787376`*^9, 
   3.90926219540302*^9}, {3.909399678889777*^9, 3.909399748011541*^9}, {
   3.909408836916426*^9, 3.9094088405660105`*^9}, 3.909506945911566*^9, 
   3.9095079077241917`*^9, 3.9095095815770464`*^9, 3.909763260468707*^9, {
   3.909994226717275*^9, 3.909994229220044*^9}, 3.910262786472221*^9, 
   3.910262825316229*^9, 3.910526638422332*^9, 3.910620600486313*^9, {
   3.9106207655050583`*^9, 3.9106207658000107`*^9}, {3.9109596879973855`*^9, 
   3.9109596884789953`*^9}, 3.9109597187507105`*^9, 3.910970301088915*^9, {
   3.9109706494659276`*^9, 3.9109706698046207`*^9}, {3.9109836867498574`*^9, 
   3.9109836909986477`*^9}, 3.910983806837716*^9, {3.9109841159513583`*^9, 
   3.910984131028698*^9}, 3.9109850093857355`*^9, 3.9109870978629293`*^9, {
   3.9116808191571894`*^9, 3.911680825629899*^9}, {3.9117267355489664`*^9, 
   3.911726745828261*^9}, 3.9117439844611225`*^9, 3.9117505986207128`*^9, 
   3.9117511528286552`*^9, {3.9117528353723154`*^9, 3.911752841041359*^9}, {
   3.9139728763129015`*^9, 3.913972883184521*^9}, {3.913980844840376*^9, 
   3.9139808615907917`*^9}, {3.9139809369203367`*^9, 3.913980937189619*^9}, 
   3.913981084983636*^9, 3.9163370080644507`*^9, 3.9163371543224688`*^9, {
   3.91633735934649*^9, 3.9163373691913133`*^9}, 3.9164244534579554`*^9, 
   3.9164246147824354`*^9, {3.9164757224406614`*^9, 3.9164757495516863`*^9}, {
   3.9164778019787645`*^9, 3.916477806414214*^9}, 3.9164788365289354`*^9, 
   3.9216503943175383`*^9, 3.921677563897884*^9, 3.921677657991407*^9, {
   3.921677985466196*^9, 3.9216779891550684`*^9}, 3.9216834256972103`*^9, 
   3.9217449275471716`*^9, 3.930229099798218*^9, {3.930296804276101*^9, 
   3.930296814860077*^9}, {3.930296889128871*^9, 3.9302969002652454`*^9}, {
   3.930297161674841*^9, 3.930297163336253*^9}, 3.9302982496254826`*^9, 
   3.9303021041440473`*^9, 3.9303021452798414`*^9, {3.9303023749993176`*^9, 
   3.930302376501109*^9}, {3.9303025355376205`*^9, 3.930302536901127*^9}, 
   3.9303029062878933`*^9},
 CellLabel->
  "In[2496]:=",ExpressionUUID->"f2df995a-561c-4dcc-83ed-057b4b0b65b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"images", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fileFolder", "<>", "$PathnameSeparator", "<>", "#"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "@", 
     RowBox[{"First", "@", "images"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"ImageDimensions", ",", "ImageType"}], "}"}]}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.82237034851377*^9, 3.822370354429882*^9}, 
   3.822370406705285*^9, {3.8223707318084*^9, 3.8223707386015005`*^9}, {
   3.8223708729527082`*^9, 3.822370904441451*^9}, {3.8459085060339146`*^9, 
   3.8459085143374596`*^9}, 3.8609203411662297`*^9, {3.88537816042834*^9, 
   3.8853782515299673`*^9}, {3.889024629776803*^9, 3.8890246300244803`*^9}, {
   3.889898347437231*^9, 3.889898347625966*^9}, {3.8900450734216557`*^9, 
   3.890045084298572*^9}, {3.8932634378919077`*^9, 3.893263488648225*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"a4efabc0-6431-4664-b053-de608be82619"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 
  3.8468307830344753`*^9}},ExpressionUUID->"a6c1a855-d2ce-4ce7-8e77-\
3002edfcfd56"],

Cell["ALWAYS EVALUATE THESE", "Abstract",
 CellChangeTimes->{{3.9302912326562643`*^9, 3.9302912635169945`*^9}, {
  3.930291295979615*^9, 3.9302912964203715`*^9}},
 FontSize->24,ExpressionUUID->"20e40580-43f6-4c5f-853c-559b2bb054ce"],

Cell[CellGroupData[{

Cell["Image Filtering & Manipulation", "Subsection",
 CellChangeTimes->{{3.8381889592254605`*^9, 3.8381889906103125`*^9}},
 FontSize->24,ExpressionUUID->"0e5b0001-b41e-4467-b3f9-0da9893d8598"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"backgroundBias", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderBias", "=", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applySCTMM", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "]"}]}], "&"}], "@", 
    "image"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyNMM", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "*", "image"}], "-", 
     RowBox[{"nonlocalCorrectionWeight", "*", 
      RowBox[{"NonlocalMeansFilter", "[", "\[IndentingNewLine]", 
       RowBox[{
       "image", ",", "nonlocalCorrectionRadius", ",", "nonlocalNoiseFactor"}],
        "\[IndentingNewLine]", "]"}]}]}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getChanVeseLevelSet", "[", 
     RowBox[{"lambda_", ",", "gridPoints_", ",", "image_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", 
        RowBox[{"First", "@", 
         RowBox[{"ImageDimensions", "@", "image"}]}]}], "]"}], "&"}], "@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"\[Pi]", "/", "lambda"}]}], "\[IndentingNewLine]", "]"}], 
         "*", 
         RowBox[{"Sin", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{"\[Pi]", "/", "lambda"}]}], "\[IndentingNewLine]", "]"}]}],
         "&"}], "/@", "gridPoints"}], "\[IndentingNewLine]", ")"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getChanVeseGridPoints", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "#2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "#1"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], "&"}], "@@", 
    RowBox[{"ImageDimensions", "@", "image"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"applyCustomChanVese", "[", "image_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ChanVeseBinarize", "[", "\[IndentingNewLine]", 
       RowBox[{
       "#", ",", "initialLevelSetImage", ",", "customChanVeseWeights", ",", 
        RowBox[{"MaxIterations", "\[Rule]", "levelSetIterations"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", "image"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentationSmallSwarmsChanVese", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DeleteSmallComponents", "[", 
            RowBox[{"#", ",", "swarmSizeThreshold"}], "]"}], "&"}], "@", 
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Closing", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "closingScale"}]}], "]"}]}]}], "&"}], 
        "@", 
        RowBox[{"Dilation", "[", 
         RowBox[{"#", ",", 
          RowBox[{"DiskMatrix", "@", "dilationScale"}]}], "]"}]}], "&"}], "@", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mean", "@", "#"}], ">", "levelSetInversionThreshold"}], ",", 
        RowBox[{"ColorNegate", "@", "#"}], ",", "#"}], "]"}]}], "&"}], "@", 
    "\[IndentingNewLine]", 
    RowBox[{"applyCustomChanVese", "@", "image"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"preprocessImage", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"BrightnessEqualize", "[", 
      RowBox[{"#", "+", "placeholderBias"}], "]"}], "&"}], "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"ColorToneMapping", "@", 
      RowBox[{"ImageAdjust", "@", "image"}]}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viewImage", "[", "image_", "]"}], ":=", 
   RowBox[{"Image", "[", 
    RowBox[{"image", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalFilter", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{"applySCTMM", ",", "#", ",", "SCTMMiterations"}], "]"}], 
       "&"}], "@", 
      RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", "totalVariationWeight", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}], ",", 
        RowBox[{"MaxIterations", "\[Rule]", "totalVariationIterations"}]}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
    RowBox[{"ColorNegate", "@", 
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"preprocessImage", "@", "image"}]}]}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentation", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"#", ",", "sizeThreshold"}], "]"}], "&"}], "@", 
        RowBox[{"FillingTransform", "@", 
         RowBox[{"Erosion", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "erosionScale"}]}], "]"}]}]}], "&"}], 
      "@", 
      RowBox[{"Binarize", "@", 
       RowBox[{"GaussianFilter", "[", 
        RowBox[{"#", ",", "smoothingScale"}], "]"}]}]}], "&"}], "@", 
    RowBox[{"Binarize", "@", "image"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentationAlternative", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DeleteBorderComponents", "@", 
            RowBox[{"DeleteSmallComponents", "[", 
             RowBox[{"#", ",", "sizeThreshold"}], "]"}]}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Opening", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "openingScale"}]}], "]"}]}]}], "&"}], 
        "@", 
        RowBox[{"Erosion", "[", 
         RowBox[{"#", ",", 
          RowBox[{"DiskMatrix", "@", "erosionScale"}]}], "]"}]}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"Binarize", "@", 
       RowBox[{"GaussianFilter", "[", 
        RowBox[{"#", ",", "smoothingScale"}], "]"}]}]}], "&"}], "@", 
    RowBox[{"Binarize", "@", "image"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getEllipticMask", "[", "ruleset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Binarize", "@", 
        RowBox[{"FillingTransform", "@", 
         RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"RasterSize", "\[Rule]", 
            RowBox[{"ImageDimensions", "@", 
             RowBox[{"First", "@", "testImages"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "*", 
         RowBox[{"First", "@", "testImages"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"getEllipseGrahpicObject", "[", 
           RowBox[{"#", ",", "White", ",", "Thin"}], "]"}], "&"}], "/@", 
         "#"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", "ruleset"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"localImage", "[", "image_", "]"}], ":=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"ColorNegate", "@", "image"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonlocalFiltered", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{"NonlocalMeansFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
     "image", ",", "nonlocalFilterRadius", ",", "Automatic", ",", 
      "nonlocalFilterReach"}], "\[IndentingNewLine]", "]"}], "//", 
    "ImageAdjust"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanFilter", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{"MeanFilter", "[", 
     RowBox[{"image", ",", "meanFilterRadius"}], "]"}], "//", 
    "ImageAdjust"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"localSegmentation", "[", "image_", "]"}], ":=", 
   RowBox[{"DeleteBorderComponents", "@", 
    RowBox[{"LocalAdaptiveBinarize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"applySCTMM", "@", "image"}], ",", "adaptiveThresholdRadius"}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredRegion", "[", "image_", "]"}], ":=", 
   RowBox[{"meanFilter", "@", 
    RowBox[{"nonlocalFiltered", "@", 
     RowBox[{"applySCTMM", "@", 
      RowBox[{"applyNMM", "@", 
       RowBox[{"localImage", "@", "image"}]}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"segmentedRegion", "[", "image_", "]"}], ":=", 
   RowBox[{"localSegmentation", "@", 
    RowBox[{"filteredRegion", "@", "image"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCleanSwarmWindowMask", "[", 
    RowBox[{"image_", ",", "ellipseMask_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteBorderComponents", "@", 
          RowBox[{"FillingTransform", "@", "\[IndentingNewLine]", 
           RowBox[{"Opening", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "openingRadius"}]}], "]"}]}]}], "&"}],
         "@", "\[IndentingNewLine]", 
        RowBox[{"SelectComponents", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"#Area", ">", "minimumArea"}], "&"}]}], "]"}]}], "&"}], 
      "@", "\[IndentingNewLine]", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ColorNegate", "@", "ellipseMask"}]}], "]"}]}], "&"}], "@", 
    "image"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCheckMask", "[", 
    RowBox[{"intensityMap_", ",", "ellipseMask_", ",", "windowMask_"}], "]"}],
    ":=", 
   RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"backgroundBias", "+", "intensityMap"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageMultiply", "[", 
      RowBox[{
       RowBox[{"ColorNegate", "@", "ellipseMask"}], ",", "windowMask"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"segmentRegion", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Last", "@", 
           RowBox[{"FindShortestTour", "@", "#"}]}]}], "]"}], "&"}], "@", 
       "\[IndentingNewLine]", 
       RowBox[{"PixelValuePositions", "[", 
        RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
     RowBox[{"MorphologicalPerimeter", "[", 
      RowBox[{"image", ",", 
       RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], "]"}]}], "//", 
    "Polygon"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBlackWindow", "[", 
    RowBox[{"widthPixels_", ",", "heightPixels_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"getBlackWindow", "[", 
     RowBox[{"widthPixels", ",", "heightPixels"}], "]"}], "=", 
    RowBox[{"Image", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "heightPixels"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "widthPixels"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCentralEllipseSW", "[", "maskSW_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inputMask", "=", "maskSW"}], ",", "masksCentroidsSW", ",", 
       "centerSW"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"masksCentroidsSW", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "/@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<Mask\>\"", ",", "\"\<Centroid\>\""}], "}"}]}], 
           "]"}]}], "&"}], "@", "inputMask"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"centerSW", "=", 
       RowBox[{"0.5", "*", 
        RowBox[{"ImageDimensions", "@", "inputMask"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"masksCentroidsSW", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
             RowBox[{"Last", "@", 
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{"Last", "/@", "masksCentroidsSW"}], ",", "centerSW"}],
                "]"}]}]}], "&"}]}], "\[IndentingNewLine]", "]"}], "//", 
         "Last"}], "//", "First"}], "//", "Image"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPointGrowthMask", "[", 
    RowBox[{"windowMask_", ",", "windowParticles_"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getBlackWindow", "@@", 
        RowBox[{"ImageDimensions", "@", "windowMask"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"windowParticles", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"PointSize", "@", "pointSeedSize"}]}], "}"}], "}"}]}]}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"maskDownscaleFactor", "*", 
       RowBox[{"ImageDimensions", "@", "windowMask"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"growPointClusters", "[", "growthMask_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Nest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ArrayFilter", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}], "\[Equal]", "0"}], 
                 ",", 
                 RowBox[{"Max", "@", "#"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], ",",
               "\[IndentingNewLine]", "#", ",", "growthIncrement"}], 
             "\[IndentingNewLine]", "]"}], "&"}], ",", "#", ",", 
           "growthIterations"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"MorphologicalComponents", "[", 
         RowBox[{"#", ",", "0.5", ",", 
          RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], "]"}]}], "&"}], 
      "@", 
      RowBox[{"ImagePad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"-", "2"}]}], "]"}]}], "&"}], "@", "growthMask"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInitialComponents", "[", "growthMask_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MorphologicalComponents", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", "0.5", ",", 
         RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", 
      RowBox[{"ImagePad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"-", "2"}]}], "]"}]}], "&"}], "@", "growthMask"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"growInitializedPointClusters", "[", "growthMask_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Nest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ArrayFilter", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"Max", "@", "#"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
          "\[IndentingNewLine]", "#", ",", "growthIncrement"}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", "#", ",", 
       "growthIterations"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    "growthMask"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCleanSwarmWindowMaskAlternative", "[", 
    RowBox[{"image_", ",", "ellipseMask_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SelectComponents", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#Area", ">", "minimumArea"}], "&"}]}], "]"}], "&"}], 
          "@", "\[IndentingNewLine]", 
          RowBox[{"DeleteBorderComponents", "@", 
           RowBox[{"FillingTransform", "@", "\[IndentingNewLine]", 
            RowBox[{"Opening", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DiskMatrix", "@", "openingRadius"}]}], "]"}]}]}]}], 
         "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"SelectComponents", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"#Area", ">", "minimumArea"}], "&"}]}], "]"}]}], "&"}], 
      "@", "\[IndentingNewLine]", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ColorNegate", "@", "ellipseMask"}]}], "]"}]}], "&"}], "@", 
    "image"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanCorrection", "[", 
    RowBox[{"image_", ",", "meanImage_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"image", "-", "meanImage"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalFilterSmallSwarms", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Nest", "[", 
        RowBox[{"applySCTMM", ",", "#", ",", "SCTMMiterations"}], "]"}], 
       "&"}], "@", 
      RowBox[{"CurvatureFlowFilter", "[", 
       RowBox[{
       "#", ",", "curvatureFlowIterations", ",", 
        "curvatureFlowConductivity"}], "]"}]}], "&"}], "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"preprocessImage", "@", "image"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCombinedFilteredImage", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"globalFilterSmallSwarms", "/@", 
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"ColorNegate", "@", "#"}]}], "}"}]}], "&"}], "@", "image"}],
      "//", "ImageAdd"}], "//", "ImageAdjust"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentationSmallSwarms", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"#", ",", "swarmSizeThreshold"}], "]"}], "&"}], "@", 
        RowBox[{"FillingTransform", "@", 
         RowBox[{"Closing", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "closingScale"}]}], "]"}]}]}], "&"}], 
      "@", 
      RowBox[{"Dilation", "[", 
       RowBox[{"#", ",", 
        RowBox[{"DiskMatrix", "@", "dilationScale"}]}], "]"}]}], "&"}], "@", 
    RowBox[{"MorphologicalBinarize", "@", "image"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalSegmentCorrectionSmallSwarms", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteBorderComponents", "@", 
          RowBox[{"DeleteSmallComponents", "[", 
           RowBox[{"#", ",", "swarmSizeThreshold"}], "]"}]}], "&"}], "@", 
        RowBox[{"Opening", "[", 
         RowBox[{"#", ",", 
          RowBox[{"DiskMatrix", "@", "openingScale"}]}], "]"}]}], "&"}], "@", 
      RowBox[{"Binarize", "@", 
       RowBox[{"GaussianFilter", "[", 
        RowBox[{"#", ",", "blurScale"}], "]"}]}]}], "&"}], "@", "image"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imageInversionSwitch", "[", 
     RowBox[{"image_", ",", "switchIndex_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Nest", "[", 
       RowBox[{"ColorNegate", ",", "#", ",", "switchIndex"}], "]"}], "&"}], 
     "@", "image"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getEllipticMaskAlternative", "[", "ruleset_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Binarize", "@", 
       RowBox[{"FillingTransform", "@", 
        RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"RasterSize", "\[Rule]", 
           RowBox[{"ImageDimensions", "@", 
            RowBox[{"First", "@", "globalSwarmCoreSegments"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"0", "*", 
        RowBox[{"First", "@", "globalSwarmCoreSegments"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"getEllipseGrahpicObject", "[", 
          RowBox[{"#", ",", "White", ",", "Thin"}], "]"}], "&"}], "/@", 
        "#"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
   "ruleset"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8381890059119296`*^9, {3.8381893677521863`*^9, 3.8381893696496534`*^9}, {
   3.838189457199703*^9, 3.838189457584342*^9}, {3.8382126360472965`*^9, 
   3.8382126363285446`*^9}, {3.8382149489599414`*^9, 
   3.8382149492401924`*^9}, {3.838293176831523*^9, 3.8382931784701414`*^9}, {
   3.8391485552078114`*^9, 3.839148556895608*^9}, 3.839148672008988*^9, {
   3.839149255616995*^9, 3.839149259809787*^9}, {3.842955724667177*^9, 
   3.8429558004029775`*^9}, {3.842955841163106*^9, 3.8429558419005594`*^9}, 
   3.84295587762633*^9, {3.843304653089132*^9, 3.8433046561598926`*^9}, {
   3.8433048180942583`*^9, 3.8433048242616744`*^9}, {3.8433055032045217`*^9, 
   3.8433055042237835`*^9}, {3.8434800790645485`*^9, 
   3.8434800798615627`*^9}, {3.8434808011695547`*^9, 3.843480801723075*^9}, {
   3.8458162682218466`*^9, 3.8458162686108065`*^9}, {3.8466704748407636`*^9, 
   3.846670475504183*^9}, {3.8467523367189393`*^9, 3.8467523374546785`*^9}, {
   3.846752387230635*^9, 3.8467523881428027`*^9}, {3.846769318722342*^9, 
   3.8467693208825655`*^9}, {3.8467694299469147`*^9, 3.846769431114791*^9}, {
   3.846829503023484*^9, 3.8468295219189806`*^9}, {3.846829714132536*^9, 
   3.8468297147769403`*^9}, 3.846829770476872*^9, {3.8468367343621416`*^9, 
   3.846836740433859*^9}, {3.8468368184982905`*^9, 3.846836818986068*^9}, {
   3.8468376554587145`*^9, 3.846837660004117*^9}, {3.8468382162411404`*^9, 
   3.8468382198736067`*^9}, {3.8468382731475267`*^9, 
   3.8468383406590633`*^9}, {3.846838396428229*^9, 3.8468384008191967`*^9}, {
   3.8468472200165663`*^9, 3.846847221363595*^9}, {3.8468478649999065`*^9, 
   3.8468478670945644`*^9}, {3.8468491478061705`*^9, 
   3.8468491502317123`*^9}, {3.846849808653754*^9, 3.846849809929842*^9}, {
   3.8468499445745735`*^9, 3.84684994788789*^9}, {3.847444433002282*^9, 
   3.8474444341113186`*^9}, {3.8479565550591283`*^9, 3.8479565561243076`*^9}, 
   3.8479584002362967`*^9, 3.847958889635376*^9, 3.8479589355907516`*^9, 
   3.8479593282027287`*^9, 3.847961680799029*^9, {3.8480390910382395`*^9, 
   3.848039092217394*^9}, {3.8480394826619787`*^9, 3.8480394834092846`*^9}, {
   3.848040227238947*^9, 3.848040233605711*^9}, {3.8480432756919456`*^9, 
   3.8480432763426332`*^9}, {3.8480433387886744`*^9, 
   3.8480433395105877`*^9}, {3.854635135575929*^9, 3.854635143063056*^9}, {
   3.8546353048539505`*^9, 3.854635310385127*^9}, {3.8546361587395926`*^9, 
   3.8546361589820004`*^9}, {3.854723029087531*^9, 3.8547230380861025`*^9}, {
   3.8547230952710233`*^9, 3.8547230963273664`*^9}, {3.854811196436452*^9, 
   3.854811215124194*^9}, {3.8548228668299527`*^9, 3.854822867515088*^9}, 
   3.854823793720137*^9, 3.8606963696633587`*^9, {3.8615985970465927`*^9, 
   3.861598599006845*^9}, {3.861600132373684*^9, 3.8616001370973067`*^9}, {
   3.861724596314806*^9, 3.861724601881921*^9}, 3.8617762678673763`*^9, {
   3.8617791439652243`*^9, 3.8617791454780593`*^9}, 3.86178725989005*^9, 
   3.8617915019514894`*^9, {3.861791540787301*^9, 3.8617915553660483`*^9}, {
   3.8618777597683935`*^9, 3.8618778246299534`*^9}, 3.8623832640750103`*^9, {
   3.8852949994424696`*^9, 3.885295027958845*^9}, {3.8852950768516197`*^9, 
   3.885295099481221*^9}, {3.885295147676483*^9, 3.8852951600188026`*^9}, {
   3.8853805948029346`*^9, 3.885380595700157*^9}, {3.885402555673275*^9, 
   3.885402556708188*^9}, {3.888485789546218*^9, 3.8884857942821302`*^9}, {
   3.8884941328875313`*^9, 3.888494136251226*^9}, {3.8889240760145288`*^9, 
   3.888924084593076*^9}, {3.889011302374075*^9, 3.889011325056558*^9}, 
   3.8890114191910796`*^9, {3.889015894015092*^9, 3.8890159001264696`*^9}, 
   3.8890343698106813`*^9, {3.8890435816504974`*^9, 3.8890435818337193`*^9}, {
   3.889114993091215*^9, 3.8891149941964664`*^9}, {3.889115539161128*^9, 
   3.8891155456820893`*^9}, {3.8893007430483522`*^9, 
   3.8893007551364975`*^9}, {3.889300949062793*^9, 3.8893009627558208`*^9}, {
   3.8896388605138426`*^9, 3.8896388623851347`*^9}, {3.889640329470795*^9, 
   3.889640330376751*^9}, 3.889898362002493*^9, {3.890076882746663*^9, 
   3.8900768832226734`*^9}, {3.890305002612569*^9, 3.8903050182372637`*^9}, {
   3.890388575510442*^9, 3.8903885769517455`*^9}, {3.89055306998922*^9, 
   3.8905530708704767`*^9}, {3.89343961069697*^9, 3.8934396113944054`*^9}, {
   3.894826302411278*^9, 3.89482633220352*^9}, {3.8994934047714405`*^9, 
   3.8994934055482483`*^9}, {3.899493551020452*^9, 3.899493577373485*^9}, {
   3.899494277276867*^9, 3.8994942795891523`*^9}, {3.899494721026575*^9, 
   3.899494721662327*^9}, {3.899494817258607*^9, 3.8994948180623817`*^9}, {
   3.8995653445448956`*^9, 3.8995653464184475`*^9}, {3.8997105546800747`*^9, 
   3.89971055735201*^9}, {3.8998888772412424`*^9, 3.899888892348868*^9}, {
   3.8998950925510635`*^9, 3.899895095169362*^9}, {3.8999019779141912`*^9, 
   3.8999019786777306`*^9}, {3.899916922182691*^9, 3.8999169839086695`*^9}, {
   3.900067041923176*^9, 3.900067042870823*^9}, 3.9006765045188417`*^9, {
   3.910125299281283*^9, 3.91012530421658*^9}},
 CellLabel->
  "In[2515]:=",ExpressionUUID->"beaec6fc-29f0-4523-aef2-66cb9807b124"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Processing ", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, 
   3.8382140851103477`*^9},
 FontSize->24,ExpressionUUID->"8030b3f9-704c-4f14-a34c-1c106b3f9c9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xPad", "[", "box_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"box", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"box", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"scaleBoxFactor", "-", "1"}], ")"}], "/", "2"}]}], ")"}], "//",
    "Round"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yPad", "[", "box_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"scaleBoxFactor", "-", "1"}], ")"}], "/", "2"}]}], ")"}], "//",
     "Round"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boxCenter", "[", "box_", "]"}], " ", ":=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newBox", "[", "box_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
            RowBox[{"xPad", "@", "box"}]}], ")"}], "<", "0"}], " ", ",", "0", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"box", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
          RowBox[{"xPad", "@", "box"}]}]}], "\[IndentingNewLine]", "]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
            RowBox[{"yPad", "@", "box"}]}], ")"}], "<", "0"}], " ", ",", "0", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"box", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"yPad", "@", "box"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"xPad", "@", "box"}]}], ")"}], ">", "widthPixels"}], ",", 
         "widthPixels", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"box", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"xPad", "@", "box"}]}]}], "\[IndentingNewLine]", "]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"box", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"yPad", "@", "box"}]}], ")"}], ">", "heightPixels"}], ",",
          "heightPixels", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"box", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"yPad", "@", "box"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getEllipseGrahpicObject", "[", 
    RowBox[{"parameters_", ",", "color_", ",", "style_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Rotate", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ArcTan", "@", 
          RowBox[{"Tan", "@", "\[Phi]"}]}]}], "]"}], "&"}], "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"color", ",", "style", ",", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"h", ",", "k"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], "]"}], "/.", "parameters"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getEllipseRulesets", "[", "fitParameters_", "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"h", ",", "k", ",", "a", ",", "b", ",", "\[Phi]"}], "}"}], 
       ",", "fitParameters"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getScanSteps", "[", 
    RowBox[{"images_", ",", "offset_", ",", "axis_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "windowSize"}], "/", "offset"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"axis", "@", 
           RowBox[{"ImageDimensions", "@", "#"}]}], "/", "offset"}]}], 
        "\[IndentingNewLine]", ")"}], "&"}], "/@", "images"}], "//", "N"}], "//",
     "Round"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"truePosition", "[", 
    RowBox[{"windowCentroid_", ",", "referenceImage_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"ImageDimensions", "@", "referenceImage"}]}], "-", 
        RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}], "&"}], 
    "@", 
    RowBox[{"Reverse", "@", "windowCentroid"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTestPatchBounds", "[", 
    RowBox[{"testID_", ",", "windowTestID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "/@", "#"}], ",", 
        RowBox[{"Max", "/@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"Abs", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"samplingOffset", ",", "2"}], "]"}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
         RowBox[{"Last", "@", 
          RowBox[{"ImageDimensions", "@", 
           RowBox[{"swarmWindowsUnified", "[", 
            RowBox[{"[", "testID", "]"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", "}"}], "-", 
      RowBox[{"windowBounds", "[", 
       RowBox[{"[", 
        RowBox[{"testID", ",", "windowTestID"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", 
    RowBox[{"images_", ",", "folder_", ",", "format_", ",", "compression_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imageSequence", "=", "images"}], ",", 
       RowBox[{"exportFormat", "=", "format"}], ",", "\[IndentingNewLine]", 
       RowBox[{"exportFolder", "=", "folder"}], ",", 
       RowBox[{"compressionLevel", "=", "compression"}], ",", "k", ",", 
       "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "@", "imageSequence"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"exportFolder", "<>", "\"\<Frame_\>\"", "<>", 
               RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
              RowBox[{"imageSequence", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequenceWithSize", "[", 
    RowBox[{
    "images_", ",", "folder_", ",", "format_", ",", "compression_", ",", 
     "resolution_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imageSequence", "=", "images"}], ",", 
       RowBox[{"exportFormat", "=", "format"}], ",", 
       RowBox[{"exportFolder", "=", "folder"}], ",", "\[IndentingNewLine]", 
       RowBox[{"compressionLevel", "=", "compression"}], ",", 
       RowBox[{"imageResolution", "=", "resolution"}], ",", "k", ",", 
       "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "@", "imageSequence"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"exportFolder", "<>", "\"\<Frame_\>\"", "<>", 
               RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
              RowBox[{"imageSequence", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}], 
              ",", 
              RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findEligibleParticles", "[", "image_", "]"}], ":=", 
   RowBox[{"Last", "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
       RowBox[{"image", ",", "\"\<Centroid\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "#Elongation"}], ")"}]}], "/", 
           "#Circularity"}], "<", "criticalFactor"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", ")"}]}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getNearestNeighborTracks", "[", 
    RowBox[{"list_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"index", ",", "next"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"index", "=", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"next", "=", 
       RowBox[{
        RowBox[{"Length", "@", "index"}], "+", "1"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Reap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Sow", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], "]"}]}], "}"}], 
               ",", "#"}], "]"}], "&"}], ",", "index"}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"newIndex", "@", 
               RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Index\>\"", ",", "\"\<Distance\>\""}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "threshold"}], "}"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}], "]"}]}], "}"}], 
                  ",", "#"}], "]"}], "&"}], ",", "n"}], "\[IndentingNewLine]",
               "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "@", "list"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "_", ",", 
         RowBox[{"#2", "&"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "]"}], "//", "Last"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toIndex", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", 
  RowBox[{"next", "++"}]}], "\n", 
 RowBox[{
  RowBox[{"toIndex", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a_Integer", ",", "_"}], "}"}], "}"}], "]"}], ":=", 
  RowBox[{"toIndex", "@", "a"}]}], "\n", 
 RowBox[{
  RowBox[{"toIndex", "[", "a_Integer", "]"}], ":=", 
  RowBox[{"index", "[", 
   RowBox[{"[", "a", "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"newIndex", "[", "list_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"old", "=", 
       RowBox[{"toIndex", "/@", "list"}]}], "}"}], ",", 
     RowBox[{"index", "=", "old"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMatchingIndex", "[", 
    RowBox[{"list_", ",", "checkedElement_"}], "]"}], ":=", 
   RowBox[{"Position", "[", 
    RowBox[{"list", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "==", "checkedElement"}], "&"}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDataBins", "[", "dataset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"N", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
          RowBox[{"First", "@", "#"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Rescale", "@", 
          RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
     "&"}], "@", "dataset"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeOutliers", "[", 
    RowBox[{"dataset_", ",", "deviationFactor_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "dataset"}], ",", 
       RowBox[{"factor", "=", "deviationFactor"}], ",", "\[IndentingNewLine]",
        "meansDeviations", ",", "bounds", ",", "outlierPositions", ",", 
       "\[IndentingNewLine]", "replacementValues", ",", "replacementRules"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"meansDeviations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "@", "#"}], ",", 
           RowBox[{"StandardDeviation", "@", "#"}]}], "}"}], "&"}], "@", 
        "input"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bounds", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "@", "#"}], "-", 
            RowBox[{"factor", "*", 
             RowBox[{"Last", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"First", "@", "#"}], "+", 
            RowBox[{"factor", "*", 
             RowBox[{"Last", "@", "#"}]}]}]}], "\[IndentingNewLine]", "}"}], 
         "&"}], "@", "meansDeviations"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outlierPositions", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{"input", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{
               RowBox[{"First", "@", "bounds"}], "<", "#", "<", 
               RowBox[{"Last", "@", "bounds"}]}], "]"}], "&"}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Nest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MedianFilter", "[", 
             RowBox[{"#", ",", "outlierMedianFilterRadius"}], "]"}], "&"}], 
           ",", "\[IndentingNewLine]", "#", ",", 
           "outlierMedianFilterIterations"}], "\[IndentingNewLine]", "]"}], 
         "&"}], "@", "input"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementRules", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "\[Rule]", 
           RowBox[{"replacementValues", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        "outlierPositions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"input", ",", "replacementRules"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCenteredPolarCoordinates", "[", 
    RowBox[{"particles_", ",", "swarmWindow_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centroids", "=", "particles"}], ",", 
       RowBox[{"window", "=", "swarmWindow"}], ",", "\[IndentingNewLine]", 
       "swarmWindowCenter", ",", "windowParticlesCentered"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"swarmWindowCenter", "=", 
       RowBox[{
        RowBox[{"Mean", "/@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"ImageDimensions", "@", "swarmWindow"}]}], "}"}]}]}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"windowParticlesCentered", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "swarmWindowCenter"}], ")"}], "&"}], "/@", 
        "centroids"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ToPolarCoordinates", "@", "windowParticlesCentered"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportBatchImageSequence", "[", 
    RowBox[{"images_", ",", "folder_", ",", "format_", ",", "compression_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imageSequence", "=", "images"}], ",", 
       RowBox[{"exportFormat", "=", "format"}], ",", 
       RowBox[{"exportFolder", "=", "folder"}], ",", 
       RowBox[{"compressionLevel", "=", "compression"}], ",", "k", ",", 
       "monitorCounter"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k", "=", 
            RowBox[{"First", "@", 
             RowBox[{"batchIndices", "[", 
              RowBox[{"[", "batchID", "]"}], "]"}]}]}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Last", "@", 
             RowBox[{"batchIndices", "[", 
              RowBox[{"[", "batchID", "]"}], "]"}]}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"exportFolder", "<>", "\"\<Frame_\>\"", "<>", 
               RowBox[{"ToString", "@", "k"}], "<>", "exportFormat"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"imageSequence", "[", 
               RowBox[{"[", "\[IndentingNewLine]", 
                RowBox[{"k", "+", "1", "-", 
                 RowBox[{"First", "@", 
                  RowBox[{"batchIndices", "[", 
                   RowBox[{"[", "batchID", "]"}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"CompressionLevel", "\[Rule]", "compressionLevel"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "imageSequence"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPixelCoordinates", "[", "image_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"First", "@", 
        RowBox[{"List", "@", 
         RowBox[{"Delete", "[", 
          RowBox[{"#", ",", "0"}], "]"}]}]}]}], "&"}], "@", 
     RowBox[{"First", "@", 
      RowBox[{"Last", "@", 
       RowBox[{"First", "@", 
        RowBox[{"ComponentMeasurements", "[", 
         RowBox[{"image", ",", "\"\<Contours\>\""}], "]"}]}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"buildBoundarySpline", "[", 
     RowBox[{"boundaryPoints_", ",", " ", "splineOrder_"}], "]"}], ":=", 
    RowBox[{"BSplineFunction", "[", "\n", 
     RowBox[{"boundaryPoints", ",", 
      RowBox[{"SplineDegree", "\[Rule]", "splineOrder"}], ",", 
      RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arcIncrement", "[", 
    RowBox[{
     RowBox[{"t_", "?", "NumericQ"}], ",", "spline_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "-", "1."}], "<=", "0"}], ",", 
     RowBox[{
      RowBox[{"spline", "'"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"spline", "'"}], "[", "1", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getCheckpoints", "[", "spline_", "]"}], ":=", 
    RowBox[{"NDSolveValue", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "==", 
         RowBox[{"1", "/", 
          RowBox[{"Norm", "@", 
           RowBox[{"arcIncrement", "[", 
            RowBox[{
             RowBox[{"t", "[", "s", "]"}], ",", "spline"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "==", "0"}], ",", 
        RowBox[{"WhenEvent", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", "s", "]"}], "==", "1"}], ",", 
          "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
      ",", "t", ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", 
        RowBox[{"1", "+", 
         RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"spline", "'"}], "[", "t", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", "\"\<LocalAdaptive\>\""}], ",", 
           RowBox[{"MaxRecursion", "\[Rule]", "500"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
     "]"}]}], ";"}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniformlySampleSpline", "[", 
     RowBox[{"spline_", ",", "pointCount_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "arcCheckpoints", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arcCheckpoints", "=", 
        RowBox[{"getCheckpoints", "@", "spline"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{"spline", ",", 
         RowBox[{"arcCheckpoints", "@", 
          RowBox[{"Rescale", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1", "/", "pointCount"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"arcCheckpoints", "[", "\"\<Domain\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUpsampledBoundary", "[", "swarmMask_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inputMask", "=", "swarmMask"}], ",", "boundaryPoints", ",", 
       "boundarySpline"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"boundaryPoints", "=", 
       RowBox[{"getPixelCoordinates", "@", "inputMask"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"boundarySpline", "=", 
       RowBox[{"buildBoundarySpline", "[", 
        RowBox[{"boundaryPoints", ",", "splineOrder"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"uniformlySampleSpline", "[", "\[IndentingNewLine]", 
       RowBox[{"boundarySpline", ",", 
        RowBox[{"upsamplingFactor", "*", 
         RowBox[{"Length", "@", "boundaryPoints"}]}]}], "\[IndentingNewLine]",
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParticleToSurfaceDistances", "[", 
    RowBox[{"swarmCoreMask_", ",", "swarmParticles_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputMask", "=", "swarmCoreMask"}], ",", 
       RowBox[{"inputParticles", "=", "swarmParticles"}], ",", 
       "\[IndentingNewLine]", "upsampledBoundary", ",", 
       "nearestSurfacePoints"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"upsampledBoundary", "=", 
       RowBox[{"getUpsampledBoundary", "@", "inputMask"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nearestSurfacePoints", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
          RowBox[{"Nearest", "[", 
           RowBox[{"upsampledBoundary", ",", "#", ",", "1"}], "]"}]}], "&"}], 
        "/@", "inputParticles"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Norm", "/@", 
       RowBox[{"(", 
        RowBox[{"inputParticles", "-", "nearestSurfacePoints"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParticleConnectivity", "[", 
    RowBox[{"pointClusters_", ",", "windowParticles_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputClusters", "=", "pointClusters"}], ",", 
       RowBox[{"inputParticles", "=", "windowParticles"}], ",", 
       "\[IndentingNewLine]", "initialComponentData"}], "\[IndentingNewLine]",
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"initialComponentData", "=", 
       RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
        RowBox[{"inputClusters", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Neighbors\>\"", ",", "\"\<Centroid\>\""}], "}"}], ",", 
         "\[IndentingNewLine]", "\"\<PropertyComponentAssociation\>\""}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
       RowBox[{"initialComponentData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "#"}], "}"}], "\[Rule]", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
              RowBox[{"inputParticles", ",", 
               RowBox[{"initialComponentData", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "#"}], "]"}], "]"}], ",", "1"}], 
              "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "inputParticles"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getConnectionsCentroids", "[", "componentData_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
         RowBox[{"Sort", "/@", 
          RowBox[{"Join", "@@", 
           RowBox[{"Thread", "/@", 
            RowBox[{
             RowBox[{"KeyValueMap", "[", "UndirectedEdge", "]"}], "@", 
             "#Neighbors"}]}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
       "componentData"}], "/.", 
      RowBox[{"UndirectedEdge", "\[Rule]", "List"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Last", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Normal", "@", "#Centroid"}], "&"}], "@", "componentData"}],
         "/.", 
        RowBox[{"Rule", "\[Rule]", "List"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFieldSwitchTimings", "[", "timeSeries_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"First", "/@", 
       RowBox[{"timeSeries", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
     RowBox[{"Round", "@", 
      RowBox[{"Flatten", "@", "\[IndentingNewLine]", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Differences", "@", "timeSeries"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"Last", "@", "#"}]}], ">", "0"}], "&"}], ")"}]}]}], 
        "]"}]}]}]}], "//", "Quiet"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getComponents", "[", 
    RowBox[{"dataset_", ",", "swarmID_", ",", "component_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "component"}], "}"}], "]"}], "]"}]}], "&"}], "@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"dataset", "[", 
      RowBox[{"[", "swarmID", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAccumulatedDisplacementSeries", "[", "dataset_", "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", 
               RowBox[{"dataset", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "#"}], 
            "\[IndentingNewLine]", "}"}]}], "&"}], "/@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Accumulate", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", "3"}], "]"}], "]"}]}]}]}]}], "&"}], "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"dataset", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "dataset"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"resolveDetectionOverlaps", "[", 
    RowBox[{"inputCentroids_", ",", "distanceThreshold_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"minimumDistance", "=", "distanceThreshold"}], ",", 
       RowBox[{"centroids", "=", "inputCentroids"}], ",", 
       "\[IndentingNewLine]", "distanceMatrix", ",", "criticalProximityMap", 
       ",", "overlappingPairs", ",", "overlappingGroups", ",", 
       "\[IndentingNewLine]", "getOverlappingGroups", ",", "resolvedOverlaps",
        ",", "redundantCentroids"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distanceMatrix", "=", 
       RowBox[{"DistanceMatrix", "[", "\[IndentingNewLine]", 
        RowBox[{"centroids", ",", 
         RowBox[{"DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"criticalProximityMap", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "<", "minimumDistance"}], "&"}], ",", "distanceMatrix",
          ",", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\n",
       "\[IndentingNewLine]", 
      RowBox[{"overlappingPairs", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Last", "@", 
          RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"criticalProximityMap", ",", "True"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Union", "[", "#", "]"}]}], "&"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"overlappingGroups", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Union", "/@", 
          RowBox[{"Flatten", "/@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "k"}], "]"}]}], "&"}], "]"}], "[", 
              "overlappingPairs", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"DeleteDuplicates", "@", 
                RowBox[{"Flatten", "@", "overlappingPairs"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"getOverlappingGroups", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"centroids", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        "overlappingGroups"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resolvedOverlaps", "=", 
       RowBox[{"Mean", "/@", "getOverlappingGroups"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"redundantCentroids", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"getOverlappingGroups", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"resolvedCentroids", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"resolvedOverlaps", ",", "\[IndentingNewLine]", 
         RowBox[{"Complement", "[", 
          RowBox[{"centroids", ",", "redundantCentroids"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getResolvedParticles", "[", 
    RowBox[{"centroids_", ",", "minimumDistance_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unresolvedCentroids", "=", "centroids"}], ",", 
       RowBox[{"distanceThreshold", "=", "minimumDistance"}], ",", 
       "\[IndentingNewLine]", "k", ",", "inputCentroids", ",", 
       "monitorCounter", ",", "outputCentroids"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outputCentroids", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"For", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "\[LessEqual]", 
                RowBox[{"Length", "@", "unresolvedCentroids"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{"inputCentroids", "=", 
                 RowBox[{"unresolvedCentroids", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"inputCentroids", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"Sow", "@", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"resolveDetectionOverlaps", "[", 
                    RowBox[{"inputCentroids", ",", "distanceThreshold"}], 
                    "]"}], ";", "\n", "     ", 
                   RowBox[{"While", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "inputCentroids", "\[NotEqual]", "resolvedCentroids"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"inputCentroids", "=", "resolvedCentroids"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"resolveDetectionOverlaps", "[", 
                    RowBox[{"inputCentroids", ",", "distanceThreshold"}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Sow", "@", "resolvedCentroids"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], "//", "Reap"}], "//", "Last"}], "//", "First"}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "unresolvedCentroids"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "outputCentroids"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findEligibleParticlesTwoLevelsets", "[", 
    RowBox[{"mask_", ",", "criticalFactor_"}], "]"}], ":=", 
   RowBox[{"Last", "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
       RowBox[{"mask", ",", "\"\<Centroid\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#CaliperWidth", "/", "#EquivalentDiskRadius"}], ")"}], 
            "^", "powerHullShape"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"#ConvexArea", "^", "powerHullSize"}], "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "#Elongation"}], ")"}], "^", 
              "powerAspectRatio"}]}], "/", 
            RowBox[{"#Circularity", "^", "powerCircularity"}]}]}], "<", 
          "criticalFactor"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", ")"}]}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrackOverlapIDs", "[", 
    RowBox[{"matches_", ",", "trackID_"}], "]"}], ":=", 
   RowBox[{"Position", "[", 
    RowBox[{"matches", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", "trackID"}], "]"}], "&"}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getConnectedTracksIDs", "[", 
    RowBox[{
    "trackEndpoints_", ",", "trackEndpointDistances_", ",", 
     "trackEndpointIDs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"endpoints", "=", "trackEndpoints"}], ",", 
       RowBox[{"distances", "=", "trackEndpointDistances"}], ",", 
       RowBox[{"endIDs", "=", "trackEndpointIDs"}], ",", 
       "\[IndentingNewLine]", "trackMatchesInitial", ",", "deltaLength", ",", 
       "checkLength", ",", "extraConnections", ",", "checkID", ",", 
       "trackOverlapIDs", ",", "trackMatchesFinal"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trackMatchesInitial", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"endIDs", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"distances", ",", "#"}], "]"}], "&"}], "/@", 
              "endpoints"}], "\[IndentingNewLine]", "]"}]}], ")"}]}], "//", 
         "DeleteDuplicates"}], "//", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#"}], "\[NotEqual]", 
             RowBox[{"Last", "@", "#"}]}], "&"}]}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Initially matched track pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "trackMatchesInitial"}]}]}], "//", 
       "PrintTemporary"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"deltaLength", "=", "1"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deltaLength", ">", "0"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"checkLength", "=", 
          RowBox[{"Length", "@", "trackMatchesInitial"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"extraConnections", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"For", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"checkID", "=", "1"}], ",", 
               RowBox[{"checkID", "\[LessEqual]", 
                RowBox[{"Length", "@", "trackMatchesInitial"}]}], ",", 
               RowBox[{"checkID", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"trackOverlapIDs", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", "checkID"}], "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"getTrackOverlapIDs", "[", 
                    RowBox[{"trackMatchesInitial", ",", "#"}], "]"}]}]}], 
                   "&"}], "/@", 
                  RowBox[{"trackMatchesInitial", "[", 
                   RowBox[{"[", "checkID", "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", "\n", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trackMatchesInitial", "[", 
                    RowBox[{"[", "checkID", "]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"trackMatchesInitial", "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "@", "trackOverlapIDs"}], "]"}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}], "//", "Flatten"}], 
                   "//", "DeleteDuplicates"}], "//", "Sort"}], "//", "Sow"}], 
                ";", "\[IndentingNewLine]", "\n", 
                RowBox[{"trackMatchesInitial", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{"trackMatchesInitial", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "#", "}"}], "&"}], "/@", 
                    RowBox[{"Flatten", "@", "trackOverlapIDs"}]}]}], 
                  "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "]"}], "//", "Reap"}], "//", "Last"}], "//", "Last"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"trackMatchesInitial", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Catenate", "[", 
            RowBox[{"{", 
             RowBox[{"extraConnections", ",", "trackMatchesInitial"}], "}"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"deltaLength", "=", 
          RowBox[{"checkLength", "-", 
           RowBox[{"Length", "@", "trackMatchesInitial"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trackMatchesFinal", "=", "trackMatchesInitial"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Finalized matched track groups: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "trackMatchesFinal"}]}]}], "//", 
       "PrintTemporary"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "trackMatchesFinal"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRefinedTracks", "[", 
    RowBox[{
    "nearestNeighborTracks_", ",", "deltaTimeFloor_", ",", 
     "deltaTimeThreshold_", ",", "deltaLocationThreshold_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputTracks", "=", "nearestNeighborTracks"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaMinimum", "=", "deltaTimeFloor"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaMaximum", "=", "deltaTimeThreshold"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaLocationMaximum", "=", "deltaLocationThreshold"}], ",", 
       "\[IndentingNewLine]", "swarmTrackStartpoints", ",", 
       "swarmTrackEndpoints", ",", "swarmTrackStartEndIDs", ",", 
       "\[IndentingNewLine]", "swarmTrackStartEndCombos", ",", 
       "swarmTrackStartEndDistances", ",", "nearbyEndpoints", ",", 
       "nearbyTrackIDs", ",", "newTracks", ",", "redundantTrackIDs", ",", 
       "outputTracks", ",", "monitorCounter"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Initial tracks: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "inputTracks"}]}]}], "//", "PrintTemporary"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"swarmTrackStartpoints", ",", "swarmTrackEndpoints"}], "}"}], 
       "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "/@", "inputTracks"}],
         "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"swarmTrackStartEndIDs", "=", 
       RowBox[{
        RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "inputTracks"}]}], ",", "2"}], 
         "\[IndentingNewLine]", "]"}], "//", "Tuples"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"swarmTrackStartEndCombos", "=", 
       RowBox[{"Tuples", "@", 
        RowBox[{"{", 
         RowBox[{"swarmTrackEndpoints", ",", "swarmTrackStartpoints"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<All start-/endpoint pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "swarmTrackStartEndCombos"}]}]}], "//", 
       "PrintTemporary"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"swarmTrackStartEndDistances", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Abs", "@", "#1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", "#2"}], "//", 
                    "Total"}], "//", "Sqrt"}]}], "\[IndentingNewLine]", "}"}],
                 "&"}], "@@", 
               RowBox[{"Subtract", "@@", "#"}]}]}], "\[IndentingNewLine]", 
             ")"}], "&"}], "/@", "swarmTrackStartEndCombos"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "swarmTrackStartEndCombos"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"nearbyEndpoints", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{"swarmTrackStartEndDistances", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"deltaMinimum", "<", 
            RowBox[{"First", "@", "#"}], "<", "deltaMaximum"}], "&&", 
           RowBox[{
            RowBox[{"Last", "@", "#"}], "<", "deltaLocationMaximum"}]}], 
          "&"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Eligible start-/endpoint pairs: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "nearbyEndpoints"}]}]}], "//", 
       "PrintTemporary"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"nearbyTrackIDs", "=", 
       RowBox[{"getConnectedTracksIDs", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "nearbyEndpoints", ",", "swarmTrackStartEndDistances", ",", 
          "swarmTrackStartEndIDs"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"newTracks", "=", 
       RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"SortBy", "[", 
                RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
              RowBox[{"Catenate", "@", 
               RowBox[{"inputTracks", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "@", "#"}], "&"}], 
          "/@", "nearbyTrackIDs"}], ",", "\[IndentingNewLine]", "Length"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"redundantTrackIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Flatten", "@", "nearbyTrackIDs"}]}]}], "//", 
        "DeleteDuplicates"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"outputTracks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReverseSortBy", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
        RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"inputTracks", ",", "redundantTrackIDs"}], "]"}], ",", 
           "newTracks"}], "}"}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Finalized tracks: \>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "outputTracks"}]}]}], "//", 
       "PrintTemporary"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "outputTracks"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getNumberRangeUniqueTuples", "[", "rangeLimit_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "/@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
      RowBox[{"Range", "@", "rangeLimit"}]}], "//", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "\[NotEqual]", 
          RowBox[{"Last", "@", "#"}]}], "&"}]}], "]"}], "&"}]}], "//", 
    "DeleteDuplicates"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"runTrackRefinement", "[", 
    RowBox[{"swarmTracks_", ",", "parameterSet_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inputTracks", "=", "swarmTracks"}], ",", 
        RowBox[{"refinementParameters", "=", "parameterSet"}], ",", 
        "\[IndentingNewLine]", "swarmTracksImproved", ",", "runID"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"swarmTracksImproved", "=", "inputTracks"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"runID", "=", "1"}], ",", 
         RowBox[{"runID", "\[LessEqual]", 
          RowBox[{"Length", "@", "refinementParameters"}]}], ",", 
         RowBox[{"runID", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "swarmTracksImproved"}], "//", "Sow"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Iteration \>\"", "<>", 
              RowBox[{"ToString", "@", "runID"}]}], "//", "Print"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\"\<{\!\(\*SubscriptBox[\(\[Delta]t\), \
\(min\)]\),\!\(\*SubscriptBox[\(\[Delta]t\), \(max\)]\),\!\(\*SubscriptBox[\(\
\[Delta]r\), \(max\)]\)} = \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"refinementParameters", "[", 
                RowBox[{"[", "runID", "]"}], "]"}]}]}], "//", "Print"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<======================================\>\"", "//", 
             "PrintTemporary"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"swarmTracksImproved", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"runID", ">", "singletRemovalThreshold"}], ",", 
                   RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                   ",", "#"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
                RowBox[{"getRefinedTracks", "[", 
                 RowBox[{
                 "swarmTracksImproved", ",", "#1", ",", "#2", ",", "#3"}], 
                 "]"}]}], "&"}], "@@", 
              RowBox[{"refinementParameters", "[", 
               RowBox[{"[", "runID", "]"}], "]"}]}]}], ";"}], "//", 
           "AbsoluteTiming"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", "#"}], ">", "10"}], "&"}]}], "]"}], 
               "&"}], "@", "swarmTracksImproved"}], ")"}]}], "//", 
           "PrintTemporary"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<======================================\>\"", "//", "Print"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", 
            RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "#"}], ">", "10"}], "&"}]}], "]"}], 
             "&"}], "@", "swarmTracksImproved"}], ")"}]}], "//", 
         "ListLinePlot"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "swarmTracksImproved"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Reap"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTimeScaledVelocityValues", "[", 
     RowBox[{"dataX_", ",", "dataY_", ",", "time_"}], "]"}], ":=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "/", "#3"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"dataX", ",", "dataY", ",", "time"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredTrack", "[", "track_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MeanFilter", "[", 
        RowBox[{"#", ",", "trackMeanFilterRadius"}], "]"}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"MedianFilter", "[", 
       RowBox[{"#", ",", "trackMedianFilterRadius"}], "]"}]}], "&"}], "@", 
    "track"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolateEnvelope", "[", "envelope_", "]"}], ":=", 
   RowBox[{"Interpolation", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"Transpose", "@", "envelope"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateArguments", "[", 
    RowBox[{"dataset_", ",", "envelope_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"Transpose", "@", "envelope"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"First", "@", 
          RowBox[{"Nearest", "[", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"Transpose", "@", "envelope"}]}], ",", 
            RowBox[{"First", "@", "#"}]}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "&"}], "/@", "dataset"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"envelopeConstraints", "[", 
     RowBox[{"dataset_", ",", "lowLimits_", ",", "highLimits_"}], "]"}], ":=", 
    RowBox[{"Delete", "[", "\[IndentingNewLine]", 
     RowBox[{"dataset", ",", 
      RowBox[{"Position", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "<", 
            RowBox[{"Last", "@", "#3"}], "<", "#2"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"lowLimits", ",", "highLimits", ",", "dataset"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredDataQSE", "[", "dataset_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputData", "=", "dataset"}], ",", "\[IndentingNewLine]", 
       "envelopeFunctions", ",", "envelopeValues", ",", "envelopeSampling", 
       ",", "filteredEnvelopes", ",", "\[IndentingNewLine]", "low", ",", 
       "high", ",", "functionLow", ",", "functionHigh", ",", "argumentsLow", 
       ",", "argumentsHigh", ",", "\[IndentingNewLine]", "lowLimits", ",", 
       "highLimits"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"envelopeFunctions", "=", 
       RowBox[{"QuantileRegression", "[", "\[IndentingNewLine]", 
        RowBox[{"inputData", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"sizeFactor", "*", 
              RowBox[{"Length", "@", "inputData"}]}], "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Round", "[", 
            RowBox[{"sizeFactor", "*", 
             RowBox[{"Length", "@", "inputData"}]}], "]"}], ",", "1"}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"lowerThreshold", ",", "upperThreshold"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"InterpolationOrder", "\[Rule]", "splineOrder"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"envelopeValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Range", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Min", "@", "#"}], ",", 
           RowBox[{"Max", "@", "#"}], ",", 
           RowBox[{
            RowBox[{"Max", "@", "#"}], "/", 
            RowBox[{"(", 
             RowBox[{"controlValueFactor", "*", 
              RowBox[{"Length", "@", "inputData"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", "inputData"}]}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"envelopeSampling", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"#", "[", "k", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "envelopeValues"}], "}"}]}], "]"}], "&"}], "/@",
         "envelopeFunctions"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"filteredEnvelopes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "envelopeRegularization", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}], ",", 
           RowBox[{"MaxIterations", "\[Rule]", "Automatic"}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", "envelopeSampling"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"low", ",", "high"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"envelopeValues", ",", "#"}], "}"}]}], "&"}], "/@", 
        "filteredEnvelopes"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"functionLow", ",", "functionHigh"}], "}"}], "=", 
       RowBox[{"interpolateEnvelope", "/@", 
        RowBox[{"{", 
         RowBox[{"low", ",", "high"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"argumentsLow", ",", "argumentsHigh"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"generateArguments", "[", "\[IndentingNewLine]", 
          RowBox[{"inputData", ",", "#"}], "\[IndentingNewLine]", "]"}], 
         "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"low", ",", "high"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lowLimits", ",", "highLimits"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"functionLow", "@", "argumentsLow"}], ",", 
         RowBox[{"functionHigh", "@", "argumentsHigh"}]}], "}"}]}], ";", 
      RowBox[{"envelopeConstraints", "[", 
       RowBox[{"inputData", ",", "lowLimits", ",", "highLimits"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMeansDeviations", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"input", "=", "data"}], ",", "dataComponents", ",", 
       "meansDeviationsValue", ",", "meansCoordinates"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataComponents", "=", 
       RowBox[{
        RowBox[{"Transpose", "/@", 
         RowBox[{"Partition", "[", "\[IndentingNewLine]", 
          RowBox[{"input", ",", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"binScale", "*", 
                RowBox[{"Length", "@", "input"}]}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Round", "[", 
              RowBox[{"binScale", "*", 
               RowBox[{"Length", "@", "input"}]}], "]"}], ",", "1"}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "//",
         "Transpose"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"meansDeviationsValue", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Around", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "@", "#"}], ",", 
            RowBox[{"StandardDeviation", "@", "#"}]}], "}"}]}], "&"}], "/@", 
        RowBox[{"dataComponents", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"meansCoordinates", "=", 
       RowBox[{"Mean", "/@", 
        RowBox[{"dataComponents", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"meansCoordinates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MeanFilter", "[", 
            RowBox[{"#", ",", "dataMeanFilterScale"}], "]"}], "&"}], "@", 
          "meansDeviationsValue"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInterSwarmDistances", "[", 
    RowBox[{"timestamps_", ",", "tracks_", ",", "pairDistances_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"trackTime", "=", "timestamps"}], ",", 
       RowBox[{"trackCoordinates", "=", "tracks"}], ",", 
       RowBox[{"swarmDistances", "=", "pairDistances"}], ",", 
       "\[IndentingNewLine]", "trackDataRecombined"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trackDataRecombined", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"swarmTrackTimestamps", ",", "swarmTracksClean"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Delete", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"#", ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", ">", "distanceEventDeltaTimeThreshold"}], 
                   "&"}], ")"}]}]}], "]"}], "&"}], "@", 
             RowBox[{"Differences", "@", 
              RowBox[{"First", "@", 
               RowBox[{"Transpose", "@", "#"}]}]}]}], "+", "1"}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", "#"}]}], "&"}], "/@", "#"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Norm", "/@", 
                    RowBox[{"Last", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", "#"}], 
                    ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "@", 
                  RowBox[{"Select", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "2"}], "&"}]}], 
                   "]"}]}], "&"}], "@", 
                RowBox[{"GatherBy", "[", 
                 RowBox[{"#", ",", "First"}], "]"}]}], "&"}], "@", 
              RowBox[{"Catenate", "@", 
               RowBox[{"trackDataRecombined", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "@", "#"}], "&"}], 
          "/@", "swarmDistances"}], "\[IndentingNewLine]", ")"}]}], "//", 
       "Quiet"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", " ", "sublists"}], ",", " ", 
    RowBox[{"overlapping", " ", "k", " ", "elements"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partitionRagged", "[", 
     RowBox[{"list_", ",", "n_", ",", 
      RowBox[{"k_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dl", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", "list"}], "-", "k"}], ")"}], "/", "n"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "dl"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"k", "+", 
                 RowBox[{"j", "*", "dl"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Length", "@", "list"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "/;", 
       RowBox[{"dl", ">", "0"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getOrderedZoneSectorAreas", "[", 
    RowBox[{"coreSegmentMask_", ",", "particleZoneMask_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputMask", "=", "coreSegmentMask"}], ",", 
       RowBox[{"inputZone", "=", "particleZoneMask"}], ",", 
       "\[IndentingNewLine]", "coreCentroid", ",", "discretizedParticleZone", 
       ",", "angleSectors", ",", "\[IndentingNewLine]", "sectorCentroids", 
       ",", "sectorAreas", ",", "sectorCentroidsCentered", ",", 
       "\[IndentingNewLine]", "sectorAngles", ",", "sectorIntervals", ",", 
       "angleIntervals", ",", "sectorIndices", ",", "sectorAspectRatios"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coreCentroid", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Centroid\>\""}], "]"}]}]}], "&"}], "@", 
        "coreSegmentMask"}]}], ";", "\n", "\n", 
      RowBox[{"discretizedParticleZone", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DeleteSmallComponents", "[", 
              RowBox[{"#", ",", "sectorSegmentSizeThreshold"}], "]"}], "&"}], 
            "@", 
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", "sectorSegmentLuminanceThreshold"}], "]"}]}], 
           "&"}], "@", 
          RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
           RowBox[{"particleZoneMask", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "1"}], "}"}], ",", "coreCentroid"}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
        "angleDiscretizationLines"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sectorCentroids", ",", "sectorAreas"}], "}"}], "=", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
          RowBox[{"discretizedParticleZone", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Centroid\>\"", ",", "\"\<Count\>\""}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "//", "Transpose"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sectorAspectRatios", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"Last", "/@", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"#", ",", "\"\<Elongation\>\""}], "]"}]}]}], "&"}], "@",
           "discretizedParticleZone"}], ")"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"sectorCentroidsCentered", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "-", "coreCentroid"}], "&"}], "/@", 
        "sectorCentroids"}]}], ";", "\n", 
      RowBox[{"sectorAngles", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"ToPolarCoordinates", "@", "sectorCentroidsCentered"}]}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"sectorIntervals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericalSort", "@", 
          RowBox[{"Nearest", "[", 
           RowBox[{"angleCheckpoints", ",", "#", ",", "2"}], "]"}]}], "&"}], "/@",
         "sectorAngles"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"angleIntervals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"partitionRagged", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Length", "@", "#"}], "-", "1"}], ",", "1"}], "]"}], 
         "&"}], "@", "angleCheckpoints"}]}], ";", "\n", 
      RowBox[{"sectorIndices", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{"angleIntervals", ",", "#"}], "]"}]}]}], "&"}], "/@", 
        "sectorIntervals"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", "First"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"sectorIndices", ",", "sectorAreas"}], "}"}]}]}], ",", 
        "\[IndentingNewLine]", "sectorAspectRatios"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMappedRadialBinRingAreas", "[", "coreEffectiveRadius_", "]"}], 
   ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputRadius", "=", "coreEffectiveRadius"}], ",", 
       "\[IndentingNewLine]", "radialBinCentersCoreOffset", ",", 
       "radialBinRingIntervals", ",", "radialBinRingIndices"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radialBinCentersCoreOffset", "=", 
       RowBox[{"radialBinCenters", "+", "inputRadius"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"radialBinRingIntervals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericalSort", "/@", 
          RowBox[{"Nearest", "[", 
           RowBox[{"radialCheckpoints", ",", "#", ",", "2"}], "]"}]}], "&"}], 
        "@", "radialBinCentersCoreOffset"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"radialBinRingIndices", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{"radialIntervals", ",", "#"}], "]"}]}]}], "&"}], "/@", 
        "radialBinRingIntervals"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"radialBinRingAreasPhysical", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       "radialBinRingIndices"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkMetricContrast", "[", "metric_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Divide", "@@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Subtract", "@@", 
           RowBox[{"MinMax", "@", "#"}]}], "//", "Abs"}], ",", 
         RowBox[{"Median", "@", "#"}]}], "}"}]}], "&"}], "@", "metric"}], "//",
     "N"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkEligibleEntries", "[", 
    RowBox[{"metric_", ",", "metricThreshold_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"metric", ",", 
         RowBox[{
          RowBox[{"#", "<", "metricThreshold"}], "&"}]}], "]"}]}], "/", 
      RowBox[{"Length", "@", "metric"}]}], "//", "N"}], "//", 
    "PercentForm"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTimeSeriesMetric", "[", 
    RowBox[{"timeSeries_", ",", "metric_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", "#"}], ",", 
          RowBox[{"metric", "/@", 
           RowBox[{"Last", "@", "#"}]}]}], "}"}]}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Last", "@", "#"}]}], ">", "1"}], "&"}]}], "]"}]}]}], 
     "&"}], "@", "timeSeries"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getIntervalMeansVelocityMF", "[", 
    RowBox[{"swarmID_", ",", "componentID_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"swarm", "=", "swarmID"}], ",", 
       RowBox[{"component", "=", "componentID"}], ",", "\[IndentingNewLine]", 
       "timeInterval", ",", "velocityLimits", ",", "intervalValuesField", ",",
        "intervalValuesVelocity"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeInterval", "=", 
       RowBox[{"fieldValueIntervals", "[", 
        RowBox[{"[", 
         RowBox[{"swarm", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"fieldIDs", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", "component"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"velocityLimits", "=", 
       RowBox[{"velocityRangeLimiters", "[", 
        RowBox[{"[", "swarmID", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"intervalValuesField", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mean", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Select", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"alphaSinDouble", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
               RowBox[{"fieldIDs", "[", 
                RowBox[{"[", "component", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"IntervalMemberQ", "[", 
                RowBox[{
                 RowBox[{"Interval", "@", 
                  RowBox[{"timeInterval", "[", 
                   RowBox[{"[", "intervalID", "]"}], "]"}]}], ",", 
                 RowBox[{"First", "@", "#"}]}], "]"}], "&"}]}], 
             "\[IndentingNewLine]", "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"intervalID", ",", "1", ",", 
           RowBox[{"Length", "@", "timeInterval"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"intervalValuesVelocity", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mean", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Select", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Select", "[", "\[IndentingNewLine]", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", "velocityLimits"}], "<", 
                    RowBox[{"First", "@", "#"}], "<", 
                    RowBox[{"Last", "@", "velocityLimits"}]}], "&"}]}], 
                    "\[IndentingNewLine]", "]"}], "&"}], "@", 
                   RowBox[{"swarmVelocityComponentsPhysical", "[", 
                    RowBox[{"[", 
                    RowBox[{"swarm", ",", "#"}], "]"}], "]"}]}], "&"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "component", "]"}], "]"}]}], "&"}], "@", 
               RowBox[{"Reverse", "@", "fieldIDs"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"IntervalMemberQ", "[", 
                RowBox[{
                 RowBox[{"Interval", "@", 
                  RowBox[{"timeInterval", "[", 
                   RowBox[{"[", "intervalID", "]"}], "]"}]}], ",", 
                 RowBox[{"First", "@", "#"}]}], "]"}], "&"}]}], 
             "\[IndentingNewLine]", "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"intervalID", ",", "1", ",", 
           RowBox[{"Length", "@", "timeInterval"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"intervalValuesField", ",", "intervalValuesVelocity"}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sortPointsCounterClockwise", "[", "points_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"center", "=", 
         RowBox[{"Mean", "@", "points"}]}], ",", "angles"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"angles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcTan", "@@", 
           RowBox[{"(", 
            RowBox[{"#", "-", "center"}], ")"}]}], "&"}], "/@", "points"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"points", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "angles"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"convexHull", "[", "points_", "]"}], ":=", 
    RowBox[{"sortPointsCounterClockwise", "@", 
     RowBox[{"MeshCoordinates", "@", 
      RowBox[{"ConvexHullMesh", "@", "points"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"triangleArea", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"p3", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"p1", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p3", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"p2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]",
       ")"}], "/", "2"}], "//", "Abs"}]}], "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Proposed", " ", "by", " ", "Preparata", " ", "and", " ", "Shamos", " ", 
    "in", " ", "1985", " ", "that", " ", "avoided", " ", "calculation", " ", 
    "of", " ", "angles"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getAllAntiPodalPairs", "[", "p_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "@", "p"}]}], ",", "i0", ",", 
       RowBox[{"i", "=", "1"}], ",", "j", ",", "j0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i0", "=", "n"}], ";", 
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ">", 
         RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"Mod", "[", 
             RowBox[{"j", ",", "n", ",", "1"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"j0", "=", "j"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{"While", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "\[NotEqual]", "j0"}], ",", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"While", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}], ">", 
              RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"j", ",", "n", ",", "1"}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"j", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], "\[NotEqual]", 
                 RowBox[{"{", 
                  RowBox[{"j0", ",", "i0"}], "}"}]}], ",", 
                RowBox[{"Sow", "[", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}], "\[Equal]", 
              RowBox[{"triangleArea", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"j", ",", "n", ",", "1"}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], "\[NotEqual]", 
                 RowBox[{"{", 
                  RowBox[{"j0", ",", "i0"}], "}"}]}], ",", 
                RowBox[{"Sow", "[", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                  "}"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Sow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "]"}], ",",
                    "j"}], "}"}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFarthestPoints", "[", "points_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputPoints", "=", "points"}], ",", "polygonPoints", ",", 
       "antiPodalPairs", ",", "\[IndentingNewLine]", "numberOfPolygonPoints", 
       ",", "calculateDistance", ",", "maxPointsPairs"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"polygonPoints", "=", 
       RowBox[{"sortPointsCounterClockwise", "@", 
        RowBox[{"convexHull", "@", "inputPoints"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"antiPodalPairs", "=", 
       RowBox[{"getAllAntiPodalPairs", "@", "polygonPoints"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"calculateDistance", "=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"EuclideanDistance", "@@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"polygonPoints", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Length", "@", "polygonPoints"}], ",", "1"}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"polygonPoints", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"Length", "@", "polygonPoints"}], ",", "1"}], 
                  "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
             "\[IndentingNewLine]", ")"}], "&"}], ")"}], "@@", "#"}], "&"}], 
        "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"maxPointsPairs", "=", 
       RowBox[{"MaximalBy", "[", 
        RowBox[{"antiPodalPairs", ",", "calculateDistance"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Part", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"polygonPoints", "[", 
             RowBox[{"[", "#1", "]"}], "]"}], ",", 
            RowBox[{"polygonPoints", "[", 
             RowBox[{"[", "#2", "]"}], "]"}]}], "}"}], "&"}], "@@@", 
         "maxPointsPairs"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getEffectiveMotionAngle", "[", "points_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trackFragmentPoints", "=", "points"}], ",", 
      "\[IndentingNewLine]", "fitModel", ",", "referencePoints", ",", 
      "referenceModel", ",", "effectiveFitResults", ",", "motionAngle"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fitModel", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"LinearModelFit", "[", 
         RowBox[{"#", ",", "x", ",", "x"}], "]"}], "&"}], "@", 
       "trackFragmentPoints"}]}], ";", 
     RowBox[{"referencePoints", "=", 
      RowBox[{"getFarthestPoints", "@", "trackFragmentPoints"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"referenceModel", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"referencePoints", ",", "x", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"effectiveFitResults", "=", 
      RowBox[{
       RowBox[{"First", "/@", 
        RowBox[{"Last", "/@", 
         RowBox[{"Normal", "/@", 
          RowBox[{"{", 
           RowBox[{"fitModel", ",", "referenceModel"}], "}"}]}]}]}], "//", 
       "Mean"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"motionAngle", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Around", "@@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"#", "*", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"fitModel", "[", "\"\<ParameterErrors\>\"", "]"}]}], 
              "/", 
              RowBox[{"First", "@", 
               RowBox[{"Last", "@", 
                RowBox[{"Normal", "@", "fitModel"}]}]}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"180", "*", 
         RowBox[{
          RowBox[{"ArcTan", "@", "effectiveFitResults"}], "/", "\[Pi]"}]}], 
        ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816685025014761*^9, 3.816685121824583*^9}, 
   3.8166851702611666`*^9, {3.8166853319319143`*^9, 3.8166853570017614`*^9}, {
   3.8166853921288576`*^9, 3.8166854430994287`*^9}, 3.8172933692699223`*^9, 
   3.8215213526898475`*^9, {3.8215219225755024`*^9, 3.821521924970554*^9}, {
   3.8215229316665196`*^9, 3.821522945393096*^9}, {3.821522980951149*^9, 
   3.8215229979667287`*^9}, {3.8215230467223215`*^9, 
   3.8215230604803877`*^9}, {3.8216285722586937`*^9, 
   3.8216285725139947`*^9}, {3.821628929343667*^9, 3.821628965792157*^9}, {
   3.8216290306326895`*^9, 3.8216292710985947`*^9}, {3.8216293014025493`*^9, 
   3.82162930963951*^9}, {3.821629370877658*^9, 3.821629377081064*^9}, {
   3.8216300310778837`*^9, 3.821630031732127*^9}, {3.8216383543553753`*^9, 
   3.8216383590896854`*^9}, {3.8216389284082756`*^9, 
   3.8216389842724094`*^9}, {3.821639232759909*^9, 3.8216392344633527`*^9}, {
   3.821639307842224*^9, 3.821639308720874*^9}, {3.821639585663513*^9, 
   3.821639599374831*^9}, {3.8216396491287265`*^9, 3.8216396501190767`*^9}, {
   3.8216429790351295`*^9, 3.8216429909672303`*^9}, {3.8374402327092*^9, 
   3.837440248492099*^9}, {3.83744424832545*^9, 3.8374442495444384`*^9}, {
   3.838186973248103*^9, 3.8381870424399757`*^9}, {3.838187423689406*^9, 
   3.838187441344855*^9}, {3.8381889975548377`*^9, 3.838189026392866*^9}, {
   3.838189332176097*^9, 3.838189337056424*^9}, {3.83818939578568*^9, 
   3.838189397793891*^9}, {3.8381897288247213`*^9, 3.838189749417483*^9}, {
   3.8382138820253506`*^9, 3.8382138841995373`*^9}, {3.838214072640682*^9, 
   3.8382141392226744`*^9}, {3.8382153711753535`*^9, 3.838215376439974*^9}, 
   3.8387032384222097`*^9, {3.838703732473629*^9, 3.8387037369775667`*^9}, {
   3.8428548039237576`*^9, 3.842854934305986*^9}, {3.842860282742243*^9, 
   3.8428602829875865`*^9}, {3.842870228415135*^9, 3.8428702291701164`*^9}, {
   3.842870267846715*^9, 3.8428702742944756`*^9}, {3.8429556294353204`*^9, 
   3.8429556394117627`*^9}, 3.8429557446139927`*^9, {3.8429558134350357`*^9, 
   3.8429558351643076`*^9}, {3.843042091380003*^9, 3.843042092644679*^9}, {
   3.8466805217818155`*^9, 3.8466805561470957`*^9}, {3.8466817589565873`*^9, 
   3.846681760002698*^9}, {3.846830318068039*^9, 3.8468303227811403`*^9}, {
   3.846836794250393*^9, 3.846836795673586*^9}, {3.8468388032090836`*^9, 
   3.8468388042609167`*^9}, {3.846850990461435*^9, 3.846850991216034*^9}, {
   3.846851762069357*^9, 3.8468517629910154`*^9}, {3.8468570654987984`*^9, 
   3.846857066510357*^9}, {3.847176357203411*^9, 3.847176365642843*^9}, {
   3.847181268905512*^9, 3.847181280689003*^9}, 3.8479584078119354`*^9, {
   3.8480397232691083`*^9, 3.848039727605297*^9}, {3.8480399095730343`*^9, 
   3.8480399149990773`*^9}, {3.8480400878616786`*^9, 
   3.8480400888955398`*^9}, {3.848040138181182*^9, 3.8480401392481413`*^9}, {
   3.8480403111972227`*^9, 3.8480403127980833`*^9}, {3.848043112108138*^9, 
   3.848043112566221*^9}, {3.861733656133502*^9, 3.8617338662603717`*^9}, {
   3.86176934714069*^9, 3.8617693724140406`*^9}, 3.861778568938816*^9, {
   3.8622430503751097`*^9, 3.862243051090524*^9}, 3.8623736077235756`*^9, 
   3.88529497097243*^9, {3.888494118454095*^9, 3.888494145667081*^9}, {
   3.889090822505982*^9, 3.8890908232189107`*^9}, {3.8891090862595997`*^9, 
   3.8891090868162723`*^9}, {3.8892483477682085`*^9, 
   3.8892483484480977`*^9}, {3.8892498055888453`*^9, 
   3.8892498082206764`*^9}, {3.889276229104906*^9, 3.889276267385105*^9}, {
   3.8898983886186423`*^9, 3.889898449060826*^9}, {3.8899041659732947`*^9, 
   3.889904166712389*^9}, {3.890046170318183*^9, 3.890046209900818*^9}, {
   3.8900462659591503`*^9, 3.890046270599622*^9}, {3.8900654002298822`*^9, 
   3.8900654016140833`*^9}, {3.890066092862156*^9, 3.890066129819665*^9}, {
   3.890067445284498*^9, 3.8900674463071547`*^9}, {3.890067542821095*^9, 
   3.8900675433292036`*^9}, {3.8900781043227777`*^9, 3.890078125443683*^9}, {
   3.890129641754139*^9, 3.890129650377389*^9}, {3.8901317774575396`*^9, 
   3.8901317809112263`*^9}, {3.8902029948095384`*^9, 
   3.8902029998603096`*^9}, {3.8902037672795553`*^9, 
   3.8902038129977217`*^9}, {3.8907333058606453`*^9, 3.890733306698245*^9}, 
   3.8907333399987135`*^9, {3.8908333871438456`*^9, 3.8908333985443945`*^9}, {
   3.890843513968988*^9, 3.890843560646533*^9}, {3.893095144175351*^9, 
   3.893095150510409*^9}, {3.893142205642288*^9, 3.893142206738003*^9}, {
   3.8946319308259935`*^9, 3.8946319383768206`*^9}, {3.8946376626404037`*^9, 
   3.8946376633071947`*^9}, {3.894715669204131*^9, 3.894715679293622*^9}, {
   3.894715769660548*^9, 3.8947157706182175`*^9}, {3.894715818389233*^9, 
   3.8947158352612343`*^9}, 3.8947299834526567`*^9, {3.894826295064418*^9, 
   3.8948263268873425`*^9}, {3.8985926459191093`*^9, 
   3.8985926572490215`*^9}, {3.898675733421308*^9, 3.898675737324503*^9}, {
   3.8986855128120303`*^9, 3.8986855135492887`*^9}, {3.89875942088224*^9, 
   3.8987594245157175`*^9}, {3.8987638701375003`*^9, 
   3.8987638708129883`*^9}, {3.8996642710019073`*^9, 
   3.8996642778906364`*^9}, {3.899709954541397*^9, 3.899709955639675*^9}, {
   3.900143571076066*^9, 3.9001435805339766`*^9}, 3.900251863220096*^9, {
   3.900264734620539*^9, 3.9002647637092133`*^9}, {3.9002729201746664`*^9, 
   3.900272922936228*^9}, {3.900509768608174*^9, 3.9005098198199806`*^9}, {
   3.9005100051660786`*^9, 3.9005100323425465`*^9}, {3.900510097989289*^9, 
   3.900510099326236*^9}, {3.900575926214774*^9, 3.9005759718143387`*^9}, {
   3.900590587514408*^9, 3.9005906191884975`*^9}, {3.9031993647049975`*^9, 
   3.9031993657430224`*^9}, {3.903199952967141*^9, 3.9031999537482214`*^9}, {
   3.9032001797431173`*^9, 3.9032001812747664`*^9}, 3.9033631012274704`*^9, {
   3.909398943980892*^9, 3.9093989546228647`*^9}, {3.9094044996104155`*^9, 
   3.9094045225649567`*^9}, {3.909404582095292*^9, 3.9094045826721277`*^9}, {
   3.909405036543246*^9, 3.909405095085456*^9}, {3.9094051873900805`*^9, 
   3.9094051931273985`*^9}, 3.9094054395367785`*^9, {3.909440420399663*^9, 
   3.9094404225828056`*^9}, 3.90944104702874*^9, {3.9095038874097557`*^9, 
   3.9095038881432695`*^9}, {3.909506493330638*^9, 3.90950650584651*^9}, {
   3.90950863332522*^9, 3.909508687826792*^9}, {3.9095087961924148`*^9, 
   3.9095088211866126`*^9}, 3.909580320222438*^9, {3.909602468533187*^9, 
   3.9096025131017265`*^9}, 3.909604173252448*^9, {3.909654252912099*^9, 
   3.909654276082286*^9}, {3.9099547163628855`*^9, 3.9099547214177203`*^9}, {
   3.910014758824114*^9, 3.9100147645690193`*^9}, {3.9100148204369297`*^9, 
   3.9100148354433675`*^9}, {3.9100149653527164`*^9, 
   3.9100149806153903`*^9}, {3.910032092511443*^9, 3.9100320947735205`*^9}, 
   3.910081515743555*^9, {3.910081562523821*^9, 3.9100815949640107`*^9}, {
   3.9100816509147215`*^9, 3.910081723812087*^9}, {3.910081758693939*^9, 
   3.9100818686585116`*^9}, 3.910081902736282*^9, {3.910081992870617*^9, 
   3.910082043271532*^9}, {3.910082133573485*^9, 3.910082138402652*^9}, {
   3.910082951076929*^9, 3.9100829615697775`*^9}, {3.910090572857478*^9, 
   3.9100905784038315`*^9}, {3.9101196051279244`*^9, 
   3.9101196068533335`*^9}, {3.9107978030013285`*^9, 3.910797810946908*^9}, {
   3.910798016169207*^9, 3.910798019974847*^9}, 3.910798194888879*^9, {
   3.9109685057279143`*^9, 3.9109685064581757`*^9}, {3.9302909920790515`*^9, 
   3.930290992941373*^9}},
 CellLabel->
  "In[2552]:=",ExpressionUUID->"25de1078-bc4a-4399-9c4b-3250768822a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, {
   3.8382140851103477`*^9, 3.838214092870597*^9}},
 FontSize->24,ExpressionUUID->"79f94e50-5c8b-4fab-b397-bdcb801b3455"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getMaskOverlays", "[", 
    RowBox[{"image_", ",", "mask_", ",", "color_", ",", "thickness_"}], "]"}],
    ":=", 
   RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", "image"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "color"}]}], "]"}], "&"}], "@", 
        RowBox[{"Binarize", "@", 
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "thickness"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", "mask"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"previewTrueParticleMask", "[", 
    RowBox[{
    "trueMask_", ",", "inputMask_", ",", "ellipseMask_", ",", "window_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Image", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}], "@", 
        RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ColorReplace", "[", 
               RowBox[{"#", ",", 
                RowBox[{"White", "\[Rule]", "Orange"}]}], "]"}], "&"}], "@", 
             "\[IndentingNewLine]", 
             RowBox[{"Binarize", "@", 
              RowBox[{"GaussianFilter", "[", 
               RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
           "\[IndentingNewLine]", 
           RowBox[{"EdgeDetect", "@", "ellipseMask"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
      RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ImageAdjust", "@", "window"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", "White"}]}], "]"}], "&"}], "@", 
           RowBox[{"EdgeDetect", "@", "trueMask"}]}]}], "\[IndentingNewLine]",
          "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}]}],
      "&"}], "@", 
    RowBox[{
    "ImageDifference", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ColorNegate", "@", "ellipseMask"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FillingTransform", "@", "inputMask"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "trueMask"}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredWindowParticleOverlay", "[", 
    RowBox[{
    "particles_", ",", "particleMask_", ",", "cutoffMask_", ",", "image_", 
     ",", "ellipseMask_"}], "]"}], ":=", 
   RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getMaskOverlays", "[", 
        RowBox[{"#", ",", "cutoffMask", ",", "Green", ",", "3"}], "]"}], 
       "&"}], "@", 
      RowBox[{"ImageAdd", "[", 
       RowBox[{"image", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", "Orange"}]}], "]"}], "&"}], "@", 
           RowBox[{"Binarize", "@", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", "ellipseMask"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", 
               RowBox[{"Lighter", "@", "Red"}]}]}], "]"}], "&"}], "@", 
           RowBox[{"Binarize", "@", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", "particleMask"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "@", 
          RowBox[{"ImageMarker", "[", 
           RowBox[{"#", ",", "\"\<Circle\>\"", ",", "10"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "@", 
          RowBox[{"ImageMarker", "[", 
           RowBox[{"#", ",", "\"\<Arrow\>\"", ",", "20"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}], "&"}], "@", "particles"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParticleOverlays", "[", 
    RowBox[{"windowImage_", ",", "particles_", ",", "swarmMask_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "@", 
            RowBox[{"ImageMarker", "[", 
             RowBox[{"#", ",", "\"\<Circle\>\"", ",", "10"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "@", 
            RowBox[{"ImageMarker", "[", 
             RowBox[{"#", ",", "\"\<Arrow\>\"", ",", "20"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], "&"}], "@", "particles"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"getMaskOverlays", "[", 
     RowBox[{"windowImage", ",", "swarmMask", ",", 
      RowBox[{"Darker", "@", "Orange"}], ",", "2"}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getParticleDensityPlot", "[", 
    RowBox[{"particles_", ",", "region_", ",", "window_"}], "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SmoothDensityHistogram", "[", "\[IndentingNewLine]", 
       RowBox[{
       "particles", ",", "densityMapBinKernelMethods", ",", 
        "\"\<Intensity\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "densityPlotSize"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Bold", ",", "densityPlotLabelSize"}], 
          "}"}]}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"ColorData", "[", "colorScheme", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Mesh", "\[Rule]", "5"}], ",", 
        RowBox[{"MeshStyle", "\[Rule]", 
         RowBox[{"{", "White", "}"}]}], ",", 
        RowBox[{"MaxRecursion", "\[Rule]", "densityPlotRecursion"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Gray", ",", "region"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"ImageDimensions", "@", "window"}]}], "}"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PlotPoints", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "*", 
               RowBox[{"Divide", "@@", 
                RowBox[{"ImageDimensions", "@", "window"}]}]}], "//", 
              "Round"}], ",", "#"}], "}"}]}], "&"}], "@", "plotPointCount"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ColorData", "[", "colorScheme", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "Automatic", ",", 
             RowBox[{
             "LegendMarkerSize", "\[Rule]", "densityPlotLegendSize"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "Right"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"particles", ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBinPlot", "[", 
    RowBox[{"bins_", ",", "labels_", ",", "xAxisRange_"}], "]"}], ":=", 
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{"bins", ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"xAxisRange", ",", "All"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "labels"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "histogramInterpolationOrder"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSmoothPropertyHistogram", "[", 
    RowBox[{"dataset_", ",", "labels_", ",", "xAxisRange_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"getBinPlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", "labels", ",", "xAxisRange"}], "]"}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getDataBins", "@", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"#", ",", "histogramBinningMethod"}], "]"}]}], "&"}], "/@", 
      "dataset"}], "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSmoothStatsHistogram", "[", 
    RowBox[{"dataset_", ",", "labels_", ",", "xAxisRange_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"getBinPlot", "[", 
       RowBox[{"#1", ",", "labels", ",", "xAxisRange"}], "]"}], "&"}], ")"}], 
    "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"getDataBins", "[", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"#1", ",", "histogramBinningMethod"}], "]"}], "]"}], "&"}], 
      ")"}], "@", "dataset"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLatexStyling", "[", "latexInput_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MaTeX", "[", 
        RowBox[{"#", ",", 
         RowBox[{"FontSize", "\[Rule]", 
          RowBox[{"fontSize", "+", "2"}]}]}], "]"}], "&"}], "@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"\"\<\\\\boldsymbol{\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", "\"\<}\>\""}], 
       "\[IndentingNewLine]", ")"}]}], "&"}], "@", "latexInput"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportSwarmDensityPlots", "[", 
    RowBox[{"plotArray_", ",", "plotArrayID_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"array", "=", "plotArray"}], ",", 
       RowBox[{"arrayID", "=", "plotArrayID"}], ",", "\[IndentingNewLine]", 
       "swarmAccretionMapFolder"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"swarmAccretionMapFolder", "=", 
        RowBox[{"output", "<>", "\"\<Swarm \>\"", "<>", 
         RowBox[{"ToString", "@", "arrayID"}], "<>", 
         "\"\< Accretion Density Maps\\\\\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CreateDirectory", "@", "swarmAccretionMapFolder"}], "//", 
        "Quiet"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"exportImageSequenceWithSize", "[", "\[IndentingNewLine]", 
        RowBox[{
        "array", ",", "swarmAccretionMapFolder", ",", "plotExportFormat", ",",
          "plotExportCompression", ",", "plotExportResolution"}], 
        "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSwarmTrackPlots", "[", "cleanTracks_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "plotRangesTracks", ",", "plotRangeOffsets", ",", 
       "plotRangeTracksWithOffsets", ",", "\[IndentingNewLine]", 
       "swarmTrackAspectRatios", ",", "endpointSizes", ",", 
       "\[IndentingNewLine]", "colorPalette", ",", "colorGrading", ",", 
       "dotColors", ",", "dotsGotStyle", ",", "\[IndentingNewLine]", 
       RowBox[{"inputTracks", "=", "cleanTracks"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colorPalette", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}], 
        "}"}]}], ";", "\n", 
      RowBox[{"colorGrading", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Rescale", "@", 
          RowBox[{"N", "@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"#", "&"}], ",", 
             RowBox[{"Range", "@", 
              RowBox[{"Length", "@", "#"}]}]}], "]"}]}]}], "&"}], "/@", 
        "inputTracks"}]}], ";", "\n", 
      RowBox[{"dotColors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ColorData", "@", 
              RowBox[{"colorPalette", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", "#", "]"}], 
           "&"}], "/@", "#"}], "&"}], "/@", "colorGrading"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dotsGotStyle", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Point", "@", "#1"}], ",", "#2"}], "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"inputTracks", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"dotColors", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "inputTracks"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRangesTracks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "@", "#"}], ",", 
               RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
            RowBox[{"Sort", "@", "#"}]}], "&"}], "/@", 
          RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "inputTracks"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"plotRangeOffsets", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"plotRangeOffsetScale", "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
          RowBox[{"Min", "@", "#"}]}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Subtract", "@@", 
              RowBox[{"Reverse", "@", "#"}]}], "&"}], "/@", "#"}], "&"}], "/@",
           "plotRangesTracks"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"plotRangeTracksWithOffsets", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#1"}], "+", "#2"}], ",", 
            RowBox[{
             RowBox[{"Last", "@", "#1"}], "+", "#2"}]}], "}"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"plotRangesTracks", ",", "plotRangeOffsets"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", 
      RowBox[{"swarmTrackAspectRatios", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Divide", "@@", 
            RowBox[{"Reverse", "@", 
             RowBox[{"ImageDimensions", "@", 
              RowBox[{"Image", "@", 
               RowBox[{"Graphics", "@", 
                RowBox[{"Line", "@", "#"}]}]}]}]}]}], "&"}], "/@", 
          "inputTracks"}], "//", "N"}], "//", 
        RowBox[{
         RowBox[{"#", "*", "scalesAspectRatio"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"endpointSizes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"endpointSizeScale", "*", 
           RowBox[{"Times", "@@", "#"}]}], "&"}], "/@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subtract", "@@", 
               RowBox[{"Reverse", "@", "#"}]}], "&"}], "/@", "#"}], "&"}], "/@",
            "plotRangesTracks"}], "\[IndentingNewLine]", ")"}]}], "//", 
        RowBox[{
         RowBox[{"#", "*", "scalesEndpointSizes"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
          RowBox[{"#1", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", "axesLabelsTracks"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "#2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", "LightGray"}], ",", 
           RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "#4"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"First", "@", "#1"}]}], ",", 
                RowBox[{"Darker", "@", "Green"}], ",", 
                RowBox[{"PointSize", "@", "#3"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"Last", "@", "#1"}]}], ",", "Red", ",", 
                RowBox[{"PointSize", "@", "#3"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "#5"}], "\[IndentingNewLine]", "}"}]}]}],
           "]"}], "&"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "inputTracks", ",", "swarmTrackAspectRatios", ",", "endpointSizes", 
          ",", "\[IndentingNewLine]", "plotRangeTracksWithOffsets", ",", 
          "dotsGotStyle"}], "\[IndentingNewLine]", "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getAngularBinPlot", "[", 
    RowBox[{"binData_", ",", "rangeFactor_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPolarPlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "@", "Black"}], ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Black", ",", "Bold"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", "Bold"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"rangeFactor", "*", 
         RowBox[{"Mean", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "#"}]}]}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarGridLines", "\[Rule]", "True"}], ",", 
       RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", 
       RowBox[{"PolarTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Drop", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"-", "radianConversion"}], "*", "\[Pi]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"radianConversion", "*", "\[Pi]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"radianConversion", "*", 
                 RowBox[{"\[Pi]", "/", "12"}]}]}], "\[IndentingNewLine]", 
               "}"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"#", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "&"}], "@", 
        "\"\<\\\\boldsymbol{\\\\langle n_r(\\\\varphi) \\\\rangle,~ {\\\\mu \
m}^{-2}}\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Gray", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"Last", "@", "#"}], "*", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Cos", "@", 
                    RowBox[{"First", "@", "#"}]}], ",", 
                    RowBox[{"Sin", "@", 
                    RowBox[{"First", "@", "#"}]}]}], "}"}]}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], "&"}], "/@", "#"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Thick", ",", "Orange", ",", 
            RowBox[{"Opacity", "@", "0.75"}]}], "]"}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"Mean", "@", 
             RowBox[{"Last", "@", 
              RowBox[{"Transpose", "@", "#"}]}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "@", "binData"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getAngularBinPlotAll", "[", 
    RowBox[{"binData_", ",", "rangeFactor_", ",", "referenceRangeID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPolarPlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "@", "Black"}], ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Black", ",", "Bold"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", "Bold"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"rangeFactor", "*", 
         RowBox[{"Mean", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "referenceRangeID", "]"}], "]"}]}]}]}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PolarGridLines", "\[Rule]", "True"}], ",", 
       RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", 
       RowBox[{"PolarTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Drop", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"-", "radianConversion"}], "*", "\[Pi]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"radianConversion", "*", "\[Pi]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"radianConversion", "*", 
                 RowBox[{"\[Pi]", "/", "12"}]}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"MaTeX", "[", 
           RowBox[{"#", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}]}], "]"}]}], "&"}], "@", 
        "\"\<\\\\boldsymbol{\\\\langle n_r(\\\\varphi) \\\\rangle,~ {\\\\mu \
m}^{-2}}\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"Thick", ",", "Dashed", ",", 
              RowBox[{"ColorData", "[", 
               RowBox[{"97", ",", "k"}], "]"}], ",", 
              RowBox[{"Opacity", "@", "0.75"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "]"}], "&"}], 
             "@", 
             RowBox[{"Mean", "@", 
              RowBox[{"Last", "@", 
               RowBox[{"Transpose", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}]}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "@", "#"}]}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "polarPlotLegends"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "binData"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotDualAxesErrors", "[", 
    RowBox[{
    "dataset1_", ",", "dataset2_", ",", "dataset3_", ",", "frameLabels_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data1", "=", "dataset1"}], ",", 
       RowBox[{"data2", "=", "dataset2"}], ",", 
       RowBox[{"data3", "=", "dataset3"}], ",", "\[IndentingNewLine]", 
       "plot1", ",", "plot2", ",", "plotRangeMeanMain", ",", 
       "plotRangeErrorMain", ",", "plotRangeOffsetsMain"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotRangeMeanMain", "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Value\>\"", "]"}], "&"}], "/@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "data1"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotRangeErrorMain", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Error\>\"", "]"}], "&"}], "/@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "data1"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotRangeOffsetsMain", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{"plotRangeErrorMain", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Abs", "[", 
               RowBox[{"Divide", "@@", "#"}], "]"}]}], ",", "1"}], "}"}], "*",
            "plotRangeOffsetScaleTwoAxis", "*", 
           RowBox[{"Max", "@", 
            RowBox[{"Abs", "@", "#"}]}]}]}], "&"}], "@", 
        "plotRangeMeanMain"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot1", "=", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"data1", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "@", "Gray"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", "Automatic"}], ",", 
         "dualAxesPlotOptions", ",", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "plotRangeOffsetsMain"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "None"}], "}"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Opacity", "@", "0.3"}], ",", 
            RowBox[{"Lighter", "@", "Gray"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot2", "=", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"data2", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "All"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Red"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Red"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", "Red"}], ",", 
         "dualAxesPlotOptions", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MinMax", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "data1"}]}]}], ",", "Automatic"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Catenate", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Red", ",", "Dashed", ",", "Thick"}], "]"}]}], 
                  "}"}], "&"}], "/@", 
                RowBox[{"getFieldSwitchTimings", "@", "data2"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Blue", ",", "Dashed", ",", "Thick"}], "]"}]}], 
                  "}"}], "&"}], "/@", 
                RowBox[{"getFieldSwitchTimings", "@", "data3"}]}]}], 
              "\[IndentingNewLine]", "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Darker", "@", "Red"}], ",", "Dashed", ",", 
                 "Thick"}], "]"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Overlay", "@", 
       RowBox[{"{", 
        RowBox[{"plot1", ",", "plot2"}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPropertyVersusMFerrors", "[", 
    RowBox[{
    "timeSeries_", ",", "swarmID_", ",", "componentID_", ",", "axesLabels_"}],
     "]"}], ":=", 
   RowBox[{"plotDualAxesErrors", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeries", "[", 
      RowBox[{"[", 
       RowBox[{"swarmID", ",", "componentID"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"alphaSinDouble", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
      RowBox[{"fieldIDs", "[", 
       RowBox[{"[", "componentID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"alphaSinDouble", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "componentID", "]"}], "]"}]}], "&"}], "@", 
      RowBox[{"Reverse", "@", "fieldIDs"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"axesLabels", "[", 
      RowBox[{"[", "componentID", "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAllComponentPlotsErrors", "[", 
     RowBox[{"dataset_", ",", "labels_"}], "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"plotPropertyVersusMFerrors", "[", "\[IndentingNewLine]", 
           RowBox[{"dataset", ",", "k", ",", "#", ",", "labels"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ",", 
        RowBox[{"TableDirections", "\[Rule]", "Column"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "dataset"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"plotDualAxes", "[", 
    RowBox[{
    "dataset1_", ",", "dataset2_", ",", "dataset3_", ",", "frameLabels_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data1", "=", "dataset1"}], ",", 
       RowBox[{"data2", "=", "dataset2"}], ",", 
       RowBox[{"data3", "=", "dataset3"}], ",", "\[IndentingNewLine]", 
       "plot1", ",", "plot2"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plot1", "=", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"data1", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "@", "Gray"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "\[Rule]", "Automatic"}], ",", 
         "dualAxesPlotOptions", ",", "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "None"}], "}"}]}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot2", "=", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"data2", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"False", ",", "False"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "All"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Red"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Red"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", "Red"}], ",", 
         "dualAxesPlotOptions", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MinMax", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "data1"}]}]}], ",", "Automatic"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", 
              RowBox[{"frameLabels", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Catenate", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Red", ",", "Dashed", ",", "Thick"}], "]"}]}], 
                  "}"}], "&"}], "/@", 
                RowBox[{"getFieldSwitchTimings", "@", "data2"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Blue", ",", "Dashed", ",", "Thick"}], "]"}]}], 
                  "}"}], "&"}], "/@", 
                RowBox[{"getFieldSwitchTimings", "@", "data3"}]}]}], 
              "\[IndentingNewLine]", "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Darker", "@", "Red"}], ",", "Dashed", ",", 
                 "Thick"}], "]"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Overlay", "@", 
       RowBox[{"{", 
        RowBox[{"plot1", ",", "plot2"}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPropertyVersusMF", "[", 
    RowBox[{
    "timeSeries_", ",", "swarmID_", ",", "componentID_", ",", "axesLabels_"}],
     "]"}], ":=", 
   RowBox[{"plotDualAxes", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeries", "[", 
      RowBox[{"[", 
       RowBox[{"swarmID", ",", "componentID"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"alphaSinDouble", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
      RowBox[{"fieldIDs", "[", 
       RowBox[{"[", "componentID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"alphaSinDouble", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "componentID", "]"}], "]"}]}], "&"}], "@", 
      RowBox[{"Reverse", "@", "fieldIDs"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"axesLabels", "[", 
      RowBox[{"[", "componentID", "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getAllComponentPlots", "[", 
     RowBox[{"dataset_", ",", "labels_"}], "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"plotPropertyVersusMF", "[", "\[IndentingNewLine]", 
           RowBox[{"dataset", ",", "k", ",", "#", ",", "labels"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ",", 
        RowBox[{"TableDirections", "\[Rule]", "Column"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "dataset"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBacteriaLevelsetOverlays", "[", 
    RowBox[{"masks_", ",", "colors_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"swarmWindowCoreMasksUnified", "[", 
        RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "@", 
    RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"swarmWindowsUnified", "[", 
       RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageAdd", "@@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"White", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeDetect", "/@", "masks"}], ",", "colors"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredWindowParticleOverlayAlternative", "[", 
    RowBox[{
    "particles_", ",", "particleMask_", ",", "cutoffMask_", ",", "image_", 
     ",", "ellipseMask_"}], "]"}], ":=", 
   RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getMaskOverlays", "[", 
        RowBox[{"#", ",", "cutoffMask", ",", "Green", ",", "3"}], "]"}], 
       "&"}], "@", 
      RowBox[{"ImageAdd", "[", 
       RowBox[{"image", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", "Orange"}]}], "]"}], "&"}], "@", 
           RowBox[{"Binarize", "@", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", "ellipseMask"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", 
               RowBox[{"Lighter", "@", "Blue"}]}]}], "]"}], "&"}], "@", 
           RowBox[{"Binarize", "@", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", 
          RowBox[{"particleMask", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
           RowBox[{"Binarize", "@", 
            RowBox[{"GaussianFilter", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", 
          RowBox[{"particleMask", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "@", 
          RowBox[{"ImageMarker", "[", 
           RowBox[{"#", ",", "\"\<Circle\>\"", ",", "7.5"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "@", 
          RowBox[{"ImageMarker", "[", 
           RowBox[{"#", ",", "\"\<Arrow\>\"", ",", "15"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}], "&"}], "@", "particles"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{"image_", ",", "imageName_", ",", "imageResolution_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"#1", "<>", "imageName", "<>", "#2"}], ",", "image", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
       "&"}], "@@", "#"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", "\"\<.pdf\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"figureSVGfolder", ",", "\"\<.svg\>\""}], "}"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preventPlotErrors", "[", "dataset_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "&"}], "/@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Head", "/@", "#"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "@", "#"}], "\[NotEqual]", "\"\<List\>\""}],
              "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "]"}], 
    "&"}], "@", "dataset"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8382141089276686`*^9, 3.8382141470557327`*^9}, {
   3.8383810384782114`*^9, 3.838381047604392*^9}, {3.8387855585815835`*^9, 
   3.8387855587734413`*^9}, {3.8428550422523947`*^9, 3.842855063443738*^9}, {
   3.842870277711341*^9, 3.8428702783037567`*^9}, {3.8430443574775066`*^9, 
   3.8430443581598406`*^9}, {3.843306412936756*^9, 3.843306413797443*^9}, {
   3.8433074774747143`*^9, 3.8433074795321846`*^9}, {3.8434791180537205`*^9, 
   3.843479122197983*^9}, {3.8434792010384073`*^9, 3.8434792085272436`*^9}, {
   3.8434801865205216`*^9, 3.8434801872356105`*^9}, {3.8468295524204054`*^9, 
   3.846829553281579*^9}, {3.8468303011644278`*^9, 3.846830309764868*^9}, {
   3.8468366770818214`*^9, 3.8468366776273637`*^9}, {3.846837834713642*^9, 
   3.8468378625222187`*^9}, {3.8468455070247407`*^9, 3.846845510560229*^9}, {
   3.84684815828109*^9, 3.8468481614473963`*^9}, {3.8468520157107143`*^9, 
   3.846852020830513*^9}, {3.846857168227646*^9, 3.8468571689972773`*^9}, {
   3.8471814143775034`*^9, 3.8471814167940416`*^9}, {3.847517395217419*^9, 
   3.847517396149927*^9}, {3.8475193211014194`*^9, 3.8475193256496277`*^9}, {
   3.847703442796735*^9, 3.8477034453400145`*^9}, {3.847704978874587*^9, 
   3.84770498491438*^9}, {3.847958174636939*^9, 3.847958175546935*^9}, {
   3.8479584112620754`*^9, 3.847958418107979*^9}, {3.8479584533121324`*^9, 
   3.8479584698383713`*^9}, 3.847958503411874*^9, 3.8479587019715586`*^9, 
   3.8479587489015484`*^9, {3.848039611709918*^9, 3.8480396130401764`*^9}, {
   3.854284348606432*^9, 3.854284414507883*^9}, {3.8542844460535684`*^9, 
   3.854284450163246*^9}, {3.8542844897272644`*^9, 3.854284491163439*^9}, {
   3.8542846894363155`*^9, 3.8542847196534653`*^9}, {3.854284763132161*^9, 
   3.854284805203933*^9}, {3.8543017093581405`*^9, 3.8543017097800107`*^9}, 
   3.8543021687449975`*^9, {3.86135180587704*^9, 3.861351833608179*^9}, {
   3.8613521906884565`*^9, 3.861352244163921*^9}, 3.8613523774468827`*^9, 
   3.8613527808945127`*^9, {3.861352819172843*^9, 3.8613528224911113`*^9}, {
   3.861353079779817*^9, 3.8613530820279865`*^9}, {3.861353182755934*^9, 
   3.861353198595103*^9}, {3.8613532465402184`*^9, 3.86135328889894*^9}, {
   3.861353351435895*^9, 3.861353359444062*^9}, {3.861442430138591*^9, 
   3.8614424558068857`*^9}, {3.861442950672676*^9, 3.861442980099907*^9}, {
   3.861443951145012*^9, 3.861444010521378*^9}, {3.8614442545310187`*^9, 
   3.8614442566662717`*^9}, {3.8614443760482197`*^9, 
   3.8614444124822063`*^9}, {3.861444936929628*^9, 3.8614449419627314`*^9}, {
   3.8617694039719276`*^9, 3.861769404845587*^9}, {3.8618714154161644`*^9, 
   3.861871441937232*^9}, 3.8618714766948304`*^9, {3.8618715377453823`*^9, 
   3.861871539470315*^9}, {3.8618715963929563`*^9, 3.861871600951092*^9}, {
   3.8618726375592003`*^9, 3.8618726398618665`*^9}, {3.861873404718047*^9, 
   3.8618734265576353`*^9}, 3.885294884064336*^9, {3.8852949158047347`*^9, 
   3.88529492197764*^9}, {3.885377905840366*^9, 3.8853779077071247`*^9}, {
   3.885402114857448*^9, 3.8854021282003307`*^9}, 3.8886943092933555`*^9, {
   3.889015442136024*^9, 3.889015456919775*^9}, {3.8892762475930476`*^9, 
   3.8892762562558956`*^9}, 3.8893009772205563`*^9, {3.8899841131691065`*^9, 
   3.8899841141759653`*^9}, {3.890047708116598*^9, 3.8900477146782904`*^9}, {
   3.8900675087873*^9, 3.8900675121149426`*^9}, {3.8902029366355205`*^9, 
   3.890202989738862*^9}, {3.8902039833760834`*^9, 3.890203984629099*^9}, {
   3.8904086075627317`*^9, 3.890408613241494*^9}, {3.890632148860849*^9, 
   3.890632158460635*^9}, 3.8906322433101892`*^9, {3.8907331951512904`*^9, 
   3.890733215470951*^9}, {3.8928938569995413`*^9, 3.8928938576698256`*^9}, {
   3.8941055556590333`*^9, 3.8941055565294847`*^9}, 3.8946216133283796`*^9, 
   3.8948263490958805`*^9, {3.8985945927999134`*^9, 3.8985945934481864`*^9}, {
   3.898759385267237*^9, 3.8987593894367065`*^9}, {3.899648467182111*^9, 
   3.8996484676838007`*^9}, {3.8996643286176662`*^9, 3.899664329528232*^9}, 
   3.9003109355727468`*^9, 3.900406906742863*^9, 3.90040861264791*^9, 
   3.9092614557314425`*^9, {3.909261542635873*^9, 3.909261571534644*^9}, {
   3.9092616368812504`*^9, 3.9092616397554054`*^9}, {3.909401863608731*^9, 
   3.9094018640886273`*^9}, {3.909498045448455*^9, 3.909498046226835*^9}, {
   3.9095064363510914`*^9, 3.9095064642519855`*^9}, {3.909604217112362*^9, 
   3.909604232197218*^9}, {3.9096542336393013`*^9, 3.909654234355711*^9}, 
   3.909954025548602*^9, 3.9099544454603634`*^9, {3.909955460953527*^9, 
   3.909955496770758*^9}, {3.9100905614161925`*^9, 3.9100905621613793`*^9}, {
   3.910808217332183*^9, 3.9108082177954454`*^9}, 3.910967256455363*^9, {
   3.9109800004490395`*^9, 3.910980076224047*^9}, {3.910980106785097*^9, 
   3.9109801192633076`*^9}, 3.9109801543901377`*^9},
 CellLabel->
  "In[2615]:=",ExpressionUUID->"ae9e466b-1b82-4bc9-8437-553d8b171e20"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Image Preview ]]", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423048838863`*^9}, {
  3.8892728459663477`*^9, 
  3.88927284778979*^9}},ExpressionUUID->"6f2a1bc0-34e9-4b61-a42e-\
db38886ab52b"],

Cell[CellGroupData[{

Cell["Preview Images", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}, {3.889272842781345*^9, 3.889272844669487*^9}},
 FontSize->24,ExpressionUUID->"9c3a8cec-c23b-43a9-b13c-5dc24224a498"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"previewImages", "=", "images"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"previewImages", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "previewImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
  3.8473587967119102`*^9, 3.84735880759993*^9}, {3.8473590742000065`*^9, 
  3.847359106208709*^9}, {3.847359452569849*^9, 3.8473595079603925`*^9}, {
  3.8473595389841976`*^9, 3.847359539120832*^9}, {3.8474397485342627`*^9, 
  3.8474397553889327`*^9}, {3.8852951986578484`*^9, 3.88529520428992*^9}, {
  3.8852958562998705`*^9, 3.8852958631861887`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"1ea10bda-d7ad-42b8-b0e4-58111a06e837"],

Cell["\<\
Defaults (see Mean Correction Intervals.txt) :
   
meanCorrectionInvervals={1;;All};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.890277324764104*^9, {
   3.8998652744622345`*^9, 3.8998652822264137`*^9}, {3.910263618452039*^9, 
   3.9102636362119803`*^9}},
 FontSize->16,ExpressionUUID->"366c78d8-5688-454c-93c7-a2923ffec2a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanCorrectionInvervals", "=", 
   RowBox[{"{", 
    RowBox[{"1", ";;", "All"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"meanCorrectionInvervals", "//", "Length"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.899862103201767*^9, 3.899862106036577*^9}, {
   3.8998621549014835`*^9, 3.8998622133834724`*^9}, {3.8998622798451576`*^9, 
   3.8998622835766225`*^9}, {3.8998625119265766`*^9, 
   3.8998626207892914`*^9}, {3.899862662845368*^9, 3.8998626659162083`*^9}, {
   3.8998626967665644`*^9, 3.899862753917693*^9}, {3.8998628876449842`*^9, 
   3.899862889509884*^9}, {3.8998639651574135`*^9, 3.899863973428339*^9}, {
   3.8998640061234684`*^9, 3.899864048125186*^9}, {3.899864102868125*^9, 
   3.8998641031963468`*^9}, {3.8998641515394883`*^9, 3.899864164524146*^9}, {
   3.899864202789747*^9, 3.899864250996023*^9}, {3.899908337798148*^9, 
   3.8999083411940794`*^9}, {3.9003263941544757`*^9, 3.9003264066501074`*^9}, 
   3.9003269761383305`*^9, {3.9003303475999126`*^9, 3.900330349966528*^9}, {
   3.900332237909223*^9, 3.9003322590080905`*^9}, {3.9003459604673805`*^9, 
   3.9003459654504347`*^9}, {3.9003464425071282`*^9, 
   3.9003464618198743`*^9}, {3.9003465327236147`*^9, 
   3.9003465364104347`*^9}, {3.900355386637405*^9, 3.900355390236788*^9}, {
   3.9003555059963217`*^9, 3.9003555142113595`*^9}, {3.9003555531994977`*^9, 
   3.900355553340173*^9}, {3.9004283223089533`*^9, 3.9004283376109266`*^9}, 
   3.9004350169739003`*^9, 3.9004376147587185`*^9, {3.9102628543200693`*^9, 
   3.910262858588371*^9}, {3.9102635153367186`*^9, 3.910263517588751*^9}, 
   3.9105266787044067`*^9, {3.910620811773783*^9, 3.9106208132392974`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"91bf1d76-cd45-48e4-b713-d9c9f1d0a50e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Image Sequence Checkup", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
  3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
  3.888486151680708*^9}},
 FontSize->24,ExpressionUUID->"490656a1-7045-4adf-b8e6-76f1cabd2196"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkupIDs", "=", 
   RowBox[{"1", ";;", "All"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
  3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
  3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
  3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
  3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
  3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
  3.896369230096441*^9}, {3.8964361643856163`*^9, 3.89643622317446*^9}, {
  3.89643675712685*^9, 3.896436757391596*^9}, {3.896437331514621*^9, 
  3.89643733292544*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"a552173d-c230-4776-9277-63c03c42bb2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imageStack", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{"ColorCombine", "@", "#"}], ",", "\"\<Bit16\>\""}], "]"}], 
      "&"}], "@", 
     RowBox[{"images", "[", 
      RowBox[{"[", "checkupIDs", "]"}], "]"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToString", "@", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"ByteCount", "@", "imageStack"}], "/", 
      RowBox[{"1024", "^", "3"}]}], "]"}]}], "<>", "\"\< Gb\>\""}], "//", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"memoryCheck", "[", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"imageForms", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Image", "[", 
          RowBox[{"#", ",", "Byte"}], "]"}], "&"}], "/@", 
        RowBox[{"ImageAdjust", "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", "#"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Mean", "@", "#"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImageApply", "[", 
              RowBox[{"Min", ",", "#"}], "]"}], "&"}], "@", "imageStack"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImageApply", "[", 
              RowBox[{"StandardDeviation", ",", "#"}], "]"}], "&"}], "@", 
            "imageStack"}]}], "\[IndentingNewLine]", "}"}]}]}], "&"}], "@", 
      RowBox[{"images", "[", 
       RowBox[{"[", "checkupIDs", "]"}], "]"}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotImageForms", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"RasterSize", "\[Rule]", 
          RowBox[{"0.5", "*", 
           RowBox[{"ImageDimensions", "@", 
            RowBox[{"First", "@", "images"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], "&"}], "/@", "imageForms"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.885408382496828*^9, 3.8854083987486277`*^9}, {
  3.8854084986136913`*^9, 3.885408499268813*^9}, {3.885408593677886*^9, 
  3.8854086063801184`*^9}, {3.885409519131166*^9, 3.8854095763927016`*^9}, {
  3.890216468749096*^9, 3.890216501490799*^9}, {3.890216553203435*^9, 
  3.890216555819228*^9}, {3.8902772978538885`*^9, 3.890277302108052*^9}, {
  3.8908334266930494`*^9, 3.890833429726142*^9}, {3.8963692247707596`*^9, 
  3.896369230096441*^9}, {3.8964361643856163`*^9, 3.8964363299489517`*^9}, {
  3.8964363877439537`*^9, 3.8964365422773743`*^9}, {3.896436599043357*^9, 
  3.8964366370728083`*^9}, {3.8964366671448145`*^9, 3.89643673724588*^9}, {
  3.8964367773351607`*^9, 3.896436778740844*^9}, {3.8964368224816637`*^9, 
  3.896436875022439*^9}, {3.8964369825451965`*^9, 3.8964370098803487`*^9}, {
  3.896437198809002*^9, 3.8964371998180475`*^9}, {3.8997967835223236`*^9, 
  3.8997968038311157`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"cf94c8d2-4c96-4099-bebf-978587dcc2a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", 
     RowBox[{"StringDelete", "[", 
      RowBox[{"subFolder", ",", "$PathnameSeparator"}], "]"}], "<>", 
     "\"\<_OG_mean_min_stdev_projections.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotImageForms", ",", 
    RowBox[{"CompressionLevel", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.896437205370595*^9, 3.8964372099179287`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"618dcf84-9348-40fc-ae54-deccf99e2127"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", 
     RowBox[{
     "imageStack", ",", "imageForms", ",", "plotImageForms", ",", 
      "checkupIDs"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.896437342966795*^9, 3.8964373543052807`*^9}, {
  3.896437454486349*^9, 3.896437474268625*^9}, {3.8964375080412807`*^9, 
  3.8964375297373896`*^9}, {3.896437576159813*^9, 3.8964376082130527`*^9}, {
  3.8964377890112224`*^9, 3.8964378420869074`*^9}, {3.8964379361119566`*^9, 
  3.896437936432515*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"b5a77385-f1a1-4586-a749-76e001a1deed"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swarm Core Detection", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 
  3.8890423160585136`*^9}},ExpressionUUID->"80421e6f-dc59-4fad-a1f7-\
61515f3a16d5"],

Cell[CellGroupData[{

Cell["Mean Correction", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}, {
   3.898853315670269*^9, 3.8988533194764414`*^9}},
 FontSize->24,ExpressionUUID->"f5b4f863-00fd-4acd-a714-72745e72fdf2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"meanImage", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mean", "@", 
       RowBox[{"images", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     "meanCorrectionInvervals"}]}], ";"}], "//", "AbsoluteTiming"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"imagesCorrected", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{"meanCorrection", "[", "\[IndentingNewLine]", 
               RowBox[{"#", ",", 
                RowBox[{"meanImage", "[", 
                 RowBox[{"[", "interval", "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"images", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
            RowBox[{"meanCorrectionInvervals", "[", 
             RowBox[{"[", "interval", "]"}], "]"}]}]}], "\[IndentingNewLine]",
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"interval", ",", "1", ",", 
           RowBox[{"Length", "@", "meanCorrectionInvervals"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "images"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8988533815549645`*^9, 3.8988533929067574`*^9}, {
   3.898854304699804*^9, 3.898854305964093*^9}, 3.898854373925583*^9, {
   3.898877986713492*^9, 3.8988779915800266`*^9}, {3.8998652535571938`*^9, 
   3.89986525914505*^9}, {3.8998837461649704`*^9, 3.8998837467316227`*^9}, {
   3.9102635354219666`*^9, 3.9102635365450573`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"ce1f7044-5da6-4ddd-bb7e-51dd7fa71c15"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
    RowBox[{"imagesCorrected", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesCorrected"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
   3.8473587967119102`*^9, 3.84735880759993*^9}, {3.8473590742000065`*^9, 
   3.847359106208709*^9}, {3.847359452569849*^9, 3.8473595079603925`*^9}, {
   3.8473595389841976`*^9, 3.847359539120832*^9}, {3.8474397485342627`*^9, 
   3.8474397553889327`*^9}, {3.8852951986578484`*^9, 3.88529520428992*^9}, {
   3.8852958562998705`*^9, 3.8852958631861887`*^9}, {3.898854358530354*^9, 
   3.898854369507185*^9}, 3.900262041510577*^9},
 CellLabel->
  "In[295]:=",ExpressionUUID->"c47cd5a2-931d-4c7b-a32c-7edcf50dd322"]
}, Closed]],

Cell[CellGroupData[{

Cell["8-bit Images for Visuals", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9, {3.890389188350938*^9, 3.8903892049792967`*^9}},
 FontSize->24,ExpressionUUID->"b6573177-44ef-402d-917c-b44cd250e387"],

Cell["\<\
Defaults :
   
imageIndices:=1;;All;

11_all  --  imageIndices=1;;6800;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.890277324764104*^9, 
   3.90047487594096*^9, {3.9005086280372458`*^9, 3.9005086457806206`*^9}},
 FontSize->16,ExpressionUUID->"4aac670b-3e93-4c62-b4cf-11425d7f137e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageIndices", "=", 
   RowBox[{"1", ";;", "6800"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890245583183916*^9, 3.8902456614535065`*^9}, {
   3.8902773452159863`*^9, 3.8902773622840977`*^9}, {3.8988543996271057`*^9, 
   3.89885440055398*^9}, {3.899494674490989*^9, 3.89949467454513*^9}, {
   3.8995447576340475`*^9, 3.8995447576989765`*^9}, {3.8995678374104304`*^9, 
   3.899567837665861*^9}, 3.9004378746023083`*^9, {3.9102636880697174`*^9, 
   3.9102636924457293`*^9}, 3.910620879667564*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"34ef7084-673a-4a52-93c7-d5fa92d9fe2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testImages", "=", 
   RowBox[{"imagesCorrected", "[", 
    RowBox[{"[", "imageIndices", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testImages", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"reducedImages", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"Image", "[", 
               RowBox[{"#", ",", "Byte"}], "]"}], "&"}], "@", 
             RowBox[{"ImageAdjust", "@", "#"}]}]}], ")"}], "&"}], "/@", 
         "testImages"}], "//", "Parallelize"}]}], ";"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "testImages"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"images", ",", "previewImages"}], "}"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.889625446103185*^9, 3.889625446304331*^9}, {
   3.890045087353386*^9, 3.890045103997046*^9}, {3.8900451402213306`*^9, 
   3.8900451765400467`*^9}, 3.8900651460431423`*^9, {3.8902773649898624`*^9, 
   3.890277368064213*^9}, {3.892888349442803*^9, 3.8928884218379297`*^9}, {
   3.8988532609247694`*^9, 3.8988532628583164`*^9}, {3.898853294442675*^9, 
   3.898853330730877*^9}, 3.8988543945473557`*^9, {3.8993858406599693`*^9, 
   3.8993858820029535`*^9}, 3.8994053811212006`*^9, {3.8996224393529105`*^9, 
   3.899622482822687*^9}, {3.8997988371648197`*^9, 3.8997988375590386`*^9}, 
   3.899798872790203*^9, {3.8998838217957883`*^9, 3.8998838221018534`*^9}, {
   3.8998838561658826`*^9, 3.8998838629538155`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"e8bad021-ca43-48a2-8238-3c57eaa115ac"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image Filtering & Correction", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
   3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
   3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, 
   3.889042323484454*^9},
 FontSize->24,ExpressionUUID->"65bd0a82-eb4e-479f-8914-0109fdde88b3"],

Cell[CellGroupData[{

Cell["Setup Global Filtering", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8994947556886783`*^9, 3.89949477016847*^9}, {3.8997992032759304`*^9, 
  3.8997992073254013`*^9}, {3.899894983574377*^9, 3.899894985089367*^9}, {
  3.8999021323649983`*^9, 3.899902136823823*^9}, {3.900397608100218*^9, 
  3.9003976146187973`*^9}},ExpressionUUID->"156730bf-d3ab-40cc-bae7-\
dc3580cd0008"],

Cell["\<\
Defaults :
   
curvatureFlowIterations=2;
curvatureFlowConductivity=4;
luminanceCompression=0.1;
SCTMMiterations=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.8988444342614117`*^9},
 FontSize->16,ExpressionUUID->"06b1812c-024c-49ce-94a3-ab5924f58f60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"curvatureFlowIterations", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvatureFlowConductivity", "=", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SCTMMiterations", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8852960353394794`*^9, 3.885296036366276*^9}, {
   3.8852962948679204`*^9, 3.885296445041147*^9}, {3.885296598841734*^9, 
   3.885296601329003*^9}, {3.885296692665163*^9, 3.8852967615690117`*^9}, {
   3.8852968395596366`*^9, 3.885296843986663*^9}, {3.885296880056861*^9, 
   3.885296917175844*^9}, {3.8853776071503005`*^9, 3.8853776487135553`*^9}, {
   3.88537789933575*^9, 3.8853779001806145`*^9}, {3.88537800992544*^9, 
   3.885378017968091*^9}, {3.8854094750444183`*^9, 3.885409491795374*^9}, {
   3.885409958584223*^9, 3.885410017484313*^9}, 3.888485867768777*^9, {
   3.8884867806795597`*^9, 3.888486780945943*^9}, 3.8884870363589325`*^9, 
   3.888487087198887*^9, {3.8884945067304697`*^9, 3.8884945593544445`*^9}, {
   3.8886954970506325`*^9, 3.888695497713893*^9}, {3.8890158844784145`*^9, 
   3.889015888926398*^9}, {3.889016160206788*^9, 3.8890161709821315`*^9}, {
   3.8890162502148438`*^9, 3.889016265046629*^9}, {3.889016965789277*^9, 
   3.889016984853629*^9}, {3.889021421319033*^9, 3.8890214215895123`*^9}, {
   3.8890239188568177`*^9, 3.8890239191368475`*^9}, {3.8890339206976547`*^9, 
   3.8890339287771845`*^9}, {3.8890339894803743`*^9, 
   3.8890340017202168`*^9}, {3.8890340364801655`*^9, 3.889034036620988*^9}, {
   3.889034075097415*^9, 3.8890340981680226`*^9}, {3.8902176446587467`*^9, 
   3.8902177017860065`*^9}, {3.8902178048996134`*^9, 
   3.8902178121380153`*^9}, {3.890218781265541*^9, 3.8902187827453165`*^9}, {
   3.890221463637655*^9, 3.890221467078759*^9}, 3.8902272552075863`*^9, {
   3.89022731713731*^9, 3.8902273173852215`*^9}, {3.890227351849341*^9, 
   3.8902274365534706`*^9}, {3.890227723040264*^9, 3.8902277463612146`*^9}, {
   3.89024487987037*^9, 3.890244879933134*^9}, {3.8902449551347075`*^9, 
   3.8902450180139155`*^9}, {3.8902453150137353`*^9, 
   3.8902453150775566`*^9}, {3.8988240066304417`*^9, 
   3.8988240349887223`*^9}, {3.8988241262544994`*^9, 
   3.8988241652928658`*^9}, {3.8988242425892067`*^9, 3.898824254019895*^9}, {
   3.898824411227763*^9, 3.8988244325802774`*^9}, {3.89882449262899*^9, 
   3.898824560820507*^9}, {3.898824921397147*^9, 3.8988249496643114`*^9}, {
   3.8988265373927917`*^9, 3.8988265480851336`*^9}, {3.8988582149495087`*^9, 
   3.8988582440988336`*^9}, {3.8988582925877047`*^9, 3.898858302475651*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"b9917ff4-93bf-48f4-887c-9fda1bcab963"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Global Filtering ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8994947556886783`*^9, 3.89949477016847*^9}, {3.8997992032759304`*^9, 
  3.8997992073254013`*^9}, {3.899894983574377*^9, 3.899894985089367*^9}, {
  3.8999021323649983`*^9, 
  3.899902136823823*^9}},ExpressionUUID->"4310fa75-dc33-41df-b749-\
f864d9816d52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testStage1", "=", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"preprocessImage", "@", 
      RowBox[{"testImages", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testStage2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"CurvatureFlowFilter", "[", 
       RowBox[{
       "#", ",", "curvatureFlowIterations", ",", 
        "curvatureFlowConductivity"}], "]"}], "&"}], "@", "testStage1"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testStage3", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Nest", "[", 
       RowBox[{"applySCTMM", ",", "#", ",", "SCTMMiterations"}], "]"}], "&"}],
      "@", "testStage2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageAdjust", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"testImages", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "testStage1", ",", 
         "testStage2", ",", "testStage3"}], "}"}]}], ",", "2"}], 
     "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Image", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
   RowBox[{"getCombinedFilteredImage", "@", 
    RowBox[{"testImages", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}]}], "//", "ImageAdjust"}]}], "Input",
 CellChangeTimes->{{3.898824447703362*^9, 3.8988244556289964`*^9}, {
   3.898824862349291*^9, 3.8988249060715404`*^9}, {3.898824961822523*^9, 
   3.8988250664038477`*^9}, {3.8988251107240124`*^9, 3.8988251115710115`*^9}, 
   3.8988260675373864`*^9, 3.8988261425355325`*^9, {3.898826557507362*^9, 
   3.8988266458126554`*^9}, {3.898844082974761*^9, 3.8988441074297504`*^9}, {
   3.8988441824571247`*^9, 3.898844253929885*^9}, {3.8988544338452225`*^9, 
   3.8988544773664494`*^9}, {3.899494784969802*^9, 3.8994947852683487`*^9}, {
   3.899799056838868*^9, 3.8997990849763927`*^9}, 3.8997991292464323`*^9, {
   3.899799532837628*^9, 3.899799535380498*^9}, {3.8997995737024*^9, 
   3.899799580386132*^9}, {3.8997999689994726`*^9, 3.899799969205638*^9}, 
   3.8998000592367916`*^9, {3.8998003659649057`*^9, 3.8998003951638737`*^9}, {
   3.8998838932097473`*^9, 3.899883896148367*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"ce7184cf-8ecc-4f38-898f-08a3a0d6bc20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 
  3.8887785266060743`*^9}},ExpressionUUID->"29fb3c44-0d17-4611-9065-\
d782a5b85ec0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"globalImagesFiltered", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"getCombinedFilteredImage", "@", "#"}]}], ")"}], "&"}], 
        ",", "testImages"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "testImages"}]}], "]"}]}], "\[IndentingNewLine]",
    "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.889025616191172*^9, 3.889025652271534*^9}, {
   3.889025775040247*^9, 3.8890257764862776`*^9}, {3.8896217851541767`*^9, 
   3.8896218212276373`*^9}, {3.8896219102988257`*^9, 
   3.8896219212551622`*^9}, {3.8899003884109387`*^9, 3.889900389719758*^9}, 
   3.8903842510130467`*^9, {3.8988488961318607`*^9, 3.8988488983472924`*^9}, {
   3.8988522765889826`*^9, 3.8988523264124413`*^9}, 3.8988533412882037`*^9, 
   3.8988542875726547`*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"755bc11b-164d-4458-8b7f-704acf3414d3"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"globalImagesFiltered", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "globalImagesFiltered"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.892821837937907*^9, 3.8928218565972977`*^9}, 
   3.892828454761511*^9, {3.8988524169953394`*^9, 3.8988524191797256`*^9}, {
   3.90043798216377*^9, 
   3.900438001856044*^9}},ExpressionUUID->"01fab233-02d3-47b7-aeb8-\
a5b8e5be58b0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Swarm Core Segmentation", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049420537167`*^9}, {
  3.8854094478035316`*^9, 3.885409453076508*^9}, {3.888486141552059*^9, 
  3.8884861720324974`*^9}, {3.8890422059622965`*^9, 3.889042235610273*^9}, {
  3.889042323484454*^9, 3.889042343794162*^9}},
 FontSize->24,ExpressionUUID->"a58d7667-9468-4620-8f3c-768adb31aa20"],

Cell[CellGroupData[{

Cell["Segmentation Setup", "Subsubsection",
 CellChangeTimes->{{3.8884866650191913`*^9, 3.88848670409513*^9}, {
  3.8891198156497955`*^9, 3.8891198179379873`*^9}, {3.8904094932471294`*^9, 
  3.890409494585987*^9}, {3.8994948422992015`*^9, 3.899494859049247*^9}, {
  3.8999021012290983`*^9, 
  3.8999021073496304`*^9}},ExpressionUUID->"624a3541-d102-4336-af01-\
99900049504e"],

Cell["\<\
Defaults :
   
customChanVeseWeights={0.025,0,2,2};
levelSetIterations=500;
lambdaID=1;
levelSetInversionThreshold=0.25;

lambda2={2,2.5,3,4,5,6,7,8,9,10};

(only when Chan-Vese is used)
   
   
dilationScale=2;
closingScale=10;
swarmSizeThreshold=2500;
blurScale=10;
openingScale=10;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.8988444342614117`*^9, 
   3.8988488211503143`*^9, 3.899198220007211*^9, {3.89989078316335*^9, 
   3.899890831472375*^9}, 3.8998923934500127`*^9, {3.89989343367811*^9, 
   3.8998934338376527`*^9}, {3.8999084319352713`*^9, 3.899908440687881*^9}, 
   3.8999084720036874`*^9, {3.899909056831335*^9, 3.899909063360956*^9}, {
   3.9004769040765676`*^9, 3.9004769072141776`*^9}, {3.900477081467938*^9, 
   3.9004770983717246`*^9}},
 FontSize->16,ExpressionUUID->"297cca5e-2a34-4594-8573-bf93d62388dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"customChanVeseWeights", "=", 
   RowBox[{"{", 
    RowBox[{"0.025", ",", "0", ",", "2", ",", "2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"levelSetIterations", "=", "500"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lambdaID", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"levelSetInversionThreshold", "=", "0.25"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dilationScale", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"closingScale", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmSizeThreshold", "=", "2500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blurScale", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"openingScale", "=", "10"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.898826939537151*^9, 3.898826990138914*^9}, 
   3.8988530334938993`*^9, {3.8988584892771864`*^9, 3.8988585016683187`*^9}, {
   3.8998885805226135`*^9, 3.899888653158087*^9}, 3.8998894696664114`*^9, {
   3.8998908121233034`*^9, 3.8998908126493487`*^9}, {3.8998923584491243`*^9, 
   3.899892387203883*^9}, {3.8998934085932655`*^9, 3.89989340877313*^9}, {
   3.8999013171434183`*^9, 3.899901317320093*^9}, {3.899908444793448*^9, 
   3.8999084455125246`*^9}, {3.9004750401923428`*^9, 
   3.9004751015732307`*^9}, {3.9004751362631197`*^9, 
   3.9004751570852547`*^9}, {3.9004751973757067`*^9, 3.900475437093857*^9}, 
   3.9004754700580993`*^9, 3.9004755320535855`*^9, {3.9004763441733236`*^9, 
   3.9004763452922783`*^9}, {3.900476583356929*^9, 3.900476599213657*^9}, {
   3.9004769554784827`*^9, 3.9004769937402596`*^9}, 3.900477103262741*^9},
 CellLabel->
  "In[520]:=",ExpressionUUID->"014f406b-9f5f-401c-9579-5630965a3f68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda2", "=", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2.5", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
     "8", ",", "9", ",", "10"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridPoints", "=", 
    RowBox[{"getChanVeseGridPoints", "@", 
     RowBox[{"First", "@", "testImages"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"initialLevelSetImage", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Image", "@", 
      RowBox[{"getChanVeseLevelSet", "[", 
       RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}]}], "&"}], "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lambda2", "[", 
       RowBox[{"[", "lambdaID", "]"}], "]"}], ",", "gridPoints", ",", 
      RowBox[{"First", "@", "testImages"}]}], "\[IndentingNewLine]", 
     "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8998889576454515`*^9, 3.899888989418672*^9}, {
   3.8998891525469527`*^9, 3.899889185519435*^9}, {3.8998909729751587`*^9, 
   3.89989098828126*^9}, {3.899891018958794*^9, 3.899891025847213*^9}, {
   3.899891082215299*^9, 3.899891104405199*^9}, {3.899891136903345*^9, 
   3.8998911418308897`*^9}, {3.899891176357442*^9, 3.8998912092752185`*^9}, {
   3.8998948664152822`*^9, 3.8998948728757124`*^9}, 3.8998950429091053`*^9, {
   3.8999014587756753`*^9, 3.899901464694798*^9}, {3.8999085997545547`*^9, 
   3.8999086044735346`*^9}, {3.900475507149946*^9, 3.900475508660853*^9}, {
   3.9004755541654987`*^9, 3.9004755557741957`*^9}, {3.900476876069522*^9, 
   3.9004768763965907`*^9}, {3.900477087537702*^9, 3.9004770949807982`*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"26af7b87-e63b-4377-8d18-5906194d1267"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Global Segmentation ]]", "Subsubsection",
 CellChangeTimes->{{3.8884866650191913`*^9, 3.88848670409513*^9}, {
  3.8891198156497955`*^9, 3.8891198179379873`*^9}, {3.8904094932471294`*^9, 
  3.890409494585987*^9}, {3.8994948422992015`*^9, 3.899494859049247*^9}, {
  3.8999021012290983`*^9, 3.8999021073496304`*^9}, {3.8999021931663294`*^9, 
  3.899902197742074*^9}},ExpressionUUID->"ed56756a-635d-44c7-85e4-\
6f0ca5dc9758"],

Cell["\<\
Tests:
   
testInitialMask=MorphologicalBinarize@globalImagesFiltered[[testID]];

testInitialMask=If[Mean@#>levelSetInversionThreshold,ColorNegate@#,#]&@\
applyCustomChanVese@globalImagesFiltered[[testID]];\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.8988444342614117`*^9, 
   3.8988488211503143`*^9, 3.899198220007211*^9, {3.89989078316335*^9, 
   3.899890831472375*^9}, {3.899892300029889*^9, 3.8998923367113724`*^9}, 
   3.8998947781341667`*^9},
 FontSize->16,ExpressionUUID->"2201ad87-a4e5-4f54-82d7-176e1dac79f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFilteredImage", "=", 
    RowBox[{"getCombinedFilteredImage", "@", 
     RowBox[{"testImages", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testInitialMask", "=", 
    RowBox[{"MorphologicalBinarize", "@", "testFilteredImage"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testInitialMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mean", "@", "#"}], ">", "levelSetInversionThreshold"}], ",", 
        RowBox[{"ColorNegate", "@", "#"}], ",", "#"}], "]"}], "&"}], "@", 
     RowBox[{"applyCustomChanVese", "@", "testFilteredImage"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testRefinedMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DeleteSmallComponents", "[", 
           RowBox[{"#", ",", "swarmSizeThreshold"}], "]"}], "&"}], "@", 
         RowBox[{"FillingTransform", "@", 
          RowBox[{"Closing", "[", 
           RowBox[{"#", ",", 
            RowBox[{"DiskMatrix", "@", "closingScale"}]}], "]"}]}]}], "&"}], 
       "@", 
       RowBox[{"Dilation", "[", 
        RowBox[{"#", ",", 
         RowBox[{"DiskMatrix", "@", "dilationScale"}]}], "]"}]}], "&"}], "@", 
     "testInitialMask"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFinalMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DeleteBorderComponents", "@", 
           RowBox[{"DeleteSmallComponents", "[", 
            RowBox[{"#", ",", "swarmSizeThreshold"}], "]"}]}], "&"}], "@", 
         RowBox[{"Opening", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "openingScale"}]}], "]"}]}], "&"}], "@", 
       RowBox[{"Binarize", "@", 
        RowBox[{"GaussianFilter", "[", 
         RowBox[{"#", ",", "blurScale"}], "]"}]}]}], "&"}], "@", 
     "testRefinedMask"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testResult", "=", 
    RowBox[{"getMaskOverlays", "[", 
     RowBox[{
      RowBox[{"testImages", "[", 
       RowBox[{"[", "testID", "]"}], "]"}], ",", "testFinalMask", ",", "Red", 
      ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
    RowBox[{"{", 
     RowBox[{
     "testInitialMask", ",", "testRefinedMask", ",", "testFinalMask", ",", 
      "testResult"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8999099679396114`*^9, 3.899910146710103*^9}, {
   3.8999101774970665`*^9, 3.8999102609905376`*^9}, {3.900067024149847*^9, 
   3.9000670274550285`*^9}, 3.9003560395396957`*^9, {3.9004750140862226`*^9, 
   3.900475014470191*^9}, 3.9004751172878704`*^9, {3.9004756972393303`*^9, 
   3.9004761468377714`*^9}, {3.900476428934899*^9, 3.90047645851819*^9}, {
   3.90047652037333*^9, 3.900476563644652*^9}, {3.9004766174617805`*^9, 
   3.9004768635479054`*^9}, {3.9004768950307584`*^9, 
   3.9004769342562065`*^9}, {3.900477013654584*^9, 3.9004770583007812`*^9}, {
   3.9004771239254675`*^9, 3.9004771243803034`*^9}},
 CellLabel->
  "In[540]:=",ExpressionUUID->"ef177435-1427-466b-8b38-a832bbb47551"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 
  3.8887785266060743`*^9}},ExpressionUUID->"bc788cf6-b802-4bbf-84a2-\
242ec27da5c2"],

Cell["\<\
Functions:
   
globalSegmentationSmallSwarms  (2-Otsu hysteresis binarization, ***DEFAULT***)

globalSegmentationSmallSwarmsChanVese  (custom Chan-Vese binarization)\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.8988444342614117`*^9, 
   3.8988488211503143`*^9, 3.899198220007211*^9, {3.89989078316335*^9, 
   3.899890831472375*^9}, {3.899892300029889*^9, 3.8998923367113724`*^9}, 
   3.8998947781341667`*^9, {3.899908904738388*^9, 3.899908940120177*^9}, {
   3.899916565011021*^9, 3.8999165810839667`*^9}},
 FontSize->16,ExpressionUUID->"28fa8f5c-3d6c-4090-b6b6-819b89a08b49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"globalSwarmCoreSegmentsInitial", "=", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"globalSegmentationSmallSwarms", "@", "#"}]}], 
           "\[IndentingNewLine]", ")"}], "&"}], ",", "globalImagesFiltered"}],
         "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "globalImagesFiltered"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"globalSwarmCoreSegments", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"globalSegmentCorrectionSmallSwarms", "@", "#"}]}], 
          "\[IndentingNewLine]", ")"}], "&"}], ",", 
        "globalSwarmCoreSegmentsInitial"}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "globalSwarmCoreSegmentsInitial"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8854098471313815`*^9, 3.885409933267644*^9}, {
   3.885410664894001*^9, 3.8854106700445356`*^9}, {3.8883999167470474`*^9, 
   3.8883999258106775`*^9}, {3.888400027275715*^9, 3.8884000364702787`*^9}, {
   3.8884002363149176`*^9, 3.888400412017642*^9}, 3.8884004473870497`*^9, {
   3.888400553371066*^9, 3.8884005543263245`*^9}, {3.8884768214567413`*^9, 
   3.8884768282921553`*^9}, {3.888476922425911*^9, 3.8884769256867676`*^9}, {
   3.8884868836990614`*^9, 3.8884869009999094`*^9}, {3.8884944871631703`*^9, 
   3.888494492978544*^9}, {3.8884945654116993`*^9, 3.888494606922541*^9}, {
   3.8890159717912235`*^9, 3.889016078942408*^9}, {3.8890161131184845`*^9, 
   3.8890161444391685`*^9}, {3.889016199822705*^9, 3.8890162238735485`*^9}, 
   3.8890168784314547`*^9, {3.8890214883900447`*^9, 3.889021570318064*^9}, {
   3.8890239285159335`*^9, 3.889023931946168*^9}, 3.8890241486841745`*^9, {
   3.889034176388325*^9, 3.8890342136723127`*^9}, {3.8890344436882095`*^9, 
   3.8890344440503335`*^9}, 3.889034540992892*^9, 3.88903765517065*^9, {
   3.88903959262265*^9, 3.889039593292654*^9}, {3.8896217044725924`*^9, 
   3.8896217078729*^9}, 3.8896220263932486`*^9, {3.889623319941121*^9, 
   3.889623320827937*^9}, {3.889623515411318*^9, 3.8896235156933913`*^9}, {
   3.8902173511017323`*^9, 3.890217352380131*^9}, {3.890246074183222*^9, 
   3.8902460754329033`*^9}, {3.8903770708089566`*^9, 3.89037708230973*^9}, {
   3.8903835012221355`*^9, 3.890383503009507*^9}, 3.8903838261496696`*^9, {
   3.8903850215088654`*^9, 3.89038502503242*^9}, {3.8903871641057816`*^9, 
   3.8903871712938724`*^9}, {3.89083984898612*^9, 3.890839881433424*^9}, {
   3.8988510887987895`*^9, 3.898851123038909*^9}, {3.898851368138894*^9, 
   3.8988513684989343`*^9}, 3.8988528741986003`*^9, {3.8998924788470883`*^9, 
   3.8998924830260425`*^9}, {3.8999019938234587`*^9, 3.8999019952072763`*^9}, 
   3.899909606483694*^9, {3.9000670858538914`*^9, 3.900067088669574*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"91badf37-71f2-4744-880d-2accfba6ebb1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testImages", "[", 
      RowBox[{"[", "k", "]"}], "]"}], ",", 
     RowBox[{"globalSwarmCoreSegments", "[", 
      RowBox[{"[", "k", "]"}], "]"}], ",", "Red", ",", "2"}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "globalSwarmCoreSegments"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8998069151283655`*^9, 3.8998069380551777`*^9}, {
  3.8999079492116766`*^9, 3.8999079810497227`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"7917da1d-adb9-4619-8b45-7960ac16809e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkSegmentCount", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"#", ",", "\"\<Area\>\""}], "]"}]}], "&"}], "/@", 
       RowBox[{"globalSwarmCoreSegments", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "All"}], "]"}], "]"}]}], "//", "Parallelize"}], "//",
      "Flatten"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Position", "[", 
  RowBox[{"checkSegmentCount", ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", ">", "1"}], "&"}], ")"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{"checkSegmentCount", ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8988784921315775`*^9, 3.8988786492278366`*^9}, {
  3.8988786823810177`*^9, 3.89887869405031*^9}, {3.8999020682145176`*^9, 
  3.899902075413299*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"5fddb8eb-3329-47f4-a2b1-5787c64dd4e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Initial VS Corrected Segments ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9, {3.8903871897899866`*^9, 
   3.890387209869462*^9}},ExpressionUUID->"a69f70d3-c714-492a-8453-\
3d6b0302df17"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"globalSwarmCoreSegmentsInitial", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "globalSwarmCoreSegmentsInitial"}], ",", "1"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890388210694503*^9, 3.890388234868422*^9}, 
   3.8903882695071955`*^9, {3.8903883169183693`*^9, 3.8903883632852335`*^9}, 
   3.8903884034462843`*^9, 3.892874454020651*^9, {3.8988585307863965`*^9, 
   3.8988585319381237`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"6ecd30b4-2bdd-4681-a4a6-2714607505c2"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reducedImages", "[", 
      RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
        RowBox[{"Binarize", "@", 
         RowBox[{"Blur", "[", 
          RowBox[{"#", ",", "5"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", 
       RowBox[{"globalSwarmCoreSegmentsInitial", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Binarize", "@", 
        RowBox[{"Blur", "[", 
         RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", 
       RowBox[{"globalSwarmCoreSegments", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "globalSwarmCoreSegments"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.888487900253811*^9, 3.88848795573306*^9}, {
   3.8884879868762054`*^9, 3.8884880402293463`*^9}, {3.888488079622923*^9, 
   3.8884881201174326`*^9}, {3.88848831980529*^9, 3.8884883483092823`*^9}, {
   3.8884885370662584`*^9, 3.888488611348756*^9}, {3.8884887481494102`*^9, 
   3.8884887613174496`*^9}, {3.888489227579985*^9, 3.888489269890977*^9}, {
   3.888489388827734*^9, 3.888489389963131*^9}, {3.8884894304436607`*^9, 
   3.8884896015065603`*^9}, {3.888489749043769*^9, 3.8884897876263447`*^9}, {
   3.8884898316516533`*^9, 3.8884899817464375`*^9}, {3.8884900222906218`*^9, 
   3.88849007553136*^9}, {3.888490176515911*^9, 3.88849018212197*^9}, {
   3.888490260682706*^9, 3.8884903251305184`*^9}, {3.888490463169798*^9, 
   3.888490463888937*^9}, {3.8884905001140437`*^9, 3.8884905066414804`*^9}, {
   3.888490804833956*^9, 3.888490809368975*^9}, 3.8884908469534826`*^9, {
   3.8884909049530163`*^9, 3.888490907345979*^9}, {3.888491547024638*^9, 
   3.888491596134221*^9}, {3.888493379653384*^9, 3.8884933857965393`*^9}, 
   3.8884940858679495`*^9, {3.888494396388753*^9, 3.888494400898628*^9}, {
   3.8884946820362077`*^9, 3.888494693897938*^9}, {3.889016673591229*^9, 
   3.8890167881046777`*^9}, {3.889021392254198*^9, 3.889021396856002*^9}, {
   3.8890214542862196`*^9, 3.8890214544051294`*^9}, {3.8890216099584403`*^9, 
   3.889021612764716*^9}, 3.8890236775461707`*^9, {3.8890237689059696`*^9, 
   3.889023783897764*^9}, 3.8890339030908012`*^9, {3.889034269417774*^9, 
   3.889034283295813*^9}, {3.8890348977665377`*^9, 3.8890349221587563`*^9}, {
   3.8890349658928137`*^9, 3.889034981039402*^9}, {3.890387234231617*^9, 
   3.890387242663167*^9}, {3.89038771692036*^9, 3.8903877700875463`*^9}, {
   3.890387833925543*^9, 3.8903878439030147`*^9}, {3.8903878762407866`*^9, 
   3.8903878970618153`*^9}, {3.8903880877295074`*^9, 
   3.8903880919415665`*^9}, {3.8903882729348183`*^9, 3.890388292416382*^9}, {
   3.890388417663119*^9, 3.8903884269749165`*^9}, {3.8903884593020487`*^9, 
   3.890388513810408*^9}, {3.898852719547793*^9, 3.8988527209466705`*^9}, 
   3.898852899942528*^9},
 CellLabel->
  "In[197]:=",ExpressionUUID->"8bda878b-02ec-43f1-a907-3fe3aba1f348"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Global Swarm Core Segments >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889621133375841*^9, 
   3.8896211363840966`*^9}, {3.889621720189864*^9, 3.8896217261626763`*^9}, 
   3.8896235107221956`*^9},ExpressionUUID->"06bffdd9-68e2-465f-a381-\
8ab4cf9e1a56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compressedGlobalSwarmCoreSegments", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", "globalSwarmCoreSegments"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalSwarmCoreMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Global Swarm Core Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"globalSwarmCoreMaskFolder", "//", "CreateDirectory"}], ";"}], "//",
    "Quiet"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "compressedGlobalSwarmCoreSegments", ",", "globalSwarmCoreMaskFolder", 
     ",", "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
   3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
   3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
   3.889621126101282*^9, 3.8896211918063293`*^9}, 3.8896214994948688`*^9, {
   3.8896215537218475`*^9, 3.889621561789811*^9}, {3.8896216430248423`*^9, 
   3.8896216457023907`*^9}, 3.8896216789445276`*^9, {3.8896220419612627`*^9, 
   3.8896220975531425`*^9}, {3.889623340867552*^9, 3.8896233411228905`*^9}, {
   3.8899819697164917`*^9, 3.889981979009638*^9}, 3.889982019469488*^9, {
   3.8899820760598574`*^9, 3.8899820783107395`*^9}, {3.890046229067525*^9, 
   3.890046277931983*^9}, {3.890527335932677*^9, 3.8905273362291927`*^9}, {
   3.899494914195033*^9, 3.8994949154990673`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"630a9c56-02e2-4302-a470-902c86a8b117"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clear Unneeded Data from Memory", "Subsubsection",
 CellChangeTimes->{{3.894805045033735*^9, 
  3.8948050655017843`*^9}},ExpressionUUID->"293a8743-6d19-4512-b792-\
a827a00c0276"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "globalImagesFiltered", ",", "globalSwarmCoreSegmentsInitial", ",", 
      "globalSwarmCoreSegments", ",", "compressedGlobalSwarmCoreSegments"}], 
     "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.8964379636831303`*^9, 3.896437980238473*^9}, {
  3.8964381383738813`*^9, 3.8964381596718073`*^9}, {3.898878807298684*^9, 
  3.898878807938448*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"3f747777-23a1-4e03-92f4-9be2e6b590be"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Global Swarm Core Segments  <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, {3.88962249911553*^9, 3.8896225193161316`*^9}, 
   3.8896234870902314`*^9},ExpressionUUID->"b926cddd-ec58-4f47-ac7b-\
86375e28345d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"globalSwarmCoreMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<1 Global Swarm Core Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "globalSwarmCoreMaskFolder"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"globalSwarmCoreSegments", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"globalSwarmCoreMaskFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896225359098797`*^9, 3.8896226218372874`*^9}, {3.88962271829244*^9, 
   3.8896227275498905`*^9}, {3.889623134636578*^9, 3.889623137861703*^9}, {
   3.889623351635437*^9, 3.889623352090786*^9}, {3.8896235050986195`*^9, 
   3.889623534803034*^9}, 3.8899815513595295`*^9, {3.8901546653652105`*^9, 
   3.890154666131366*^9}, {3.8903837878670807`*^9, 3.8903837896332626`*^9}, {
   3.8903838511865406`*^9, 3.890383858398181*^9}, 3.8903839043715124`*^9, {
   3.890384135310108*^9, 3.890384146650017*^9}, {3.890386917039728*^9, 
   3.8903869187284775`*^9}, {3.8904093272504597`*^9, 3.890409333525776*^9}, 
   3.890409366183757*^9, {3.890527338154413*^9, 3.8905273383735204`*^9}, {
   3.8988782099719763`*^9, 3.8988782104193707`*^9}, {3.900093179450349*^9, 
   3.9000932064248447`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"c2276ca9-3457-465a-a722-7e56077054a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Detection Overlays", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119657154166*^9}, {3.889119711513423*^9, 3.889119714537727*^9}, {
  3.889119782649438*^9, 3.889119789409094*^9}, {3.8896233901939363`*^9, 
  3.88962339466506*^9}, {3.8896234654186*^9, 3.88962350097915*^9}, {
  3.898878240746064*^9, 3.8988782414678726`*^9}, {3.898879893689663*^9, 
  3.8988798939862194`*^9}},ExpressionUUID->"8ea8472c-c055-4acf-9129-\
8aaabaadad13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"globalOverlays", "=", 
      RowBox[{"Parallelize", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"getMaskOverlays", "[", 
             RowBox[{"#1", ",", "#2", ",", "White", ",", "2"}], "]"}]}], 
           ")"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"reducedImages", ",", "globalSwarmCoreSegments"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "globalSwarmCoreSegments"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8928748705781903`*^9, 3.892874873330296*^9}, {
  3.8988788614276185`*^9, 3.898878925082382*^9}, {3.8988789620594873`*^9, 
  3.8988789621947546`*^9}, {3.8988789977140284`*^9, 3.8988790680296216`*^9}, {
  3.898879105355255*^9, 3.8988791066823025`*^9}, {3.8988791595704784`*^9, 
  3.8988791653433867`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"ca8b2b7d-838a-4658-a4b4-ee9c6846cd4c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Swarm Tracks", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
   3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
   3.889119657154166*^9}, {3.889119711513423*^9, 3.889119714537727*^9}, {
   3.889119782649438*^9, 3.889119789409094*^9}, {3.88961880728358*^9, 
   3.889618811514926*^9}, 3.892882963980362*^9, {3.898878175643344*^9, 
   3.898878181307367*^9}, {3.89887825124391*^9, 3.898878252762829*^9}, {
   3.898879891680964*^9, 
   3.8988798924101124`*^9}},ExpressionUUID->"6d71c612-967c-4a01-8f02-\
7a62df9184f6"],

Cell["\<\
Defaults :
   
dotLimit=10000;
dotScale=0.0075;
colorPaletteID=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.894826466624727*^9},
 FontSize->16,ExpressionUUID->"69dbffd9-5560-45d5-957b-2dcc63ec7b19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dotLimit", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotScale", "=", "0.0095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPaletteID", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8895931355983543`*^9, 3.88959319052549*^9}, {
   3.8895934186546507`*^9, 3.889593447613721*^9}, 3.889593496617155*^9, 
   3.8895935364939322`*^9, {3.889594482789895*^9, 3.8895944938993745`*^9}, {
   3.889594562755831*^9, 3.8895946020905266`*^9}, 3.889595237089754*^9, {
   3.8895953792498074`*^9, 3.8895953804260626`*^9}, {3.8895954121070423`*^9, 
   3.8895954169457407`*^9}, {3.889599304989027*^9, 3.8895993060507126`*^9}, {
   3.8896184342677636`*^9, 3.889618441091414*^9}, 3.889618598067729*^9, {
   3.8902318679484415`*^9, 3.8902318684690504`*^9}, {3.892808372941639*^9, 
   3.892808373908989*^9}, {3.892883034981555*^9, 3.8928830354923964`*^9}, {
   3.8988795426765647`*^9, 3.8988795427786245`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"6f423e92-fe88-4e5c-894c-09afeb5bb34e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"globalSwarmCentroids", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Last", "/@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", "\"\<Centroid\>\""}], "]"}]}], ")"}], "&"}], "/@",
        "globalSwarmCoreSegments"}], "//", "Parallelize"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorPalette", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}], 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"colorGrading", "=", 
   RowBox[{"Rescale", "@", 
    RowBox[{"N", "@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"#", "&"}], ",", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", "globalSwarmCentroids"}]}]}], "]"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dotColors", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ColorData", "@", 
         RowBox[{"colorPalette", "[", 
          RowBox[{"[", "colorPaletteID", "]"}], "]"}]}], ")"}], "[", "#", 
       "]"}], "&"}], "/@", "colorGrading"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"overlayTrajectoryPoints", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "\[LessEqual]", "dotLimit"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#1", ",", "#2", ",", 
             RowBox[{"PointSize", "@", "dotScale"}]}], "]"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"globalSwarmCentroids", "[", 
             RowBox[{"[", 
              RowBox[{";;", "#"}], "]"}], "]"}], ",", 
            RowBox[{"dotColors", "[", 
             RowBox[{"[", 
              RowBox[{";;", "#"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#1", ",", "#2", ",", 
             RowBox[{"PointSize", "@", "dotScale"}]}], "]"}], "&"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"globalSwarmCentroids", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "-", "dotLimit"}], ";;", "#"}], "]"}], "]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"dotColors", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "-", "dotLimit"}], ";;", "#"}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "globalSwarmCentroids"}]}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.89887921385634*^9, 3.8988793846776752`*^9}, {
  3.89887946658117*^9, 3.8988794754372115`*^9}, {3.9000906310837708`*^9, 
  3.900090632034766*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"cb4af84d-c83c-498f-8882-4ba27aedc10c"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Track Overlays ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, 3.8896191954917336`*^9, {
   3.889625361951063*^9, 3.889625370288069*^9}, {3.898878186682585*^9, 
   3.8988781870659127`*^9}, {3.898878255236931*^9, 3.898878256124148*^9}, {
   3.8988798887582016`*^9, 
   3.898879889062641*^9}},ExpressionUUID->"fc705d55-8490-4495-bbf2-\
5b527c43254a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reducedImages", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"globalSwarmCoreSegments", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", "White", ",", "2"}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"overlayTrajectoryPoints", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "reducedImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8928085035652866`*^9, 3.89280854405246*^9}, {
  3.8988794958266997`*^9, 3.898879504242413*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"375ee098-115f-4c8e-9923-e7d7500965ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrajectoryLastOverlay", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getMaskOverlays", "[", 
         RowBox[{"#1", ",", "#2", ",", "White", ",", "2"}], "]"}], ",", 
        "#3"}], "\[IndentingNewLine]", "]"}], "&"}], "@@", 
     RowBox[{"(", 
      RowBox[{"Last", "/@", 
       RowBox[{"{", 
        RowBox[{
        "reducedImages", ",", "globalSwarmCoreSegments", ",", 
         "overlayTrajectoryPoints"}], "}"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Ellipse Tracks Full.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "swarmTrajectoryLastOverlay", ",", 
    RowBox[{"CompressionLevel", "\[Rule]", "0.25"}], ",", 
    RowBox[{"ImageResolution", "\[Rule]", "125"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.892882866790864*^9, 3.892882934971696*^9}, {
   3.8928829881344357`*^9, 3.892883009273057*^9}, 3.898879509517644*^9, {
   3.8988795665570226`*^9, 3.8988795734433784`*^9}, {3.898879814364642*^9, 
   3.8988798319708323`*^9}, {3.900159720840516*^9, 3.9001597222602777`*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"fd24a8b3-3a71-4499-a88d-e678505acbc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Track Overlays", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119657154166*^9}, {3.889119711513423*^9, 3.889119714537727*^9}, {
  3.889119782649438*^9, 3.889119789409094*^9}, {3.88961880728358*^9, 
  3.889618811514926*^9}, {3.892882963980362*^9, 3.8928829772838907`*^9}, {
  3.898878188473907*^9, 3.8988781886661463`*^9}, {3.898878268042225*^9, 
  3.898878269820528*^9}, {3.89887988539355*^9, 
  3.898879885833495*^9}},ExpressionUUID->"cbfe937e-eb24-4ae0-b305-\
1a59ddedb499"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrajectoryOverlays", "=", 
    RowBox[{"Parallelize", "@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"getMaskOverlays", "[", 
           RowBox[{"#1", ",", "#2", ",", "White", ",", "2"}], "]"}], ",", 
          "#3"}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "reducedImages", ",", "globalSwarmCoreSegments", ",", 
         "overlayTrajectoryPoints"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8895931355983543`*^9, 3.88959319052549*^9}, {
   3.8895934186546507`*^9, 3.889593447613721*^9}, 3.889593496617155*^9, 
   3.8895935364939322`*^9, {3.889594482789895*^9, 3.8895944938993745`*^9}, {
   3.889594562755831*^9, 3.8895946020905266`*^9}, {3.889595237089754*^9, 
   3.8895952610603004`*^9}, {3.8895992581887417`*^9, 3.889599299068014*^9}, {
   3.889611379392375*^9, 3.8896113820542994`*^9}, 3.8896114553457384`*^9, {
   3.889611941522838*^9, 3.8896119731681585`*^9}, {3.8896136005167522`*^9, 
   3.8896136068989315`*^9}, 3.889613702236475*^9, {3.8896138657417083`*^9, 
   3.8896139094065027`*^9}, {3.8896181260922976`*^9, 3.889618127549098*^9}, {
   3.8896184256926556`*^9, 3.889618461252082*^9}, {3.889618584285379*^9, 
   3.8896186171148114`*^9}, {3.889618763628744*^9, 3.8896187679426985`*^9}, {
   3.8900452468260813`*^9, 3.8900452565737963`*^9}, 3.8900474640435195`*^9, {
   3.890048646854436*^9, 3.890048652205389*^9}, {3.890204658307106*^9, 
   3.8902046596630116`*^9}, {3.8902046907451477`*^9, 3.8902046963995123`*^9}, 
   3.8928083679087896`*^9, 3.892808480516358*^9, {3.898879841825593*^9, 
   3.898879849789977*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"69338457-030e-485a-be62-9a65cdbfe1e1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"swarmTrajectoryOverlays", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "swarmTrajectoryOverlays"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.88962446953216*^9, 3.8896244883847437`*^9}, {
  3.898879868028154*^9, 3.8988798694060583`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"97452b9d-7bc3-4e2d-88fa-17e55b362638"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accretion Bacteria Detection", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.8890423778257504`*^9, 
  3.889042384505704*^9}},ExpressionUUID->"a4feb96b-f813-4ed0-9703-\
152c70302f67"],

Cell[CellGroupData[{

Cell["Get Swarm Windows (SWs)", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049706133485`*^9}, 
   3.889042400618967*^9},
 FontSize->24,ExpressionUUID->"65ddd956-59c6-4606-af76-2ec71aac41ad"],

Cell[CellGroupData[{

Cell["Get Swarm Segment Data", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}, {3.889275900944454*^9, 
  3.889275905151973*^9}},ExpressionUUID->"848f22b3-b78c-4a5c-b3fd-\
56311c3b8dd3"],

Cell["\<\
Defaults :
   
artifactSizeThreshold=2500; (equal to \[OpenCurlyQuote]swarmSizeThreshold\
\[CloseCurlyQuote])\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.8886956257693124`*^9}, {3.899199579561748*^9, 3.8991996008376074`*^9}},
 FontSize->16,ExpressionUUID->"721042db-fe5d-4457-89cd-2d8c4b3449c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"artifactSizeThreshold", "=", "2500"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8884953578807507`*^9, 3.888495359840838*^9}, {
  3.8900669621709642`*^9, 3.890066963074564*^9}, {3.89039133876204*^9, 
  3.890391341705586*^9}, {3.899199575958339*^9, 3.899199577252507*^9}, {
  3.9003977088912754`*^9, 3.9003977101459208`*^9}, {3.900491430657554*^9, 
  3.900491430777234*^9}, {3.9004918473456087`*^9, 3.9004918485274596`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"5bc38f90-9c67-43ff-8e7c-251bcf1d41de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"swarmData", "=", 
      RowBox[{
       RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Image\>\"", ",", "\"\<FilledCount\>\"", ",", 
                "\"\<Centroid\>\"", ",", "\"\<BoundingBox\>\""}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"#FilledCount", ">", "artifactSizeThreshold"}], 
               "&"}]}], "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], "/@", 
         "globalSwarmCoreSegments"}], "\[IndentingNewLine]", "]"}], "/.", 
       RowBox[{"Rule", "\[Rule]", "List"}]}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "globalSwarmCoreSegments"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.885379618645537*^9, 3.885379693339284*^9}, {
   3.8853801810059605`*^9, 3.8853801983793373`*^9}, {3.8854058065349464`*^9, 
   3.8854058657442856`*^9}, {3.885410690324025*^9, 3.8854107266065598`*^9}, 
   3.888494429707915*^9, {3.8884948734189844`*^9, 3.8884949065136824`*^9}, {
   3.8884950769943542`*^9, 3.888495096993413*^9}, {3.8884952163063817`*^9, 
   3.8884952170691195`*^9}, {3.888495253650058*^9, 3.888495254041366*^9}, {
   3.8884953250675526`*^9, 3.888495355714203*^9}, {3.889039936536928*^9, 
   3.889040005127777*^9}, {3.889040084767647*^9, 3.8890400962635455`*^9}, {
   3.8890401266244555`*^9, 3.8890401350232735`*^9}, 3.8892761025216856`*^9, {
   3.892888216338532*^9, 3.892888289407872*^9}, 3.892912341634059*^9, {
   3.892912389839753*^9, 3.8929123968385086`*^9}, {3.8929126849268055`*^9, 
   3.89291270389203*^9}, {3.8991996215775547`*^9, 3.8991996232902403`*^9}, {
   3.8991996543674607`*^9, 3.8991996577264695`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"19ff30c8-0e68-4f25-9f0d-be9f6755ab5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Swarm Data >>", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}, {3.8892759125438747`*^9, 3.889275917544747*^9}, {
  3.890391483929043*^9, 
  3.8903914910011883`*^9}},ExpressionUUID->"cfa6506c-bb76-4ea0-9f4f-\
d9b123603093"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dataCompressedfolder", "<>", "\"\<Swarm Data.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "swarmData"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8903915643219943`*^9, 3.890391614698898*^9}, {
  3.90940053501092*^9, 
  3.909400537336396*^9}},ExpressionUUID->"726b809b-1550-47de-8488-\
33af34305527"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Swarm Data <<", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}, {3.8892759125438747`*^9, 3.889275917544747*^9}, {
  3.890391483929043*^9, 
  3.890391499641883*^9}},ExpressionUUID->"52ae6d21-144f-4d16-aab2-\
cbfe3d63be5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"swarmData", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", 
     RowBox[{"dataCompressedfolder", "<>", "\"\<Swarm Data.txt\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8903916307441673`*^9, 3.8903916497855167`*^9}, {
   3.8987599986253157`*^9, 3.8987599992489624`*^9}, 3.9094005414746633`*^9},
 CellLabel->
  "In[2638]:=",ExpressionUUID->"ade5766a-721d-43f6-8888-3f92aa7eb1f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate SWs", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}, {3.8892759125438747`*^9, 
  3.889275917544747*^9}},ExpressionUUID->"2d050de6-b383-407b-a556-\
9f5a489177d4"],

Cell["\<\
Defaults :
   
scaleBoxFactor=4;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.8886956257693124`*^9}, 3.8890436732167683`*^9, {3.899920945360106*^9, 
   3.899920956079045*^9}},
 FontSize->16,ExpressionUUID->"61eba5b6-6516-42a6-948b-31c932e97030"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scaleBoxFactor", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"placeholderSize", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderBias", "=", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderSW", "=", 
    RowBox[{"Image", "[", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"placeholderBias", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "placeholderSize"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "placeholderSize"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{"Length", "/@", "swarmData"}], ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.751367533932418*^9}, 3.7513678787540135`*^9, {3.751368682841755*^9, 
   3.751368710653499*^9}, {3.7513689560071154`*^9, 3.751368969333048*^9}, {
   3.7513702998183403`*^9, 3.7513703169215965`*^9}, {3.751370787710986*^9, 
   3.7513707969726477`*^9}, {3.751694728455764*^9, 3.7516947508282638`*^9}, {
   3.7516956463966684`*^9, 3.751695664837387*^9}, {3.7517117899960823`*^9, 
   3.751711790208119*^9}, {3.751715307345482*^9, 3.7517153142250805`*^9}, {
   3.751717768351387*^9, 3.7517178095255127`*^9}, {3.7517178904197807`*^9, 
   3.751717892263572*^9}, {3.751718021858073*^9, 3.7517180449997435`*^9}, 
   3.7517958177090473`*^9, {3.7517962384460444`*^9, 3.751796247771106*^9}, {
   3.751798356897586*^9, 3.751798359319228*^9}, {3.7518003178915434`*^9, 
   3.751800322200385*^9}, {3.7518054063190494`*^9, 3.751805413644461*^9}, {
   3.7518090738015766`*^9, 3.7518090780190587`*^9}, {3.751809128739005*^9, 
   3.7518091377363367`*^9}, {3.751809633506062*^9, 3.7518097128353043`*^9}, {
   3.751809747610074*^9, 3.751809763471615*^9}, {3.7518098013434286`*^9, 
   3.7518098312315564`*^9}, 3.75181018092091*^9, {3.751810440182747*^9, 
   3.7518104638003564`*^9}, {3.7518104975231147`*^9, 
   3.7518105003860273`*^9}, {3.7518706948423195`*^9, 
   3.7518706950687003`*^9}, {3.7518710217670946`*^9, 
   3.7518710268604765`*^9}, {3.751879180640204*^9, 3.751879198671009*^9}, {
   3.751954609915016*^9, 3.7519546122218122`*^9}, {3.7519574350255146`*^9, 
   3.7519574378918285`*^9}, {3.751957531661088*^9, 3.75195753194832*^9}, 
   3.7519739381155186`*^9, {3.751974564149325*^9, 3.7519745737382736`*^9}, {
   3.7519746061642714`*^9, 3.7519746074588327`*^9}, {3.7519863533188334`*^9, 
   3.7519863536130424`*^9}, {3.751986413477455*^9, 3.7519864235716724`*^9}, {
   3.7519870974555826`*^9, 3.7519871318905077`*^9}, {3.7520039790994835`*^9, 
   3.75200399610083*^9}, 3.752050298923599*^9, {3.7520514591520195`*^9, 
   3.752051513645871*^9}, {3.7520515810146384`*^9, 3.7520516070481863`*^9}, {
   3.7520517026397276`*^9, 3.7520517030814557`*^9}, {3.752051745263569*^9, 
   3.7520517836363487`*^9}, 3.752071268552267*^9, 3.7522119243556566`*^9, {
   3.760172950640916*^9, 3.760172954195407*^9}, {3.7601730596555715`*^9, 
   3.7601730603896136`*^9}, {3.760173095951811*^9, 3.7601731098661714`*^9}, {
   3.7601732070097156`*^9, 3.760173207577176*^9}, {3.7608967010022516`*^9, 
   3.760896713375206*^9}, {3.760929196843571*^9, 3.760929229387312*^9}, 
   3.7609305771199694`*^9, {3.76093208087411*^9, 3.760932116185805*^9}, {
   3.76093218508365*^9, 3.7609322280421505`*^9}, {3.760932258883037*^9, 
   3.7609322613026257`*^9}, {3.7609324644993386`*^9, 3.760932476353635*^9}, 
   3.760948494764584*^9, {3.760954822229915*^9, 3.760954828183131*^9}, {
   3.760957174116322*^9, 3.7609571745322294`*^9}, {3.760957895235751*^9, 
   3.760957921379594*^9}, {3.7609651595617104`*^9, 3.7609651654958453`*^9}, {
   3.7613977902309713`*^9, 3.7613977942121305`*^9}, {3.7614005950165224`*^9, 
   3.761400595718647*^9}, 3.766941086103475*^9, {3.766941253319908*^9, 
   3.766941267420458*^9}, {3.7669413812977057`*^9, 3.7669413828107724`*^9}, {
   3.766991390999523*^9, 3.7669913930191407`*^9}, 3.767012354908183*^9, 
   3.781935806390972*^9, 3.781936033385374*^9, 3.7819360705919476`*^9, 
   3.781936103022912*^9, {3.7819364081089644`*^9, 3.781936410955409*^9}, {
   3.7819367452987604`*^9, 3.7819367622895584`*^9}, {3.7819368721284275`*^9, 
   3.7819368997005873`*^9}, {3.78256209209163*^9, 3.782562093890131*^9}, {
   3.844257799340705*^9, 3.844257813457425*^9}, {3.8553920078497667`*^9, 
   3.855392012814232*^9}, {3.856250191201414*^9, 3.856250232703102*^9}, {
   3.8562520431182947`*^9, 3.856252141381493*^9}, {3.856252203719722*^9, 
   3.856252255915289*^9}, {3.856252300863139*^9, 3.856252305392064*^9}, {
   3.856252352196966*^9, 3.8562523888538857`*^9}, {3.856252446343231*^9, 
   3.8562524895773783`*^9}, {3.8562553818556347`*^9, 3.856255409433647*^9}, {
   3.856256366655346*^9, 3.856256382108848*^9}, {3.856257008256236*^9, 
   3.856257010794084*^9}, {3.856257303136685*^9, 3.856257354834614*^9}, {
   3.856257774714705*^9, 3.8562579213044643`*^9}, {3.856257994277404*^9, 
   3.856258020270615*^9}, {3.856258089739832*^9, 3.856258132265641*^9}, {
   3.8562581913408937`*^9, 3.856258237797119*^9}, {3.856258271983555*^9, 
   3.856258295413122*^9}, {3.856258365182643*^9, 3.8562583752102213`*^9}, {
   3.856258687450672*^9, 3.85625876406513*^9}, {3.856259620096257*^9, 
   3.856259683887211*^9}, 3.8562708470666122`*^9, {3.859021745750124*^9, 
   3.8590217499397583`*^9}, {3.859103445801277*^9, 3.859103491056922*^9}, {
   3.859103596619948*^9, 3.8591035975827913`*^9}, {3.8591036326916313`*^9, 
   3.859103638582407*^9}, {3.859451511333824*^9, 3.859451515423167*^9}, {
   3.859451592850288*^9, 3.85945160401833*^9}, {3.859451850580456*^9, 
   3.859451879730114*^9}, 3.859451950169718*^9, 3.859452522522209*^9, 
   3.86004606069128*^9, {3.86004610376902*^9, 3.8600461477185793`*^9}, {
   3.860046448959958*^9, 3.860046558255125*^9}, 3.860046606719643*^9, {
   3.8600466743704977`*^9, 3.86004668326213*^9}, {3.8600467713400106`*^9, 
   3.860046771813838*^9}, {3.86004708146483*^9, 3.860047094976729*^9}, {
   3.860050046917284*^9, 3.860050144811077*^9}, {3.8600591063930283`*^9, 
   3.860059111141946*^9}, {3.860059144816346*^9, 3.860059154307877*^9}, {
   3.860059189230633*^9, 3.860059198471508*^9}, {3.8600593175543013`*^9, 
   3.860059380249292*^9}, {3.8600594380314627`*^9, 3.860059456766239*^9}, {
   3.860059508947998*^9, 3.860059522156027*^9}, 3.860078446986199*^9, 
   3.860741938210567*^9, {3.860742677818672*^9, 3.860742680045698*^9}, {
   3.860742903361553*^9, 3.860742919820343*^9}, {3.860744409385338*^9, 
   3.8607444399598227`*^9}, 3.8607444720057163`*^9, 3.8629475255316467`*^9, {
   3.8692993412799187`*^9, 3.869299398279628*^9}, {3.869299471886497*^9, 
   3.869299519895006*^9}, {3.870788594259224*^9, 3.8707886433076973`*^9}, {
   3.870789036708892*^9, 3.8707890735065117`*^9}, 3.8707898968360634`*^9, {
   3.8707901752169447`*^9, 3.870790177837435*^9}, {3.8707902417937965`*^9, 
   3.870790243755803*^9}, {3.8853797814032106`*^9, 3.885379795030085*^9}, {
   3.885379850477587*^9, 3.8853798645388393`*^9}, {3.885380274764432*^9, 
   3.885380288147811*^9}, {3.885385903360512*^9, 3.8853859143694797`*^9}, 
   3.8854058777353487`*^9, {3.8854107307240386`*^9, 3.885410784715227*^9}, {
   3.885410893492056*^9, 3.885410913404173*^9}, 3.885412592010369*^9, {
   3.889040014704732*^9, 3.889040075741843*^9}, 3.8929090641901193`*^9, {
   3.8929099110718365`*^9, 3.8929099217503443`*^9}, 3.8994565540217333`*^9, {
   3.899828390408118*^9, 3.899828391532455*^9}, {3.8999209408387446`*^9, 
   3.8999209572591867`*^9}, {3.899921693751095*^9, 3.8999216940746737`*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"cf1db522-56de-4ffb-a04b-a1dd6e966d3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"widthPixels", ",", "heightPixels"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "@", 
      RowBox[{"ImageDimensions", "@", 
       RowBox[{"First", "@", "testImages"}]}]}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"First", ",", "Last"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"swarmBoxes", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"newBox", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}]}]}], "&"}], "/@", "#"}], "&"}], "/@",
     "swarmData"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmBoxCenters", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"boxCenter", "/@", "#"}], "&"}], "/@", "swarmBoxes"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmWindows", "=", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#2", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"ImageTrim", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", "placeholderSW"}], "]"}], 
        "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"testImages", ",", "swarmBoxes"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmWindowCoreMasks", "=", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#2", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"ImageTrim", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", "placeholderSW"}], "]"}], 
        "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"globalSwarmCoreSegments", ",", "swarmBoxes"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmWindowsUnified", "=", 
    RowBox[{"Flatten", "@", "swarmWindows"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"reducedSwarmWindowsUnified", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{
             RowBox[{
              RowBox[{"Image", "[", 
               RowBox[{"#", ",", "Byte"}], "]"}], "&"}], "@", 
             RowBox[{"ImageAdjust", "@", "#"}]}]}], ")"}], "&"}], ",", 
         "\[IndentingNewLine]", "swarmWindowsUnified"}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "swarmWindowsUnified"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmWindowCoreMasksUnified", "=", 
   RowBox[{"Flatten", "@", "swarmWindowCoreMasks"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844327947132184*^9, 3.844327993532775*^9}, {
   3.844328068509672*^9, 3.844328086460628*^9}, {3.844328157287871*^9, 
   3.844328184029101*^9}, {3.84432922069366*^9, 3.844329406395509*^9}, {
   3.844329719343751*^9, 3.844329721361863*^9}, {3.8443299100997*^9, 
   3.84432995293017*^9}, 3.844330314590372*^9, {3.844331801367824*^9, 
   3.844331803574844*^9}, 3.8443318887053432`*^9, {3.844344362002143*^9, 
   3.844344365358268*^9}, {3.8444758321829777`*^9, 3.844475836522172*^9}, {
   3.844476636608193*^9, 3.8444766711707363`*^9}, {3.844476717143077*^9, 
   3.8444767543435793`*^9}, {3.844476793411387*^9, 3.844476847033173*^9}, {
   3.8444771700990868`*^9, 3.844477177245574*^9}, {3.844490174909404*^9, 
   3.844490256357587*^9}, 3.844490286846259*^9, {3.844491932433262*^9, 
   3.844491936317299*^9}, {3.844510329775901*^9, 3.844510341878995*^9}, {
   3.844510792704219*^9, 3.8445108814217663`*^9}, {3.844776207760549*^9, 
   3.8447762267697268`*^9}, {3.844777025792883*^9, 3.8447770424727173`*^9}, {
   3.844950017589574*^9, 3.844950022993186*^9}, 3.8450189935432463`*^9, 
   3.851165446813231*^9, 3.851165492426255*^9, {3.851410453094966*^9, 
   3.851410456504076*^9}, {3.851759417778524*^9, 3.8517594794090776`*^9}, {
   3.851759538881502*^9, 3.8517596926437902`*^9}, {3.8517597493089457`*^9, 
   3.851759754264937*^9}, {3.855255811138956*^9, 3.8552558359551687`*^9}, {
   3.860047956749874*^9, 3.8600479885549583`*^9}, {3.8600500082357397`*^9, 
   3.86005001484288*^9}, 3.860052612167486*^9, 3.86224096726058*^9, {
   3.8622478875722446`*^9, 3.862247912465518*^9}, {3.862521364309702*^9, 
   3.862521404975964*^9}, {3.862523989235916*^9, 3.862524016561905*^9}, {
   3.862524224913505*^9, 3.862524253563901*^9}, {3.862914735192995*^9, 
   3.862914751136565*^9}, {3.8629354379696827`*^9, 3.862935445122716*^9}, {
   3.862947581637824*^9, 3.862947604896407*^9}, {3.8692992579302692`*^9, 
   3.8692993041911077`*^9}, {3.8707885015759945`*^9, 
   3.8707885170346594`*^9}, {3.8853802322111616`*^9, 3.885380293666809*^9}, {
   3.885380430896724*^9, 3.8853805660034432`*^9}, {3.885387449712861*^9, 
   3.885387460658683*^9}, {3.885398163721943*^9, 3.885398165898441*^9}, {
   3.8854058797740135`*^9, 3.8854058812460656`*^9}, 3.8854107419337654`*^9, {
   3.8854108334920025`*^9, 3.885410845307675*^9}, {3.885410908059766*^9, 
   3.885411024701245*^9}, {3.8854119932526007`*^9, 3.885412032819084*^9}, {
   3.8884949891640787`*^9, 3.8884950109707*^9}, {3.88849538041094*^9, 
   3.8884954617212925`*^9}, {3.888678953086662*^9, 3.8886789900139074`*^9}, {
   3.889040072615802*^9, 3.889040073224363*^9}, {3.8890401207278676`*^9, 
   3.8890402270536423`*^9}, {3.8890413407685566`*^9, 3.889041347044804*^9}, {
   3.889118438476203*^9, 3.889118439323839*^9}, {3.8896256399117947`*^9, 
   3.88962564025791*^9}, {3.8900620697322645`*^9, 3.8900621169803305`*^9}, {
   3.8900621649740963`*^9, 3.890062167938925*^9}, {3.890132052153559*^9, 
   3.8901320532692184`*^9}, 3.890391846350341*^9, 3.8903919990837364`*^9, {
   3.890409195062518*^9, 3.890409199901922*^9}, {3.8929091908017025`*^9, 
   3.892909213494076*^9}, 3.892909258888797*^9, 3.8929121043498178`*^9, 
   3.892912727705081*^9, 3.8929129448837557`*^9, 3.8929130194726577`*^9, {
   3.8931533076515946`*^9, 3.893153308881016*^9}, {3.893264052679895*^9, 
   3.8932641390476265`*^9}, {3.8932641772154493`*^9, 
   3.8932642213857317`*^9}, {3.8932642814246883`*^9, 3.893264281679952*^9}, {
   3.893264334096637*^9, 3.893264344027729*^9}, {3.8991997172224813`*^9, 
   3.899199726933958*^9}, {3.899201598318099*^9, 3.899201611475009*^9}, {
   3.899201674726512*^9, 3.8992017241187053`*^9}, 3.899385927959689*^9, {
   3.8994053954044456`*^9, 3.8994053980079527`*^9}, {3.8998101016067266`*^9, 
   3.89981014635701*^9}, {3.8998102098313265`*^9, 3.8998102320173626`*^9}, {
   3.899921202991926*^9, 3.8999212034978695`*^9}, {3.900397842307703*^9, 
   3.9003978429386225`*^9}, {3.916315413383194*^9, 
   3.916315425225561*^9}},ExpressionUUID->"fb59b98a-5240-48ac-a458-\
a8baeb98b2b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview SWs ]]", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}},ExpressionUUID->"d2ed447b-66b6-42d2-bb09-\
10fc31081c03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImageCollage", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}], "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"viewImage", "@", 
      RowBox[{"reducedImages", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageAdjust", "/@", 
      RowBox[{"swarmWindows", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.844327947132184*^9, 3.844327993532775*^9}, {
   3.844328068509672*^9, 3.844328086460628*^9}, {3.844328157287871*^9, 
   3.844328184029101*^9}, {3.84432922069366*^9, 3.844329406395509*^9}, {
   3.844329719343751*^9, 3.844329721361863*^9}, {3.8443299100997*^9, 
   3.84432995293017*^9}, 3.844330314590372*^9, {3.844331801367824*^9, 
   3.844331803574844*^9}, 3.8443318887053432`*^9, {3.844344362002143*^9, 
   3.844344365358268*^9}, {3.8444758321829777`*^9, 3.844475836522172*^9}, {
   3.844476636608193*^9, 3.8444766711707363`*^9}, {3.844476717143077*^9, 
   3.8444767543435793`*^9}, {3.844476793411387*^9, 3.844476847033173*^9}, {
   3.8444771700990868`*^9, 3.844477177245574*^9}, {3.844490174909404*^9, 
   3.844490256357587*^9}, 3.844490286846259*^9, {3.844491932433262*^9, 
   3.844491936317299*^9}, {3.844510329775901*^9, 3.844510341878995*^9}, {
   3.844510792704219*^9, 3.8445108814217663`*^9}, {3.844776207760549*^9, 
   3.8447762267697268`*^9}, {3.844777025792883*^9, 3.8447770424727173`*^9}, {
   3.844950017589574*^9, 3.844950022993186*^9}, 3.8450189935432463`*^9, 
   3.851165446813231*^9, 3.851165492426255*^9, {3.851410453094966*^9, 
   3.851410456504076*^9}, {3.851759417778524*^9, 3.8517594794090776`*^9}, {
   3.851759538881502*^9, 3.8517596926437902`*^9}, {3.8517597493089457`*^9, 
   3.851759754264937*^9}, {3.855255811138956*^9, 3.8552558359551687`*^9}, {
   3.860047956749874*^9, 3.8600479885549583`*^9}, {3.8600500082357397`*^9, 
   3.86005001484288*^9}, 3.860052612167486*^9, 3.86224096726058*^9, {
   3.8622478875722446`*^9, 3.862247912465518*^9}, {3.862521364309702*^9, 
   3.862521404975964*^9}, {3.862523989235916*^9, 3.862524016561905*^9}, {
   3.862524224913505*^9, 3.862524253563901*^9}, {3.862914735192995*^9, 
   3.862914751136565*^9}, {3.8629354379696827`*^9, 3.862935445122716*^9}, {
   3.862947581637824*^9, 3.862947604896407*^9}, {3.8692992579302692`*^9, 
   3.8692993041911077`*^9}, {3.8707885015759945`*^9, 
   3.8707885170346594`*^9}, {3.8853802322111616`*^9, 3.885380293666809*^9}, {
   3.885380430896724*^9, 3.8853805660034432`*^9}, {3.885387449712861*^9, 
   3.885387460658683*^9}, {3.885398163721943*^9, 3.885398165898441*^9}, {
   3.8854058797740135`*^9, 3.8854058812460656`*^9}, 3.8854107419337654`*^9, {
   3.8854108334920025`*^9, 3.885410845307675*^9}, {3.885410908059766*^9, 
   3.885411024701245*^9}, {3.8854119932526007`*^9, 3.885412032819084*^9}, {
   3.8884949891640787`*^9, 3.8884950109707*^9}, {3.88849538041094*^9, 
   3.8884954617212925`*^9}, {3.888678953086662*^9, 3.8886789900139074`*^9}, {
   3.889040072615802*^9, 3.889040073224363*^9}, {3.8890401207278676`*^9, 
   3.8890404528454895`*^9}, {3.8890406798949947`*^9, 3.889040680500852*^9}, 
   3.8890413598928075`*^9, {3.8903918532818985`*^9, 3.890391984128643*^9}, {
   3.8903920267083826`*^9, 3.890392030611355*^9}, {3.892912196656477*^9, 
   3.8929122233251457`*^9}, {3.892913512741443*^9, 3.892913517980023*^9}, {
   3.892913549941654*^9, 3.8929135602652707`*^9}, {3.8929137946617317`*^9, 
   3.892913803751068*^9}, 3.8948265159808626`*^9, {3.8991997601443167`*^9, 
   3.899199784693632*^9}, {3.8993749061769*^9, 3.8993749285243683`*^9}, {
   3.8998102929886937`*^9, 3.8998102981807528`*^9}, {3.899828459560221*^9, 
   3.899828519696065*^9}, 3.900326744913706*^9, {3.9003267973486156`*^9, 
   3.900326797584931*^9}, 3.9003978559233775`*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"2d8c8d6d-8088-44fe-8635-687289f56583"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate IW lattices for SWs", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, {3.8854049095906363`*^9, 3.8854049706133485`*^9}, 
   3.889042400618967*^9, {3.8890424578986416`*^9, 3.8890424598186126`*^9}, {
   3.8890436487601223`*^9, 3.8890436504397755`*^9}, {3.8931426661310005`*^9, 
   3.8931426691125093`*^9}},
 FontSize->24,ExpressionUUID->"2eb9755c-0953-470f-8eef-1e8f96cc1e2a"],

Cell[CellGroupData[{

Cell["Generate the IW Lattice", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 
  3.8905085347331257`*^9}},ExpressionUUID->"e6ba94ff-4ab3-4354-b7ef-\
2e4bbf70b147"],

Cell["\<\
Defaults :
   
windowSize=60;
{offsetX,offsetY}={20,20};   
   
histogramRanges={All,All,All};
histogramBinningMethod=\[CloseCurlyDoubleQuote]Scott\[CloseCurlyDoubleQuote];
histogramInterpolationOrder=2;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, 3.8886956066872177`*^9, {
   3.8903800716612153`*^9, 3.890380078358664*^9}, 3.894826466624727*^9, {
   3.8948265492913275`*^9, 3.8948265658429685`*^9}, {3.8948266013930264`*^9, 
   3.8948266032992535`*^9}, {3.899911911607043*^9, 3.8999119162398343`*^9}, 
   3.899912141898555*^9, {3.9100902147352557`*^9, 3.910090217063285*^9}},
 FontSize->16,ExpressionUUID->"7a27d2ae-2e06-4dd7-8679-13a03fd7793c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"windowSize", "=", "60"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"offsetX", ",", "offsetY"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"20", ",", "20"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderBounds", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axesLabelsWindowsHistogram", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<n_x\>\"", ",", "\"\<\\\\rho\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n_y\>\"", ",", "\"\<\\\\rho\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n_x \\cdot n_y\>\"", ",", "\"\<\\\\rho\>\""}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramRanges", "=", 
   RowBox[{"{", 
    RowBox[{"All", ",", "All", ",", "All"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramBinningMethod", "=", "\"\<Scott\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramInterpolationOrder", "=", "2"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8901982132575226`*^9, 3.8901982412177467`*^9}, {
   3.890198438254984*^9, 3.8901984785653296`*^9}, {3.89020011741765*^9, 
   3.8902001695412455`*^9}, 3.890200218556176*^9, {3.8902003672791376`*^9, 
   3.890200386811405*^9}, {3.890200462388465*^9, 3.890200462641219*^9}, {
   3.890200794468899*^9, 3.890200807042573*^9}, {3.8902030136220255`*^9, 
   3.8902030204194756`*^9}, {3.890207269925324*^9, 3.890207286325079*^9}, {
   3.8902075488712687`*^9, 3.890207578277294*^9}, {3.8904082351520047`*^9, 
   3.8904083109435806`*^9}, 3.8904083937598867`*^9, {3.890408627584133*^9, 
   3.8904086278069224`*^9}, 3.890408658993986*^9, {3.890409115831479*^9, 
   3.8904091165199275`*^9}, {3.8908339413518925`*^9, 3.8908339481517506`*^9}, 
   3.892922539238779*^9, {3.8948265557533836`*^9, 3.89482655698593*^9}, {
   3.8948265940709047`*^9, 3.8948265970588927`*^9}, {3.899405408500008*^9, 
   3.899405409563958*^9}, {3.8994943231094065`*^9, 3.8994943245690575`*^9}, {
   3.8999119035795155`*^9, 3.8999119149110074`*^9}, {3.8999121305292397`*^9, 
   3.899912134038105*^9}, {3.899913535086313*^9, 3.8999135354133863`*^9}, {
   3.9001603913973227`*^9, 3.9001603925236893`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[193]:=",ExpressionUUID->"37b1a085-5d0d-47d9-a0ba-6b0867a3e667"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"backgroundBias", "=", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"scanStepsX", ",", "scanStepsY"}], "}"}], "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getScanSteps", "[", 
        RowBox[{"swarmWindowsUnified", ",", "#1", ",", "#2"}], "]"}], "&"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"offsetX", ",", "offsetY"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"First", ",", "Last"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"windowBounds", "=", 
    RowBox[{
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"k", "*", " ", "offsetY"}]}], ",", 
               RowBox[{"windowSize", "+", 
                RowBox[{"k", "*", "offsetY"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"m", "*", "offsetX"}]}], ",", 
               RowBox[{"windowSize", "+", 
                RowBox[{"m", "*", "offsetX"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", "#1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", "#2"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"scanStepsY", ",", "scanStepsX"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "/.", 
     RowBox[{
      RowBox[{"{", "}"}], "\[Rule]", 
      RowBox[{"{", "placeholderBounds", "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"windowLocations", "=", 
       RowBox[{
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"monitorCounter", "++"}], ";", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Mean", "/@", "#"}], ")"}], "&"}], "/@", "#"}]}], 
            ")"}], "&"}], ",", "windowBounds"}], "\[IndentingNewLine]", "]"}],
         "//", "N"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "windowBounds"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"trueWindowLocations", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{
           RowBox[{
            RowBox[{"truePosition", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"swarmWindowsUnified", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "&"}], "/@", 
           RowBox[{"windowLocations", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "swarmWindowsUnified"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "swarmWindowsUnified"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scanWindowStats", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#1", ",", "#2", ",", 
       RowBox[{"#1", "*", "#2"}]}], "}"}], "&"}], "@@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"scanStepsX", "+", "1"}], ",", 
      RowBox[{"scanStepsY", "+", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\"\<IW count: \>\"", "<>", 
    RowBox[{"ToString", "@", 
     RowBox[{"Total", "@", 
      RowBox[{"Last", "@", "scanWindowStats"}]}]}]}], "//", "Print"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"plotInterrogationWindowStats", "=", 
   RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"getSmoothStatsHistogram", "[", 
         RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "scanWindowStats", ",", "axesLabelsWindowsHistogram", ",", 
         "histogramRanges"}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotInterrogationWindowStats", ",", "\"\<Interrogation Window Stats\>\"", 
    ",", "250"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890867003474216`*^9, 3.889086714224699*^9}, {
   3.889087776415456*^9, 3.8890878082379704`*^9}, {3.8891090952055936`*^9, 
   3.889109098955806*^9}, {3.8892497844957514`*^9, 3.8892497894366226`*^9}, {
   3.889272305744315*^9, 3.8892723253753605`*^9}, {3.889293278611692*^9, 
   3.889293279214778*^9}, {3.8896256341219163`*^9, 3.8896256349053802`*^9}, 
   3.889626344487015*^9, 3.8903925118255124`*^9, {3.8903926808270826`*^9, 
   3.8903927268984566`*^9}, 3.89040818077588*^9, {3.890409028311659*^9, 
   3.8904090313183784`*^9}, {3.8904090691531477`*^9, 3.890409071654849*^9}, {
   3.8904091256870127`*^9, 3.890409130350337*^9}, {3.890409392865803*^9, 
   3.8904094306651487`*^9}, {3.8904096840773077`*^9, 3.8904096885099277`*^9}, 
   3.8929154448367367`*^9, {3.8929157924534273`*^9, 3.892915809026864*^9}, {
   3.8929162158293104`*^9, 3.892916217962659*^9}, 3.892916269190138*^9, {
   3.8929582345268726`*^9, 3.892958234832056*^9}, {3.8931431256986065`*^9, 
   3.893143137056078*^9}, {3.8931533508998966`*^9, 3.8931533931636477`*^9}, {
   3.89315344006701*^9, 3.8931535469886427`*^9}, {3.893439734035904*^9, 
   3.893439763692526*^9}, 3.8998288281005754`*^9, 3.89991175148934*^9, 
   3.8999210018212137`*^9, {3.910090526799746*^9, 3.9100905277444425`*^9}, 
   3.910263879080783*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"7299f3a6-ae53-4562-8d3f-17cb4fc896d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clear Unneeded Data from Memory", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085456415696`*^9}, {3.8929183936404963`*^9, 
  3.8929184140097203`*^9}},ExpressionUUID->"51eb650a-04a7-448c-becf-\
8ded4bb2e375"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "images", ",", "testImages", ",", "reducedImages", ",", "previewImages", 
      ",", "\[IndentingNewLine]", "swarmWindows", ",", "swarmWindowCoreMasks",
       ",", "swarmBoxes", ",", "swarmBoxCenters", ",", "\[IndentingNewLine]", 
      "scanStepsX", ",", "scanStepsY", ",", "windowLocations", ",", 
      "scanWindowStats", ",", "\[IndentingNewLine]", 
      "plotInterrogationWindowStats", ",", "imagesCorrected"}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, {
   3.8964388163994665`*^9, 3.8964388236567764`*^9}, {3.899199931724986*^9, 
   3.89919993378083*^9}, {3.8997104199283957`*^9, 3.899710420538272*^9}, {
   3.9002672079401007`*^9, 3.9002672084078474`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"d80a5dba-309c-4abb-8a11-dd2fa82d9745"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize IW Processing Parameters", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.893142317079878*^9}, {
  3.900090711353264*^9, 3.9000907134016094`*^9}},
 FontSize->24,ExpressionUUID->"fd50a93f-856c-46a9-92c1-3f8f2622bf93"],

Cell[CellGroupData[{

Cell["Initialize Parameters", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085347331257`*^9}, {3.899493321458995*^9, 
  3.899493328786914*^9}, {3.8994936005813937`*^9, 3.899493615657549*^9}, {
  3.9000907022820663`*^9, 
  3.9000907083944397`*^9}},ExpressionUUID->"de9ebaef-de39-499f-8788-\
dbdbfbdc5e42"],

Cell["\<\
Defaults :
   
nonlocalCorrectionWeight=1.5;
nonlocalCorrectionRadius=1;
luminanceCompression=0.65;
nonlocalNoiseFactor=0.5;
nonlocalFilterRadius=2;
nonlocalFilterReach=10;
meanFilterRadius=2;
adaptiveThresholdRadius=10;
intensityThresholdWindows=0.25;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, {3.8994938548099174`*^9, 
   3.89949385659409*^9}, 3.9001604345809636`*^9},
 FontSize->16,ExpressionUUID->"3ec1c225-40bc-43a4-9b0d-2e3fd6f6bbea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonlocalCorrectionWeight", "=", "1.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalCorrectionRadius", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.65"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalNoiseFactor", "=", "0.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalFilterRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalFilterReach", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"meanFilterRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"adaptiveThresholdRadius", "=", "10"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensityThresholdWindows", "=", "0.25"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8152928701385374`*^9, 3.8152929095154223`*^9}, {
   3.815293203100834*^9, 3.8152932044252834`*^9}, {3.8152985915999465`*^9, 
   3.815298592711982*^9}, {3.8152991651625996`*^9, 3.815299165246368*^9}, 
   3.8153004254453*^9, 3.8153009423101015`*^9, 3.815301467391207*^9, {
   3.8153024734657407`*^9, 3.815302473527557*^9}, 3.8153058689692507`*^9, 
   3.8153061799079037`*^9, 3.815306979816579*^9, {3.8153198102442603`*^9, 
   3.815319820259759*^9}, {3.815320423702215*^9, 3.815320430021192*^9}, {
   3.8161004329154563`*^9, 3.816100447325368*^9}, {3.816193512329442*^9, 
   3.8161935221296062`*^9}, {3.8161936372647877`*^9, 
   3.8161936650790825`*^9}, {3.816193746912405*^9, 3.816193759839574*^9}, {
   3.8161965226458163`*^9, 3.8161965302297077`*^9}, {3.8333446031900454`*^9, 
   3.833344622515641*^9}, {3.8333477657667913`*^9, 3.8333478038209476`*^9}, {
   3.8333478388130074`*^9, 3.833347841543011*^9}, 3.833461104908938*^9, {
   3.8334675243859324`*^9, 3.8334675287574058`*^9}, {3.8334677176114845`*^9, 
   3.8334677247410355`*^9}, 3.8887782593496017`*^9, {3.8891092731240644`*^9, 
   3.8891092742837543`*^9}, {3.8891096002436085`*^9, 3.88910962432487*^9}, {
   3.8891096837955675`*^9, 3.889109695820222*^9}, {3.8891149515307293`*^9, 
   3.8891149828096275`*^9}, 3.889276380440755*^9, {3.889276684704445*^9, 
   3.889276688360054*^9}, {3.8892823751511817`*^9, 3.8892823752704334`*^9}, 
   3.88928648288863*^9, {3.890204865106165*^9, 3.8902048652134542`*^9}, {
   3.89314024976995*^9, 3.893140260170452*^9}, {3.893140580522293*^9, 
   3.8931405806948347`*^9}, 3.899493648719296*^9, {3.8994937479100266`*^9, 
   3.899493749378961*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"ce6c91c0-6267-4620-83b5-032efc520b6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SW Processing Test Module Definition", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085347331257`*^9}, {3.899493321458995*^9, 
  3.899493328786914*^9}, {3.8994936005813937`*^9, 
  3.899493615657549*^9}},ExpressionUUID->"cc2a5f39-5c04-4a05-a29d-\
dcce48b7ba5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testingModuleSWprocessing", "[", 
    RowBox[{"testID_", ",", "negationSwitch_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputID", "=", "testID"}], ",", 
       RowBox[{"negationIndex", "=", "negationSwitch"}], ",", "testSW", ",", 
       "\[IndentingNewLine]", "backgroundBias", ",", "testIWs", ",", 
       "testFilteredIWs", ",", "testIWmasks", ",", "\[IndentingNewLine]", 
       "cleanStage0", ",", "cleanStage1", ",", "cleanStage2", ",", 
       "testIWmasksClean", ",", "testSWmask", ",", "testSWmaskClean", ",", 
       "\[IndentingNewLine]", "globalCleanStage1", ",", "globalCleanStage2", 
       ",", "globalCleanStage3", ",", "testBlackWindowCanvas", ",", 
       "\[IndentingNewLine]", "globalSWmaskFinal"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testSW", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Nest", "[", 
          RowBox[{"ColorNegate", ",", "#", ",", "negationIndex"}], "]"}], 
         "&"}], "@", 
        RowBox[{"swarmWindowsUnified", "[", 
         RowBox[{"[", "inputID", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"backgroundBias", "=", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testIWs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
          RowBox[{"testSW", ",", 
           RowBox[{"First", "@", "#"}], ",", 
           RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
        "/@", 
        RowBox[{"windowBounds", "[", 
         RowBox[{"[", "inputID", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"testFilteredIWs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"filteredRegion", "@", "#"}], "&"}], "/@", "testIWs"}], "//",
         "Parallelize"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testIWmasks", "=", 
       RowBox[{
        RowBox[{"localSegmentation", "/@", "testFilteredIWs"}], "//", 
        "Parallelize"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cleanStage0", "=", 
       RowBox[{"Parallelize", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ImageMultiply", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ImageAdd", "[", 
                RowBox[{"#", ",", "backgroundBias"}], "]"}], "&"}], "/@", 
              "testFilteredIWs"}], "//", "Parallelize"}], ",", 
            "\[IndentingNewLine]", "testIWmasks"}], "\[IndentingNewLine]", 
           "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cleanStage1", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}],
                "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], ",", 
         "cleanStage0"}], "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", 
      RowBox[{"cleanStage2", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", ">", "intensityThresholdWindows"}], "&"}], "/@", 
            RowBox[{"cleanStage1", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], ",", "False"}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"Length", "@", "cleanStage1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testIWmasksClean", "=", "\[IndentingNewLine]", 
       RowBox[{"Parallelize", "@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getBlackWindow", "@@", 
               RowBox[{"ImageDimensions", "@", "#1"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", "#"}], "\[Equal]", "0"}], ",", 
                  "\[IndentingNewLine]", "0", ",", 
                  RowBox[{"Image", "@", 
                   RowBox[{"Total", "@", "#"}]}]}], "\[IndentingNewLine]", 
                 "]"}], "&"}], "@", 
               RowBox[{"(", 
                RowBox[{"Last", "/@", 
                 RowBox[{"Delete", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "@", 
                    "#1"}], ",", "#2"}], "\[IndentingNewLine]", "]"}]}], 
                ")"}]}]}], "\[IndentingNewLine]", "]"}], ")"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"testIWmasks", ",", "cleanStage2"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"testSWmask", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], "@", 
        RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"getBlackWindow", "@@", 
           RowBox[{"ImageDimensions", "@", 
            RowBox[{"swarmWindowCoreMasksUnified", "[", 
             RowBox[{"[", "inputID", "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "0.5"}], "}"}], "&"}], "/@", 
           "testIWmasksClean"}], ",", "\[IndentingNewLine]", 
          RowBox[{"trueWindowLocations", "[", 
           RowBox[{"[", "inputID", "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testSWmaskClean", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"getCleanSwarmWindowMaskAlternative", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@", 
        RowBox[{"{", 
         RowBox[{"testSWmask", ",", 
          RowBox[{"swarmWindowCoreMasksUnified", "[", 
           RowBox[{"[", "inputID", "]"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"globalCleanStage1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
            RowBox[{"Last", "/@", 
             RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}], 
                "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
          RowBox[{"getCheckMask", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{"swarmWindowCoreMasksUnified", "[", 
             RowBox[{"[", "inputID", "]"}], "]"}], ",", "testSWmaskClean"}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
        RowBox[{"ImageAdjust", "@", 
         RowBox[{"preprocessImage", "@", 
          RowBox[{"ColorNegate", "@", "testSW"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"globalCleanStage2", "=", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", ">", 
            RowBox[{
             RowBox[{"Mean", "@", "globalCleanStage1"}], "*", 
             RowBox[{"intensityThresholdGlobal", "[", 
              RowBox[{"[", 
               RowBox[{"negationIndex", "+", "1"}], "]"}], "]"}]}]}], "&"}], "/@",
           "globalCleanStage1"}], ",", "\[IndentingNewLine]", "False"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"globalCleanStage3", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "@", 
        RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ColorNegate", "@", 
           RowBox[{"swarmWindowCoreMasksUnified", "[", 
            RowBox[{"[", "inputID", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FillingTransform", "@", "testSWmaskClean"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"testBlackWindowCanvas", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
        RowBox[{"swarmWindowCoreMasksUnified", "[", 
         RowBox[{"[", "inputID", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\n", 
      RowBox[{"globalSWmaskFinal", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"ColorNegate", "@", 
              RowBox[{"DeleteSmallComponents", "@", 
               RowBox[{"Binarize", "@", 
                RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
                 RowBox[{"#", ",", 
                  RowBox[{"swarmWindowCoreMasksUnified", "[", 
                   RowBox[{"[", "inputID", "]"}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}]}]}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "@", "#"}]}], "==", "\"\<SparseArray\>\""}], 
            ",", 
            RowBox[{"Image", "@", "#"}], ",", "placeholderSW"}], "]"}]}], 
         "&"}], "@", 
        RowBox[{"Total", "[", "\[IndentingNewLine]", 
         RowBox[{"Last", "/@", 
          RowBox[{"Delete", "[", 
           RowBox[{"globalCleanStage3", ",", "globalCleanStage2"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Image", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
               RowBox[{"#", ",", 
                RowBox[{"swarmWindowCoreMasksUnified", "[", 
                 RowBox[{"[", "inputID", "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "&"}], "@", 
             RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Nest", "[", 
                  RowBox[{"ColorNegate", ",", "#", ",", "negationIndex"}], 
                  "]"}], "&"}], "@", "testSW"}], ",", "\[IndentingNewLine]", 
               "testSWmask", ",", "White", ",", "1"}], "\[IndentingNewLine]", 
              "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"previewTrueParticleMask", "[", "\[IndentingNewLine]", 
             RowBox[{
             "testSWmaskClean", ",", "testSWmask", ",", "\[IndentingNewLine]", 
              RowBox[{"swarmWindowCoreMasksUnified", "[", 
               RowBox[{"[", "inputID", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Nest", "[", 
                 RowBox[{"ColorNegate", ",", "#", ",", "negationIndex"}], 
                 "]"}], "&"}], "@", "testSW"}]}], "\[IndentingNewLine]", 
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"previewTrueParticleMask", "[", "\[IndentingNewLine]", 
             RowBox[{
             "globalSWmaskFinal", ",", "testSWmaskClean", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"swarmWindowCoreMasksUnified", "[", 
               RowBox[{"[", "inputID", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Nest", "[", 
                 RowBox[{"ColorNegate", ",", "#", ",", "negationIndex"}], 
                 "]"}], "&"}], "@", "testSW"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
         RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", "]"}],
        "//", "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "globalSWmaskFinal"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testBacteriaSegmentFilter", "[", 
    RowBox[{"mask_", ",", "criticalFactor_"}], "]"}], ":=", 
   RowBox[{"Last", "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
       RowBox[{"mask", ",", "\"\<Centroid\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#CaliperWidth", "/", "#EquivalentDiskRadius"}], ")"}], 
            "^", "powerHullShape"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"#ConvexArea", "^", "powerHullSize"}], "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "#Elongation"}], ")"}], "^", 
              "powerAspectRatio"}]}], "/", 
            RowBox[{"#Circularity", "^", "powerCircularity"}]}]}], "<", 
          "criticalFactor"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], 
       "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", ")"}]}]}],
   "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testBacteriaSegmentSelector", "[", 
   RowBox[{"mask_", ",", "criticalFactor_"}], "]"}], ":=", 
  RowBox[{"SelectComponents", "[", "\[IndentingNewLine]", 
   RowBox[{"mask", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#CaliperWidth", "/", "#EquivalentDiskRadius"}], ")"}], "^", 
        "powerHullShape"}], "*", 
       RowBox[{
        RowBox[{
         RowBox[{"#ConvexArea", "^", "powerHullSize"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "#Elongation"}], ")"}], "^", 
          "powerAspectRatio"}]}], "/", 
        RowBox[{"#Circularity", "^", "powerCircularity"}]}]}], "<", 
      "criticalFactor"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CornerNeighbors", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.899494350715086*^9, 3.899494351867289*^9}, {
   3.8996363791875515`*^9, 3.8996363814924407`*^9}, 3.899637249883071*^9, {
   3.899637306387048*^9, 3.899637309890731*^9}, {3.89963757670772*^9, 
   3.899637577394935*^9}, {3.8996376236791134`*^9, 3.8996376254115624`*^9}, {
   3.899638075250373*^9, 3.899638075425897*^9}, {3.899638204754442*^9, 
   3.899638215249362*^9}, {3.8996388163386374`*^9, 3.8996388178515396`*^9}, {
   3.899639055595168*^9, 3.899639056193556*^9}, {3.8996392348525867`*^9, 
   3.8996392350819187`*^9}, {3.899642226721989*^9, 3.8996422444821463`*^9}, {
   3.899648520990533*^9, 3.89964852644536*^9}, {3.8996496792878466`*^9, 
   3.8996496817029285`*^9}, {3.8997097343377695`*^9, 3.8997097487532797`*^9}, 
   3.8999181186167297`*^9},
 CellLabel->
  "In[224]:=",ExpressionUUID->"75598def-fb35-45ba-bde3-97e95d1ff0ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ SW Processing Tests ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085347331257`*^9}, {3.899493321458995*^9, 
  3.899493328786914*^9}, {3.899493624577567*^9, 
  3.8994936295155125`*^9}},ExpressionUUID->"845d2580-6ff6-444e-9cb4-\
f1dfabaa3f50"],

Cell["\<\
Defaults :

nonlocalCorrectionWeight=1.5;
nonlocalCorrectionRadius=1;
luminanceCompression=0.65;
nonlocalNoiseFactor=0.5;
nonlocalFilterRadius=2;
nonlocalFilterReach=10;
meanFilterRadius=2;
adaptiveThresholdRadius=10;

intensityThresholdWindows=0.25;

minimumArea=25;
openingRadius=1;

intensityThresholdGlobal={0.95,0.93};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, {3.8994635369885664`*^9, 
   3.8994635410540743`*^9}, {3.8994680642651815`*^9, 3.899468124697826*^9}, {
   3.8994856886448145`*^9, 3.8994857433334675`*^9}, 3.8994937685625105`*^9, {
   3.899493813803657*^9, 3.899493817225876*^9}, {3.899494397408998*^9, 
   3.899494398808589*^9}, 3.899495101661936*^9, 3.899647314079805*^9, 
   3.899649087861864*^9, 3.899709761823976*^9, 3.910267358916534*^9},
 FontSize->16,ExpressionUUID->"d62049fd-a1f0-4604-aa3e-a9070563b322"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonlocalCorrectionWeight", "=", "1.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalCorrectionRadius", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.65"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalNoiseFactor", "=", "0.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalFilterRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalFilterReach", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"meanFilterRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"adaptiveThresholdRadius", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"intensityThresholdWindows", "=", "0.25"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minimumArea", "=", "25"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"openingRadius", "=", "1"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intensityThresholdGlobal", "=", 
   RowBox[{"{", 
    RowBox[{"0.95", ",", "0.93"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8994502147394*^9, 3.8994502271591563`*^9}, {
   3.8994535386802483`*^9, 3.8994535448856735`*^9}, {3.899453575015906*^9, 
   3.899453756969485*^9}, {3.899453818082502*^9, 3.899453846792325*^9}, {
   3.8994553705132117`*^9, 3.899455370672812*^9}, {3.89945555021523*^9, 
   3.8994555725582438`*^9}, {3.8994556067067204`*^9, 3.8994556882301865`*^9}, 
   3.899455719331024*^9, {3.8994557625984488`*^9, 3.8994558335029488`*^9}, {
   3.8994558732310443`*^9, 3.8994558751260004`*^9}, {3.899455936041691*^9, 
   3.8994559366769743`*^9}, {3.899456425490161*^9, 3.89945643323781*^9}, {
   3.8994566874080696`*^9, 3.8994566893668547`*^9}, {3.8994610243755245`*^9, 
   3.8994610330724845`*^9}, {3.8994634626781025`*^9, 3.899463493516733*^9}, {
   3.899463532485509*^9, 3.899463558549762*^9}, 3.8994639004599667`*^9, {
   3.899463936029253*^9, 3.8994639388942184`*^9}, {3.8994639785956736`*^9, 
   3.899464023844617*^9}, {3.89946405449949*^9, 3.8994642015371494`*^9}, {
   3.899464312871584*^9, 3.899464328885775*^9}, {3.899464369218334*^9, 
   3.8994645004226117`*^9}, {3.899464531620302*^9, 3.899464544157982*^9}, 
   3.899465969653557*^9, 3.8994668878358383`*^9, {3.8994669498459387`*^9, 
   3.899466975052449*^9}, 3.899467005187866*^9, {3.899467035227932*^9, 
   3.8994672029065747`*^9}, {3.8994674202594757`*^9, 3.899467441333315*^9}, {
   3.89946748073884*^9, 3.8994675388431664`*^9}, 3.8994675730532866`*^9, {
   3.8994676961939945`*^9, 3.8994677221341124`*^9}, {3.8994677709646344`*^9, 
   3.8994678016442842`*^9}, 3.8994678723631096`*^9, {3.8994679059156327`*^9, 
   3.899467927318285*^9}, 3.899471779619058*^9, {3.899474212156314*^9, 
   3.899474212259863*^9}, {3.899474255954708*^9, 3.8994742848455*^9}, {
   3.8994831365258493`*^9, 3.899483149669479*^9}, 3.899483257800079*^9, {
   3.8994833069374924`*^9, 3.8994833498783054`*^9}, {3.899483740989992*^9, 
   3.899483742012686*^9}, {3.899484000658782*^9, 3.8994841100070543`*^9}, {
   3.8994842706403923`*^9, 3.8994842937347956`*^9}, {3.8994843574893255`*^9, 
   3.899484359692665*^9}, {3.8994844644615164`*^9, 3.8994844660861907`*^9}, 
   3.8994845388239913`*^9, 3.899484931390332*^9, {3.8994854011331587`*^9, 
   3.8994854300851564`*^9}, 3.899485467206096*^9, {3.899485500126648*^9, 
   3.89948551137346*^9}, 3.899485594279964*^9, 3.899485750262042*^9, {
   3.899486290702064*^9, 3.8994862919746237`*^9}, {3.899486535143131*^9, 
   3.899486536527302*^9}, {3.8994866073007245`*^9, 3.899486608516177*^9}, {
   3.8994905598599806`*^9, 3.8994906351636205`*^9}, {3.8994906727080264`*^9, 
   3.899490695508842*^9}, {3.899490817902087*^9, 3.8994908193940306`*^9}, {
   3.899490912835332*^9, 3.899490934090223*^9}, {3.8994909736685295`*^9, 
   3.8994910046133404`*^9}, {3.899491106966017*^9, 3.899491129018306*^9}, {
   3.89949147945973*^9, 3.899491536467407*^9}, {3.899491681269125*^9, 
   3.899491688059015*^9}, {3.8996364606497917`*^9, 3.899636481872959*^9}, {
   3.8996365788816814`*^9, 3.899636608762105*^9}, {3.8996368955325427`*^9, 
   3.8996369260259137`*^9}, {3.8996369669056826`*^9, 3.8996370203367677`*^9}, 
   3.8996371216889267`*^9, {3.8996371528985186`*^9, 3.8996371538341084`*^9}, 
   3.899637339217759*^9, {3.8996376850738497`*^9, 3.8996377050256147`*^9}, {
   3.8996377451333036`*^9, 3.899637745185107*^9}, {3.8996380231210794`*^9, 
   3.8996380256802907`*^9}, {3.8996473047430496`*^9, 3.8996473059014616`*^9}, 
   3.8996484127191176`*^9, 3.8996495045983596`*^9, {3.8996495528451633`*^9, 
   3.899649554125063*^9}, 3.8997096762905765`*^9, 3.899709768200657*^9, 
   3.910264376967739*^9, {3.9102644735655546`*^9, 3.910264478258213*^9}, {
   3.9102659900479527`*^9, 3.910265991221959*^9}, {3.910266455013502*^9, 
   3.9102664772682667`*^9}, {3.91026655038116*^9, 3.9102666325655823`*^9}, 
   3.9102666720291653`*^9, {3.91026694571731*^9, 3.910266946900138*^9}, {
   3.91026705702991*^9, 3.9102671093727164`*^9}, {3.9102671995016613`*^9, 
   3.910267200076309*^9}, 3.9102672725331697`*^9, {3.9102673138571997`*^9, 
   3.910267314491798*^9}, {3.910527497526984*^9, 3.910527500290326*^9}, {
   3.910527540244344*^9, 3.9105275493736787`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"ea7efe56-c01f-4356-82c5-9437ce3e3cd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testLevelsetColors", "=", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "White"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testBacteriaLevelsets", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"testingModuleSWprocessing", "[", 
       RowBox[{"testID", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8994502147394*^9, 3.8994502271591563`*^9}, {
   3.8994535386802483`*^9, 3.8994535448856735`*^9}, {3.899453575015906*^9, 
   3.899453756969485*^9}, {3.899453818082502*^9, 3.899453846792325*^9}, {
   3.8994553705132117`*^9, 3.899455370672812*^9}, {3.89945555021523*^9, 
   3.8994555725582438`*^9}, {3.8994556067067204`*^9, 3.8994556882301865`*^9}, 
   3.899455719331024*^9, {3.8994557625984488`*^9, 3.8994558335029488`*^9}, {
   3.8994558732310443`*^9, 3.8994558751260004`*^9}, {3.899455936041691*^9, 
   3.8994559366769743`*^9}, {3.899456425490161*^9, 3.89945643323781*^9}, {
   3.8994566874080696`*^9, 3.8994566893668547`*^9}, {3.8994610243755245`*^9, 
   3.8994610330724845`*^9}, {3.8994634626781025`*^9, 3.899463493516733*^9}, {
   3.899463532485509*^9, 3.899463558549762*^9}, 3.8994639004599667`*^9, {
   3.899463936029253*^9, 3.8994639388942184`*^9}, {3.8994639785956736`*^9, 
   3.899464023844617*^9}, {3.89946405449949*^9, 3.8994642015371494`*^9}, {
   3.899464312871584*^9, 3.899464328885775*^9}, {3.899464369218334*^9, 
   3.8994645004226117`*^9}, {3.899464531620302*^9, 3.899464544157982*^9}, 
   3.899465969653557*^9, 3.8994668878358383`*^9, {3.8994669498459387`*^9, 
   3.899466975052449*^9}, 3.899467005187866*^9, {3.899467035227932*^9, 
   3.8994672029065747`*^9}, {3.8994674202594757`*^9, 3.899467441333315*^9}, {
   3.89946748073884*^9, 3.8994675388431664`*^9}, 3.8994675730532866`*^9, {
   3.8994676961939945`*^9, 3.8994677221341124`*^9}, {3.8994677709646344`*^9, 
   3.8994678016442842`*^9}, 3.8994678723631096`*^9, {3.8994679059156327`*^9, 
   3.899467927318285*^9}, 3.899471779619058*^9, {3.899474212156314*^9, 
   3.899474212259863*^9}, {3.899474255954708*^9, 3.8994742848455*^9}, {
   3.8994831365258493`*^9, 3.899483149669479*^9}, 3.899483257800079*^9, {
   3.8994833069374924`*^9, 3.8994833498783054`*^9}, {3.899483740989992*^9, 
   3.899483742012686*^9}, {3.899484000658782*^9, 3.8994841100070543`*^9}, {
   3.8994842706403923`*^9, 3.8994842937347956`*^9}, {3.8994843574893255`*^9, 
   3.899484359692665*^9}, {3.8994844644615164`*^9, 3.8994844660861907`*^9}, 
   3.8994845388239913`*^9, 3.899484931390332*^9, {3.8994854011331587`*^9, 
   3.8994854300851564`*^9}, 3.899485467206096*^9, {3.899485500126648*^9, 
   3.89948551137346*^9}, 3.899485594279964*^9, {3.899485750262042*^9, 
   3.899485754540161*^9}, 3.8994858125092564`*^9, {3.8994859440782423`*^9, 
   3.899485944332883*^9}, {3.899486032014985*^9, 3.899486033452897*^9}, 
   3.8994865612546473`*^9, {3.8994866225032206`*^9, 3.899486622604329*^9}, 
   3.8994869858967977`*^9, {3.8994887044141726`*^9, 3.899488707045272*^9}, {
   3.899490655116678*^9, 3.8994906551735396`*^9}, 3.8994909549492836`*^9, {
   3.8994909887891283`*^9, 3.899490988856161*^9}, 3.8994910221774654`*^9, {
   3.8994912843480277`*^9, 3.8994912844992714`*^9}, {3.899491356596981*^9, 
   3.8994913585389442`*^9}, {3.8994914322298946`*^9, 3.89949143302686*^9}, 
   3.899491628254121*^9, {3.899491702682017*^9, 3.8994917027510643`*^9}, {
   3.899491747993862*^9, 3.8994917481225824`*^9}, 3.899494137549036*^9, {
   3.8994944469392304`*^9, 3.8994944472904124`*^9}, {3.8994950238686886`*^9, 
   3.899495024188393*^9}, {3.899541022781294*^9, 3.8995410228502913`*^9}, {
   3.8996363266979666`*^9, 3.8996363282009525`*^9}, {3.899636531738612*^9, 
   3.899636531873252*^9}, 3.899636632882554*^9, {3.899636754357052*^9, 
   3.89963675925815*^9}, {3.899636835041819*^9, 3.8996368366753592`*^9}, {
   3.8996369525310884`*^9, 3.899636952689724*^9}, {3.899637063035556*^9, 
   3.8996370631134596`*^9}, {3.899637201689995*^9, 3.899637201832614*^9}, {
   3.899637368149393*^9, 3.899637369729168*^9}, {3.8996374390189867`*^9, 
   3.8996374603848486`*^9}, {3.899637493386033*^9, 3.8996374937291684`*^9}, {
   3.899637668483549*^9, 3.89963766864013*^9}, {3.8996377844910474`*^9, 
   3.899637784817127*^9}, 3.8996378567128696`*^9, {3.899638106251833*^9, 
   3.899638107505443*^9}, {3.8996381376638346`*^9, 3.899638137753597*^9}, {
   3.8996382728815465`*^9, 3.8996382771771193`*^9}, {3.899638379687997*^9, 
   3.899638383419964*^9}, {3.899638464882185*^9, 3.8996384651853805`*^9}, 
   3.899638632235662*^9, {3.899638709770378*^9, 3.899638710041703*^9}, 
   3.8996387505861793`*^9, {3.899638784833642*^9, 3.8996387850091724`*^9}, 
   3.8996392212757835`*^9, 3.8996393494330063`*^9, {3.899639393231965*^9, 
   3.899639393489195*^9}, 3.899641538657403*^9, {3.8996415733045654`*^9, 
   3.899641574775339*^9}, {3.8996416795758786`*^9, 3.8996416950872526`*^9}, {
   3.89964175630562*^9, 3.8996417566168003`*^9}, {3.899641841248931*^9, 
   3.899641841415557*^9}, {3.8996418763136525`*^9, 3.8996418775284986`*^9}, {
   3.899641936353006*^9, 3.8996419364637547`*^9}, {3.8996419731124096`*^9, 
   3.899641973599588*^9}, {3.8996421230171843`*^9, 3.8996421231299067`*^9}, 
   3.899642355185711*^9, 3.8996423926327734`*^9, 3.899642458633378*^9, {
   3.8996424898012857`*^9, 3.899642489897394*^9}, {3.8996425625201225`*^9, 
   3.8996425625690727`*^9}, {3.8996426114970317`*^9, 3.899642611631614*^9}, {
   3.8996456016321244`*^9, 3.8996456027184453`*^9}, {3.899645653791926*^9, 
   3.8996456549741497`*^9}, {3.8996457513443823`*^9, 3.899645753406244*^9}, {
   3.899645976144395*^9, 3.8996459765021677`*^9}, 3.899646038352186*^9, {
   3.8996460958958397`*^9, 3.899646097798299*^9}, 3.8996485325105762`*^9, 
   3.8996486471665087`*^9, 3.899648777804891*^9, 3.8996489650703473`*^9, {
   3.89964899615716*^9, 3.8996489964385586`*^9}, {3.8996490339339967`*^9, 
   3.899649034021661*^9}, {3.8996490768625107`*^9, 3.8996490769329147`*^9}, {
   3.899649128886261*^9, 3.8996491290368576`*^9}, {3.8996491847656555`*^9, 
   3.899649184861017*^9}, {3.8996492151658216`*^9, 3.8996492152363663`*^9}, {
   3.899649460382077*^9, 3.8996494607480707`*^9}, {3.899649595670949*^9, 
   3.8996495967885914`*^9}, 3.899649686255718*^9, 3.89981056929528*^9, 
   3.8998106469908576`*^9, {3.899829091708696*^9, 3.899829106993251*^9}, {
   3.8999139506862154`*^9, 3.8999139607851105`*^9}, {3.899919215913125*^9, 
   3.8999192308076177`*^9}, {3.899919430217667*^9, 3.899919453528851*^9}, 
   3.8999194968579016`*^9, {3.8999195495326705`*^9, 3.8999195530566216`*^9}, {
   3.899919585226324*^9, 3.899919659792284*^9}, {3.899919696951702*^9, 
   3.8999197202825365`*^9}, {3.8999197505174904`*^9, 
   3.8999197573851976`*^9}, {3.8999201508348455`*^9, 
   3.8999201759938145`*^9}, {3.9102643345803304`*^9, 3.9102643349463277`*^9}, 
   3.910265985189272*^9, {3.9102664201873293`*^9, 3.9102664205130253`*^9}, {
   3.910267180164838*^9, 3.910267180626464*^9}, {3.9102672212101355`*^9, 
   3.9102672367721815`*^9}, 3.9102676827336063`*^9, {3.910268066910181*^9, 
   3.910268067308055*^9}, {3.910268315375312*^9, 3.9102683156771784`*^9}, {
   3.910268721758636*^9, 3.9102687230205383`*^9}, 3.9102687964238667`*^9, {
   3.9102688513032837`*^9, 3.9102688749265003`*^9}, 3.910269006829906*^9, {
   3.9105274211571164`*^9, 3.910527421318997*^9}, 3.9105274677901692`*^9, 
   3.910527642412515*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"7c2e42f0-a649-4f62-ad9f-fbbe96a9fe5e"],

Cell["\<\
Defaults :

powerHullShape=1.75;
powerHullSize=1;
powerAspectRatio=0.2;
powerCircularity=1;
criticalFactorDark=350;
criticalFactorBright=3500;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, {3.8994635369885664`*^9, 
   3.8994635410540743`*^9}, {3.8994680642651815`*^9, 3.899468124697826*^9}, {
   3.8994856886448145`*^9, 3.8994857433334675`*^9}, 3.8994937685625105`*^9, {
   3.899493813803657*^9, 3.899493817225876*^9}, {3.899494397408998*^9, 
   3.899494398808589*^9}, 3.899495101661936*^9, 3.899647314079805*^9, 
   3.899649087861864*^9, 3.899709761823976*^9, 3.910267365366597*^9},
 FontSize->16,ExpressionUUID->"77a753c5-0a66-4814-9030-59af54289881"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"powerHullShape", "=", "1.75"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"powerHullSize", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"powerAspectRatio", "=", "0.2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"powerCircularity", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalFactorDark", "=", "450"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalFactorBright", "=", "3500"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.9102673398852186`*^9, {3.910267386470317*^9, 3.910267406125847*^9}, {
   3.910267737052678*^9, 3.910267883940187*^9}, {3.910267953422122*^9, 
   3.9102679540849257`*^9}, {3.910268009884696*^9, 3.910268035653685*^9}, {
   3.9102683527601643`*^9, 3.9102683664551373`*^9}, 3.910268455838277*^9, 
   3.910268713239118*^9, 3.9104628781560793`*^9},
 CellLabel->
  "In[242]:=",ExpressionUUID->"bf50e466-86c0-4a41-8df5-400de1b7c16d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testEligibleSegments", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"testBacteriaSegmentSelector", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"testBacteriaLevelsets", ",", 
        RowBox[{"{", 
         RowBox[{"criticalFactorDark", ",", "criticalFactorBright"}], "}"}]}],
        "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testEligibleBacteria", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "@", "#"}]}], "\[Equal]", 
         RowBox[{"{", "1.", "}"}]}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Join", "@@", "#"}]}], "]"}], "&"}], "@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"testBacteriaSegmentFilter", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"testBacteriaLevelsets", ",", 
         RowBox[{"{", 
          RowBox[{"criticalFactorDark", ",", "criticalFactorBright"}], 
          "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getBacteriaLevelsetOverlays", "[", 
        RowBox[{"#", ",", "testLevelsetColors"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"testBacteriaLevelsets", ",", "testEligibleSegments"}], 
       "}"}]}], ",", "\[IndentingNewLine]", "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"swarmWindowCoreMasksUnified", "[", 
             RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageMarker", "[", 
             RowBox[{"testEligibleBacteria", ",", "\"\<Arrow\>\""}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "@", 
       RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"swarmWindowsUnified", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageAdd", "@@", "testEligibleSegments"}], ",", 
         "\[IndentingNewLine]", "White", ",", "1"}], "\[IndentingNewLine]", 
        "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8994502147394*^9, 3.8994502271591563`*^9}, {
   3.8994535386802483`*^9, 3.8994535448856735`*^9}, {3.899453575015906*^9, 
   3.899453756969485*^9}, {3.899453818082502*^9, 3.899453846792325*^9}, {
   3.8994553705132117`*^9, 3.899455370672812*^9}, {3.89945555021523*^9, 
   3.8994555725582438`*^9}, {3.8994556067067204`*^9, 3.8994556882301865`*^9}, 
   3.899455719331024*^9, {3.8994557625984488`*^9, 3.8994558335029488`*^9}, {
   3.8994558732310443`*^9, 3.8994558751260004`*^9}, {3.899455936041691*^9, 
   3.8994559366769743`*^9}, {3.899456425490161*^9, 3.89945643323781*^9}, {
   3.8994566874080696`*^9, 3.8994566893668547`*^9}, {3.8994610243755245`*^9, 
   3.8994610330724845`*^9}, {3.8994634626781025`*^9, 3.899463493516733*^9}, {
   3.899463532485509*^9, 3.899463558549762*^9}, 3.8994639004599667`*^9, {
   3.899463936029253*^9, 3.8994639388942184`*^9}, {3.8994639785956736`*^9, 
   3.899464023844617*^9}, {3.89946405449949*^9, 3.8994642015371494`*^9}, {
   3.899464312871584*^9, 3.899464328885775*^9}, {3.899464369218334*^9, 
   3.8994645004226117`*^9}, {3.899464531620302*^9, 3.899464544157982*^9}, 
   3.899465969653557*^9, 3.8994668878358383`*^9, {3.8994669498459387`*^9, 
   3.899466975052449*^9}, 3.899467005187866*^9, {3.899467035227932*^9, 
   3.8994672029065747`*^9}, {3.8994674202594757`*^9, 3.899467441333315*^9}, {
   3.89946748073884*^9, 3.8994675388431664`*^9}, 3.8994675730532866`*^9, {
   3.8994676961939945`*^9, 3.8994677221341124`*^9}, {3.8994677709646344`*^9, 
   3.8994678016442842`*^9}, 3.8994678723631096`*^9, {3.8994679059156327`*^9, 
   3.899467927318285*^9}, 3.899471779619058*^9, {3.899474212156314*^9, 
   3.899474212259863*^9}, {3.899474255954708*^9, 3.8994742848455*^9}, {
   3.8994831365258493`*^9, 3.899483149669479*^9}, 3.899483257800079*^9, {
   3.8994833069374924`*^9, 3.8994833498783054`*^9}, {3.899483740989992*^9, 
   3.899483742012686*^9}, {3.899484000658782*^9, 3.8994841100070543`*^9}, {
   3.8994842706403923`*^9, 3.8994842937347956`*^9}, {3.8994843574893255`*^9, 
   3.899484359692665*^9}, {3.8994844644615164`*^9, 3.8994844660861907`*^9}, 
   3.8994845388239913`*^9, 3.899484931390332*^9, {3.8994854011331587`*^9, 
   3.8994854300851564`*^9}, 3.899485467206096*^9, {3.899485500126648*^9, 
   3.89948551137346*^9}, 3.899485594279964*^9, {3.899485750262042*^9, 
   3.899485754540161*^9}, 3.8994858125092564`*^9, {3.8994859440782423`*^9, 
   3.899485944332883*^9}, {3.899486032014985*^9, 3.899486033452897*^9}, 
   3.8994865612546473`*^9, {3.8994866225032206`*^9, 3.899486622604329*^9}, 
   3.8994869858967977`*^9, {3.8994887044141726`*^9, 3.899488707045272*^9}, {
   3.899490655116678*^9, 3.8994906551735396`*^9}, 3.8994909549492836`*^9, {
   3.8994909887891283`*^9, 3.899490988856161*^9}, 3.8994910221774654`*^9, {
   3.8994912843480277`*^9, 3.8994912844992714`*^9}, {3.899491356596981*^9, 
   3.8994913585389442`*^9}, {3.8994914322298946`*^9, 3.89949143302686*^9}, 
   3.899491628254121*^9, {3.899491702682017*^9, 3.8994917027510643`*^9}, {
   3.899491747993862*^9, 3.8994917481225824`*^9}, 3.899494137549036*^9, {
   3.8994944469392304`*^9, 3.8994944472904124`*^9}, {3.8994950238686886`*^9, 
   3.899495024188393*^9}, {3.899541022781294*^9, 3.8995410228502913`*^9}, {
   3.8996363266979666`*^9, 3.8996363282009525`*^9}, {3.899636531738612*^9, 
   3.899636531873252*^9}, 3.899636632882554*^9, {3.899636754357052*^9, 
   3.89963675925815*^9}, {3.899636835041819*^9, 3.8996368366753592`*^9}, {
   3.8996369525310884`*^9, 3.899636952689724*^9}, {3.899637063035556*^9, 
   3.8996370631134596`*^9}, {3.899637201689995*^9, 3.899637201832614*^9}, {
   3.899637368149393*^9, 3.899637369729168*^9}, {3.8996374390189867`*^9, 
   3.8996374603848486`*^9}, {3.899637493386033*^9, 3.8996374937291684`*^9}, {
   3.899637668483549*^9, 3.89963766864013*^9}, {3.8996377844910474`*^9, 
   3.899637784817127*^9}, 3.8996378567128696`*^9, {3.899638106251833*^9, 
   3.899638107505443*^9}, {3.8996381376638346`*^9, 3.899638137753597*^9}, {
   3.8996382728815465`*^9, 3.8996382771771193`*^9}, {3.899638379687997*^9, 
   3.899638383419964*^9}, {3.899638464882185*^9, 3.8996384651853805`*^9}, 
   3.899638632235662*^9, {3.899638709770378*^9, 3.899638710041703*^9}, 
   3.8996387505861793`*^9, {3.899638784833642*^9, 3.8996387850091724`*^9}, 
   3.8996392212757835`*^9, 3.8996393494330063`*^9, {3.899639393231965*^9, 
   3.899639393489195*^9}, 3.899641538657403*^9, {3.8996415733045654`*^9, 
   3.899641574775339*^9}, {3.8996416795758786`*^9, 3.8996416950872526`*^9}, {
   3.89964175630562*^9, 3.8996417566168003`*^9}, {3.899641841248931*^9, 
   3.899641841415557*^9}, {3.8996418763136525`*^9, 3.8996418775284986`*^9}, {
   3.899641936353006*^9, 3.8996419364637547`*^9}, {3.8996419731124096`*^9, 
   3.899641973599588*^9}, {3.8996421230171843`*^9, 3.8996421231299067`*^9}, 
   3.899642355185711*^9, 3.8996423926327734`*^9, 3.899642458633378*^9, {
   3.8996424898012857`*^9, 3.899642489897394*^9}, {3.8996425625201225`*^9, 
   3.8996425625690727`*^9}, {3.8996426114970317`*^9, 3.899642611631614*^9}, {
   3.8996456016321244`*^9, 3.8996456027184453`*^9}, {3.899645653791926*^9, 
   3.8996456549741497`*^9}, {3.8996457513443823`*^9, 3.899645753406244*^9}, {
   3.899645976144395*^9, 3.8996459765021677`*^9}, 3.899646038352186*^9, {
   3.8996460958958397`*^9, 3.899646097798299*^9}, 3.8996485325105762`*^9, 
   3.8996486471665087`*^9, 3.899648777804891*^9, 3.8996489650703473`*^9, {
   3.89964899615716*^9, 3.8996489964385586`*^9}, {3.8996490339339967`*^9, 
   3.899649034021661*^9}, {3.8996490768625107`*^9, 3.8996490769329147`*^9}, {
   3.899649128886261*^9, 3.8996491290368576`*^9}, {3.8996491847656555`*^9, 
   3.899649184861017*^9}, {3.8996492151658216`*^9, 3.8996492152363663`*^9}, {
   3.899649460382077*^9, 3.8996494607480707`*^9}, {3.899649595670949*^9, 
   3.8996495967885914`*^9}, 3.899649686255718*^9, 3.89981056929528*^9, 
   3.8998106469908576`*^9, {3.899829091708696*^9, 3.899829106993251*^9}, {
   3.8999139506862154`*^9, 3.8999139607851105`*^9}, {3.899919215913125*^9, 
   3.8999192308076177`*^9}, {3.899919430217667*^9, 3.899919453528851*^9}, 
   3.8999194968579016`*^9, {3.8999195495326705`*^9, 3.8999195530566216`*^9}, {
   3.899919585226324*^9, 3.899919659792284*^9}, {3.899919696951702*^9, 
   3.8999197202825365`*^9}, {3.8999197505174904`*^9, 
   3.8999197573851976`*^9}, {3.8999201508348455`*^9, 
   3.8999201759938145`*^9}, {3.9102643345803304`*^9, 3.9102643349463277`*^9}, 
   3.910265985189272*^9, {3.9102664201873293`*^9, 3.9102664205130253`*^9}, {
   3.910267180164838*^9, 3.910267180626464*^9}, {3.9102672212101355`*^9, 
   3.9102672413159647`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"8a13446f-3cc2-47b6-a288-f6621100d89f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Define SW Batches", "Subsection",
 CellChangeTimes->{{3.8931423053858385`*^9, 3.8931423475374203`*^9}, 
   3.900090717393674*^9},
 FontSize->24,ExpressionUUID->"5ddb74a0-d46e-474d-9a1a-9fc13d2d2c29"],

Cell["\<\
Defaults :
   
batchSizeIWs=Min[1000,Length@swarmWindowsUnified];
initialBatchID=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, 3.894826642660596*^9},
 FontSize->16,ExpressionUUID->"ae5ccf1a-a2a5-4207-8ded-bf96e0a6aff0"],

Cell[BoxData[{
 RowBox[{"batchSizeIWs", "=", 
  RowBox[{"Min", "[", 
   RowBox[{"500", ",", 
    RowBox[{"Length", "@", "swarmWindowsUnified"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"initialBatchID", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.893091939241186*^9, 3.893091966454409*^9}, {
   3.8930919979716434`*^9, 3.8930920968452725`*^9}, {3.8930921339081755`*^9, 
   3.8930921473471603`*^9}, 3.893092815999363*^9, {3.893138224852011*^9, 
   3.893138248876231*^9}, 3.8931427165048513`*^9, {3.8931538571737576`*^9, 
   3.8931538763557425`*^9}, {3.893156756017968*^9, 3.8931567562813363`*^9}, {
   3.893157177034091*^9, 3.8931571799841585`*^9}, {3.893268379921282*^9, 
   3.8932683926027093`*^9}, 3.8964389575427866`*^9, {3.8995705877020593`*^9, 
   3.899570598790648*^9}, {3.899921089639865*^9, 3.8999211189029455`*^9}, {
   3.8999214472174144`*^9, 3.8999215260384893`*^9}, {3.899921619865641*^9, 
   3.8999216262395697`*^9}, {3.9001604821093235`*^9, 3.90016048722822*^9}, {
   3.910269027381262*^9, 3.910269037181138*^9}, {3.910582586944501*^9, 
   3.9105825869943666`*^9}, 3.9106209437173877`*^9},
 CellLabel->
  "In[251]:=",ExpressionUUID->"6ea43299-1b48-4720-b4b7-360261b41542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"batchIndices", "=", 
    RowBox[{"Partition", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "swarmWindowsUnified"}]}], ",", 
      RowBox[{"UpTo", "@", "batchSizeIWs"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"batchID", "=", "initialBatchID"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "batchIndices"}]}], "Input",
 CellChangeTimes->{{3.893138544571164*^9, 3.893138544948039*^9}, {
  3.8931409884012556`*^9, 3.8931410326111937`*^9}, {3.8931427240012307`*^9, 
  3.8931427312488976`*^9}, {3.893144753336337*^9, 3.893144765775181*^9}, {
  3.8995437575634546`*^9, 3.89954376098332*^9}, {3.9102690697485886`*^9, 
  3.9102690750688024`*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"111037de-8438-45ba-bca9-96d5960c8ec8"]
}, Closed]],

Cell[CellGroupData[{

Cell["SW Batch Processing Module", "Subsection",
 CellChangeTimes->{{3.8931383292377715`*^9, 3.893138361946556*^9}, {
  3.8931412021322594`*^9, 3.893141204546124*^9}, {3.89314236077756*^9, 
  3.8931423667291946`*^9}, {3.8931438911597214`*^9, 3.893143891687642*^9}},
 FontSize->24,ExpressionUUID->"5aa81d14-3073-4136-b4a5-50c59d720c51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\"\<Initial batch ID = \>\"", "<>", 
   RowBox[{"ToString", "@", "batchID"}]}], "//", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCheck", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\"\<================================================\>\"", "//", 
    "Print"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"While", "[", "\n", " ", 
  RowBox[{
   RowBox[{"batchID", "\[LessEqual]", 
    RowBox[{"Length", "@", "batchIndices"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"\"\<Batch ID = \>\"", "<>", 
                    RowBox[{"ToString", "@", "batchID"}], "<>", "\"\</\>\"", "<>", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"Length", "@", "batchIndices"}]}]}], "//", 
                    "Print"}], ";", 
                    RowBox[{
                    RowBox[{"\"\<SW IDs: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "@", 
                    RowBox[{"batchIndices", "[", 
                    RowBox[{"[", "batchID", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"First", ",", "Last"}], "}"}]}], "]"}]}], "//", 
                    "Print"}], ";", "\[IndentingNewLine]", "\n", " ", 
                    RowBox[{"\"\<Generating IWs\>\"", "//", "Print"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"interrogationWindows", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"imageInversionSwitch", "[", 
                    RowBox[{"#", ",", "switchIndex"}], "]"}], "&"}], "@", 
                    RowBox[{"swarmWindowsUnified", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                    RowBox[{"First", "@", "#"}], ",", 
                    RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", 
                    "]"}], "&"}], "/@", 
                    RowBox[{"windowBounds", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"batchIndices", "[", 
                    RowBox[{"[", "batchID", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"switchIndex", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", 
                    RowBox[{"batchIndices", "[", 
                    RowBox[{"[", "batchID", "]"}], "]"}]}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
                     "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<Batch IW count: \>\"", "<>", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Length", "/@", 
                    RowBox[{"Flatten", "/@", "interrogationWindows"}]}], 
                    "]"}]}]}], "//", "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"\"\<Filtering IWs\>\"", "//", "Print"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"filteredWindows", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"filteredRegion", "/@", 
                    RowBox[{"interrogationWindows", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], "//", 
                    "Parallelize"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", "interrogationWindows"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", "interrogationWindows"}]}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], "//", 
                    "AbsoluteTiming"}], "//", "Print"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<IW segmentation - initial masks\>\"", "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"windowMasks", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"localSegmentation", "/@", 
                    RowBox[{"filteredWindows", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], "//", 
                    "Parallelize"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", "filteredWindows"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", "filteredWindows"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
                     "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Exporting compressed initial IW masks\>\"", "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compressedIWMasks", "=", 
                    RowBox[{
                    RowBox[{"Compress", "/@", "windowMasks"}], "//", 
                    "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"IWMaskFolder", "=", 
                    RowBox[{"output", "<>", "\"\<3 IW Masks\\\\\>\""}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"CreateDirectory", "@", "IWMaskFolder"}], ";"}], "//",
                     "Quiet"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "exportBatchImageSequence", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "compressedIWMasks", ",", "IWMaskFolder", ",", 
                    "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Generating masked IW luminance maps\>\"", "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"backgroundBias", "=", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "6"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maskedLuminanceMaps", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Parallelize", "@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ImageAdd", "[", 
                    RowBox[{"#", ",", "backgroundBias"}], "]"}], "&"}], "/@", 
                    RowBox[{"filteredWindows", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], "//", 
                    "Parallelize"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"windowMasks", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", "windowMasks"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", "windowMasks"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
                     "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Exporting compressed IW luminance maps\>\"", "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compressedLuminanceMaps", "=", 
                    RowBox[{
                    RowBox[{"Compress", "/@", "maskedLuminanceMaps"}], "//", 
                    "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"luminanceMapFolder", "=", 
                    RowBox[{
                    "output", "<>", "\"\<4 IW Luminance Maps\\\\\>\""}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"CreateDirectory", "@", "luminanceMapFolder"}], 
                    ";"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "exportBatchImageSequence", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "compressedLuminanceMaps", ",", "luminanceMapFolder", 
                    ",", "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Performing memory cleanup\>\"", "//", "Print"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"memoryCleanupStart", "[", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ClearAll", "/@", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    "interrogationWindows", ",", "filteredWindows", ",", 
                    "\[IndentingNewLine]", "compressedIWMasks", ",", 
                    "compressedLuminanceMaps"}], "\[IndentingNewLine]", "}"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"memoryCleanupFinalize", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Getting IW false positive IDs\>\"", "//", "Print"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"criterionValues", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
                    RowBox[{"Last", "/@", 
                    RowBox[{
                    "ComponentMeasurements", "[", "\[IndentingNewLine]", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}]}], ")"}],
                     ",", 
                    RowBox[{"maskedLuminanceMaps", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", "maskedLuminanceMaps"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", "maskedLuminanceMaps"}]}]}], 
                    "]"}]}], "\n", "]"}], "//", "AbsoluteTiming"}], "//", 
                    "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"monitorCounter", "=", "0"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"falsePositiveIDs", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Position", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", ">", "intensityThresholdWindows"}], "&"}], "/@", 
                    RowBox[{"criterionValues", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "branch", ",", "k"}], "]"}], "]"}]}], 
                    ",", "False"}], "\[IndentingNewLine]", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", 
                    RowBox[{"Length", "@", "criterionValues"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"criterionValues", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "branch"}], "]"}], "]"}]}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                    RowBox[{"progress", "[", 
                    RowBox[{"monitorCounter", ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "@", "criterionValues"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
                     "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"memoryCheck", "[", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<Exporting compressed IW false positive IDs\>\"", "//",
                     "Print"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compressedFalsePositiveIDs", "=", 
                    RowBox[{"Compress", "/@", "falsePositiveIDs"}]}], ";"}], "//",
                    "AbsoluteTiming"}], "//", "Print"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"falsePositiveFolder", "=", 
                  RowBox[{
                  "output", "<>", "\"\<5 False Positive IDs\\\\\>\""}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"CreateDirectory", "@", "falsePositiveFolder"}], 
                 ";"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"exportBatchImageSequence", "[", "\[IndentingNewLine]", 
                RowBox[{
                "compressedFalsePositiveIDs", ",", "falsePositiveFolder", 
                 ",", "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", 
                "]"}], ";"}], "//", "AbsoluteTiming"}], "//", "Print"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"memoryCheck", "[", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Assembling true IW masks\>\"", "//", "Print"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"trueParticleMasks", "=", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"getBlackWindow", "@@", 
                    RowBox[{"ImageDimensions", "@", "#1"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", "0", ",", 
                    RowBox[{"Image", "@", 
                    RowBox[{"Total", "@", "#"}]}]}], "\[IndentingNewLine]", 
                    "]"}], "&"}], "@", 
                    RowBox[{"(", 
                    RowBox[{"Last", "/@", 
                    RowBox[{"Delete", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "@", 
                    "#1"}], ",", "#2"}], "\[IndentingNewLine]", "]"}]}], 
                    ")"}]}]}], "\[IndentingNewLine]", "]"}], ")"}], "&"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"windowMasks", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}], ",", 
                    RowBox[{"falsePositiveIDs", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "branch"}], "]"}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "@", "falsePositiveIDs"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"branch", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                RowBox[{"progress", "[", 
                 RowBox[{"monitorCounter", ",", 
                  RowBox[{"2", "*", 
                   RowBox[{"Length", "@", "falsePositiveIDs"}]}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//", 
             "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"memoryCheck", "[", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<Exporting compressed true IW masks\>\"", "//", "Print"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"compressedTrueParticleMasks", "=", 
             RowBox[{
              RowBox[{"Compress", "/@", "trueParticleMasks"}], "//", 
              "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], "//", 
          "Print"}], ";", "\[IndentingNewLine]", 
         RowBox[{"trueIWMasksFolder", "=", 
          RowBox[{"output", "<>", "\"\<6 True IW Masks\\\\\>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CreateDirectory", "@", "trueIWMasksFolder"}], ";"}], "//", 
        "Quiet"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"exportBatchImageSequence", "[", "\[IndentingNewLine]", 
        RowBox[{
        "compressedTrueParticleMasks", ",", "trueIWMasksFolder", ",", 
         "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//",
       "AbsoluteTiming"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Performing memory cleanup\>\"", "//", "Print"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"memoryCleanupStart", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "/@", 
     RowBox[{"Unevaluated", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "windowMasks", ",", "maskedLuminanceMaps", ",", "falsePositiveIDs", 
        ",", "criterionValues", ",", "compressedTrueParticleMasks", ",", 
        "compressedFalsePositiveIDs", ",", "trueParticleMasks"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"memoryCleanupFinalize", "[", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"\"\<SW batch processed\>\"", "//", "Print"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<================================================\>\"", "//", 
     "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"batchID", "++"}]}]}], "\n", " ", "]"}]}], "Input",
 CellChangeTimes->{{3.8931385727737494`*^9, 3.8931386303630943`*^9}, {
   3.893140896711752*^9, 3.8931409373730335`*^9}, {3.893141034450965*^9, 
   3.8931412766109395`*^9}, {3.8931415395876184`*^9, 
   3.8931415869711375`*^9}, {3.893141673459625*^9, 3.8931417469782825`*^9}, {
   3.8931417847405076`*^9, 3.8931418390354*^9}, {3.893141871034717*^9, 
   3.8931421284596024`*^9}, 3.8931434089316173`*^9, {3.893143594497156*^9, 
   3.8931436020999303`*^9}, 3.893143828072871*^9, {3.893143997811604*^9, 
   3.893143999411334*^9}, {3.893144080779928*^9, 3.893144275597258*^9}, {
   3.8931443471350317`*^9, 3.8931443519312663`*^9}, {3.8931447756356487`*^9, 
   3.893144841717338*^9}, {3.8931448956441107`*^9, 3.893144895942253*^9}, {
   3.8931538927580643`*^9, 3.8931539018926673`*^9}, {3.8931539508813877`*^9, 
   3.893154070503278*^9}, {3.8931545811419563`*^9, 3.893154581899885*^9}, {
   3.89315648354926*^9, 3.8931564837097883`*^9}, {3.8931570780616717`*^9, 
   3.8931570883332777`*^9}, {3.893263822923854*^9, 3.8932638419885497`*^9}, {
   3.8932638958365245`*^9, 3.893263896442902*^9}, {3.8932645073301706`*^9, 
   3.893264507766014*^9}, {3.8932666073821945`*^9, 3.893266635147708*^9}, {
   3.8932672805611186`*^9, 3.893267284776843*^9}, {3.8964389032750998`*^9, 
   3.896438936545695*^9}, {3.8964404419694834`*^9, 3.8964404786718245`*^9}, 
   3.896440600171146*^9, {3.896440673716462*^9, 3.896440692204131*^9}, {
   3.899203824473755*^9, 3.8992038269517546`*^9}, {3.899543373482252*^9, 
   3.899543397974165*^9}, {3.8995437799468203`*^9, 3.899543796249298*^9}, {
   3.8995438388414125`*^9, 3.8995438738274508`*^9}, {3.899544086392646*^9, 
   3.8995441260892973`*^9}, {3.8995447220718503`*^9, 3.899544737832039*^9}, {
   3.8995449718017216`*^9, 3.8995449720959573`*^9}, {3.8995450926403637`*^9, 
   3.899545094987007*^9}, {3.8995462014703608`*^9, 3.8995462425454483`*^9}, {
   3.899551815500765*^9, 3.8995518180903835`*^9}, 3.89955196780372*^9, {
   3.8995534604692354`*^9, 3.899553486604563*^9}, {3.899553582664319*^9, 
   3.8995535861898394`*^9}, {3.899554030094188*^9, 3.8995540339969597`*^9}, {
   3.899555246153264*^9, 3.8995553056728215`*^9}, 3.8995553601742463`*^9, {
   3.899555480782241*^9, 3.8995555210152016`*^9}, {3.899555592543477*^9, 
   3.899555593463916*^9}, {3.8995556297932816`*^9, 3.899555632215845*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"a67e0e43-830c-4889-a367-4fdb8f456dbd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Assemble the SW Masks", "Subsection",
 CellChangeTimes->{{3.8161869474002137`*^9, 3.8161869738160024`*^9}, {
   3.8163362044174833`*^9, 3.8163362211503696`*^9}, 3.8235283520980687`*^9, {
   3.8333644982915487`*^9, 3.833364503652794*^9}, 3.833633284819133*^9, {
   3.8931439089674244`*^9, 3.893143909231435*^9}},
 FontSize->24,ExpressionUUID->"862814e2-aac2-4211-9e28-53e5cecaac71"],

Cell[CellGroupData[{

Cell[">> Import Compressed True IW Masks <<", "Subsubsection",
 CellChangeTimes->{{3.8887784671333437`*^9, 3.888778481319368*^9}, {
  3.8891191356180696`*^9, 3.889119137233969*^9}, {3.889119632338035*^9, 
  3.889119688890498*^9}, {3.8892759125438747`*^9, 3.889275917544747*^9}, {
  3.890391483929043*^9, 3.890391499641883*^9}, {3.890456026893295*^9, 
  3.890456068613413*^9}, {3.890466325939958*^9, 3.8904663327194595`*^9}, {
  3.890479237569111*^9, 3.890479238792901*^9}, {3.8905019958946877`*^9, 
  3.890502012648638*^9}, {3.890502693482668*^9, 3.890502698279925*^9}, {
  3.89050413874428*^9, 3.890504144880747*^9}, {3.89050452135915*^9, 
  3.8905045247920065`*^9}, {3.890538287922927*^9, 3.890538288187433*^9}, {
  3.8932667704481897`*^9, 
  3.8932667722002306`*^9}},ExpressionUUID->"d6b5bf13-81e8-44d4-bdf5-\
ff8b430ea634"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trueIWMasksFolder", "=", 
   RowBox[{"output", "<>", "\"\<6 True IW Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "trueIWMasksFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"compressedTrueParticleMasks", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Import", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"trueIWMasksFolder", "<>", "#"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
           "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896255885199213`*^9, 3.8896255896557426`*^9}, 3.8904662971580048`*^9, {
   3.8904667087090826`*^9, 3.890466748957419*^9}, {3.890497786701861*^9, 
   3.890497800253456*^9}, {3.890498008083782*^9, 3.890498008747785*^9}, {
   3.890505025354515*^9, 3.8905050392672606`*^9}, {3.8905052730660973`*^9, 
   3.8905052998805933`*^9}, {3.890527616204788*^9, 3.89052761644471*^9}, {
   3.890538252980605*^9, 3.8905382676923475`*^9}, {3.893263923831809*^9, 
   3.8932639517964563`*^9}, {3.893263993081145*^9, 3.8932639946489506`*^9}, 
   3.8932645353296227`*^9, 3.893265027808015*^9, {3.8932653463221707`*^9, 
   3.893265394424678*^9}, {3.8932655818232837`*^9, 3.893265665254691*^9}, {
   3.8932661327191715`*^9, 3.8932661358836565`*^9}, {3.893266211839534*^9, 
   3.893266216892918*^9}, 3.893266730705143*^9},
 CellLabel->
  "In[263]:=",ExpressionUUID->"baa9fcca-a033-48bd-96d0-c52a629f2419"]
}, Closed]],

Cell[CellGroupData[{

Cell["Define SW Assembly Batches", "Subsubsection",
 CellChangeTimes->{{3.893266877978691*^9, 3.893266891462199*^9}, {
  3.8932669963486795`*^9, 
  3.893266999349956*^9}},ExpressionUUID->"c89b5c2d-e0ad-49c1-9665-\
794361ccfafb"],

Cell["\<\
Defaults :
   
batchSizeSWs=Min[1000,Length@swarmWindowsUnified];
initialBatchID=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, 3.894826642660596*^9, 
   3.8948266766030755`*^9, {3.8995558805956264`*^9, 3.899555881561578*^9}},
 FontSize->16,ExpressionUUID->"15c2f1c3-77e0-4905-a6fd-f03be35f4df4"],

Cell[BoxData[{
 RowBox[{"batchSizeSWs", "=", 
  RowBox[{"Min", "[", 
   RowBox[{"1000", ",", 
    RowBox[{"Length", "@", "swarmWindowsUnified"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"initialBatchID", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.893091939241186*^9, 3.893091966454409*^9}, {
   3.8930919979716434`*^9, 3.8930920968452725`*^9}, {3.8930921339081755`*^9, 
   3.8930921473471603`*^9}, 3.893092815999363*^9, {3.893138224852011*^9, 
   3.893138248876231*^9}, 3.8931427165048513`*^9, {3.8931538571737576`*^9, 
   3.8931538763557425`*^9}, {3.893156756017968*^9, 3.8931567562813363`*^9}, {
   3.893157177034091*^9, 3.8931571799841585`*^9}, {3.8932668992942543`*^9, 
   3.893266909758314*^9}, {3.8932684068961487`*^9, 3.893268409093931*^9}, {
   3.893269165191947*^9, 3.8932691652607617`*^9}, {3.8932695077904935`*^9, 
   3.8932695080453277`*^9}, {3.8932698925812874`*^9, 3.8932699166698956`*^9}, 
   3.8964392742384644`*^9, {3.900239589991143*^9, 3.9002395933061895`*^9}, {
   3.9002397095261693`*^9, 3.900239717908987*^9}, 3.900248471792772*^9, 
   3.9104288325410595`*^9, {3.9104408366463795`*^9, 3.9104408369865046`*^9}, 
   3.9104625647990303`*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"5dc4640c-72d8-444a-af09-b2e208a8e795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"batchIndices", "=", 
    RowBox[{"Partition", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "compressedTrueParticleMasks"}]}], ",", 
      RowBox[{"UpTo", "@", "batchSizeSWs"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"batchID", "=", "initialBatchID"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "batchIndices"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"#", "@", 
    RowBox[{"batchIndices", "[", 
     RowBox[{"[", "batchID", "]"}], "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"First", ",", "Last"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.893138544571164*^9, 3.893138544948039*^9}, {
  3.8931409884012556`*^9, 3.8931410326111937`*^9}, {3.8931427240012307`*^9, 
  3.8931427312488976`*^9}, {3.893144753336337*^9, 3.893144765775181*^9}, {
  3.893266925591406*^9, 3.893266930287294*^9}, {3.900239607909999*^9, 
  3.900239626845564*^9}, {3.910428836974207*^9, 3.910428841549971*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"c4762a14-7087-4395-b106-1a1fb87bb692"]
}, Closed]],

Cell[CellGroupData[{

Cell["SW Batch Assembly Module", "Subsubsection",
 CellChangeTimes->{{3.8891198875942893`*^9, 3.88911992666564*^9}, {
   3.889275707553129*^9, 3.8892757082482405`*^9}, 3.8892758147928467`*^9, {
   3.893266987095005*^9, 
   3.8932669946851816`*^9}},ExpressionUUID->"f6c3cc98-b811-4733-a57d-\
acace75667c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\"\<Initial batch ID = \>\"", "<>", 
   RowBox[{"ToString", "@", "batchID"}]}], "//", 
  "Print"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCheck", "[", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\"\<================================================\>\"", "//", 
    "Print"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", "\n", " ", 
  RowBox[{
   RowBox[{"batchID", "\[LessEqual]", 
    RowBox[{"Length", "@", "batchIndices"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Batch ID = \>\"", "<>", 
           RowBox[{"ToString", "@", "batchID"}], "<>", "\"\</\>\"", "<>", 
           RowBox[{"ToString", "@", 
            RowBox[{"Length", "@", "batchIndices"}]}]}], "//", "Print"}], ";", 
         RowBox[{
          RowBox[{"\"\<SW IDs: \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "@", 
                RowBox[{"batchIndices", "[", 
                 RowBox[{"[", "batchID", "]"}], "]"}]}], ")"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"First", ",", "Last"}], "}"}]}], "]"}]}], "//", 
          "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<Uncompressing true IW masks\>\"", "//", "Print"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"trueParticleMasks", "=", 
               RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"monitorCounter", "++"}], ";", 
                    RowBox[{"Uncompress", "@", "#"}]}], ")"}], "&"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"compressedTrueParticleMasks", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
                  RowBox[{"batchIndices", "[", 
                   RowBox[{"[", "batchID", "]"}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
             RowBox[{"progress", "[", 
              RowBox[{"monitorCounter", ",", "batchSizeSWs"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//", 
          "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"memoryCheck", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Assembling SW masks\>\"", "//", "Print"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"swarmWindowMasks", "=", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"monitorCounter", "++"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Binarize", "[", 
                    RowBox[{"#", ",", "0"}], "]"}], "&"}], "@", 
                   RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"getBlackWindow", "@@", 
                    RowBox[{"ImageDimensions", "@", 
                    RowBox[{"swarmWindowCoreMasksUnified", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "0.5"}], "}"}], "&"}], "/@", 
                    RowBox[{"trueParticleMasks", "[", 
                    RowBox[{"[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"k", "+", "1", "-", 
                    RowBox[{"First", "@", 
                    RowBox[{"batchIndices", "[", 
                    RowBox[{"[", "batchID", "]"}], "]"}]}]}], ",", "branch"}],
                     "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"trueWindowLocations", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"batchIndices", "[", 
                    RowBox[{"[", "batchID", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"branch", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
             RowBox[{"progress", "[", 
              RowBox[{"monitorCounter", ",", 
               RowBox[{"2", "*", 
                RowBox[{"Length", "@", 
                 RowBox[{"batchIndices", "[", 
                  RowBox[{"[", "batchID", "]"}], "]"}]}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//", 
          "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"memoryCheck", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Exporting SW masks\>\"", "//", "Print"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"compressedSwarmWindowMasks", "=", 
          RowBox[{
           RowBox[{"Compress", "/@", "swarmWindowMasks"}], "//", 
           "Parallelize"}]}], ";"}], "\[IndentingNewLine]", "//", 
        "AbsoluteTiming"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
      RowBox[{"swarmWindowMaskFolder", "=", 
       RowBox[{"output", "<>", "\"\<7 Swarm Window Masks\\\\\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CreateDirectory", "@", "swarmWindowMaskFolder"}], ";"}], "//", 
     "Quiet"}], ";", "\[IndentingNewLine]", 
    RowBox[{"exportBatchImageSequence", "[", 
     RowBox[{
     "compressedSwarmWindowMasks", ",", "swarmWindowMaskFolder", ",", 
      "\"\<.txt\>\"", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Performing memory cleanup\>\"", "//", "Print"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"memoryCleanupStart", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "/@", 
     RowBox[{"Unevaluated", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "trueParticleMasks", ",", "swarmWindowMasks", ",", 
        "compressedSwarmWindowMasks"}], "\[IndentingNewLine]", "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"memoryCleanupFinalize", "[", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"\"\<SW Batch Processed\>\"", "//", "Print"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<================================================\>\"", "//", 
     "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"batchID", "++"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8996195846068544`*^9, 3.899619588623768*^9}, {
  3.8996196741638317`*^9, 3.8996196850083847`*^9}, {3.910429311774785*^9, 
  3.910429313717843*^9}, {3.9104309351537576`*^9, 3.9104309366619997`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"b2707f9f-f171-4f0e-b908-168b45f36c2b"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Swarm Window Masks <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
  3.8892820855119534`*^9}, {3.889293060503975*^9, 
  3.889293061213849*^9}},ExpressionUUID->"e7310513-bfe5-422e-b331-\
487727a8c8fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmWindowMaskFolder", "=", 
    RowBox[{"output", "<>", "\"\<7 Swarm Window Masks\\\\\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "swarmWindowMaskFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"swarmWindowMasks", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"swarmWindowMaskFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8892930799576654`*^9, 3.88929312647618*^9}, {3.889986536406354*^9, 
   3.88998653764981*^9}, {3.890538502915165*^9, 3.8905385029869165`*^9}, {
   3.8933038222200327`*^9, 3.8933038672060905`*^9}, {3.8992224590720425`*^9, 
   3.899222460255929*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"488d72b5-0213-4b24-af04-a5a390d88665"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clean the SW Masks", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889292678076763*^9, 
  3.889292688060924*^9}, {3.893143912783554*^9, 
  3.893143913007474*^9}},ExpressionUUID->"60a24408-439f-4417-8e45-\
3fdb0d4308ad"],

Cell["\<\
Defaults :
   
minimumArea=25;
openingRadius=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.8892932534172153`*^9, {3.8994938282912283`*^9, 
   3.899493842187771*^9}, {3.8995627042722216`*^9, 3.8995627201354*^9}, 
   3.899797019279358*^9},
 FontSize->16,ExpressionUUID->"3b42f1b4-f869-4c6f-8d50-d762f6bcd132"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minimumArea", "=", "25"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"openingRadius", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890062407364352*^9, 3.8900624073653097`*^9}, 
   3.8994938058209467`*^9},
 CellLabel->
  "In[296]:=",ExpressionUUID->"f402f353-1389-46ff-b918-17679e7e8440"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"swarmWindowMasksClean", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
       RowBox[{"Parallelize", "@", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"monitorCounter", "++"}], ";", 
             RowBox[{"getCleanSwarmWindowMaskAlternative", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "@", "swarmWindowMasks"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
              "swarmWindowCoreMasksUnified"}], "//", "Flatten"}]}], 
           "\[IndentingNewLine]", "}"}]}], "]"}]}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"2", "*", 
       RowBox[{"Length", "@", "swarmWindowCoreMasksUnified"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8995568225806093`*^9, 3.8995568875893073`*^9}, {
  3.899557087635744*^9, 3.8995571017262135`*^9}, {3.8995573073960323`*^9, 
  3.899557309618965*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"937f0267-0d7b-4356-84d1-5ac1bc044895"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Clean SW Masks ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889292678076763*^9, 
  3.889292688060924*^9}, {3.889626473269869*^9, 3.889626479974066*^9}, {
  3.8931439160872035`*^9, 
  3.893143916295191*^9}},ExpressionUUID->"1df61aac-ba0a-4ec7-be4b-\
23a9ba3214a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"viewImage", "/@", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"swarmWindowCoreMasksUnified", "[", 
            RowBox[{"[", "testID", "]"}], "]"}], ",", "Orange", ",", "2"}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"getMaskOverlays", "[", 
           RowBox[{
            RowBox[{"ImageAdjust", "@", "#3"}], ",", "#1", ",", "White", ",", 
            "2"}], "]"}], ",", 
          RowBox[{"#2", "-", "#1"}], ",", "Red", ",", "2"}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "@@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"swarmWindowMasksClean", "[", 
         RowBox[{"[", 
          RowBox[{"testID", ",", "branch"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"swarmWindowMasks", "[", 
         RowBox[{"[", 
          RowBox[{"testID", ",", "branch"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"reducedSwarmWindowsUnified", "[", 
         RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"branch", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "//", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "5"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.889295787586458*^9, 3.8892958375296035`*^9}, {
   3.889296085583479*^9, 3.88929613220712*^9}, {3.8892961913203106`*^9, 
   3.8892961950674486`*^9}, {3.889296738743577*^9, 3.8892967619903064`*^9}, {
   3.889296801150568*^9, 3.889296813891158*^9}, {3.8892972260302134`*^9, 
   3.8892972390543013`*^9}, {3.8892972810713615`*^9, 
   3.8892973913172035`*^9}, {3.8892974244662952`*^9, 
   3.8892974601530113`*^9}, {3.889297532801303*^9, 3.889297573176382*^9}, {
   3.889297658685427*^9, 3.889297677373721*^9}, {3.889298371204778*^9, 
   3.889298374787366*^9}, {3.88929899917894*^9, 3.8892990224104185`*^9}, 
   3.889300421714444*^9, {3.88962618906699*^9, 3.889626226622657*^9}, {
   3.889626395720998*^9, 3.8896263960142803`*^9}, 3.8896264429109707`*^9, 
   3.890062357845134*^9, {3.8900652416453857`*^9, 3.8900652560992613`*^9}, {
   3.8902085395620995`*^9, 3.890208540779868*^9}, {3.8933040939237075`*^9, 
   3.8933041645950975`*^9}, {3.893326911751495*^9, 3.8933269121265554`*^9}, {
   3.8933415197511263`*^9, 3.8933415368067327`*^9}, 3.8948266928096685`*^9, 
   3.899202114590011*^9, 3.8992023698313694`*^9, {3.8992039141797924`*^9, 
   3.8992039166433067`*^9}, {3.899206352003517*^9, 3.8992063604961786`*^9}, 
   3.8992205009201784`*^9, {3.8995571624858017`*^9, 3.899557283922185*^9}, {
   3.9000063669169807`*^9, 3.9000063761908092`*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"4dba5d06-0dd3-4686-8a89-d49c995d4db6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SW False Positive Filtering", "Subsection",
 CellChangeTimes->{{3.8161869474002137`*^9, 3.8161869738160024`*^9}, {
   3.8163362044174833`*^9, 3.8163362211503696`*^9}, 3.8235283520980687`*^9, {
   3.8333644982915487`*^9, 3.833364503652794*^9}, 3.833633284819133*^9, {
   3.888778581098545*^9, 3.88877858626712*^9}, {3.8887796307218065`*^9, 
   3.88877967709704*^9}, {3.8896263222306767`*^9, 3.8896263227357903`*^9}, {
   3.893143919631085*^9, 3.8931439210716476`*^9}},
 FontSize->24,ExpressionUUID->"212bbe3a-1484-4378-816c-05fab6277fe3"],

Cell[CellGroupData[{

Cell["SW Filter Testing Setup", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.900262474324109*^9, 
  3.900262479732193*^9}},ExpressionUUID->"ebb40c1d-cc2d-47d0-9a53-\
edc87e520b55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testSWFilter", "[", "swarmWindowID_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testID", "=", "swarmWindowID"}], ",", "backgroundBias", ",", 
      "\[IndentingNewLine]", "testCriterionValuesWindow", ",", 
      "testFalsePositiveIDsWindow", ",", "testSegmentImagesWindow", ",", 
      "\[IndentingNewLine]", "testBlackWindowCanvas", ",", 
      "testTrueWindowParticleMask"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"backgroundBias", "=", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"testCriterionValuesWindow", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
               RowBox[{"Last", "/@", 
                RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}], 
                   "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
             RowBox[{"getCheckMask", "[", "\[IndentingNewLine]", 
              RowBox[{"#", ",", 
               RowBox[{"swarmWindowCoreMasksUnified", "[", 
                RowBox[{"[", "testID", "]"}], "]"}], ",", 
               RowBox[{"swarmWindowMasksClean", "[", 
                RowBox[{"[", 
                 RowBox[{"testID", ",", 
                  RowBox[{"switchIndex", "+", "1"}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
           RowBox[{"ImageAdjust", "@", 
            RowBox[{"preprocessImage", "@", 
             RowBox[{"ColorNegate", "@", 
              RowBox[{"imageInversionSwitch", "[", 
               RowBox[{"#", ",", "switchIndex"}], "]"}]}]}]}]}], "&"}], "@", 
         RowBox[{"swarmWindowsUnified", "[", 
          RowBox[{"[", "testID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"switchIndex", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"testFalsePositiveIDsWindow", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{
              RowBox[{"Mean", "@", 
               RowBox[{"testCriterionValuesWindow", "[", 
                RowBox[{"[", "branch", "]"}], "]"}]}], "*", 
              RowBox[{"intensityThresholdGlobal", "[", 
               RowBox[{"[", "branch", "]"}], "]"}]}]}], "&"}], "/@", 
           RowBox[{"testCriterionValuesWindow", "[", 
            RowBox[{"[", "branch", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
           "False"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"branch", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"testSegmentImagesWindow", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "@", 
         RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ColorNegate", "@", 
            RowBox[{"swarmWindowCoreMasksUnified", "[", 
             RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FillingTransform", "@", 
            RowBox[{"swarmWindowMasksClean", "[", 
             RowBox[{"[", 
              RowBox[{"testID", ",", "branch"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"branch", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"testBlackWindowCanvas", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Binarize", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
       RowBox[{"swarmWindowCoreMasksUnified", "[", 
        RowBox[{"[", "testID", "]"}], "]"}]}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"testTrueWindowParticleMask", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"ColorNegate", "@", 
               RowBox[{"DeleteSmallComponents", "@", 
                RowBox[{"Binarize", "@", 
                 RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
                  RowBox[{"#", ",", 
                   RowBox[{"swarmWindowCoreMasksUnified", "[", 
                    RowBox[{"[", "testID", "]"}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}]}]}]}]}], "\[IndentingNewLine]",
              "]"}], "&"}], "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"Head", "@", "#"}]}], "==", "\"\<SparseArray\>\""}], 
             ",", 
             RowBox[{"Image", "@", "#"}], ",", "placeholderSW"}], "]"}]}], 
          "&"}], "@", 
         RowBox[{"Total", "[", "\[IndentingNewLine]", 
          RowBox[{"Last", "/@", 
           RowBox[{"Delete", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"testSegmentImagesWindow", "[", 
              RowBox[{"[", "branch", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"testFalsePositiveIDsWindow", "[", 
              RowBox[{"[", "branch", "]"}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"branch", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"viewImage", "/@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"previewTrueParticleMask", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"testTrueWindowParticleMask", "[", 
                 RowBox[{"[", 
                  RowBox[{"switchIndex", "+", "1"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"swarmWindowMasksClean", "[", 
                 RowBox[{"[", 
                  RowBox[{"testID", ",", 
                   RowBox[{"switchIndex", "+", "1"}]}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"swarmWindowCoreMasksUnified", "[", 
                 RowBox[{"[", "testID", "]"}], "]"}], ",", 
                RowBox[{"reducedSwarmWindowsUnified", "[", 
                 RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]",
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"switchIndex", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
                 RowBox[{"#", ",", 
                  RowBox[{"swarmWindowCoreMasksUnified", "[", 
                   RowBox[{"[", "testID", "]"}], "]"}], ",", "Orange", ",", 
                  "2"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
               RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
                RowBox[{"#", ",", 
                 RowBox[{"testTrueWindowParticleMask", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "Red", ",", "2"}], 
                "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
             RowBox[{"getMaskOverlays", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"reducedSwarmWindowsUnified", "[", 
                RowBox[{"[", "testID", "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"testTrueWindowParticleMask", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Lighter", "@", "Blue"}], ",", "2"}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedSwarmWindowsUnified", "[", 
             RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "}"}]}]}], "//", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"GraphicsGrid", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
          RowBox[{"Spacings", "\[Rule]", "5"}]}], "]"}], "&"}]}], "//", 
      "Print"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88927030378636*^9, 3.889270349778026*^9}, {
   3.88927113689786*^9, 3.889271176483074*^9}, {3.889271671368741*^9, 
   3.8892716761920652`*^9}, {3.8892984917080355`*^9, 3.889298497147481*^9}, {
   3.889299025899432*^9, 3.8892990262666883`*^9}, {3.8892990824342227`*^9, 
   3.8892990841793103`*^9}, {3.8893000113935003`*^9, 3.8893000122249765`*^9}, 
   3.889300079417344*^9, {3.8893001987520847`*^9, 3.8893001994642334`*^9}, {
   3.8893002347077265`*^9, 3.889300253490049*^9}, {3.889300433809244*^9, 
   3.8893004373278675`*^9}, {3.889300665001961*^9, 3.889300666344548*^9}, {
   3.8896263653840384`*^9, 3.889626381263075*^9}, 3.889626553034603*^9, 
   3.8896270874329166`*^9, {3.8896283092540255`*^9, 3.889628320178583*^9}, {
   3.8896284051864367`*^9, 3.889628409015211*^9}, {3.889628711068329*^9, 
   3.889628744602418*^9}, {3.889628775574562*^9, 3.889628860259157*^9}, {
   3.889631027026637*^9, 3.889631045080316*^9}, {3.8896323872154226`*^9, 
   3.8896324026704783`*^9}, 3.8896325002865796`*^9, {3.88963433932853*^9, 
   3.889634341092704*^9}, {3.8896357081082597`*^9, 3.889635713796998*^9}, {
   3.889637830729537*^9, 3.889637845097272*^9}, {3.889639363752881*^9, 
   3.889639416105651*^9}, {3.8896405016035132`*^9, 3.8896405043986454`*^9}, {
   3.8900624436399183`*^9, 3.8900624453039713`*^9}, {3.890079325039683*^9, 
   3.890079325275359*^9}, 3.8908414594755945`*^9, 3.893341482697646*^9, {
   3.8933415266790247`*^9, 3.8933415268804913`*^9}, {3.899202241014969*^9, 
   3.899202262957304*^9}, 3.89920237959532*^9, {3.8992024323338294`*^9, 
   3.8992024522569113`*^9}, 3.899206310084524*^9, 3.8992202834815483`*^9, 
   3.8992203136434817`*^9, {3.899220359765911*^9, 3.8992203613443093`*^9}, {
   3.899220429432428*^9, 3.899220454702691*^9}, {3.899220487529214*^9, 
   3.899220507936672*^9}, {3.899374803558981*^9, 3.8993748282314806`*^9}, {
   3.899557466709652*^9, 3.899557470122573*^9}, {3.899557509467965*^9, 
   3.8995575246034822`*^9}, {3.89955765442939*^9, 3.899557685979661*^9}, {
   3.899557806933014*^9, 3.8995578424599476`*^9}, {3.8995579619788914`*^9, 
   3.8995579721326227`*^9}, {3.8995609256116114`*^9, 
   3.8995609276171155`*^9}, {3.8995627455622873`*^9, 
   3.8995627509617815`*^9}, {3.89956278648342*^9, 3.899563141250348*^9}, {
   3.899563818384906*^9, 3.899563818650485*^9}, {3.899646330167381*^9, 
   3.899646390254574*^9}, {3.8996464984959917`*^9, 3.899646498749995*^9}, {
   3.8996474536063213`*^9, 3.8996474927254467`*^9}, {3.899647650990716*^9, 
   3.8996476804226027`*^9}, {3.899647717199506*^9, 3.8996477172503843`*^9}, {
   3.899647805638623*^9, 3.89964783014968*^9}, {3.8996478700475435`*^9, 
   3.899647870109435*^9}, {3.899647907966834*^9, 3.899647924304105*^9}, 
   3.8996480139189463`*^9, {3.8996481246630893`*^9, 3.8996481878219767`*^9}, {
   3.899648231279888*^9, 3.899648247957853*^9}, {3.89964828635168*^9, 
   3.8996483056714597`*^9}, {3.899648371287648*^9, 3.8996483715425043`*^9}, 
   3.899650229141876*^9, 3.8999205364587836`*^9, {3.8999980538873672`*^9, 
   3.899998060108676*^9}, {3.900006450815503*^9, 3.900006450949202*^9}, 
   3.9000542438047037`*^9, {3.9000589648849583`*^9, 3.900058965059539*^9}, {
   3.900059086452855*^9, 3.9000591101788545`*^9}, 3.9000591537592735`*^9, {
   3.9000592068682823`*^9, 3.9000592071335793`*^9}, {3.9000592407417765`*^9, 
   3.900059286683861*^9}, {3.9000594980451393`*^9, 3.9000594982207193`*^9}, {
   3.9002624935091867`*^9, 3.900262647622102*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"8a01896e-e080-4625-a5ea-fa1409f70ccd"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Filter Output ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 
  3.8896283956833787`*^9}},ExpressionUUID->"a795e655-90bd-4db3-a740-\
90584a21d980"],

Cell[BoxData[
 RowBox[{
  RowBox[{"intensityThresholdGlobal", "=", 
   RowBox[{"{", 
    RowBox[{"0.95", ",", "0.93"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88877452718019*^9, 3.88877456044153*^9}, {
   3.888774752962145*^9, 3.888774754649767*^9}, {3.8887755834516788`*^9, 
   3.888775617520907*^9}, {3.888775655658278*^9, 3.8887756558324194`*^9}, {
   3.8887757490018673`*^9, 3.8887757665856614`*^9}, {3.8887762486411924`*^9, 
   3.888776347832482*^9}, {3.8887763886000104`*^9, 3.8887763951841516`*^9}, {
   3.8887769200808897`*^9, 3.88877700658224*^9}, {3.8887770544788065`*^9, 
   3.888777054710743*^9}, {3.8887779212705216`*^9, 3.8887779602203317`*^9}, {
   3.8887780130604005`*^9, 3.888778046645835*^9}, 3.888779450290223*^9, {
   3.889275085530616*^9, 3.8892750954980445`*^9}, {3.889275490698642*^9, 
   3.889275492225775*^9}, {3.88927560811423*^9, 3.8892756241685424`*^9}, {
   3.8892765007519875`*^9, 3.889276542423807*^9}, {3.8892765727276583`*^9, 
   3.889276572807505*^9}, {3.8892766288955097`*^9, 3.8892766290641766`*^9}, 
   3.889276789343395*^9, 3.889298565659087*^9, {3.8892986021952405`*^9, 
   3.889298682786625*^9}, {3.889298740235504*^9, 3.8892987719880767`*^9}, {
   3.889298942547864*^9, 3.889298968442112*^9}, {3.889299047549329*^9, 
   3.889299058227835*^9}, {3.8892991062596555`*^9, 3.889299146538028*^9}, {
   3.8892991775382752`*^9, 3.8892992215143614`*^9}, {3.889299308906891*^9, 
   3.8892993608421926`*^9}, {3.889299565978891*^9, 3.889299566265806*^9}, {
   3.8892997570575294`*^9, 3.8892997641682453`*^9}, {3.8892997994901037`*^9, 
   3.8892998201715727`*^9}, {3.8892999496731853`*^9, 
   3.8892999713364706`*^9}, {3.889626541601503*^9, 3.8896265422854185`*^9}, 
   3.8992204685148015`*^9, {3.8992207626685314`*^9, 3.8992207879661617`*^9}, 
   3.8994943896627607`*^9, {3.899646376472185*^9, 3.899646377662245*^9}, {
   3.899647727430163*^9, 3.899647762751521*^9}, {3.8996478449905043`*^9, 
   3.899647845222935*^9}, {3.899647947094538*^9, 3.8996480054449463`*^9}, {
   3.8996483227810717`*^9, 3.8996483550710926`*^9}, {3.89965025973359*^9, 
   3.899650261467985*^9}, {3.900054221734729*^9, 3.9000542233663645`*^9}, {
   3.9000590191159587`*^9, 3.900059037092925*^9}, {3.9000593062126284`*^9, 
   3.9000594399071217`*^9}, {3.900059482166102*^9, 3.900059482274809*^9}, {
   3.900262895867755*^9, 3.900262960644853*^9}, {3.9104471209614325`*^9, 
   3.910447122309167*^9}, {3.910447181054925*^9, 3.910447201309739*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"183df332-4cea-4bbf-87cd-8d4d02b77a05"],

Cell[BoxData[
 RowBox[{"testSWFilter", "@", "1"}]], "Input",
 CellChangeTimes->{{3.88927030378636*^9, 3.889270349778026*^9}, {
   3.88927113689786*^9, 3.889271176483074*^9}, {3.889271671368741*^9, 
   3.8892716761920652`*^9}, {3.8892984917080355`*^9, 3.889298497147481*^9}, {
   3.889299025899432*^9, 3.8892990262666883`*^9}, {3.8892990824342227`*^9, 
   3.8892990841793103`*^9}, {3.8893000113935003`*^9, 3.8893000122249765`*^9}, 
   3.889300079417344*^9, {3.8893001987520847`*^9, 3.8893001994642334`*^9}, {
   3.8893002347077265`*^9, 3.889300253490049*^9}, {3.889300433809244*^9, 
   3.8893004373278675`*^9}, {3.889300665001961*^9, 3.889300666344548*^9}, {
   3.8896263653840384`*^9, 3.889626381263075*^9}, 3.889626553034603*^9, 
   3.8896270874329166`*^9, {3.8896283092540255`*^9, 3.889628320178583*^9}, {
   3.8896284051864367`*^9, 3.889628409015211*^9}, {3.889628711068329*^9, 
   3.889628744602418*^9}, {3.889628775574562*^9, 3.889628860259157*^9}, {
   3.889631027026637*^9, 3.889631045080316*^9}, {3.8896323872154226`*^9, 
   3.8896324026704783`*^9}, 3.8896325002865796`*^9, {3.88963433932853*^9, 
   3.889634341092704*^9}, {3.8896357081082597`*^9, 3.889635713796998*^9}, {
   3.889637830729537*^9, 3.889637845097272*^9}, {3.889639363752881*^9, 
   3.889639416105651*^9}, {3.8896405016035132`*^9, 3.8896405043986454`*^9}, {
   3.8900624436399183`*^9, 3.8900624453039713`*^9}, {3.890079325039683*^9, 
   3.890079325275359*^9}, 3.8908414594755945`*^9, 3.893341482697646*^9, {
   3.8933415266790247`*^9, 3.8933415268804913`*^9}, {3.899202241014969*^9, 
   3.899202262957304*^9}, 3.89920237959532*^9, {3.8992024323338294`*^9, 
   3.8992024522569113`*^9}, 3.899206310084524*^9, 3.8992202834815483`*^9, 
   3.8992203136434817`*^9, {3.899220359765911*^9, 3.8992203613443093`*^9}, {
   3.899220429432428*^9, 3.899220454702691*^9}, {3.899220487529214*^9, 
   3.899220507936672*^9}, {3.899374803558981*^9, 3.8993748282314806`*^9}, {
   3.899557466709652*^9, 3.899557470122573*^9}, {3.899557509467965*^9, 
   3.8995575246034822`*^9}, {3.89955765442939*^9, 3.899557685979661*^9}, {
   3.899557806933014*^9, 3.8995578424599476`*^9}, {3.8995579619788914`*^9, 
   3.8995579721326227`*^9}, {3.8995609256116114`*^9, 
   3.8995609276171155`*^9}, {3.8995627455622873`*^9, 
   3.8995627509617815`*^9}, {3.89956278648342*^9, 3.899563141250348*^9}, {
   3.899563818384906*^9, 3.899563818650485*^9}, {3.899646330167381*^9, 
   3.899646390254574*^9}, {3.8996464984959917`*^9, 3.899646498749995*^9}, {
   3.8996474536063213`*^9, 3.8996474927254467`*^9}, {3.899647650990716*^9, 
   3.8996476804226027`*^9}, {3.899647717199506*^9, 3.8996477172503843`*^9}, {
   3.899647805638623*^9, 3.89964783014968*^9}, {3.8996478700475435`*^9, 
   3.899647870109435*^9}, {3.899647907966834*^9, 3.899647924304105*^9}, 
   3.8996480139189463`*^9, {3.8996481246630893`*^9, 3.8996481878219767`*^9}, {
   3.899648231279888*^9, 3.899648247957853*^9}, {3.89964828635168*^9, 
   3.8996483056714597`*^9}, {3.899648371287648*^9, 3.8996483715425043`*^9}, 
   3.899650229141876*^9, 3.8999205364587836`*^9, {3.8999980538873672`*^9, 
   3.899998060108676*^9}, {3.900006450815503*^9, 3.900006450949202*^9}, 
   3.9000542438047037`*^9, {3.9000589648849583`*^9, 3.900058965059539*^9}, {
   3.900059086452855*^9, 3.9000591101788545`*^9}, 3.9000591537592735`*^9, {
   3.9000592068682823`*^9, 3.9000592071335793`*^9}, {3.9000592407417765`*^9, 
   3.900059286683861*^9}, {3.9000594980451393`*^9, 3.9000594982207193`*^9}, {
   3.900262667167068*^9, 3.9002626719472494`*^9}, 3.9002627475007696`*^9, {
   3.9002628669491606`*^9, 3.900262867146632*^9}, 3.9002640346829295`*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"723cd10a-e7ff-40f3-8194-2483d79a14d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 
  3.8896286009554386`*^9}},ExpressionUUID->"43b50310-13f9-4cb4-9794-\
f4b2ab715bb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"backgroundBias", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"checkMasks", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Parallelize", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
               RowBox[{"getCheckMask", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"ImageAdjust", "@", 
                    RowBox[{"preprocessImage", "@", 
                    RowBox[{"ColorNegate", "@", "\[IndentingNewLine]", 
                    RowBox[{"imageInversionSwitch", "[", 
                    RowBox[{"#", ",", "switchIndex"}], "]"}]}]}]}], "&"}], 
                  "@", "#1"}], ",", "\[IndentingNewLine]", "#2", ",", "#3"}], 
                "]"}]}], ")"}], "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
             "swarmWindowsUnified", ",", "swarmWindowCoreMasksUnified", ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"switchIndex", "+", "1"}], "]"}], "]"}], "&"}], "@", 
               RowBox[{"Transpose", "@", "swarmWindowMasksClean"}]}]}], 
             "\[IndentingNewLine]", "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"switchIndex", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"2", "*", 
        RowBox[{"Length", "@", "swarmWindowsUnified"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"criterionValuesWindow", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<MeanIntensity\>\"", ",", "\"\<MaxIntensity\>\""}],
                "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "/@", 
         RowBox[{"checkMasks", "[", 
          RowBox[{"[", "branch", "]"}], "]"}]}], "//", "Parallelize"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"branch", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"falsePositiveIDsWindow", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", ">", 
            RowBox[{
             RowBox[{"Mean", "@", 
              RowBox[{"criterionValuesWindow", "[", 
               RowBox[{"[", 
                RowBox[{"branch", ",", "k"}], "]"}], "]"}]}], "*", 
             RowBox[{"intensityThresholdGlobal", "[", 
              RowBox[{"[", "branch", "]"}], "]"}]}]}], "&"}], "/@", 
          RowBox[{"criterionValuesWindow", "[", 
           RowBox[{"[", 
            RowBox[{"branch", ",", "k"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "False"}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"Transpose", "@", "criterionValuesWindow"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"branch", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"segmentImagesWindow", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}], "&"}], "/@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"Parallelize", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"monitorCounter", "++"}], ";", 
                 RowBox[{"ImageMultiply", "[", 
                  RowBox[{
                   RowBox[{"ColorNegate", "@", "#1"}], ",", 
                   RowBox[{"FillingTransform", "@", "#2"}]}], "]"}]}], ")"}], 
               "&"}], ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
               "swarmWindowCoreMasksUnified", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "branch", "]"}], "]"}], "&"}], "@", 
                 RowBox[{"Transpose", "@", "swarmWindowMasksClean"}]}]}], 
               "\[IndentingNewLine]", "}"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"branch", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"2", "*", 
        RowBox[{"Length", "@", "swarmWindowMasksClean"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trueWindowParticleMasks", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Parallelize", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{
                RowBox[{
                 RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
                  RowBox[{"#1", ",", 
                   RowBox[{"ColorNegate", "@", 
                    RowBox[{"DeleteSmallComponents", "@", 
                    RowBox[{"Binarize", "@", 
                    RowBox[{"ImageAdd", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}]}]}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], "@@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"Head", "@", "#"}]}], "==", 
                    "\"\<SparseArray\>\""}], ",", 
                    RowBox[{"Image", "@", "#"}], ",", "placeholderSW"}], 
                    "]"}], "&"}], "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{"Last", "/@", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "]"}]}], ",", "#3"}], 
                 "\[IndentingNewLine]", "}"}]}]}], ")"}], "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"segmentImagesWindow", "[", 
               RowBox[{"[", "branch", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"falsePositiveIDsWindow", "[", 
               RowBox[{"[", "branch", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "swarmWindowCoreMasksUnified"}], 
             "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"branch", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"2", "*", 
       RowBox[{"Length", "@", 
        RowBox[{"Transpose", "@", "segmentImagesWindow"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8896345660457954`*^9, 3.889634603779217*^9}, 
   3.889638420901389*^9, {3.889638813868167*^9, 3.889638850872348*^9}, {
   3.8896389316234646`*^9, 3.889639026023899*^9}, {3.889639056505953*^9, 
   3.889639088424652*^9}, {3.8896391552636323`*^9, 3.8896392706398535`*^9}, {
   3.889639434935817*^9, 3.8896394370618877`*^9}, {3.8896395043688116`*^9, 
   3.8896395085112534`*^9}, {3.889639610473948*^9, 3.889639613135307*^9}, {
   3.8896398697269993`*^9, 3.889639912133737*^9}, {3.8896403128080235`*^9, 
   3.889640318550643*^9}, {3.8896414274947295`*^9, 3.889641428104889*^9}, {
   3.8896414993150406`*^9, 3.8896414999414787`*^9}, {3.89084090627608*^9, 
   3.890840929963107*^9}, {3.8908410079739885`*^9, 3.8908410460592813`*^9}, {
   3.890841114396553*^9, 3.8908411206997995`*^9}, {3.890841496054123*^9, 
   3.8908415342521753`*^9}, {3.8908416715802393`*^9, 
   3.8908417241507845`*^9}, {3.890841762404753*^9, 3.8908417948032827`*^9}, {
   3.899220843911728*^9, 3.899220851599118*^9}, 3.8992210243335743`*^9, 
   3.8992224971201086`*^9, 3.8995637480646996`*^9, {3.8995637798702946`*^9, 
   3.8995637807246833`*^9}, {3.89956389839431*^9, 3.899564006569865*^9}, {
   3.8995640530100718`*^9, 3.8995641032096605`*^9}, {3.8995641713511624`*^9, 
   3.899564179770295*^9}, {3.899564226265325*^9, 3.8995642324162188`*^9}, {
   3.8995642795897384`*^9, 3.899564283041705*^9}, {3.899564527459239*^9, 
   3.899564530728221*^9}, {3.899565253955246*^9, 3.899565257052108*^9}, 
   3.899646428054722*^9, {3.8996464905988703`*^9, 3.899646491022212*^9}, {
   3.8996471336609025`*^9, 3.8996471456046133`*^9}, {3.8999207184287167`*^9, 
   3.899920734035547*^9}, {3.9000595294542537`*^9, 3.900059530551253*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"1b856a0e-ec21-466a-8430-3480b3500e6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clear Unneeded Data from Memory", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085456415696`*^9}, {3.8929183936404963`*^9, 
  3.8929184140097203`*^9}},ExpressionUUID->"38bc1c47-249a-40ad-b73b-\
92919eb8487e"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "swarmWindowMasks", ",", "segmentImagesWindow", ",", 
      "falsePositiveIDsWindow", ",", "\[IndentingNewLine]", 
      "criterionValuesWindow", ",", "checkMasks"}], "\[IndentingNewLine]", 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, {
   3.8964388163994665`*^9, 3.8964388236567764`*^9}, {3.8964412521369915`*^9, 
   3.896441307461975*^9}, {3.8999982500871267`*^9, 3.8999982540644875`*^9}, {
   3.9000619647134647`*^9, 3.9000619657203836`*^9}, 3.910457858125843*^9},
 CellLabel->
  "In[314]:=",ExpressionUUID->"5b48f1e9-68e3-454c-a2b1-b88e346a9c7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview True SW Bacteria Mask Overlays ]]", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415678927536`*^9}, {3.893143929279602*^9, 3.89314392975134*^9}, 
   3.8996649488158417`*^9},ExpressionUUID->"cb9cb365-5d95-4cf3-be6e-\
e7e5f57e1f38"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"previewTrueParticleMask", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trueWindowParticleMasks", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "#"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"swarmWindowMasksClean", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "#"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"swarmWindowCoreMasksUnified", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"reducedSwarmWindowsUnified", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"ImageCollage", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "3"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "trueWindowParticleMasks"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8995671888494043`*^9, 3.899567247294736*^9}, {
  3.8995672848636103`*^9, 3.8995673683601875`*^9}, {3.8996208368170223`*^9, 
  3.8996208639994392`*^9}, {3.8996505881019726`*^9, 3.899650646508358*^9}, {
  3.8996507238138313`*^9, 3.899650736129855*^9}, {3.9104579652700157`*^9, 
  3.91045796641296*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"6fe10b9f-c9a2-4ce3-9826-837148d395ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate True SW Bacteria Mask Overlays", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.8931439309995537`*^9, 3.893143931783169*^9}, 
   3.8996649495598965`*^9},ExpressionUUID->"468840de-c5d9-467d-9cd0-\
b8a2cda4e9db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"trueParticleMaskOverlays", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Parallelize", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"previewTrueParticleMask", "@@", "#"}], "&"}], "@", 
            RowBox[{"(", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "branch", "]"}], "]"}], ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "branch", "]"}], "]"}], ",", "#3", ",", "#4"}], 
              "}"}], ")"}]}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "trueWindowParticleMasks", ",", "swarmWindowMasksClean", ",", 
            "\[IndentingNewLine]", "swarmWindowCoreMasksUnified", ",", 
            "reducedSwarmWindowsUnified"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"branch", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{
  3.8896415337896233`*^9, {3.8900624823807044`*^9, 3.89006248385288*^9}, {
   3.8908792922198353`*^9, 3.890879293128294*^9}, 3.8992770824544983`*^9, {
   3.8995674213268566`*^9, 3.8995674821136775`*^9}, {3.899567516945344*^9, 
   3.899567523128095*^9}},
 CellLabel->
  "In[2615]:=",ExpressionUUID->"2c8d9ccc-7fe0-4965-ba55-2481c318708d"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageCollage", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "3"}]}], "]"}], "&"}], "@", 
    RowBox[{"trueParticleMaskOverlays", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "trueParticleMaskOverlays"}], ",", "1"}], "}"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890067278339163*^9, 3.890067304546934*^9}, {
  3.8995675389245963`*^9, 3.8995676189211655`*^9}},
 CellLabel->
  "In[2616]:=",ExpressionUUID->"0b34abd2-77b3-4af7-be1d-624e87e48e7d"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export True SW Bacteria Masks >>", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900673770763755`*^9, 3.8900673775939507`*^9}, {3.89314393512727*^9, 
   3.8931439356071644`*^9}, 
   3.8996649505442605`*^9},ExpressionUUID->"9914d55c-4689-4ec6-92da-\
90a460f47a35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trueParticleMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<8 True Swarm Window Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDirectory", "@", "trueParticleMaskFolder"}], ";"}], "//", 
  "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"compressedTrueWindowParticleMasks", "=", 
    RowBox[{
     RowBox[{"Compress", "/@", "trueWindowParticleMasks"}], "//", 
     "Parallelize"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"exportImageSequence", "[", 
  RowBox[{
  "compressedTrueWindowParticleMasks", ",", "trueParticleMaskFolder", ",", 
   "\"\<.txt\>\"", ",", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.889985262799727*^9, 3.889985320750323*^9}, {
   3.889985373639123*^9, 3.8899853921340113`*^9}, {3.8899854847759438`*^9, 
   3.889985508653075*^9}, {3.8899855433550973`*^9, 3.8899856288065205`*^9}, {
   3.889985671143424*^9, 3.889985677889139*^9}, {3.889985718845848*^9, 
   3.889985721589868*^9}, {3.889986022392525*^9, 3.8899860249813004`*^9}, {
   3.8900487724354897`*^9, 3.8900487783883667`*^9}, {3.890051398200904*^9, 
   3.8900514032402954`*^9}, 3.8900514557410316`*^9, 3.8900515185737286`*^9, 
   3.890062574583122*^9, {3.890067374062076*^9, 3.890067375171962*^9}, {
   3.890592728699006*^9, 3.890592729318866*^9}, 3.8908418584736886`*^9, 
   3.8908419176899056`*^9, {3.900061944697034*^9, 3.9000619453848186`*^9}, {
   3.900250840052816*^9, 3.9002508412864637`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"695572eb-64b3-4c70-b088-9cb8c00d0bb6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clear Unneeded Data from Memory", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085456415696`*^9}, {3.8929183936404963`*^9, 
  3.8929184140097203`*^9}},ExpressionUUID->"76d3641c-15ef-4437-8606-\
68d75d24c532"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "compressedTrueWindowParticleMasks", ",", "swarmWindowMasksClean"}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, 
   3.8933587173424263`*^9, 3.8933587609259243`*^9, {3.8964413464251966`*^9, 
   3.8964413610482225`*^9}, {3.8999983457722073`*^9, 3.899998351190716*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"409d9484-40dd-4a74-9d0d-91d3442f2269"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import True SW Bacteria Masks  <<", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
   3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861530450916`*^9}, {
   3.8931439366477146`*^9, 3.89314393706353*^9}, 
   3.8996649516233683`*^9},ExpressionUUID->"fc2f9c25-b75a-4812-b622-\
3251c08b970d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trueParticleMaskFolder", "=", 
    RowBox[{"output", "<>", "\"\<8 True Swarm Window Masks\\\\\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "trueParticleMaskFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"trueWindowParticleMasks", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"trueParticleMaskFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8892930799576654`*^9, 3.88929312647618*^9}, {3.8899861898802996`*^9, 
   3.889986199007452*^9}, 3.8899862330387692`*^9, {3.8899865637821603`*^9, 
   3.889986565750928*^9}, {3.8905927341689577`*^9, 3.890592735149336*^9}, {
   3.8934061002978725`*^9, 3.8934061265005627`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"3f61d063-e1eb-4de2-bfad-2d6c24b55ef3"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swarm Core Tracking", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.8890423778257504`*^9, 3.889042384505704*^9}, {3.889641809228165*^9, 
  3.8896418544529057`*^9}},ExpressionUUID->"fdfbaa42-ba02-4943-a7e0-\
e0f311d48a9f"],

Cell[CellGroupData[{

Cell["Nearest Neighbor Tracking", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 
  3.8901316270606*^9}},ExpressionUUID->"fc172672-e836-4f70-b13f-2f62b1fbf290"],

Cell["\<\
Defaults :
   
motionThreshold=25;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}},
 FontSize->16,ExpressionUUID->"8b5c0137-095b-4b8b-8c1e-1ea74eae8360"],

Cell[BoxData[
 RowBox[{
  RowBox[{"motionThreshold", "=", "55"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890120843901436*^9, 3.890120904244889*^9}, {
   3.8901209450900283`*^9, 3.890120946571348*^9}, {3.890122984319893*^9, 
   3.890122986920873*^9}, {3.890123972255765*^9, 3.8901239812237415`*^9}, {
   3.8901286047546916`*^9, 3.890128617816607*^9}, {3.8905933876064982`*^9, 
   3.8905934097210183`*^9}, {3.892888572138487*^9, 3.8928886439450073`*^9}, {
   3.89288867921037*^9, 3.8928886948808603`*^9}, {3.8928934734380713`*^9, 
   3.892893475158003*^9}, {3.899621115166462*^9, 3.899621126726269*^9}, {
   3.899809797229292*^9, 3.899809807661023*^9}, {3.899809859365857*^9, 
   3.89980987282913*^9}, 3.9000459223038635`*^9, {3.9000460974853687`*^9, 
   3.9000461181971183`*^9}, {3.900047471229046*^9, 3.9000474712918773`*^9}, {
   3.900047521853744*^9, 3.900047522092066*^9}, {3.900047642997147*^9, 
   3.900047643253462*^9}, {3.9000476988209467`*^9, 3.900047735516001*^9}, 
   3.9000884802620645`*^9, {3.9000886592531214`*^9, 3.9000886680371304`*^9}, {
   3.900090509211933*^9, 3.900090515426762*^9}, {3.900091936146394*^9, 
   3.9000919363618402`*^9}, {3.900092058709553*^9, 3.90009205893095*^9}, {
   3.9000923348506317`*^9, 3.9000923364492006`*^9}, {3.900093319675212*^9, 
   3.900093349631632*^9}, {3.9000933926968393`*^9, 3.9000934164642553`*^9}, {
   3.900093537297714*^9, 3.900093541545133*^9}, {3.900094822369808*^9, 
   3.900094876032826*^9}, 3.900095412465242*^9, 3.9000954557195616`*^9, 
   3.9000956755426216`*^9, {3.9000957923188176`*^9, 3.900095793346131*^9}, {
   3.9000961070223875`*^9, 3.9000961143902287`*^9}, 3.900096191838406*^9, 
   3.900097210277793*^9, {3.9000973865575647`*^9, 3.9000973888454237`*^9}, 
   3.90009742527022*^9, 3.9001057592020116`*^9, 3.9001060840472345`*^9, {
   3.9001434989365644`*^9, 3.9001435000484114`*^9}, {3.900264963298522*^9, 
   3.900264963954007*^9}, {3.9002674562974343`*^9, 3.9002674755220814`*^9}, {
   3.900268127216963*^9, 3.900268146639017*^9}, {3.900268202303647*^9, 
   3.9002682177603607`*^9}, {3.900268262808874*^9, 3.900268263471103*^9}, {
   3.9002683356102085`*^9, 3.90026835651132*^9}, {3.900325008715393*^9, 
   3.9003250184822206`*^9}, {3.900398773213009*^9, 3.900398816298752*^9}, {
   3.90039898014942*^9, 3.9003990106096315`*^9}, {3.9004145482139564`*^9, 
   3.900414548348624*^9}, 3.9004276405890713`*^9, 3.9004282919139214`*^9, {
   3.900477260199849*^9, 3.900477267508355*^9}, {3.900477366924247*^9, 
   3.900477390811407*^9}, {3.900477461788267*^9, 3.9004774724915886`*^9}, {
   3.9004775397318025`*^9, 3.9004775497639694`*^9}, {3.9004780329109135`*^9, 
   3.9004780329627748`*^9}, {3.900478125660155*^9, 3.9004781532503815`*^9}, {
   3.9004784768362713`*^9, 3.9004785042020264`*^9}, {3.900491398658142*^9, 
   3.90049140842603*^9}, {3.900491441282195*^9, 3.900491441392842*^9}, {
   3.9004914860429854`*^9, 3.9004914861048203`*^9}, {3.90049174118616*^9, 
   3.9004917479690094`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"b0a3a0f8-fdc3-4d40-b272-a7b37f6d4816"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmCentroids", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}], "&"}], "@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"Last", "/@", "#"}]}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"swarmData", ",", 
           RowBox[{
            RowBox[{"#", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmTracks", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ReverseSortBy", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"getNearestNeighborTracks", "[", 
       RowBox[{"swarmCentroids", ",", "motionThreshold"}], "]"}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracks", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "swarmTracks"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Last", "@", 
     RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "swarmTracks"}], "//", 
  "ListLinePlot"}]}], "Input",
 CellChangeTimes->{{3.890120843901436*^9, 3.890120904244889*^9}, {
   3.8901209450900283`*^9, 3.890120946571348*^9}, {3.890122984319893*^9, 
   3.890122986920873*^9}, {3.890123972255765*^9, 3.8901239812237415`*^9}, {
   3.8901286047546916`*^9, 3.8901287006088676`*^9}, {3.8901293549177856`*^9, 
   3.8901293621559877`*^9}, {3.890129570188591*^9, 3.8901295924425325`*^9}, 
   3.890129683063048*^9, {3.8901297243387337`*^9, 3.8901297251124115`*^9}, {
   3.8901318707032075`*^9, 3.890131881365754*^9}, {3.8901321215909576`*^9, 
   3.890132136182907*^9}, 3.890204878146126*^9, {3.8902049590910654`*^9, 
   3.89020500490382*^9}, {3.8902050551294765`*^9, 3.8902051028545494`*^9}, {
   3.8902057132659254`*^9, 3.8902058842394295`*^9}, {3.8902066301669025`*^9, 
   3.8902066789474792`*^9}, 3.8905933145935564`*^9, {3.8905934262070227`*^9, 
   3.8905934267698927`*^9}, 3.8905935512654467`*^9, {3.890719686646451*^9, 
   3.8907196900235996`*^9}, {3.8907257322382917`*^9, 3.890725754649699*^9}, {
   3.8907257928568935`*^9, 3.890725934724451*^9}, {3.8907261232773523`*^9, 
   3.8907261564574995`*^9}, {3.8907262331656075`*^9, 3.890726287585987*^9}, {
   3.890726338558351*^9, 3.8907263390884204`*^9}, {3.89072643028997*^9, 
   3.890726444787242*^9}, {3.890842021155409*^9, 3.890842036563617*^9}, {
   3.8908424513633623`*^9, 3.890842471957111*^9}, {3.8908426636360474`*^9, 
   3.89084270443408*^9}, {3.8908427349748344`*^9, 3.8908427777798676`*^9}, {
   3.8908429459146695`*^9, 3.890842993563224*^9}, {3.8928885804997015`*^9, 
   3.892888588832988*^9}, {3.8928933671992083`*^9, 3.8928933914714336`*^9}, {
   3.892893457239046*^9, 3.8928934898243093`*^9}, {3.8929131568037825`*^9, 
   3.892913157787938*^9}, {3.893406484482804*^9, 3.8934064904165506`*^9}, {
   3.8934065241860924`*^9, 3.893406572793205*^9}, {3.9000883004153843`*^9, 
   3.900088303876607*^9}, {3.900088352752638*^9, 3.900088354772605*^9}, 
   3.9000918283310504`*^9, {3.9000947242762284`*^9, 3.900094736101893*^9}, {
   3.900094807297668*^9, 3.9000948129830294`*^9}, {3.900264880315358*^9, 
   3.900264975373167*^9}, 3.9003980188986206`*^9, {3.9004780547026286`*^9, 
   3.9004780806791544`*^9}, {3.900478157108097*^9, 3.9004781572516603`*^9}, {
   3.9006901022209115`*^9, 3.9006901025475636`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"6d28f2bf-3816-4dc2-84c2-2ec4805e2670"]
}, Closed]],

Cell[CellGroupData[{

Cell["Track Refinement (\[Delta]t > 1)", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.900268906742897*^9, 
  3.900268942742613*^9}},ExpressionUUID->"1369174f-b343-4f40-94cb-\
e02bdb44da07"],

Cell["\<\
Last working config:

singletRemovalThreshold=0;

runParameters=Join[
{0,2,#}&/@{55},
{1,6,#}&/@{55,65,70}
]\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, 3.900265210171418*^9, 
   3.9004080272102995`*^9, {3.9005691576501884`*^9, 3.9005692341363425`*^9}, {
   3.9005751484783916`*^9, 3.900575151829876*^9}, 3.9005752516464343`*^9, 
   3.9005811586028366`*^9, {3.9005861093764315`*^9, 3.900586124174613*^9}, 
   3.900590521891239*^9},
 FontSize->16,ExpressionUUID->"87d53ac9-644e-4866-9358-6a6fb72a8236"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"singletRemovalThreshold", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"runParameters", "=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "#"}], "}"}], "&"}], "/@", 
     RowBox[{"{", "55", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "6", ",", "#"}], "}"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"55", ",", "65", ",", "70"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9005176508851247`*^9, 3.900517700794817*^9}, {
   3.9005178261971636`*^9, 3.9005178415949373`*^9}, {3.9005179945199738`*^9, 
   3.900518007563015*^9}, {3.900518105420293*^9, 3.9005181203635774`*^9}, {
   3.900531831113387*^9, 3.9005318469570217`*^9}, {3.9005321073339925`*^9, 
   3.900532109994667*^9}, {3.9005321947208414`*^9, 3.9005321958528476`*^9}, {
   3.900532279919711*^9, 3.9005323321896467`*^9}, {3.900532366415073*^9, 
   3.900532368557638*^9}, {3.9005324350542135`*^9, 3.900532435847437*^9}, {
   3.900532949558832*^9, 3.9005329497017083`*^9}, {3.90053325919941*^9, 
   3.9005332619183445`*^9}, {3.900570001252911*^9, 3.900570002610753*^9}, {
   3.9005701999472804`*^9, 3.9005702062593718`*^9}, {3.9005747593035355`*^9, 
   3.9005747758471537`*^9}, 3.900574963335165*^9, {3.9005751242170815`*^9, 
   3.9005751252443247`*^9}, 3.900575241219746*^9, {3.900581036823209*^9, 
   3.900581037836811*^9}, {3.9005811564537106`*^9, 3.90058116223007*^9}, {
   3.9005812597080193`*^9, 3.9005812598427362`*^9}, {3.9005818550809937`*^9, 
   3.900581872708151*^9}, {3.900581946973035*^9, 3.9005819502922077`*^9}, {
   3.900583791158499*^9, 3.900583824237439*^9}, {3.900584987974312*^9, 
   3.900584988155039*^9}, {3.9005851575439205`*^9, 3.9005851696204276`*^9}, {
   3.9005854051059637`*^9, 3.900585459984561*^9}, {3.9005856758568034`*^9, 
   3.9005856782943287`*^9}, {3.9005859075835505`*^9, 3.900585925770328*^9}, {
   3.9005860057200384`*^9, 3.9005860058153853`*^9}, {3.900586099096962*^9, 
   3.9005861315034657`*^9}, {3.900586217916505*^9, 3.9005862219454193`*^9}, {
   3.900586260120139*^9, 3.900586260254857*^9}},
 CellLabel->
  "In[880]:=",ExpressionUUID->"d9e19acd-600e-4002-957f-4c43cc9c18cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"swarmTracksUpdated", ",", "runConvergence"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"runTrackRefinement", "[", 
       RowBox[{"swarmTracks", ",", "#"}], "]"}], "&"}], "@", 
     "runParameters"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}]}], "&"}], "@", 
     RowBox[{"Last", "@", "runConvergence"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<n\>\"", ",", "\"\<N\>\""}], "}"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MeshStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"PointSize", "@", "0.01"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "swarmTracksUpdated"}]}], "Input",
 CellChangeTimes->{{3.900264574761524*^9, 3.900264588506133*^9}, {
   3.900265078498198*^9, 3.9002651006980076`*^9}, {3.9002651835796056`*^9, 
   3.9002651880172977`*^9}, {3.900477583901711*^9, 3.900477612036512*^9}, {
   3.900477645477172*^9, 3.9004776685250206`*^9}, {3.9004784024295187`*^9, 
   3.9004784041629333`*^9}, {3.900478859596779*^9, 3.9004788612224293`*^9}, {
   3.9004803284351263`*^9, 3.9004803309616885`*^9}, {3.900514770072656*^9, 
   3.9005147790688515`*^9}, {3.9005167128832483`*^9, 3.9005167169218454`*^9}, 
   3.9005696017854047`*^9, {3.9005758655673695`*^9, 3.900575871189328*^9}, {
   3.9005855495931225`*^9, 3.9005855668301706`*^9}, 3.9005856724481277`*^9, 
   3.9005858512900267`*^9, {3.900585931025942*^9, 3.900585932478716*^9}},
 CellLabel->
  "In[882]:=",ExpressionUUID->"95721ba8-2caa-40d4-ab8d-b8cd9c914aa1"],

Cell["\<\
Defaults :
   
trackLengthThreshold=50;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.900408037816942*^9, 3.9004080378737907`*^9}},
 FontSize->16,ExpressionUUID->"0efc279a-8592-4c13-9be8-c138e4cce637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trackLengthThreshold", "=", "50"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.900265223740287*^9, 3.9002652238420725`*^9}, {
   3.9002652677069597`*^9, 3.900265267987208*^9}, {3.9002675284405465`*^9, 
   3.900267530256688*^9}, {3.9002684600176954`*^9, 3.9002684818871536`*^9}, {
   3.900325031523388*^9, 3.9003250325636487`*^9}, {3.9003268661698914`*^9, 
   3.9003268663853145`*^9}, 3.900398170171976*^9, {3.900399040946347*^9, 
   3.900399079397722*^9}, 3.9004011594957705`*^9, 3.9004039296796713`*^9, {
   3.9004137348352566`*^9, 3.900413735718841*^9}, {3.9004146355179515`*^9, 
   3.9004146357443457`*^9}, {3.9004276599951105`*^9, 
   3.9004276661895494`*^9}, {3.90043417583022*^9, 3.9004341772125235`*^9}, {
   3.900477707221244*^9, 3.900477707596242*^9}, {3.9004777840126357`*^9, 
   3.900477784978941*^9}, {3.900478313462046*^9, 3.900478313674477*^9}, {
   3.9004885524831915`*^9, 3.9004885592422967`*^9}, {3.9004885991233125`*^9, 
   3.9004885992828856`*^9}, {3.90048937953327*^9, 3.9004893894507923`*^9}, 
   3.900490671020129*^9, {3.9005765784098663`*^9, 3.9005765786073084`*^9}, {
   3.9005813461568565`*^9, 3.900581346227949*^9}, {3.900583534710637*^9, 
   3.900583534945099*^9}, 3.9005849422319417`*^9, {3.9005895108026896`*^9, 
   3.900589510992714*^9}, {3.900589545690627*^9, 3.9005895457177496`*^9}},
 CellLabel->
  "In[954]:=",ExpressionUUID->"32856db7-80b1-4b51-8025-dbc733069e3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"swarmTracksClean", ",", "swarmTrackTimestamps"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", "#"}], "&"}], "/@", "#"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "/@", "#"}], "&"}], "/@", "#"}]}], 
       "\[IndentingNewLine]", "}"}], "&"}], "@", 
     RowBox[{"Select", "[", 
      RowBox[{"swarmTracksUpdated", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], "&"}]}],
       "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracksClean", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "swarmTracksClean"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracksClean", "//", "ListLinePlot"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmTracksCleanReferenceCentroids", "=", "swarmTracksClean"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.900265157003474*^9, {3.900265254169712*^9, 3.900265257667534*^9}, {
   3.9002723300605135`*^9, 3.9002723311954775`*^9}, {3.900276473937078*^9, 
   3.9002765126106815`*^9}, {3.9002766672749653`*^9, 3.900276675207779*^9}, {
   3.9004020173946323`*^9, 3.9004020182473516`*^9}, {3.900477718404358*^9, 
   3.9004777258943596`*^9}, {3.900477969428753*^9, 3.9004780098296986`*^9}, {
   3.9004782258374043`*^9, 3.900478246002471*^9}, 3.900478289238835*^9, {
   3.9004894723390446`*^9, 3.9004894836517878`*^9}, {3.9004895392590704`*^9, 
   3.9004895446113625`*^9}, {3.9004896117887173`*^9, 3.9004896211536837`*^9}, 
   3.90048967275065*^9, 3.900491461650225*^9},
 CellLabel->
  "In[955]:=",ExpressionUUID->"7df6dadb-652c-4b81-a18b-0c8dd2a94c49"],

Cell[CellGroupData[{

Cell["(Optional) Play \[OpenCurlyDoubleQuote]Connect \
4\[CloseCurlyDoubleQuote]", "Subsubsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.900268906742897*^9, 3.900268942742613*^9}, {3.9002689879417343`*^9, 
  3.90026902638291*^9}, {3.900585970382126*^9, 
  3.9005859809451685`*^9}},ExpressionUUID->"328a5ed3-6445-4def-ab8b-\
382f16f7330b"],

Cell["\<\
Defaults :
   
trackLengthThresholdSecondary=50;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.900408037816942*^9, 3.9004080378737907`*^9}, 
   3.9005933989644566`*^9},
 FontSize->16,ExpressionUUID->"fc1dce01-5299-44f4-83b5-6f8cabe82142"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testPlotRange", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "#"}], "}"}], "&"}], "/@", 
     RowBox[{"ImageDimensions", "@", 
      RowBox[{"First", "@", "reducedImages"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackLengthThresholdSecondary", "=", "50"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9005844840025525`*^9, 3.9005844926721487`*^9}, 
   3.9005849074398165`*^9, {3.9005891493207645`*^9, 3.900589149534374*^9}, {
   3.9005902442044826`*^9, 3.9005902456548667`*^9}, {3.900593367351808*^9, 
   3.9005933959004517`*^9}},
 CellLabel->
  "In[960]:=",ExpressionUUID->"04d5e1bf-cdde-4a70-ab9b-c2518e429cdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testTrackDataRecombined", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"swarmTrackTimestamps", ",", "swarmTracksClean"}], "}"}]}], 
      "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"testTrackTimeBounds", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", "#"}]}], ",", "#"}], "}"}]}], "&"}], "@", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", 
              RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
           RowBox[{"First", "@", 
            RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}]}], "&"}], "@", 
       RowBox[{"Select", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "#"}], ">", 
           "trackLengthThresholdSecondary"}], "&"}]}], "]"}]}], "&"}], "@", 
     "testTrackDataRecombined"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.9005814928600273`*^9, 3.900581570596055*^9}, {
  3.900581790180251*^9, 3.90058179234153*^9}, {3.900582977607233*^9, 
  3.9005829966327205`*^9}, {3.9005861510486007`*^9, 3.9005861558626747`*^9}, {
  3.9005864115705185`*^9, 3.900586412174739*^9}, {3.9005943548570967`*^9, 
  3.900594356436125*^9}},
 CellLabel->
  "In[962]:=",ExpressionUUID->"b8bbc80c-e9a4-4327-ab99-c8b2fbebb82c"],

Cell["\<\
11_all
------------------------------
Events: 
8 + 9 = merge -> {1, 2, 3, 4, 6, 9, 10} + 8 -> 1 + 5

testReconnectIDs={
{1,2,3,4,6,9,10},
{12,13}
};\
\>", "Abstract",
 CellChangeTimes->{{3.9005901405675306`*^9, 3.9005902124858313`*^9}, 
   3.900590499316046*^9, {3.900595679867166*^9, 3.9005956926622615`*^9}},
 FontSize->16,ExpressionUUID->"d9b4e6fe-d7c7-49ab-ad35-7af77c345a6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testReconnectIDs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "9", ",", "10"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9005836986546516`*^9, 3.9005837239578176`*^9}, {
   3.9005840833818502`*^9, 3.900584108336729*^9}, {3.900584336334301*^9, 
   3.9005843366169596`*^9}, 3.900584423631647*^9, {3.900584497846469*^9, 
   3.900584542686799*^9}, {3.900584621636197*^9, 3.900584651565055*^9}, {
   3.9005848159654784`*^9, 3.900584840555088*^9}, 3.9005849232334595`*^9, {
   3.900588250797263*^9, 3.900588250928562*^9}, {3.900589137306457*^9, 
   3.900589155528805*^9}, {3.900590067157936*^9, 3.900590122852672*^9}, 
   3.900590491737465*^9},
 CellLabel->
  "In[974]:=",ExpressionUUID->"c2778ef1-ee56-402b-b62a-86062fed4009"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testTrackMergeGroups", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], "/@", 
        RowBox[{"Delete", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "testTrackTimeBounds"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", "#"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    "testReconnectIDs"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmTracksAssembled", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReverseSortBy", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Catenate", "@", 
        RowBox[{"testTrackDataRecombined", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
      "testTrackMergeGroups"}], "\[IndentingNewLine]", ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9005909391425037`*^9, 3.9005910409171047`*^9}, {
  3.9005943765417795`*^9, 3.900594389781252*^9}},
 CellLabel->
  "In[975]:=",ExpressionUUID->"08ef12d2-6ca2-40ff-846b-205232769570"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"swarmTracksClean", ",", "swarmTrackTimestamps"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", "#"}], "&"}], "/@", "#"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "/@", "#"}], "&"}], "/@", "#"}]}], 
       "\[IndentingNewLine]", "}"}], "&"}], "@", "swarmTracksAssembled"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "swarmTracksClean"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmTracksClean", "//", "ListLinePlot"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allReferenceRecoveredTracks", "=", "swarmTracksClean"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9005943945342917`*^9, 3.9005943987130313`*^9}, {
  3.9005944948779335`*^9, 3.900594499775468*^9}, {3.9005947731745024`*^9, 
  3.900594781765686*^9}},
 CellLabel->
  "In[977]:=",ExpressionUUID->"e6775987-482b-4f68-9370-1bb9cffcff92"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", 
              RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "testReconnectIDs", "]"}], "]"}]}], "&"}], "@", 
          RowBox[{"SortBy", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}]}], "&"}], "@", 
        RowBox[{"Select", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "#"}], ">", "50"}], "&"}]}], "]"}]}], 
       "&"}], "@", "testTrackDataRecombined"}], "//", 
     RowBox[{
     "ListLinePlot", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "testTrackVisuals"}]}], "=", 
    RowBox[{"Join", "@@", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "testReconnectIDs", "]"}], "]"}]}], "&"}], "@", 
           RowBox[{"SortBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"First", "@", "#"}]}], "&"}]}], "]"}]}], "&"}], "@", 
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], ">", "50"}], "&"}]}], "]"}]}], 
        "&"}], "@", "testTrackDataRecombined"}], "\[IndentingNewLine]", 
      "]"}]}]}], ";", "\n", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testTrackVisuals", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "k"}], "]"}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "testPlotRange"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "testTrackVisuals"}], ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9005836986546516`*^9, 3.9005837239578176`*^9}, {
   3.9005840833818502`*^9, 3.900584108336729*^9}, {3.900584336334301*^9, 
   3.9005843366169596`*^9}, 3.900584423631647*^9, {3.900584497846469*^9, 
   3.900584542686799*^9}, {3.900584621636197*^9, 3.900584661238422*^9}, {
   3.9005847330795302`*^9, 3.900584749957673*^9}, {3.900584787098342*^9, 
   3.900584796360524*^9}, {3.900584845698696*^9, 3.900584846730665*^9}, {
   3.90059025297958*^9, 3.9005902719395437`*^9}, 
   3.9005944424149666`*^9},ExpressionUUID->"4108188a-4b2c-4e6a-983c-\
02eb609923e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["(Optional) Manual Track Reconnection for Known FOV Shifts", \
"Subsubsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.900268906742897*^9, 3.900268942742613*^9}, {3.9002689879417343`*^9, 
  3.90026902638291*^9}},ExpressionUUID->"7d97bb9d-2c89-4423-aa9e-\
06eda306b642"],

Cell["\<\
(Optional) Automate using a time threshold + global FOV offset from an \
eligible track beyond the offset timestamp\
\>", "Item",
 CellChangeTimes->{{3.8889229275245905`*^9, 3.888922965923603*^9}, {
   3.8889231411421146`*^9, 3.8889231411421146`*^9}, {3.888923983544366*^9, 
   3.8889239955619717`*^9}, 3.8890434676098175`*^9, {3.8900785708684316`*^9, 
   3.890078582037179*^9}, {3.8948051049058266`*^9, 3.8948051518462944`*^9}, {
   3.894805197142715*^9, 3.894805252532962*^9}, {3.894805310837208*^9, 
   3.894805341221537*^9}, {3.8948053734362497`*^9, 3.8948053868442745`*^9}, {
   3.8948261564992857`*^9, 3.894826185928544*^9}, {3.8948267472339487`*^9, 
   3.8948268046335187`*^9}, {3.894827080024009*^9, 3.89482710542087*^9}, {
   3.8959855242137623`*^9, 3.8959855553988595`*^9}, {3.8997135040410786`*^9, 
   3.899713504042119*^9}, {3.9000878487814646`*^9, 3.900087907477004*^9}, {
   3.9000879701107597`*^9, 3.900088008871433*^9}, {3.9001589968021564`*^9, 
   3.9001589968032293`*^9}, {3.9002700524949536`*^9, 3.900270097941352*^9}},
 FontSize->18,ExpressionUUID->"abd17d36-794b-474c-81d3-6964517dc8a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testSeriesPairFormat", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#1", ",", 
         RowBox[{"Thickness", "@", "#2"}], ",", 
         RowBox[{"Opacity", "@", "#3"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"97", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "swarmTrackTimestamps"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"#", ",", 
             RowBox[{"#", "*", 
              RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], ",", "#"}], 
            "]"}], "&"}], "@", "0.005"}], "//", "Reverse"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"0.2", "+", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], ",", "1", ",", 
           RowBox[{"1", "/", 
            RowBox[{"Length", "@", "swarmTrackTimestamps"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allInitialTrackIDs", "=", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "swarmTracksClean"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allInitialTracks", "=", "swarmTracksClean"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.900271130221836*^9, 3.9002712514632535`*^9}, {
   3.900271288429968*^9, 3.9002714751969395`*^9}, 3.9002715131374674`*^9, {
   3.900271594661437*^9, 3.900271679314099*^9}, {3.900271721453395*^9, 
   3.9002717601817446`*^9}, {3.900272121558454*^9, 3.9002721228529367`*^9}, {
   3.9002785772709694`*^9, 3.9002786267593355`*^9}, {3.900278789080661*^9, 
   3.900278899321802*^9}, {3.900402189129113*^9, 3.9004021898792286`*^9}, {
   3.9004082668586583`*^9, 3.9004082678659687`*^9}, {3.900411662434951*^9, 
   3.90041166296653*^9}, 3.900412247447221*^9, {3.900412410712186*^9, 
   3.9004124114711537`*^9}, 3.900413418254587*^9, {3.9004135731355247`*^9, 
   3.9004135854141383`*^9}, {3.9004137242784395`*^9, 3.900413732549371*^9}, {
   3.9004276922209206`*^9, 3.9004276965154915`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"2688c274-ed53-4829-8a41-e9c7aaf672f5"],

Cell[BoxData[{
 RowBox[{"swarmTracksClean", "//", "ListLinePlot"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testPotentialPairs", "=", 
   RowBox[{"getNumberRangeUniqueTuples", "@", 
    RowBox[{"Length", "@", "swarmTrackTimestamps"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testSeriesPairLegend", "=", 
    RowBox[{"SwatchLegend", "@", 
     RowBox[{"{", 
      RowBox[{"getLatexStyling", "/@", "testPotentialPairs"}], "}"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Catenate", "@", 
      RowBox[{"swarmTrackTimestamps", "[", 
       RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", "testPotentialPairs"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "testSeriesPairLegend"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "testSeriesPairFormat"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.900271130221836*^9, 3.9002712514632535`*^9}, {
   3.900271288429968*^9, 3.9002714859173155`*^9}, 3.9002729031262693`*^9, {
   3.900402192329466*^9, 3.9004022046817956`*^9}, {3.900403844529559*^9, 
   3.9004038486117496`*^9}, {3.9004105199291964`*^9, 3.900410527289002*^9}, {
   3.9004114864433765`*^9, 3.900411496367833*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"d5c9f29e-2344-4e67-b745-395ad8f8a229"],

Cell["\<\
Reconnection settings:

8_all -- 1 connection;  offsetFOV has only an Y component
1) reconnectIDs={1,2};  reconnectOrder=Reverse@reconnectIDs; \
finalReconnecredIDs={1,2}

9_all -- 2 connections;  offsetFOV has only an Y component
1) reconnectIDs={4,1};  reconnectOrder=Reverse@reconnectIDs;
2) reconnectIDs={1,3};  reconnectOrder=Reverse@reconnectIDs; \
finalReconnecredIDs={4,1,3}

10_all -- 1 connection;  offsetFOV has both Y and X components
1) reconnectIDs={2,1};  reconnectOrder=Reverse@reconnectIDs; \
finalReconnecredIDs={2,1}\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.9004034924538937`*^9, 3.9004035176625147`*^9}, {
   3.900404040344387*^9, 3.900404040568838*^9}, {3.900404825124925*^9, 
   3.9004048259416995`*^9}, {3.900408278037819*^9, 3.9004082808263083`*^9}, {
   3.900414684990247*^9, 3.9004147057237415`*^9}, 3.900427451763473*^9, {
   3.900427953698574*^9, 3.900427988833603*^9}, {3.9004343705493727`*^9, 
   3.900434457844836*^9}, {3.900434880766539*^9, 3.9004348904935703`*^9}},
 FontSize->16,ExpressionUUID->"f8f4de95-b1a5-4a3b-af0f-abff05be3076"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reconnectIDs", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzE0ogwEcBvAR5SLUwiaafBy0smJNo5hG8tVih0XRO8bUGC/JkI2DpHHA
a0KWfMZFGmHLUtrdZiVJDrMkKxdrOPA+/8PT7/D0PLl6c4shXiAQZPOBjMrJ
SVMiqhmZ1QFX3d9fJt5MMxuFbR5haj+vZk2cBkcdGWro8m7XwMcRYSOU3pc1
w9D5XzfU/koMMO/dswJj+isOrpw8bUBleGgTPjAbLpjY03cGo1574QBvwwVH
qiXFclhfoiDDy8l26NvKIWU/SuUgr05STe7GfivhiCi+Cq4HbzKH8Jt+LIbP
AaYLugM7pDjB1gc1s0fk3ZgxBFcXzaSxfD4C2w+XyI+FOC3L60/OJ9kH5R50
587tQ5Pz4Jr6iheyQ93kg0mvWpJtuQ3AccYahAUh9g1+dpZ+QMWEXTfMW6fn
SJHccmnBvtVGunqL/LA2a4acElqik7wDp9PkPxDY1ZE=
  "],
 CellLabel->
  "In[365]:=",ExpressionUUID->"e158e063-fbaa-4c82-ac3d-9fd6393f0314"],

Cell[BoxData[{
 RowBox[{"Last", "@", 
  RowBox[{"swarmTracksClean", "[", 
   RowBox[{"[", 
    RowBox[{"First", "@", "reconnectIDs"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "@", 
   RowBox[{"swarmTracksClean", "[", 
    RowBox[{"[", 
     RowBox[{"Last", "@", "reconnectIDs"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offsetFOV", "=", 
   RowBox[{
    RowBox[{"Last", "@", 
     RowBox[{"swarmTracksClean", "[", 
      RowBox[{"[", 
       RowBox[{"First", "@", "reconnectIDs"}], "]"}], "]"}]}], "-", 
    RowBox[{"First", "@", 
     RowBox[{"swarmTracksClean", "[", 
      RowBox[{"[", 
       RowBox[{"Last", "@", "reconnectIDs"}], "]"}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Catenate", "@", 
   RowBox[{"swarmTracksClean", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"First", "@", "reconnectIDs"}], ",", 
       RowBox[{"Last", "@", "reconnectIDs"}]}], "}"}], "]"}], "]"}]}], "//", 
  "ListLinePlot"}]}], "Input",
 CellChangeTimes->{{3.90026864217887*^9, 3.900268685439119*^9}, {
  3.900269491790641*^9, 3.900269492810815*^9}, {3.9002697695288734`*^9, 
  3.9002697877102494`*^9}, {3.900401842238375*^9, 3.900401844352722*^9}, {
  3.9004041066956363`*^9, 3.9004041563063135`*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"784fdb97-9e99-4b41-a2ee-06a5ae64a3bb"],

Cell["\<\
Defaults:

Offset definition
{0,Last@offsetFOV}\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.9001434947304187`*^9, 3.9001434949398627`*^9}, {3.900265210171418*^9, 
   3.900265222082325*^9}, {3.9004034924538937`*^9, 3.9004035176625147`*^9}, {
   3.900404040344387*^9, 3.900404040568838*^9}, {3.900404825124925*^9, 
   3.9004048259416995`*^9}, {3.900408278037819*^9, 3.9004082808263083`*^9}, {
   3.900414684990247*^9, 3.9004147057237415`*^9}, 3.900427451763473*^9, {
   3.900427953698574*^9, 3.900427988833603*^9}, {3.9004343705493727`*^9, 
   3.900434457844836*^9}, {3.90043453203741*^9, 3.900434559669387*^9}},
 FontSize->16,ExpressionUUID->"27d20490-22f5-4fc3-8e9f-9aa792efff55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reconnectOrder", "=", 
   RowBox[{"Reverse", "@", "reconnectIDs"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9004041850963135`*^9, 3.90040421410373*^9}, {
  3.900434479278383*^9, 3.900434493677721*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"8705f587-0195-4813-bfd1-fafa5723a3c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"offsetTrack", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "+", "offsetFOV"}], "&"}], "/@", 
    RowBox[{"swarmTracksClean", "[", 
     RowBox[{"[", 
      RowBox[{"First", "@", "reconnectOrder"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"manualRecoveredTrack", "=", 
    RowBox[{"Catenate", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"swarmTracksClean", "[", 
        RowBox[{"[", 
         RowBox[{"Last", "@", "reconnectOrder"}], "]"}], "]"}], ",", 
       "offsetTrack"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"referenceRecoveredTrack", "=", 
    RowBox[{"Catenate", "@", 
     RowBox[{"swarmTracksClean", "[", 
      RowBox[{"[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "@", "reconnectIDs"}], ",", 
         RowBox[{"Last", "@", "reconnectIDs"}]}], "}"}], 
       "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"manualRecoveredTrack", ",", "referenceRecoveredTrack", ",", 
     RowBox[{"swarmTracksClean", "[", 
      RowBox[{"[", 
       RowBox[{"First", "@", "reconnectIDs"}], "]"}], "]"}]}], "}"}], "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"manualRecoveredTrack", "//", "ListLinePlot"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQnaG8JkCH/63jm5nJQSD60yvpdBD9KLimEERv+3av
HES7xCtWg+irU87OB9HC0SsWgOiQwt3n9IG0cemkSyCa5dHimyD6Uf/ruyD6
/vHMZyB61XqW1yD6y+3HDLlAWiaHgwlEb8hVDwTRU4qNw0D0wex/i0C0nvni
xSB67uOLe0D0A5P8vSB6iXnNQRDtIKp/GEQb5Vw+DqLDInlugOiyr+c+gWiG
9OIvIDqx1P4HiE4zvfoLRBcfn/oPRPPtmQOmIzaZaOcB6Sdt58C0vXCAJYi2
u54NpjnuF9iD6OVazY4g+r336nkg2sE6fyGItux9L1AL0ictIAiiAUnBmmI=

  "],
 CellLabel->
  "In[395]:=",ExpressionUUID->"8fb2a058-9326-4f30-ad6a-11cfc374d40e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmTracksCleanReferenceCentroids", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Catenate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"swarmTracksCleanReferenceCentroids", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", "reconnectIDs"}]}], "]"}], 
        ",", 
        RowBox[{"{", "referenceRecoveredTrack", "}"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmTracksClean", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Catenate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"swarmTracksClean", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", "reconnectIDs"}]}], "]"}], 
        ",", 
        RowBox[{"{", "manualRecoveredTrack", "}"}]}], "\[IndentingNewLine]", 
       "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracksClean", "//", "ListLinePlot"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracksCleanReferenceCentroids", "//", 
  "ListLinePlot"}]}], "Input",
 CellChangeTimes->{{3.90026954469956*^9, 3.900269619873499*^9}, {
   3.9002696872323513`*^9, 3.900269689215994*^9}, {3.900269892727376*^9, 
   3.9002698934115477`*^9}, {3.900271882381727*^9, 3.900271891589101*^9}, {
   3.900272022036969*^9, 3.900272024751073*^9}, {3.900276582123056*^9, 
   3.900276620593852*^9}, 3.900276692561947*^9, 3.9004111794511275`*^9, {
   3.900411598432599*^9, 3.900411599062912*^9}, {3.9004117236470847`*^9, 
   3.9004117296231537`*^9}, 3.9004131308927383`*^9, {3.900413472470592*^9, 
   3.9004134767511396`*^9}, {3.900427843307556*^9, 3.900427845003078*^9}},
 CellLabel->
  "In[400]:=",ExpressionUUID->"9b6596de-38a9-42b5-9150-04542e25f45c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "@", 
        RowBox[{"swarmTrackTimestamps", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"First", ",", "Last"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "TableForm"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrackTimestamps", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Catenate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"swarmTrackTimestamps", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", "reconnectIDs"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Catenate", "@", 
            RowBox[{"swarmTrackTimestamps", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", "reconnectIDs"}], 
         "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "@", 
       RowBox[{"swarmTrackTimestamps", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"First", ",", "Last"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.90027213787405*^9, 3.900272170547464*^9}, {
  3.900272201164626*^9, 3.9002722061661987`*^9}, {3.9002722697253447`*^9, 
  3.9002723235933275`*^9}},
 CellLabel->
  "In[404]:=",ExpressionUUID->"851eade4-430b-4dc5-a9a8-96ec76baac55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalReconntectedIDs", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9004135127151203`*^9, 3.9004135365413456`*^9}, {
  3.9004139075750875`*^9, 3.900413908357992*^9}, {3.9004147290150037`*^9, 
  3.9004147449004617`*^9}, {3.9004280106522474`*^9, 3.900428012202101*^9}, {
  3.900434654902937*^9, 3.900434655133293*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"34613086-630a-446f-b9fe-a3469563498b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"allReferenceRecoveredTracks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"allInitialTracks", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Complement", "[", 
         RowBox[{"allInitialTrackIDs", ",", "finalReconntectedIDs"}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Catenate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"allInitialTracks", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          "finalReconntectedIDs"}], "]"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"allReferenceRecoveredTracks", "//", 
  "ListLinePlot"}], "\[IndentingNewLine]", 
 RowBox[{"swarmTracksClean", "//", "ListLinePlot"}]}], "Input",
 CellChangeTimes->{{3.9004136509723625`*^9, 3.9004136626620975`*^9}, {
   3.900413713821271*^9, 3.900413713941945*^9}, {3.900413938167824*^9, 
   3.9004142499034777`*^9}, 3.900414796318941*^9, {3.9004268368219357`*^9, 
   3.9004269278844557`*^9}, {3.9004269677757616`*^9, 3.9004269887307825`*^9}, 
   3.9004271534552813`*^9},
 CellLabel->
  "In[408]:=",ExpressionUUID->"aa6eab42-b08e-43d6-8248-ba7e300f374d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Clean Swarm Tracks & Timestamps >>", "Subsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083714014845`*^9}, {3.9004084501855927`*^9, 
  3.9004084564578943`*^9}},ExpressionUUID->"ec0bffac-0189-4cd8-8b13-\
e680daa8635e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Swarm Tracks Timestamps.txt\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", 
     RowBox[{"{", 
      RowBox[{
      "swarmTracksClean", ",", "swarmTrackTimestamps", ",", 
       "allReferenceRecoveredTracks"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8903915643219943`*^9, 3.890391614698898*^9}, {
   3.900408423921915*^9, 3.900408436086995*^9}, {3.9004084695618296`*^9, 
   3.900408479681055*^9}, {3.900408511140123*^9, 3.900408515721835*^9}, {
   3.9004112146085463`*^9, 3.90041121488974*^9}, 3.900414264360875*^9, {
   3.9094005617702794`*^9, 
   3.9094005671113453`*^9}},ExpressionUUID->"7e269dec-8ebd-4cff-ad88-\
28205f45858e"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Clean Swarm Tracks & Timestamps <<", "Subsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.9004083591173897`*^9, 3.9004083811464214`*^9}, {3.900408463380304*^9, 
  3.90040846366654*^9}},ExpressionUUID->"66cf69b4-8ee6-48a1-8106-\
23563610a9d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "swarmTracksClean", ",", "swarmTrackTimestamps", ",", 
     "allReferenceRecoveredTracks"}], "}"}], "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Swarm Tracks Timestamps.txt\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8903916307441673`*^9, 3.8903916497855167`*^9}, {
   3.8987599986253157`*^9, 3.8987599992489624`*^9}, 3.900408445930025*^9, {
   3.900408501604472*^9, 3.900408503106402*^9}, {3.900411209785389*^9, 
   3.900411210441642*^9}, 3.9004142653381443`*^9, 3.909400569629669*^9},
 CellLabel->
  "In[2639]:=",ExpressionUUID->"52a58390-4d58-4736-8044-b252cf95edc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Track Coordinates Export >>", "Subsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.903358060629836*^9, 3.9033580638118668`*^9}, {3.9033615512600813`*^9, 
  3.9033615534208565`*^9}},ExpressionUUID->"29dcc2fe-38a4-4c1e-a199-\
eeb5e7b5428d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trajectoryExportData", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "/@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}]}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackTimestamps", ",", "swarmTracksClean"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dataCSVfolder", "<>", "\"\<Trajectory_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,x,y)_raw.csv\>\""}], 
      ",", 
      RowBox[{"trajectoryExportData", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "trajectoryExportData"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9033614494959016`*^9, 3.903361566135867*^9}, {
  3.9093996674063897`*^9, 3.9093996690979033`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"0084b5ee-ddf5-4d7d-8eb0-88defd092d01"]
}, Closed]],

Cell[CellGroupData[{

Cell["Track Plots", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.8940923960812793`*^9, 
  3.8940924032666903`*^9}},ExpressionUUID->"f34c4e08-a1ab-4da4-aede-\
f4f94aae5846"],

Cell["\<\
Defaults :
   
fontSize=13;
endpointSizeScale=5*10^-7;
plotRangeOffsetScale=0.05;

scalesAspectRatio={1,1,1};
scalesEndpointSizes={1,1,1};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9},
 FontSize->16,ExpressionUUID->"91d7572e-d9e7-40ca-976c-0cd236791f3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endpointSizeScale", "=", 
   RowBox[{"5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotRangeOffsetScale", "=", "0.05"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scalesAspectRatio", "=", 
   RowBox[{"{", 
    RowBox[{"0.9", ",", "1", ",", "1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"scalesEndpointSizes", "=", 
    RowBox[{"{", 
     RowBox[{"10", ",", "50", ",", "50"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsTracks", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<x, ~\\\\mu m\>\"", ",", "\"\<y, ~\\\\mu m\>\""}], "}"}]}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8928898337732215`*^9, 3.8928900171840124`*^9}, {
   3.892890091192967*^9, 3.8928900968561335`*^9}, {3.8928903168892794`*^9, 
   3.892890323103834*^9}, {3.8928904990960035`*^9, 3.89289052289637*^9}, {
   3.89289164440028*^9, 3.8928916901622314`*^9}, {3.8928917357061768`*^9, 
   3.8928917406479855`*^9}, 3.8928917834078307`*^9, 3.89289183133602*^9, 
   3.8928922106150723`*^9, {3.8928930452551527`*^9, 3.892893065992383*^9}, 
   3.8928935507519436`*^9, {3.893484043191563*^9, 3.8934840630009713`*^9}, {
   3.894092231993323*^9, 3.8940923557917967`*^9}, {3.894132781236661*^9, 
   3.894132844158662*^9}, {3.8946375064989953`*^9, 3.894637572684615*^9}, {
   3.8947154243311224`*^9, 3.8947154772671843`*^9}, 3.8947214757317576`*^9, {
   3.8996211690778804`*^9, 3.899621187886239*^9}, {3.900272409396657*^9, 
   3.9002724550604987`*^9}, {3.900272497036892*^9, 3.9002725820528407`*^9}, {
   3.900325053488586*^9, 3.9003250582827644`*^9}, {3.9004051436932573`*^9, 
   3.900405219980481*^9}, {3.900428058949731*^9, 3.900428060189415*^9}, {
   3.900434683427911*^9, 3.9004347097813296`*^9}, {3.900594841277193*^9, 
   3.9005948531326075`*^9}, 3.9005953453483334`*^9, {3.900595375545692*^9, 
   3.9005955249709334`*^9}, {3.9031542967347164`*^9, 3.903154302752947*^9}, {
   3.909261585349471*^9, 3.9092615886077695`*^9}, {3.909263880806012*^9, 
   3.9092639283810024`*^9}, {3.9094089185221105`*^9, 
   3.9094089485532227`*^9}, {3.90950727770154*^9, 3.909507292125639*^9}, 
   3.9095080667381396`*^9, {3.9095096206912775`*^9, 3.9095096721281767`*^9}, {
   3.910262302998103*^9, 3.9102623040627966`*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"79a3b4b4-8b31-4610-9fde-2b09973d3ea6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotSwarmTracks", "=", 
    RowBox[{"getSwarmTrackPlots", "[", 
     RowBox[{"pixelSizeMicroMeters", "*", "swarmTracksClean"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EvenQ", "@", 
          RowBox[{"Length", "@", "#"}]}], ",", "#", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"Image", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "&"}], "@", "plotSwarmTracks"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", 
     RowBox[{
      RowBox[{"plotSwarmTracks", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"\"\<Swarm Track \>\"", "<>", 
       RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "plotSwarmTracks"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8928898337732215`*^9, 3.8928900171840124`*^9}, {
   3.892890091192967*^9, 3.8928900968561335`*^9}, {3.8928903168892794`*^9, 
   3.892890323103834*^9}, {3.8928904990960035`*^9, 3.89289052289637*^9}, {
   3.89289164440028*^9, 3.8928916901622314`*^9}, {3.8928917357061768`*^9, 
   3.892891746096116*^9}, {3.892891785503734*^9, 3.8928917962878885`*^9}, {
   3.8928921195931344`*^9, 3.8928921254231224`*^9}, {3.892892694712243*^9, 
   3.892892762438786*^9}, {3.8928928216159706`*^9, 3.892892882736034*^9}, {
   3.8928929732640543`*^9, 3.892893163769581*^9}, 3.8928933115360837`*^9, {
   3.892893505800811*^9, 3.8928935207364864`*^9}, {3.8928938100348587`*^9, 
   3.89289382850986*^9}, 3.89962116032623*^9, {3.9002724337554293`*^9, 
   3.9002724344206495`*^9}, {3.900594885766754*^9, 3.900594920228799*^9}, {
   3.900595311315479*^9, 3.9005953132944803`*^9}, 3.900595364327819*^9, {
   3.90059549961307*^9, 3.9005955016485553`*^9}, {3.909261302677781*^9, 
   3.9092613088650403`*^9}, {3.909261499270934*^9, 3.909261506884697*^9}, {
   3.9092616778*^9, 3.9092616795680037`*^9}, 3.9094020076137333`*^9, {
   3.9095845689249644`*^9, 3.909584572844282*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"04ba33e9-6311-4cb4-83fd-a0db744ef49e"],

Cell["\<\
Defaults :
   
endpointSizeJoint=0.0125;
arrowHeadScale=0.0175;
plotRangeOffsetScale=0.05;

9_all: merge @ t = 3040\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.8947199380655823`*^9, {
   3.9003985468671727`*^9, 3.9003985659543247`*^9}},
 FontSize->16,ExpressionUUID->"fc92713b-470e-4c3d-82c6-5b619a60a05d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"endpointSizeJoint", "=", "0.0175"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arrowHeadScale", "=", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotRangeOffsetScale", "=", "0.50"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsTracksEvents", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<x, ~\\\\mu m\>\"", ",", "\"\<y, ~\\\\mu m\>\""}], "}"}]}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.89289908166714*^9, {3.8928991897068667`*^9, 3.892899200556119*^9}, {
   3.8929011550110874`*^9, 3.8929011554292393`*^9}, {3.900272661508808*^9, 
   3.900272662548059*^9}, 3.900405574549797*^9, 3.900434761080799*^9, {
   3.9092610305015416`*^9, 3.9092610367411084`*^9}, {3.9092610713333445`*^9, 
   3.909261130218566*^9}, {3.9102623163026485`*^9, 3.9102623183090577`*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"aa6292f0-2d0c-4b2a-b228-0c7528b0be5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotRangesAllTracks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pixelSizeMicroMeters", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", 
             RowBox[{"Last", "@", "#"}]}], "}"}]}], "&"}], "@", 
         RowBox[{"Sort", "@", "#"}]}], "&"}], "/@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}]}]}], "&"}], "@", 
     "swarmTracksClean"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"plotRangeOffsets", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"pixelSizeMicroMeters", "*", "plotRangeOffsetScale", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
       RowBox[{"Min", "@", "#"}]}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Subtract", "@@", 
         RowBox[{"Reverse", "@", "#"}]}], "&"}], "/@", 
       "plotRangesAllTracks"}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotAllSwarmTracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"plotRangesAllTracks", "+", "plotRangeOffsets"}]}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"SwatchLegend", "@", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "#"}]}]}], ",", "Top"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", "axesLabelsTracksEvents"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Point", "@", 
               RowBox[{"First", "@", "#"}]}], ",", 
              RowBox[{"Darker", "@", "Green"}], ",", 
              RowBox[{"PointSize", "@", "endpointSizeJoint"}]}], "]"}], "&"}],
            "/@", "#"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Point", "@", 
               RowBox[{"Last", "@", "#"}]}], ",", "Red", ",", 
              RowBox[{"PointSize", "@", "endpointSizeJoint"}]}], "]"}], "&"}],
            "/@", "#"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"(", 
     RowBox[{"pixelSizeMicroMeters", "*", "swarmTracksClean"}], ")"}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotAllSwarmTracks", ",", "\"\<Swarm Tracks All\>\"", ",", "100"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.9095033608244295`*^9, 3.9095033621898127`*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"6fd4424d-45ef-4c6e-b669-2f90073c7e81"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Position", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"First", "@", "swarmTrackTimestamps"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#", "==", 
        RowBox[{"Last", "@", 
         RowBox[{"swarmTrackTimestamps", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.90040559650243*^9, 3.900595973908803*^9, {3.9094101968682294`*^9, 
   3.909410197777895*^9}, 3.909503091042458*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"50e669fd-2480-4d1e-be2b-dc2b39c93f51"],

Cell["\<\
NOTE : edit 'mergeEvents'  and \[OpenCurlyQuote]Epilog\[CloseCurlyQuote] \
before rendering the plot\
\>", "Abstract",
 CellChangeTimes->{{3.9005962832817297`*^9, 3.9005963348540506`*^9}},
 FontSize->16,ExpressionUUID->"f653f1e0-1842-45d5-8d3f-e6d3aa1a979f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mergeEvents", "=", 
    RowBox[{
    "getLatexStyling", "@", 
     "\"\<\\\\textbf{Merges}: 7 \\\\rightarrow 1\>\""}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.90059614196437*^9, 3.900596264943736*^9}, 
   3.9094105452020297`*^9, 3.9095081497617207`*^9, 
   3.9095824947524567`*^9},ExpressionUUID->"692c7efe-0a1e-4cc1-91a2-\
86084caa3160"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"plotAllSwarmTracksEventArrows", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"plotRangesAllTracks", "+", "plotRangeOffsets"}]}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"SwatchLegend", "@", 
             RowBox[{"Range", "@", 
              RowBox[{"Length", "@", "#"}]}]}], ",", "Right"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", "axesLabelsTracksEvents"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"First", "@", "#"}]}], ",", 
                RowBox[{"Darker", "@", "Green"}], ",", 
                RowBox[{"PointSize", "@", "endpointSizeJoint"}]}], "]"}], 
              "&"}], "/@", "#"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Point", "@", 
                 RowBox[{"Last", "@", "#"}]}], ",", "Red", ",", 
                RowBox[{"PointSize", "@", "endpointSizeJoint"}]}], "]"}], 
              "&"}], "/@", "#"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Arrowheads", "@", "arrowHeadScale"}], ",", 
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Last", "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3717", "]"}], "]"}], "&"}], "@", 
                    RowBox[{"First", "@", "#"}]}]}], "}"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Thick"}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "mergeEvents"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", 
      RowBox[{"(", 
       RowBox[{"pixelSizeMicroMeters", "*", "swarmTracksClean"}], ")"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
     RowBox[{"exportImagesTwoFormat", "[", 
      RowBox[{
      "plotAllSwarmTracksEventArrows", ",", "\"\<Swarm Tracks All Events\>\"",
        ",", "100"}], "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8929011892600145`*^9, 3.892901207715805*^9}, 
   3.8929013266539745`*^9, {3.892901423083832*^9, 3.892901466914553*^9}, {
   3.8929015013875456`*^9, 3.8929017175318136`*^9}, {3.892901756652006*^9, 
   3.89290180588617*^9}, {3.8929085611297073`*^9, 3.8929085725274878`*^9}, {
   3.8929086298474665`*^9, 3.892908746878544*^9}, {3.8929088381854854`*^9, 
   3.89290885737528*^9}, {3.8929132812945795`*^9, 3.892913296190341*^9}, {
   3.893408355764449*^9, 3.8934083661205015`*^9}, {3.893410713426134*^9, 
   3.8934107711724896`*^9}, {3.9004053016143723`*^9, 3.900405312975983*^9}, {
   3.9004053896479225`*^9, 3.9004053906154337`*^9}, {3.9004054329503317`*^9, 
   3.9004055594202986`*^9}, {3.9004112693037434`*^9, 
   3.9004112759443274`*^9}, {3.9005957149288282`*^9, 3.900595717015168*^9}, {
   3.900595794617213*^9, 3.900595876500704*^9}, {3.9005960331618223`*^9, 
   3.9005960790347457`*^9}, {3.900596117931323*^9, 3.9005961388682737`*^9}, {
   3.900596200375476*^9, 3.9005962513804817`*^9}, {3.909261172751223*^9, 
   3.90926121430614*^9}, {3.909261262920701*^9, 3.9092612752029877`*^9}, {
   3.909402113802257*^9, 3.90940212632209*^9}, {3.9094101219359837`*^9, 
   3.9094101496758137`*^9}, {3.909410258717741*^9, 3.9094103155634427`*^9}, {
   3.9094105341475983`*^9, 3.90941053422663*^9}, 3.9095081596482654`*^9, 
   3.9095824921687107`*^9},ExpressionUUID->"2f65ba80-23b9-44c6-a0d9-\
5b54b69eed96"]
}, Closed]],

Cell[CellGroupData[{

Cell["Inter-Swarm Distances", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
   3.8934404012302437`*^9, 3.893440417094502*^9}, 3.8940913646822505`*^9, 
   3.89409244484873*^9},ExpressionUUID->"7c86bc33-3a9b-4a48-b1a5-\
a12d9a507d4b"],

Cell["\<\
Defaults :
   
distanceEventCountThreshold=10;
distanceEventDeltaTimeThreshold=100;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, 3.8928917560968122`*^9, {3.892893020270396*^9, 
   3.8928930313677225`*^9}, 3.8928938753869886`*^9, 3.8947199380655823`*^9, 
   3.8947215354431343`*^9, {3.900408841124337*^9, 3.900408842082766*^9}, 
   3.900409133433525*^9, {3.9092636055939407`*^9, 3.909263609023185*^9}, {
   3.909412221265213*^9, 3.9094122215689225`*^9}},
 FontSize->16,ExpressionUUID->"c7c7b8c9-c014-4d44-b29f-dded484b1302"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsSwarmDistances", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<t, ~s\>\"", ",", "\"\<d_\\\\text{swarm}, ~\\\\mu m\>\""}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolationOrder", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"distanceEventCountThreshold", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"distanceEventDeltaTimeThreshold", "=", "100"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.890722940131611*^9, 
   3.890722958012675*^9}, 3.8907255610016756`*^9, {3.893442890909734*^9, 
   3.893442918941449*^9}, {3.9002740920103474`*^9, 3.900274104564741*^9}, 
   3.9002756254819016`*^9, {3.900408814033782*^9, 3.9004088621859446`*^9}, {
   3.900408896609926*^9, 3.900408896794381*^9}, {3.9004089659410467`*^9, 
   3.900408971706626*^9}, {3.9004090038497095`*^9, 3.90040901922499*^9}, {
   3.900409091225464*^9, 3.9004091120736523`*^9}, {3.9004091785066566`*^9, 
   3.900409180224063*^9}, {3.900434778864811*^9, 3.9004347799968395`*^9}, 
   3.9005964763672705`*^9, {3.9092607707760468`*^9, 3.9092607789171567`*^9}, {
   3.9092609010555763`*^9, 3.909260901453513*^9}, {3.9092635803254538`*^9, 
   3.909263595398362*^9}, 3.909263660910116*^9, 3.909410662097785*^9, {
   3.909410710883767*^9, 3.909410750612533*^9}, {3.909410792443564*^9, 
   3.909410889041739*^9}, {3.9094109266034236`*^9, 3.9094109278978558`*^9}, {
   3.909411015577819*^9, 3.90941101760396*^9}, {3.909412219314106*^9, 
   3.9094122196887417`*^9}, 3.9095082344500475`*^9, 3.9095097595927877`*^9, {
   3.909847534188079*^9, 3.909847553017131*^9}, {3.9100943810270796`*^9, 
   3.9100943834167867`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"eb1f4baa-47c3-4b43-8469-801058e8b919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmPairsDistance", "=", 
    RowBox[{"getNumberRangeUniqueTuples", "@", 
     RowBox[{"Length", "@", "swarmTrackTimestamps"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interSwarmDistances", "=", 
    RowBox[{"getInterSwarmDistances", "[", "\[IndentingNewLine]", 
     RowBox[{
     "swarmTrackTimestamps", ",", "swarmTracksClean", ",", 
      "swarmPairsDistance"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"legendSwarmDistances", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SwatchLegend", "@", 
         RowBox[{"{", "#", "}"}]}], "&"}], "/@", 
       RowBox[{"getLatexStyling", "/@", 
        RowBox[{"swarmPairsDistance", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Position", "[", 
       RowBox[{"interSwarmDistances", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "#"}], ">", 
            "distanceEventCountThreshold"}], "&"}], ")"}]}]}], "]"}]}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interSwarmDistancesEligible", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], ">", "distanceEventCountThreshold"}], 
         "&"}]}], "]"}], "&"}], "@", "interSwarmDistances"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"interSwarmDistancesEligiblePhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frameDurationSeconds", ",", "pixelSizeMicroMeters"}], "}"}],
         "*", 
        RowBox[{"Transpose", "@", "#"}]}], "]"}], "&"}], "/@", 
     "interSwarmDistancesEligible"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotSwarmDistances", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#1", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"Placed", "[", 
             RowBox[{"#", ",", "Top"}], "]"}]}], "&"}], "@", "#2"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "axesLabelsSwarmDistances"}], ",", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "interpolationOrder"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "interSwarmDistancesEligiblePhysical", ",", "legendSwarmDistances"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotSwarmDistances", "//", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"#", ",", 
      RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], "&"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"legendSwarmDistancesAll", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"SwatchLegend", "@", 
       RowBox[{"{", "#", "}"}]}], "&"}], "@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"getLatexStyling", "/@", 
         RowBox[{"swarmPairsDistance", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"interSwarmDistances", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", 
              "distanceEventCountThreshold"}], "&"}], ")"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"plotSwarmDistancesAll", "=", 
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{"interSwarmDistancesEligiblePhysical", ",", 
     RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "axesLabelsSwarmDistances"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "interpolationOrder"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{"#", ",", "Top"}], "]"}]}], "&"}], "@", 
      "legendSwarmDistancesAll"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"exportImagesTwoFormat", "[", 
      RowBox[{
       RowBox[{"plotSwarmDistances", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"\"\<Swarm Distances \>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "plotSwarmDistances"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotSwarmDistancesAll", ",", "\"\<Swarm Distances All\>\"", ",", "100"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9002728232874737`*^9, 3.9002728432350664`*^9}, 
   3.9002729737745743`*^9, {3.9002731199806085`*^9, 3.900273131267401*^9}, 
   3.9002731747251177`*^9, {3.900273936389537*^9, 3.900273963891032*^9}, {
   3.9002741122033615`*^9, 3.9002741183239384`*^9}, {3.900274168695218*^9, 
   3.9002741749315896`*^9}, {3.9002747982530823`*^9, 3.9002748070913353`*^9}, 
   3.9002748574107513`*^9, {3.900274908588874*^9, 3.9002749589870777`*^9}, {
   3.9002756360057507`*^9, 3.900275640514741*^9}, {3.900278390786036*^9, 
   3.9002783960180435`*^9}, {3.900408740100608*^9, 3.900408756738027*^9}, {
   3.900408850740608*^9, 3.9004089146260185`*^9}, {3.9004089446751347`*^9, 
   3.900408952233867*^9}, 3.900409123412326*^9, 3.9004270410530367`*^9, 
   3.9004270722957907`*^9, {3.90059669109597*^9, 3.9005967141364346`*^9}, {
   3.9005969981550255`*^9, 3.900597041257743*^9}, {3.9091485900544977`*^9, 
   3.9091486180072145`*^9}, 3.9092309725438285`*^9, {3.9092607362882957`*^9, 
   3.9092607600936756`*^9}, {3.909260851942316*^9, 3.9092608826159115`*^9}, {
   3.9092620863984947`*^9, 3.9092621859762077`*^9}, {3.9092622188176827`*^9, 
   3.9092622457183857`*^9}, {3.909262329434022*^9, 3.909262390488676*^9}, 
   3.909262453446892*^9, {3.909262515658964*^9, 3.9092625202380652`*^9}, {
   3.909262569366948*^9, 3.909262646913848*^9}, {3.9092632379602346`*^9, 
   3.9092632660236864`*^9}, 3.909263454462598*^9, {3.9092635155626545`*^9, 
   3.9092635164433393`*^9}, {3.9092635523920956`*^9, 3.909263567376891*^9}, {
   3.9092636139211965`*^9, 3.9092636435607457`*^9}, 3.90940113189291*^9, {
   3.9094012165692754`*^9, 3.909401218769399*^9}, {3.9094024217710676`*^9, 
   3.909402457937928*^9}, 3.9094024885889006`*^9, {3.909410771752966*^9, 
   3.909410800729615*^9}, {3.909410843178657*^9, 3.9094109101155033`*^9}, {
   3.9094109574479537`*^9, 3.9094110339548826`*^9}, 3.9094110861862445`*^9, {
   3.9094111801055803`*^9, 3.909411202093609*^9}, {3.909412126782205*^9, 
   3.909412129267357*^9}, 3.9094121711469817`*^9, {3.909503177673092*^9, 
   3.9095031983346844`*^9}, {3.9095035262144327`*^9, 3.909503527582301*^9}, 
   3.9095035722873297`*^9, {3.909503903082988*^9, 3.9095039069338293`*^9}, {
   3.909504049632412*^9, 3.9095040523672915`*^9}, {3.909582471492886*^9, 
   3.9095824717625055`*^9}, {3.909847466076895*^9, 3.9098475468915386`*^9}, {
   3.910082035464835*^9, 3.9100820371533213`*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"7d3d4fe9-3937-4337-8bad-d5f1b7223f66"]
}, Closed]],

Cell[CellGroupData[{

Cell["Property Tracking", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.8901316764174047`*^9, 
  3.890131691085701*^9}},ExpressionUUID->"307459fc-d5fa-4230-90e3-\
fdec5a5b9a4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmCentroidsUnified", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Last", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "swarmData"}], 
       ")"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"swarmTrackDataIDs", "=", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"monitorCounter", "++"}], ";", 
                RowBox[{"getMatchingIndex", "[", 
                 RowBox[{"swarmCentroidsUnified", ",", "#"}], "]"}]}], ")"}], 
              "&"}], "/@", "#"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
          "allReferenceRecoveredTracks"}], ")"}]}]}], ";"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{
        RowBox[{"Length", "/@", "allReferenceRecoveredTracks"}], "//", 
        "Total"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrackData", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#1", "}"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"{", "2", "}"}], "]"}], "]"}], "&"}], "@", 
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{"Last", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"swarmData", ",", "1"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", "#"}], ")"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}], "&"}], "/@", 
     "swarmTrackDataIDs"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"swarmProperties", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "&"}], "/@", "#"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"Transpose", "@", "#"}]}], ",", "1"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "swarmTrackData"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8901294501551433`*^9, 3.89012955193723*^9}, {
   3.8901300121302853`*^9, 3.890130016745219*^9}, {3.890130047103896*^9, 
   3.890130068416865*^9}, {3.8901317149679775`*^9, 3.890131725860278*^9}, {
   3.8901324439259367`*^9, 3.890132448786749*^9}, {3.890161702603097*^9, 
   3.8901617178948*^9}, 3.8901974160810623`*^9, {3.890198286644333*^9, 
   3.890198312166299*^9}, 3.890593585592431*^9, {3.8907265859925475`*^9, 
   3.8907265862500224`*^9}, 3.890843106308819*^9, 3.8908792764800863`*^9, {
   3.8928888756136093`*^9, 3.89288889110573*^9}, 3.892893571607625*^9, {
   3.892898102843934*^9, 3.8928981449403048`*^9}, {3.8928981754536295`*^9, 
   3.892898297564838*^9}, {3.8928983429568777`*^9, 3.89289839031621*^9}, {
   3.8934108063449326`*^9, 3.8934109377131653`*^9}, 3.8934118302416*^9, 
   3.8996215440224013`*^9, {3.8996217767735653`*^9, 3.899621778723977*^9}, {
   3.9002767745873847`*^9, 3.900276796448967*^9}, {3.9004143201047783`*^9, 
   3.900414328910219*^9}, {3.909148740527232*^9, 3.9091487428721437`*^9}, {
   3.9094014940665083`*^9, 3.9094015112015257`*^9}, {3.909504115023528*^9, 
   3.909504117278641*^9}},
 CellLabel->
  "In[2640]:=",ExpressionUUID->"3dcaf8da-9b50-4f17-a677-9a13793cceb2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Property Plots", "Subsection",
 CellChangeTimes->{{3.890131603587921*^9, 3.8901316270606*^9}, {
  3.8901316764174047`*^9, 3.890131691085701*^9}, {3.894092466388378*^9, 
  3.8940924672649903`*^9}},ExpressionUUID->"858cc32f-929b-44b5-96d4-\
605c1c35c0ad"],

Cell["\<\
Defaults :

histogramRanges={All};
histogramBinningMethod=\[CloseCurlyDoubleQuote]FreedmanDiaconis\
\[CloseCurlyDoubleQuote];
histogramInterpolationOrder=2;

outlierMedianFilterRadius=50;
outlierMedianFilterIterations=5;
outlierDeviationFactors={5};
outlierDeviationFactorsDefault=ConstantArray[5,Length@swarmTracksClean];
plotGridSize=900;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.909402512865963*^9, 3.9095819515645885`*^9, {
   3.9100941488238573`*^9, 3.9100941655157785`*^9}},
 FontSize->16,ExpressionUUID->"d1d8372e-deb0-4df5-ba00-076128409311"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axesLabelsPropsHistogram", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\"\<S, ~{\\\\mu m}^2\>\"", ",", "\"\<\\\\rho\>\""}], "}"}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axesLabelsPropsSeries", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\"\<t, ~s\>\"", ",", "\"\<S, ~{\\\\mu m}^2\>\""}], "}"}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramRanges", "=", 
   RowBox[{"{", "All", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"histogramInterpolationOrder", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierMedianFilterRadius", "=", "50"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierMedianFilterIterations", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierDeviationFactors", "=", 
   RowBox[{"{", "5", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierDeviationFactorsDefault", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"5", ",", 
     RowBox[{"Length", "@", "swarmTracksClean"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotGridSize", "=", "900"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8901982132575226`*^9, 3.8901982412177467`*^9}, {
   3.890198438254984*^9, 3.8901984785653296`*^9}, {3.89020011741765*^9, 
   3.8902001695412455`*^9}, 3.890200218556176*^9, {3.8902003672791376`*^9, 
   3.890200386811405*^9}, {3.890200462388465*^9, 3.890200462641219*^9}, {
   3.890200794468899*^9, 3.890200807042573*^9}, {3.8902030136220255`*^9, 
   3.8902030204194756`*^9}, {3.890207269925324*^9, 3.890207286325079*^9}, {
   3.8902075488712687`*^9, 3.890207578277294*^9}, {3.890728435537546*^9, 
   3.890728521297693*^9}, 3.890733356299531*^9, {3.89084321969405*^9, 
   3.890843283180818*^9}, {3.8908434525342813`*^9, 3.890843460230713*^9}, {
   3.8908437440146337`*^9, 3.890843813329808*^9}, 3.890843882676123*^9, {
   3.890843914267644*^9, 3.890843964500544*^9}, {3.8908440716348915`*^9, 
   3.8908440885882273`*^9}, 3.892893604160994*^9, {3.8929088885280943`*^9, 
   3.8929089191586943`*^9}, {3.893421007385091*^9, 3.893421008368862*^9}, {
   3.893484175639843*^9, 3.8934842047594943`*^9}, {3.8947080779357405`*^9, 
   3.8947080931335173`*^9}, {3.8947081356544933`*^9, 3.894708146366071*^9}, {
   3.894712980251069*^9, 3.894713002435505*^9}, {3.894715529466498*^9, 
   3.894715529651716*^9}, {3.8947216156356688`*^9, 3.894721644920288*^9}, {
   3.8996217891111336`*^9, 3.8996218056220922`*^9}, {3.8996219040388584`*^9, 
   3.8996219041259103`*^9}, {3.9002756908846054`*^9, 3.900275721162053*^9}, 
   3.90027582336336*^9, {3.9004093133218665`*^9, 3.900409322656576*^9}, {
   3.900409389394797*^9, 3.9004093898083277`*^9}, {3.9004094344897113`*^9, 
   3.900409450313012*^9}, {3.9004271044753346`*^9, 3.900427104530135*^9}, 
   3.9004281593144546`*^9, 3.9004348020944357`*^9, {3.909263290067649*^9, 
   3.909263291806843*^9}, {3.909263767494924*^9, 3.909263828148782*^9}, {
   3.909400755555337*^9, 3.909400785224454*^9}, {3.9094008154269*^9, 
   3.9094008233378*^9}, {3.9094008561592226`*^9, 3.909400856626033*^9}, {
   3.9095801866904182`*^9, 3.9095801990045176`*^9}, 3.9095802403842106`*^9, {
   3.909580776466815*^9, 3.9095808004193244`*^9}, {3.9099942174104123`*^9, 
   3.9099942179545097`*^9}, {3.9100943293676853`*^9, 3.910094332955798*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"8b5fb3c2-5bf7-452c-9e24-f9ba97766897"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmPropertiesPhysical", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "*", "#2"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"conversionFactors", ",", "swarmProperties"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmPropertiesFiltered", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReplacePart", "[", 
       RowBox[{"#", ",", "\[IndentingNewLine]", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"removeOutliers", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Last", "@", "#"}], ",", 
             "outlierDeviationFactorsDefault"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "]"}], "&"}], "@", 
     "swarmPropertiesPhysical"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmPropertyHistograms", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getSmoothPropertyHistogram", "[", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "swarmPropertiesFiltered", ",", "axesLabelsPropsHistogram", ",", 
        "histogramRanges"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmPropertiesFilteredTimestamps", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"frameDurationSeconds", "*", 
           RowBox[{"swarmTrackTimestamps", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        "]"}], "&"}], "/@", "swarmPropertiesFiltered"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "swarmPropertiesFiltered"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.909263013833771*^9, 3.9092631284802237`*^9}, {
   3.9092631749676065`*^9, 3.909263177902175*^9}, {3.9092632156541853`*^9, 
   3.909263216071183*^9}, {3.90926331400706*^9, 3.909263322037692*^9}, {
   3.909263371439472*^9, 3.9092633865976496`*^9}, 3.9092636864790244`*^9, 
   3.9092640357523904`*^9, 3.909392353595733*^9, 3.9093923867793713`*^9, {
   3.9093948282768307`*^9, 3.909394855090789*^9}, {3.909662485200869*^9, 
   3.909662490252715*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"7145aba5-457e-43d5-ac2e-45aa91958d8f"],

Cell["\<\
Defaults :

upperThreshold=0.95;
lowerThreshold=1-upperThreshold;
sizeFactor=0.05;
splineOrder=3;
controlValueFactor=0.125;
envelopeRegularization=0.5;

binScale=10*10^-3;
dataMeanFilterScale=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.9094054360019426`*^9},
 FontSize->16,ExpressionUUID->"2cabacb7-dee0-4c77-b382-53288f3acb41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upperThreshold", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerThreshold", "=", 
   RowBox[{"1", "-", "upperThreshold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeFactor", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineOrder", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"controlValueFactor", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeRegularization", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binScale", "=", 
   RowBox[{"10", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataMeanFilterScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, 
   3.808647297464489*^9, {3.9077965118293796`*^9, 3.907796531988535*^9}, 
   3.9077966480270514`*^9, 3.9077972558054156`*^9, {3.907797307011591*^9, 
   3.907797317119295*^9}, 3.9077980032270746`*^9, 3.9077984785156126`*^9, 
   3.9093950991298914`*^9, {3.909395135307577*^9, 3.909395136219387*^9}, {
   3.9093990231939173`*^9, 3.909399052122301*^9}, {3.909399085858489*^9, 
   3.909399136218475*^9}, {3.9093994321780243`*^9, 3.9093994330097466`*^9}, {
   3.90940472574874*^9, 3.909404747904615*^9}, {3.909405209555008*^9, 
   3.9094052214074855`*^9}, 3.9094054341479125`*^9, 3.9095084219658012`*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"73163447-ec1e-4c6e-bbb1-b9283c127ce5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmPropertiesQSEfiltered", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"getFilteredDataQSE", "@", 
        RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
      "swarmPropertiesFilteredTimestamps"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"swarmPropertiesMeansDeviations", "=", 
   RowBox[{"getMeansDeviations", "/@", "swarmPropertiesQSEfiltered"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.909394957533396*^9, 3.9093949766652946`*^9}, {
   3.9093950562833123`*^9, 3.9093950573468366`*^9}, {3.9093958358104196`*^9, 
   3.9093958426185026`*^9}, {3.909398907738665*^9, 3.9093989172898307`*^9}, {
   3.909399019401739*^9, 3.909399040458167*^9}, 3.909399091225165*^9, 
   3.909400922570504*^9, {3.909508614608651*^9, 3.909508625320763*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"14a42249-7e5e-4f03-ad46-d94d11041c9d"],

Cell["\<\
Defaults :

timeSeriesPlotRanges={All};
areaPlotRanges={All,All,All};
errorBandOpacity=0.30;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, {3.9094008801385665`*^9, 3.90940091084125*^9}, {
   3.9094047346900177`*^9, 3.90940476714608*^9}},
 FontSize->16,ExpressionUUID->"8e75b9c6-2b1e-4e19-93c2-a1213f915a8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timeSeriesPlotRanges", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"50", ",", "All"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areaPlotRanges", "=", 
   RowBox[{"{", 
    RowBox[{
    "All", ",", "All", ",", "All", ",", "All", ",", "All", ",", "All", ",", 
     "All"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorBandOpacity", "=", "0.30"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909403686538426*^9, 3.909403696583669*^9}, {
   3.9094038050426455`*^9, 3.909403832090814*^9}, 3.909403867273486*^9, {
   3.9094039092121863`*^9, 3.9094039234813843`*^9}, {3.9094123383824396`*^9, 
   3.9094123803212967`*^9}, {3.9095073942938404`*^9, 
   3.9095074136966915`*^9}, {3.909508293926628*^9, 3.9095083011285768`*^9}, 
   3.9095097900371947`*^9, {3.9102624111657085`*^9, 3.9102624337176433`*^9}, {
   3.9139648843256273`*^9, 3.9139648852691345`*^9}, {3.9139743841017637`*^9, 
   3.913974391525851*^9}, {3.913980979133855*^9, 3.913980982382017*^9}, {
   3.9139810128142242`*^9, 3.9139810355501966`*^9}, {3.9140810666274424`*^9, 
   3.9140810741932116`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"0784dbd7-ae18-45c7-a4c1-8cce0e9a0db3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotSwarmAreas", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#1", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"First", "@", "axesLabelsPropsSeries"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "#2"}], ",", 
         RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", 
          RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"swarmPropertiesMeansDeviations", ",", "areaPlotRanges"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"plotSwarmAreas", "//", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"#", ",", 
      RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotSwarmProperties", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#1", ",", 
         RowBox[{"FrameLabel", "\[Rule]", "#2"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "#3"}], ",", 
         RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", 
          RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "swarmPropertiesMeansDeviations", "}"}], ",", 
        "axesLabelsPropsSeries", ",", "timeSeriesPlotRanges"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{"plotSwarmPropertiesAll", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{"plotSwarmProperties", ",", "swarmPropertyHistograms"}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "plotGridSize"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.909403382753851*^9, 3.9094033856911573`*^9}, {
   3.9094034199937153`*^9, 3.9094035660656133`*^9}, {3.9094035999068003`*^9, 
   3.9094037361374817`*^9}, {3.9094038177313156`*^9, 
   3.9094038273782034`*^9}, {3.909403879299282*^9, 3.9094038874349394`*^9}, {
   3.9094123565070925`*^9, 3.90941235779609*^9}, {3.909582518278656*^9, 
   3.9095825458616467`*^9}, {3.909582723398385*^9, 3.9095827621786394`*^9}, 
   3.909847616546605*^9, {3.910098359833454*^9, 3.91009837532902*^9}, {
   3.9100991907138333`*^9, 3.910099192213415*^9}, 3.9140811151004925`*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"0b816731-f2ae-4cab-951d-7fabd36ea8e9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", 
     RowBox[{
     "plotSwarmPropertiesAll", ",", "\"\<Swarm Properties\>\"", ",", 
      "plotGridSize"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"exportImagesTwoFormat", "[", 
       RowBox[{
        RowBox[{"plotSwarmAreas", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"\"\<Swarm Area \>\"", "<>", 
         RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "plotSwarmAreas"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.909403382753851*^9, 3.9094033856911573`*^9}, {
   3.9094034199937153`*^9, 3.9094035660656133`*^9}, {3.9094035999068003`*^9, 
   3.9094037361374817`*^9}, {3.9094038177313156`*^9, 
   3.9094038273782034`*^9}, {3.909403879299282*^9, 3.9094038874349394`*^9}, {
   3.9094123565070925`*^9, 3.90941235779609*^9}, {3.909582518278656*^9, 
   3.9095825458616467`*^9}, {3.909582723398385*^9, 3.9095827621786394`*^9}, 
   3.909847616546605*^9, {3.910098359833454*^9, 3.91009837532902*^9}, {
   3.9100991907138333`*^9, 3.910099192213415*^9}, 
   3.9140811151004925`*^9},ExpressionUUID->"e092479d-b7eb-49da-ac64-\
f7079286b2da"],

Cell[CellGroupData[{

Cell["Compute & Export Mean Swarm Radii", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676010210231*^9}, {3.91086426287315*^9, 
  3.9108642792716293`*^9}, {3.910864407713786*^9, 3.910864415984113*^9}, {
  3.913965836109617*^9, 
  3.9139658485264215`*^9}},ExpressionUUID->"d2b3a83d-1fa5-4f07-8fcd-\
f71a6d4b89cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"swarmRadiiMeansDeviations", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "@", "#"}], ",", 
         RowBox[{"StandardDeviation", "@", "#"}]}], "}"}], "&"}], "@", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "\[Pi]"}], ")"}], "*", 
          RowBox[{"#", "[", "\"\<Value\>\"", "]"}]}], "&"}], "/@", 
        RowBox[{"Last", "@", 
         RowBox[{"Transpose", "@", "#"}]}]}], "]"}]}], "&"}], "/@", 
    "swarmPropertiesMeansDeviations"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCSVfolder", "<>", "\"\<Swarm_radii_means_deviations.csv\>\""}], ",", 
    "swarmRadiiMeansDeviations", ",", "\"\<CSV\>\""}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9139651995396967`*^9, 3.9139652881332464`*^9}, {
  3.913965321062751*^9, 3.9139653308306704`*^9}, {3.913972841219969*^9, 
  3.9139728432228007`*^9}, {3.914081154035392*^9, 3.9140811700505714`*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"52b61d30-4898-4944-a300-cbda10b7f4c7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Properties VS Magnetic Field", "Subsection",
 CellChangeTimes->{{3.898162733575597*^9, 3.8981627597808433`*^9}, {
   3.899621968053005*^9, 3.8996219786639414`*^9}, {3.8996220424048824`*^9, 
   3.899622068414195*^9}, 
   3.9098477866334505`*^9},ExpressionUUID->"8bf01a32-89e4-4c7e-89ef-\
62c034762773"],

Cell[CellGroupData[{

Cell["Generate MF Data", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676010210231*^9}, {3.91086426287315*^9, 
  3.9108642792716293`*^9}, {3.910864407713786*^9, 
  3.910864415984113*^9}},ExpressionUUID->"866361f6-9c23-4f59-ba9f-\
7be61042f360"],

Cell["\<\
2019_11_13__8all:

fieldCheckpointsFrames={0,500,5996}//Round;
fieldConfigsMilitesla={{0,0,0},{0,0,-5}};
  --------------------------------------------------
2019_11_13_9all:

fieldCheckpointsFrames={0,500,1500,2000,2900,3500,4580,5105,6015,6360,7250,\
7950,8500,10000}//Round;

fieldConfigsMilitesla={{0,0,-5},{0,0.1,-5},{0,-0.2,-5},{0,0.2,-5},{0,0.2,-5},{\
0,0.2,-5},{-0.1,0,-5},{0.1,0,-5},{0,0.1,-5},{0,-0.1,-5},{-0.05,0,-5},{-0.1,0,-\
5},{0.1,0.1,-5}};
 --------------------------------------------------
2019_11_13_10all:

fieldCheckpointsFrames={0,200,975,1645,2690,3575,4215,4580,5000,6020,6219}//\
Round;

fieldConfigsMilitesla={{0,0,-3},{0,0,-5},{-0.1,0,-5},{0.1,0,-5},{-0.2,0,-5},{\
0.2,0,-5},{-0.2,0.2,-5},{0,0,-5},{0,0,-5},{0,0,0}};
  --------------------------------------------------
2019_11_13_11all:

fieldCheckpointsFrames={0,250,700,1200,1750,2300,3000,3250,5150,5925,6600,\
6800,7477}//Round;

fieldConfigsMilitesla={{0,0,-5},{0.2,0,-5},{0.3,0,-5},{-0.3,0,-5},{0.3,0,-5},{\
0,0,-5},{0.5,0,-5},{0,0,-5},{0.2,0,-5},{-0.2,0,-5},{-0.2,0.2,-5},{-0.2,-0.2,-\
5}};\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, {3.898277400950271*^9, 
   3.898277426859791*^9}, {3.89859864696354*^9, 3.8985986620304103`*^9}, {
   3.898763117266157*^9, 3.8987631198158092`*^9}, {3.9006694827888894`*^9, 
   3.900669520230598*^9}, {3.903191616181514*^9, 3.9031916301657963`*^9}, 
   3.903191987598387*^9, 3.9031997062702055`*^9, {3.9032030968702493`*^9, 
   3.903203103493866*^9}, {3.903346269546822*^9, 3.903346282220359*^9}, {
   3.9033481715280437`*^9, 3.9033481758725777`*^9}, {3.9033542130517173`*^9, 
   3.903354245579875*^9}, {3.9109640393794394`*^9, 3.910964101884325*^9}, {
   3.910964228445239*^9, 3.910964249076523*^9}, {3.9109659843565435`*^9, 
   3.910966006100197*^9}, {3.910966090934032*^9, 3.910966114683586*^9}, 
   3.9109667635422897`*^9, {3.910971680501651*^9, 3.9109716828532476`*^9}, 
   3.9109758947731323`*^9, 3.910983769837145*^9, 3.9109863385705566`*^9, {
   3.910986838982362*^9, 3.9109868467563677`*^9}, 3.910988276332876*^9, {
   3.911748124681164*^9, 3.9117481276105375`*^9}, {3.92167805011884*^9, 
   3.921678057295665*^9}, {3.921747793940508*^9, 3.921747801255406*^9}, {
   3.9224142210975585`*^9, 
   3.92241422802195*^9}},ExpressionUUID->"813df443-73b6-4b64-8dad-\
66f4dc6af49a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fieldCheckpointsFrames", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "250", ",", "700", ",", "1200", ",", "1750", ",", "2300", ",",
        "3000", ",", "3250", ",", "5150", ",", "5925", ",", "6600", ",", 
       "6800", ",", "7477"}], "}"}], "//", "Round"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldConfigsMilitesla", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.3"}], ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2"}], ",", "0", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2"}], ",", "0.2", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2"}], ",", 
       RowBox[{"-", "0.2"}], ",", 
       RowBox[{"-", "5"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8969484276649837`*^9, 3.8969487894694066`*^9}, {
   3.898262844889591*^9, 3.8982628733135023`*^9}, {3.898263004225397*^9, 
   3.8982630925055265`*^9}, {3.8982631521221285`*^9, 3.898263205824393*^9}, {
   3.8982632505790215`*^9, 3.8982632635368204`*^9}, {3.8987668157927504`*^9, 
   3.8987668910812254`*^9}, {3.8987669512203255`*^9, 
   3.8987669598784466`*^9}, {3.898767096537448*^9, 3.898767111310649*^9}, 
   3.898858082390723*^9, {3.900665213394578*^9, 3.9006653226181173`*^9}, {
   3.900665780906916*^9, 3.9006657813777094`*^9}, {3.9006658791062083`*^9, 
   3.900665920219293*^9}, {3.9006660021988506`*^9, 3.9006660029468637`*^9}, {
   3.9006661277561483`*^9, 3.9006661324655595`*^9}, {3.900666189666172*^9, 
   3.9006661956180253`*^9}, {3.9006667301966867`*^9, 3.900666758090833*^9}, {
   3.9006667965078416`*^9, 3.900666845099634*^9}, {3.9006670164744616`*^9, 
   3.900667044210621*^9}, {3.9006672714283915`*^9, 3.900667363148613*^9}, {
   3.9006674378197603`*^9, 3.9006675310438576`*^9}, {3.900667587564776*^9, 
   3.900667650099625*^9}, {3.90066775823657*^9, 3.900667781971939*^9}, {
   3.9006678151409945`*^9, 3.9006678348358335`*^9}, {3.900668066388611*^9, 
   3.900668273979498*^9}, {3.9006683790845647`*^9, 3.9006684551252985`*^9}, {
   3.9006684912204714`*^9, 3.900668507050602*^9}, 3.9006692199042854`*^9, {
   3.900669275213458*^9, 3.900669335948781*^9}, {3.900669555517208*^9, 
   3.9006696483180056`*^9}, 3.9006696930779705`*^9, {3.900669793045707*^9, 
   3.9006697983784943`*^9}, {3.900669828405391*^9, 3.9006700704547567`*^9}, {
   3.900670762841137*^9, 3.90067076610349*^9}, {3.900671217455453*^9, 
   3.9006712249892917`*^9}, {3.910862521241089*^9, 3.910862533451162*^9}, {
   3.9108626498896723`*^9, 3.9108626880084467`*^9}, {3.910863453168323*^9, 
   3.9108634565605955`*^9}, {3.910863493394738*^9, 3.910863494560268*^9}, {
   3.910863966584338*^9, 3.910863969120903*^9}, {3.910864321339134*^9, 
   3.9108643362569275`*^9}, {3.910864381513726*^9, 3.910864388145862*^9}, {
   3.9108680874972363`*^9, 3.9108680942563343`*^9}, 3.910868143395988*^9, {
   3.910868527177223*^9, 3.9108685272831593`*^9}, {3.910868571624769*^9, 
   3.910868572152528*^9}, {3.910869214841035*^9, 3.9108692785948973`*^9}, {
   3.910869324538303*^9, 3.9108693246168547`*^9}, {3.910869509306241*^9, 
   3.910869524960346*^9}, {3.9109391330868645`*^9, 3.9109391390618887`*^9}, 
   3.910939816222394*^9, {3.910939936286268*^9, 3.910939945980344*^9}, 
   3.9109399795891137`*^9, {3.9109400452298737`*^9, 3.910940049528414*^9}, {
   3.910940249137723*^9, 3.910940250133765*^9}, 3.910941878504943*^9, {
   3.910942540800077*^9, 3.9109425450690002`*^9}, {3.9109428798634305`*^9, 
   3.910942879926651*^9}, 3.9109589984049187`*^9, 3.91095941901446*^9, {
   3.9109654943648396`*^9, 3.910965538284351*^9}, {3.9109659937848434`*^9, 
   3.9109659962389984`*^9}, {3.9109660776070848`*^9, 3.910966111028432*^9}, {
   3.9109661438307867`*^9, 3.9109661580921497`*^9}, {3.910966568589036*^9, 
   3.9109666021351204`*^9}, {3.9109667019964066`*^9, 3.910966723184783*^9}, {
   3.91097070729333*^9, 3.910970747444674*^9}, {3.9109715823315105`*^9, 
   3.9109716476084275`*^9}, 3.9109716913967776`*^9, {3.910972905334238*^9, 
   3.910972905444206*^9}, {3.9109752653577776`*^9, 3.910975266044897*^9}, {
   3.9109753012772875`*^9, 3.9109754039534035`*^9}, {3.9109754348618803`*^9, 
   3.9109754492847524`*^9}, {3.910975767900222*^9, 3.9109757898286448`*^9}, {
   3.9109758284389524`*^9, 3.9109758445635552`*^9}, 3.9109837744690332`*^9, 
   3.9109841545265374`*^9, {3.910985181124452*^9, 3.9109851844673104`*^9}, {
   3.9109856977694225`*^9, 3.9109857239397154`*^9}, {3.9109858996780987`*^9, 
   3.9109859382369957`*^9}, {3.9109859718468885`*^9, 3.910985972684101*^9}, {
   3.9109860991603575`*^9, 3.91098614759064*^9}, {3.910986187332018*^9, 
   3.9109862869257584`*^9}, {3.910987122748584*^9, 3.9109872427917585`*^9}, {
   3.910987479372287*^9, 3.910987530421192*^9}, {3.910987579820819*^9, 
   3.9109875801034174`*^9}, {3.910987677942751*^9, 3.910987678844283*^9}, {
   3.9109877321403646`*^9, 3.9109877322954025`*^9}, 3.910987774116708*^9, {
   3.910987833069973*^9, 3.910987834531608*^9}, {3.91098786666911*^9, 
   3.910987895812622*^9}, 3.9109879561730986`*^9, 3.910988061665106*^9, 
   3.911653480158516*^9, 3.9116808718034434`*^9, 3.9117267833975945`*^9, 
   3.9117440093487763`*^9, 3.911744108195918*^9, {3.9117464749551334`*^9, 
   3.9117465014895377`*^9}, {3.911746802107004*^9, 3.9117468051934867`*^9}, 
   3.9117506183619895`*^9, 3.911751219811991*^9, 3.911752875670085*^9, 
   3.9164276246759424`*^9, 3.9164292535061474`*^9, 3.916477719944951*^9, 
   3.916477824742991*^9, 3.9164788702080564`*^9, 3.921650617143345*^9, 
   3.921677593136876*^9, {3.9216780323277655`*^9, 3.921678038112361*^9}, 
   3.9216834921736164`*^9, 3.921745104152915*^9, 3.9217473187903004`*^9, 
   3.9217475392883234`*^9, 3.921747611101606*^9, {3.921747658109948*^9, 
   3.921747670652076*^9}, 3.9302291407216716`*^9, 3.930296966330701*^9, 
   3.930297190331176*^9, {3.930300866292082*^9, 3.9303008686929502`*^9}, {
   3.9303021640545096`*^9, 3.9303021661963706`*^9}, 3.930302398736027*^9, {
   3.9303025793287153`*^9, 3.930302581967785*^9}, {3.930302942765521*^9, 
   3.9303029679107914`*^9}},
 CellLabel->
  "In[2647]:=",ExpressionUUID->"2deb2b02-b0e3-41a7-aba7-ac801b3f5ad1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fieldIntervalsFrames", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"partitionRagged", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "-", "1"}], ",", "1"}], "]"}], "&"}], 
     "@", "fieldCheckpointsFrames"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldMiliTesla", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"Subtract", "@@", "#2"}], "]"}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"fieldConfigsMilitesla", ",", "fieldIntervalsFrames"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.910862690594693*^9, 3.910862692546215*^9}, {
   3.910862725364212*^9, 3.9108627398239417`*^9}, {3.9108627793437862`*^9, 
   3.9108627854774456`*^9}, {3.910863467121209*^9, 3.9108635450724144`*^9}, {
   3.910863594074168*^9, 3.9108636540103874`*^9}, {3.910863876328967*^9, 
   3.910863878048293*^9}, 3.9108639099617043`*^9, 3.910864122794735*^9, {
   3.910864390704818*^9, 3.9108643954090805`*^9}, {3.9108651675554028`*^9, 
   3.9108651695285254`*^9}, {3.9109400478863797`*^9, 
   3.9109400506701536`*^9}, {3.910966363213521*^9, 3.910966385162018*^9}},
 CellLabel->
  "In[2649]:=",ExpressionUUID->"02fcbe69-f165-4b31-871c-9f0bb99c20d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Format & Trim MF Data", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
   3.8986760039148507`*^9, 3.898676010210231*^9}, 
   3.9109640248769183`*^9},ExpressionUUID->"a1176c37-7270-47ce-972a-\
ef04b415b1e8"],

Cell["\<\
2019_11_13__8all:

frameLowerLimit=750;
frameUpperLimit=All;
  --------------------------------------------------
2019_11_13_9all:

frameLowerLimit=1;
frameUpperLimit=All;
 --------------------------------------------------
2019_11_13_10all:

frameLowerLimit=1;
frameUpperLimit=6050;
  --------------------------------------------------
2019_11_13_11all:

frameLowerLimit=1;
frameUpperLimit=All;
 --------------------------------------------------

unitVectorMatcher={1,-1,1,-1};\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, {3.898277400950271*^9, 
   3.898277426859791*^9}, {3.89859864696354*^9, 3.8985986620304103`*^9}, {
   3.898763117266157*^9, 3.8987631198158092`*^9}, {3.9006694827888894`*^9, 
   3.900669520230598*^9}, {3.903191616181514*^9, 3.9031916301657963`*^9}, 
   3.903191987598387*^9, 3.9031997062702055`*^9, {3.9032030968702493`*^9, 
   3.903203103493866*^9}, {3.903346269546822*^9, 3.903346282220359*^9}, {
   3.9033481715280437`*^9, 3.9033481758725777`*^9}, {3.9033542130517173`*^9, 
   3.903354245579875*^9}, {3.9109640393794394`*^9, 3.9109641074036064`*^9}, {
   3.916479714253566*^9, 3.9164797401735363`*^9}, {3.921658038806306*^9, 
   3.9216580466780686`*^9}, {3.9216598465145693`*^9, 
   3.9216598475227404`*^9}, {3.9216601636300554`*^9, 3.9216601793245068`*^9}, 
   3.9216776197590213`*^9},ExpressionUUID->"a852991f-2473-4d78-a914-\
c0524be3ddf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"unitVectorMatcher", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameLowerLimit", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"frameUpperLimit", "=", "All"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89824375741146*^9, 3.898243771433616*^9}, {
   3.8982636470006905`*^9, 3.8982636814774885`*^9}, {3.898598595077031*^9, 
   3.8985986435327787`*^9}, {3.898759874459507*^9, 3.8987599810997972`*^9}, 
   3.898760122601976*^9, {3.898760234080479*^9, 3.898760235042351*^9}, {
   3.8987680274153976`*^9, 3.8987680308264265`*^9}, 3.900654972901105*^9, {
   3.9006662807543497`*^9, 3.900666314241929*^9}, 3.9006694909495926`*^9, {
   3.900669533070376*^9, 3.900669533628883*^9}, {3.9031901813661675`*^9, 
   3.903190181653324*^9}, {3.9031902202163115`*^9, 3.9031902490056953`*^9}, {
   3.9031903745591087`*^9, 3.9031903876252117`*^9}, {3.9031904229340925`*^9, 
   3.9031904255883017`*^9}, 3.9031916848017173`*^9, {3.903191722313541*^9, 
   3.9031917226685967`*^9}, {3.903191978351531*^9, 3.903191981052372*^9}, 
   3.9031997512706523`*^9, 3.9033455734731965`*^9, {3.90334816450301*^9, 
   3.903348164745387*^9}, 3.9033638911106224`*^9, 3.90336608808742*^9, 
   3.9033667845513*^9, 3.903367135231435*^9, 3.909412492968767*^9, {
   3.9095074808490725`*^9, 3.909507519501848*^9}, 3.9095091049042788`*^9, 
   3.909509810208299*^9, 3.9109655694788055`*^9, {3.910965878429405*^9, 
   3.910965879140086*^9}, 3.9109717000388355`*^9, 3.9109837859746294`*^9, 
   3.9109841626404934`*^9, 3.9109859862137585`*^9, 3.91098725272863*^9, 
   3.911680887054159*^9, 3.91172679158986*^9, 3.911744016388735*^9, 
   3.9117441203009605`*^9, 3.9117506265006905`*^9, 3.9117512320432515`*^9, 
   3.9117528869882436`*^9, 3.9164276492168217`*^9, 3.9164292741699486`*^9, 
   3.916477727888427*^9, 3.916477831893342*^9, 3.916478882814152*^9, 
   3.921658030836776*^9, 3.921659841356181*^9, {3.9216599290682726`*^9, 
   3.9216599778594947`*^9}, {3.9216601339655733`*^9, 3.921660182691346*^9}, {
   3.921660227205165*^9, 3.921660230355033*^9}, 3.9216776049759846`*^9, 
   3.9216780916005144`*^9, 3.9216835023010693`*^9, 3.921745112407454*^9, 
   3.9302291514800587`*^9, 3.9302969937948256`*^9, 3.9302972001625175`*^9, 
   3.9303008838657584`*^9, 3.9303021732110853`*^9, 3.930302407640788*^9, 
   3.930302591947626*^9, 3.930302975616832*^9},
 CellLabel->
  "In[2651]:=",ExpressionUUID->"ea52a271-0224-4176-a985-b2b4eab29e3a"],

Cell[BoxData[{
 RowBox[{"fieldMiliTesla", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"magneticFieldDataConverted", "=", 
   RowBox[{
    RowBox[{"unitVectorMatcher", "*", 
     RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "/@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "#"}]}], ",", "#"}], 
           "\[IndentingNewLine]", "}"}]}]}], "&"}], "@", 
       RowBox[{"fieldMiliTesla", "[", 
        RowBox[{"[", 
         RowBox[{"frameLowerLimit", ";;", "frameUpperLimit"}], "]"}], "]"}]}],
       "\[IndentingNewLine]", "]"}]}], "//", "Transpose"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.898162765409954*^9, 3.8981627674186697`*^9}, {
   3.898243376735528*^9, 3.898243378366433*^9}, {3.8982436862863636`*^9, 
   3.898243775538555*^9}, {3.898258386586837*^9, 3.898258407178158*^9}, {
   3.898263335325117*^9, 3.8982635104764695`*^9}, {3.898263586923706*^9, 
   3.898263643304959*^9}, {3.8982636772815604`*^9, 3.898263679369814*^9}, {
   3.89859856792721*^9, 3.898598579401127*^9}, 3.898598667940686*^9, 
   3.898760381779626*^9, 3.9006547011150055`*^9, {3.91086537309938*^9, 
   3.910865385592273*^9}},
 CellLabel->
  "In[2654]:=",ExpressionUUID->"a39a196d-506c-418f-92b5-c50aa5c0beb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legendMagneticField", "=", 
   RowBox[{"Placed", "[", 
    RowBox[{
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<B_x\>\"", ",", "\"\<B_y\>\"", ",", "\"\<B_z\>\""}], 
       "}"}]}], ",", "Top"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsMagneticField", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<t, ~s\>\"", ",", "\"\<B, ~mT\>\""}], "}"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909404212973961*^9, 3.909404284113989*^9}, 
   3.9094976601232786`*^9, {3.9095091093947687`*^9, 3.9095091110778484`*^9}, {
   3.9101190062515564`*^9, 3.9101190073598967`*^9}, {3.910865519737814*^9, 
   3.910865525312619*^9}, {3.910865574557152*^9, 3.910865574656616*^9}},
 CellLabel->
  "In[2657]:=",ExpressionUUID->"a116c67e-2eb5-494d-8264-64ff1c49cb2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"magneticFieldTimeSeries", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "k"}], "}"}], "]"}], "]"}]}], "&"}], "@", 
       RowBox[{"Transpose", "@", "magneticFieldDataConverted"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "2", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"magneticFieldTimeSeriesPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"frameDurationSeconds", ",", "1"}], "}"}], "*", 
        RowBox[{"Transpose", "@", "#"}]}], "]"}], "&"}], "/@", 
     "magneticFieldTimeSeries"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"plotMagneticFieldComponents", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "legendMagneticField"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", "axesLabelsMagneticField"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Dashed"}], "}"}], ",", "Automatic"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    "magneticFieldTimeSeriesPhysical"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotMagneticFieldComponentsXY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legendMagneticField"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", "axesLabelsMagneticField"}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Gray", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "@", "Red"}], ",", "Thick", ",", "Dashed"}], 
          "}"}], ",", "Automatic"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
    "&"}], "@", 
   RowBox[{"magneticFieldTimeSeriesPhysical", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8983400453092017`*^9, 3.898340054651702*^9}, {
   3.898522305565156*^9, 3.8985224404916945`*^9}, {3.8985882019446306`*^9, 
   3.898588208409618*^9}, {3.8986835866184835`*^9, 3.8986836001204777`*^9}, {
   3.8987600141622214`*^9, 3.8987600145542574`*^9}, {3.9006549839297223`*^9, 
   3.900654984389491*^9}, {3.9033457418524866`*^9, 3.9033457770542107`*^9}, {
   3.9094040107373657`*^9, 3.9094040218901653`*^9}, {3.9094041623151026`*^9, 
   3.9094041930581903`*^9}, {3.909404269925295*^9, 3.9094043032294455`*^9}, {
   3.909440712204692*^9, 3.909440732885144*^9}, {3.9094975195853205`*^9, 
   3.909497540112197*^9}, {3.910965680352026*^9, 3.9109657004927745`*^9}, {
   3.910965734884526*^9, 3.910965748191126*^9}, 3.91096595337366*^9, 
   3.9109667530165615`*^9, 3.9109717104319787`*^9, 3.9109721721186504`*^9, 
   3.910975326564229*^9, 3.910975954640602*^9, {3.9109859992596054`*^9, 
   3.910986002324278*^9}, 3.910986357306212*^9, {3.910987262715983*^9, 
   3.9109872668435783`*^9}, 3.9109882644860907`*^9, 3.9164276567728477`*^9},
 CellLabel->
  "In[2660]:=",ExpressionUUID->"175ccaab-2b09-4912-9fe4-76f04eb5eac2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotMagneticFieldComponents", ",", "\"\<Magnetic field dynamics\>\"", ",",
     "100"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotMagneticFieldComponentsXY", ",", "\"\<Magnetic field dynamics XY\>\"",
     ",", "100"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8983400453092017`*^9, 3.898340054651702*^9}, {
   3.898522305565156*^9, 3.8985224404916945`*^9}, {3.8985882019446306`*^9, 
   3.898588208409618*^9}, {3.8986835866184835`*^9, 3.8986836001204777`*^9}, {
   3.8987600141622214`*^9, 3.8987600145542574`*^9}, {3.9006549839297223`*^9, 
   3.900654984389491*^9}, {3.9033457418524866`*^9, 3.9033457770542107`*^9}, {
   3.9094040107373657`*^9, 3.9094040218901653`*^9}, {3.9094041623151026`*^9, 
   3.9094041930581903`*^9}, {3.909404269925295*^9, 3.9094043032294455`*^9}, {
   3.909440712204692*^9, 3.909440732885144*^9}, {3.9094975195853205`*^9, 
   3.909497540112197*^9}, {3.910965680352026*^9, 3.9109657004927745`*^9}, {
   3.910965734884526*^9, 3.910965748191126*^9}, 3.91096595337366*^9, 
   3.9109667530165615`*^9, 3.9109717104319787`*^9, 3.9109721721186504`*^9, 
   3.910975326564229*^9, 3.910975954640602*^9, {3.9109859992596054`*^9, 
   3.910986002324278*^9}, 3.910986357306212*^9, {3.910987262715983*^9, 
   3.9109872668435783`*^9}, 3.9109882644860907`*^9, {3.9164276567728477`*^9, 
   3.9164276585316772`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"dc9b4a7c-aa83-4d8e-8772-b20b2b796cd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axesLabelsAlphaSinDouble", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<t, ~s\>\"", ",", "\"\<\\\\sin{(2 \\\\alpha)}\>\""}], 
     "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9094976080561075`*^9, 3.909497626999402*^9}, {
   3.909497694270583*^9, 3.909497700493516*^9}, {3.9094978673061533`*^9, 
   3.909497869584978*^9}, 3.9102624896072955`*^9, {3.930229280338997*^9, 
   3.9302292813271303`*^9}},
 CellLabel->
  "In[2664]:=",ExpressionUUID->"096b3c11-2ffc-46b3-bbc9-709179b2d228"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"magneticFieldValues", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
     "magneticFieldTimeSeriesPhysical"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"magneticFieldInPlaneMagnitude", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"#", "^", "2"}], "+", 
        RowBox[{
         RowBox[{"magneticFieldValues", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "]"}], "&"}], "/@", 
     RowBox[{"magneticFieldValues", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "alphaSinX", ",", "alphaCosX", ",", "alphaSinY", ",", "alphaCosY"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "/", 
           RowBox[{"magneticFieldInPlaneMagnitude", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{"magneticFieldValues", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"k", ",", "3"}], "}"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], ";"}], "//", "Quiet"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaSinDouble", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"First", "@", "magneticFieldTimeSeriesPhysical"}]}]}], ",",
          "#"}], "\[IndentingNewLine]", "}"}]}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "*", "alphaSinX", "*", "alphaCosX"}], ",", 
       RowBox[{"2", "*", "alphaSinY", "*", "alphaCosY"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotAlphaSinDoubleXY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "legendMagneticField"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", "axesLabelsAlphaSinDouble"}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Gray", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Lighter", "@", "Red"}], ",", "Thick", ",", "Dashed"}], 
          "}"}], ",", "Automatic"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
    "&"}], "@", "alphaSinDouble"}]}]}], "Input",
 CellChangeTimes->{{3.9094875342153444`*^9, 3.909487554390221*^9}, {
   3.9094878242000885`*^9, 3.9094878312163506`*^9}, {3.9094878771123075`*^9, 
   3.9094879404979143`*^9}, {3.9094879790671606`*^9, 3.9094880017969904`*^9}, 
   3.909488065527977*^9, {3.909488424456438*^9, 3.9094884260472975`*^9}, {
   3.909491181758931*^9, 3.9094912247045126`*^9}, {3.90949145003193*^9, 
   3.909491452804073*^9}, {3.9094938836899586`*^9, 3.9094938877101517`*^9}, {
   3.909497462872465*^9, 3.9094975015109673`*^9}, {3.9094975775527153`*^9, 
   3.90949759573627*^9}, 3.909497652584334*^9, {3.9094978257692237`*^9, 
   3.9094978279504657`*^9}, {3.909497905705418*^9, 3.9094979238629446`*^9}, {
   3.9095044021285496`*^9, 3.909504436153357*^9}, {3.909507560592224*^9, 
   3.9095075675355015`*^9}, {3.916427681252904*^9, 3.916427683861888*^9}},
 CellLabel->
  "In[2665]:=",ExpressionUUID->"51cd338e-78c8-4655-a82f-f818b3cc9e4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotAlphaSinDoubleXY", ",", "\"\<Magnetic field angles\>\"", ",", "100"}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9094875342153444`*^9, 3.909487554390221*^9}, {
   3.9094878242000885`*^9, 3.9094878312163506`*^9}, {3.9094878771123075`*^9, 
   3.9094879404979143`*^9}, {3.9094879790671606`*^9, 3.9094880017969904`*^9}, 
   3.909488065527977*^9, {3.909488424456438*^9, 3.9094884260472975`*^9}, {
   3.909491181758931*^9, 3.9094912247045126`*^9}, {3.90949145003193*^9, 
   3.909491452804073*^9}, {3.9094938836899586`*^9, 3.9094938877101517`*^9}, {
   3.909497462872465*^9, 3.9094975015109673`*^9}, {3.9094975775527153`*^9, 
   3.90949759573627*^9}, 3.909497652584334*^9, {3.9094978257692237`*^9, 
   3.9094978279504657`*^9}, {3.909497905705418*^9, 3.9094979238629446`*^9}, {
   3.9095044021285496`*^9, 3.909504436153357*^9}, {3.909507560592224*^9, 
   3.9095075675355015`*^9}, 3.916427681252904*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"124d05cb-df29-4605-99ca-87638c72ec18"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Trimmed MF Data >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676010210231*^9}, {3.9033606575501795`*^9, 
  3.903360669637213*^9}, {3.9033616132632313`*^9, 
  3.9033616157800207`*^9}},ExpressionUUID->"09a11bdb-599d-4128-8ca6-\
4afa4f014b72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dataCSVfolder", "<>", "\"\<MF_(t,Bx,By,Bz)_trimmed.csv\>\""}], 
    ",", "magneticFieldDataConverted", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9033606982485566`*^9, 3.9033607754294615`*^9}, {
   3.9033616081404514`*^9, 3.903361609918125*^9}, {3.903363689059876*^9, 
   3.903363738348754*^9}, 3.9101197146868906`*^9, 3.910975966183741*^9},
 CellLabel->
  "In[486]:=",ExpressionUUID->"2052b9e8-4553-4ad8-beef-6e6c128e2ef3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter Trajectories", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 
  3.89867603204245*^9}},ExpressionUUID->"f960c329-9585-45fd-b6c5-\
d8e98d5810b9"],

Cell["\<\
Defaults :
   
trackMedianFilterRadius=1;
trackMeanFilterRadius=3;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.8908425153957324`*^9, {3.8928934797030935`*^9, 3.8928934798552217`*^9}, {
   3.8985908615127296`*^9, 3.8985908762882476`*^9}, {3.898676093234967*^9, 
   3.8986760964994974`*^9}, 3.90319999998997*^9, 3.903200196583158*^9, 
   3.9032030771169357`*^9, 3.9033626890902786`*^9, 3.911747204788563*^9},
 FontSize->16,ExpressionUUID->"dc9ff0dd-9f9d-483b-8b48-a82f91596828"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trackMedianFilterRadius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackMeanFilterRadius", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8985978232944307`*^9, 3.898597849755835*^9}, 
   3.898597978503209*^9, 3.8985998693001623`*^9, 3.8985999192543383`*^9, {
   3.9031905091659803`*^9, 3.9031905257849245`*^9}, {3.903199913021906*^9, 
   3.903199918717378*^9}, {3.9032000549837265`*^9, 3.9032000604685993`*^9}, {
   3.9032001008462667`*^9, 3.9032001571409073`*^9}, {3.903201230613509*^9, 
   3.903201232477075*^9}, {3.903348254473486*^9, 3.903348261965263*^9}, {
   3.9033626108296504`*^9, 3.9033627324365616`*^9}, {3.903363484079732*^9, 
   3.903363515126348*^9}, {3.9033641291008177`*^9, 3.9033641586436806`*^9}, {
   3.9033646060209107`*^9, 3.9033646239581604`*^9}, {3.903364659405802*^9, 
   3.9033646611250315`*^9}, {3.9033649517359905`*^9, 3.90336495249329*^9}, 
   3.9033650523914185`*^9, {3.9094043831708317`*^9, 3.9094043900892305`*^9}, 
   3.9094046295370307`*^9, 3.9094053367697115`*^9, {3.9094056521063128`*^9, 
   3.909405681163542*^9}, 3.9094083643227663`*^9, 3.9094125941868834`*^9, {
   3.9094127061714106`*^9, 3.9094127314654493`*^9}, {3.909412761905676*^9, 
   3.9094127658339157`*^9}, 3.909430386593902*^9, 3.909432950733183*^9, {
   3.909433672820341*^9, 3.909433701451419*^9}, {3.909440817379698*^9, 
   3.909440845339138*^9}, {3.9109658319974422`*^9, 3.9109658484930058`*^9}, {
   3.9109669049970713`*^9, 3.9109669237805862`*^9}, {3.9116725706568193`*^9, 
   3.911672572497185*^9}, {3.916477884900732*^9, 3.916477894392233*^9}, {
   3.9217451577102647`*^9, 3.9217451795905933`*^9}},
 CellLabel->
  "In[2670]:=",ExpressionUUID->"e08c32e2-7af0-49d9-bf68-af882e10dec3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmTracksFiltered", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
       RowBox[{"getFilteredTrack", "/@", 
        RowBox[{"Transpose", "@", "#"}]}], "\[IndentingNewLine]", "]"}], 
      "&"}], "/@", "swarmTracksClean"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"swarmTracksClean", "[", 
      RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"swarmTracksFiltered", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.898595090599412*^9, 3.898595224816209*^9}, {
   3.898595277926711*^9, 3.898595324220087*^9}, {3.898596873413954*^9, 
   3.898596886065287*^9}, {3.898597820674354*^9, 3.8985978403653264`*^9}, {
   3.898675800284095*^9, 3.8986758047567425`*^9}, {3.898684446225766*^9, 
   3.8986844480713573`*^9}, {3.8986844883954053`*^9, 
   3.8986845132321186`*^9}, {3.8987604023957043`*^9, 
   3.8987604066011086`*^9}, {3.903192117671473*^9, 3.9031921334328127`*^9}, {
   3.9031998926258345`*^9, 3.9031999082615905`*^9}, {3.9032000810554256`*^9, 
   3.9032000831071835`*^9}, 3.903200135302474*^9, 3.9032002049114394`*^9, {
   3.9094127077710714`*^9, 3.909412708645258*^9}, 3.9094283775650153`*^9, {
   3.9116759185754814`*^9, 3.9116759246671877`*^9}},
 CellLabel->
  "In[2672]:=",ExpressionUUID->"fc1226d1-8d6e-4c3c-84d4-5c58fdad56ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Swarm Velocity Components", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 
  3.898676047100078*^9}},ExpressionUUID->"b34878bb-6a6a-47a7-86b7-\
81bbf9f4f890"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"displacementsXY", "=", 
   RowBox[{"Transpose", "/@", 
    RowBox[{"Differences", "/@", "swarmTracksFiltered"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"displacementsX", ",", "displacementsY"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"First", "/@", "#"}], ",", 
       RowBox[{"Last", "/@", "#"}]}], "}"}], "&"}], "@", 
    "displacementsXY"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaTime", "=", 
    RowBox[{"Differences", "/@", "swarmTrackTimestamps"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"velocityComponentsMerged", "=", 
     RowBox[{"getTimeScaledVelocityValues", "[", "\[IndentingNewLine]", 
      RowBox[{"displacementsX", ",", "displacementsY", ",", "deltaTime"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrackVelocityTimestamps", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "/@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", "All"}], "]"}], "]"}], ",", "#2"}], "}"}]}]}],
        "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackTimestamps", ",", 
        RowBox[{"Transpose", "/@", "velocityComponentsMerged"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmTrackVelocityTimestampsClean", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Delete", "[", 
        RowBox[{"#1", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"#", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "0"}], "&"}], ")"}]}]}], "]"}], 
           "&"}], "@", "#2"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackVelocityTimestamps", ",", "deltaTime"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmVelocityComponents", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getComponents", "[", "\[IndentingNewLine]", 
         RowBox[{"swarmTrackVelocityTimestampsClean", ",", "k", ",", "#"}], 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "swarmTrackVelocityTimestampsClean"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
    "swarmVelocityComponents"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"Background", "\[Rule]", "White"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9031926803188186`*^9, 3.9031927292613716`*^9}, {
   3.9031989721653624`*^9, 3.9031989739761305`*^9}, 3.9033621746491966`*^9, 
   3.9033622226165247`*^9, {3.90336245662221*^9, 3.9033625053294077`*^9}, 
   3.9033627578008614`*^9, {3.903364643806217*^9, 3.9033646486136155`*^9}, {
   3.9094056273143053`*^9, 3.9094056350975113`*^9}, {3.9109667911961584`*^9, 
   3.9109667924838657`*^9}},
 CellLabel->
  "In[2675]:=",ExpressionUUID->"c810184b-5739-4be0-b913-a2f72a884319"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Swarm Velocity Components Raw >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676047100078*^9}, {3.9033608193887224`*^9, 
  3.9033608371250944`*^9}},ExpressionUUID->"395e076c-4dd8-4a9f-8e2c-\
877951e8abed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmVelocityComponentsRawExport", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"First", "@", "#"}]}], ",", 
           RowBox[{"Last", "@", 
            RowBox[{"First", "@", "#"}]}], ",", 
           RowBox[{"Last", "@", 
            RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}], 
         "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"Transpose", "/@", "#"}], ")"}]}], "&"}], "/@", 
     "swarmVelocityComponents"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataCSVfolder", "<>", "\"\<Velocity_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,x,y)_raw.csv\>\""}], 
      ",", 
      RowBox[{"swarmVelocityComponentsRawExport", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<CSV\>\""}], 
     "\[IndentingNewLine]", "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "swarmVelocityComponentsRawExport"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9033557204104815`*^9, 3.903355994613435*^9}, {
   3.903356172664744*^9, 3.9033561765410357`*^9}, {3.903360842028736*^9, 
   3.903360908349412*^9}, {3.903361624429884*^9, 3.903361630613931*^9}, {
   3.909404436121483*^9, 3.909404437493656*^9}, 3.910119725241911*^9},
 CellLabel->
  "In[500]:=",ExpressionUUID->"b4b7f8cf-802c-4fb2-8758-4cd2bf7834ab"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter Swarm Velocity Components", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 
  3.898676067035427*^9}},ExpressionUUID->"0d4321dc-2683-4ce9-981b-\
6f3052b2ff12"],

Cell["\<\
Defaults :

upperThreshold=0.95;
lowerThreshold=1-upperThreshold;
sizeFactor=0.05;
splineOrder=3;
controlValueFactor=0.125;
envelopeRegularization=0.5;

binScale=7.5*10^-3;
dataMeanFilterScale=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9},
 FontSize->16,ExpressionUUID->"1cbcba8e-b51d-44af-b1d2-fd36d2c36324"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upperThreshold", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerThreshold", "=", 
   RowBox[{"1", "-", "upperThreshold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeFactor", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineOrder", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"controlValueFactor", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeRegularization", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binScale", "=", 
   RowBox[{"7.5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataMeanFilterScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, 
   3.808647297464489*^9, {3.9077965118293796`*^9, 3.907796531988535*^9}, 
   3.9077966480270514`*^9, 3.9077972558054156`*^9, {3.907797307011591*^9, 
   3.907797317119295*^9}, 3.9077980032270746`*^9, 3.9077984785156126`*^9, 
   3.9093950991298914`*^9, {3.909395135307577*^9, 3.909395136219387*^9}, {
   3.9093990231939173`*^9, 3.909399052122301*^9}, {3.909399085858489*^9, 
   3.909399136218475*^9}, {3.9093994321780243`*^9, 3.9093994330097466`*^9}, {
   3.90940472574874*^9, 3.909404747904615*^9}, {3.909405209555008*^9, 
   3.9094052214074855`*^9}, {3.9094054221692467`*^9, 
   3.9094054228571606`*^9}, {3.9094084042263236`*^9, 3.909408422729328*^9}, 
   3.9094085982187595`*^9, 3.909412637873679*^9, {3.909433772341075*^9, 
   3.9094337841729617`*^9}, {3.9094344828992395`*^9, 
   3.9094344933804784`*^9}, {3.9094345753375015`*^9, 
   3.9094347668117933`*^9}, {3.9117274635240273`*^9, 3.911727464482492*^9}, {
   3.9303009201374474`*^9, 3.9303009212533073`*^9}},
 CellLabel->
  "In[2683]:=",ExpressionUUID->"983dfd0e-cc5d-487f-84c7-1914f314c805"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"testIDs", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"testData", "=", 
     RowBox[{"swarmVelocityComponents", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"First", "@", "testIDs"}], ",", 
        RowBox[{"Last", "@", "testIDs"}]}], "]"}], "]"}]}], ";", "\n", 
    RowBox[{"testData", "//", "ListPlot"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"testCleanData", "=", 
      RowBox[{"getFilteredDataQSE", "@", "testData"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"testDataMeansDeviations", "=", 
     RowBox[{"getMeansDeviations", "@", "testCleanData"}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"testData", ",", "testCleanData"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Gray"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{"testDataMeansDeviations", ",", 
          RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
          RowBox[{"IntervalMarkersStyle", "\[Rule]", 
           RowBox[{"Opacity", "@", "0.3"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.898589032794186*^9, 3.898589037381921*^9}, {
   3.898590411830922*^9, 3.898590456106402*^9}, {3.898590545342611*^9, 
   3.89859054994191*^9}, {3.898590583816875*^9, 3.8985905969253826`*^9}, {
   3.898597059086673*^9, 3.8985970661046505`*^9}, {3.8985971264389906`*^9, 
   3.898597135380801*^9}, 3.8985979484120874`*^9, {3.8985980137822905`*^9, 
   3.898598038575865*^9}, {3.8985988019203978`*^9, 3.8985988146699038`*^9}, {
   3.8986761077262397`*^9, 3.898676110139247*^9}, {3.8986765161246495`*^9, 
   3.898676517036128*^9}, {3.898684532674124*^9, 3.8986845750648003`*^9}, 
   3.8987604745421968`*^9, 3.903198482365985*^9, 3.9031990017682257`*^9, 
   3.903343620557289*^9, {3.90336402753296*^9, 3.9033640288371115`*^9}, {
   3.9033650020442963`*^9, 3.9033650246847916`*^9}, 3.9033664572457666`*^9, {
   3.909404809570223*^9, 3.909404836181225*^9}, 3.909405489984702*^9, 
   3.909405695340417*^9, {3.9094084553061676`*^9, 3.9094084736966515`*^9}, {
   3.9094085798993764`*^9, 3.9094085810259113`*^9}, {3.9094125850938873`*^9, 
   3.909412586730441*^9}, 3.9094283996576023`*^9, 3.90942855065876*^9, {
   3.9094296408769536`*^9, 3.909429655707926*^9}, {3.909434290733005*^9, 
   3.909434311413319*^9}, {3.909435169051008*^9, 3.909435171293999*^9}, {
   3.909436157284436*^9, 3.9094361640268946`*^9}, 3.909504235251887*^9, 
   3.909507595733921*^9, 
   3.9303022089988794`*^9},ExpressionUUID->"c4b7ea0b-46ce-4aaf-ad90-\
45dca811ce9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"swarmVelocityComponentsFiltered", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getMeansDeviations", "@", 
         RowBox[{"getFilteredDataQSE", "@", 
          RowBox[{"swarmVelocityComponents", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "#"}], "]"}], "]"}]}]}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "swarmVelocityComponents"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8985990634060535`*^9, 3.898599089768958*^9}, {
   3.898599947848337*^9, 3.898599958825661*^9}, {3.8986000264301176`*^9, 
   3.8986000325043535`*^9}, {3.8986228748221035`*^9, 
   3.8986228867453537`*^9}, {3.898622923825957*^9, 3.8986229566753416`*^9}, {
   3.898675966364079*^9, 3.898675972613348*^9}, {3.909434347130108*^9, 
   3.909434355409131*^9}, {3.910988580046401*^9, 3.910988585835807*^9}, 
   3.9109886327832108`*^9},
 CellLabel->
  "In[2691]:=",ExpressionUUID->"7ce266c6-3685-4dc1-adc5-c246e0b10561"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Swarm Velocity Components Filtered >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676047100078*^9}, {3.9033608193887224`*^9, 
  3.9033608371250944`*^9}, {3.903360963428008*^9, 
  3.903360964337104*^9}},ExpressionUUID->"8a6eb74b-e2a3-45fe-8367-\
d9d4d2d95327"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"velocityFilteredExportX", ",", "velocityFilteredExportY"}], 
     "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "/@", "#"}], ",", 
        RowBox[{"Last", "/@", "#"}]}], "}"}], "&"}], "@", 
     "swarmVelocityComponentsFiltered"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dataCSVfolder", "<>", "\"\<VelocityX_\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", 
        "\"\<_(t,Vx)_filtered.csv\>\""}], ",", 
       RowBox[{"velocityFilteredExportX", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "velocityFilteredExportX"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dataCSVfolder", "<>", "\"\<VelocityY_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,Vy)_filtered.csv\>\""}],
       ",", 
      RowBox[{"velocityFilteredExportY", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "velocityFilteredExportY"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9033616613213854`*^9, 3.90336172804629*^9}, {
   3.903361794718576*^9, 3.903361801900568*^9}, {3.903361884797722*^9, 
   3.903361921533622*^9}, {3.9095042532548385`*^9, 3.909504254398655*^9}, 
   3.910119897207467*^9},
 CellLabel->
  "In[514]:=",ExpressionUUID->"e7c1b683-f3a3-4e36-b962-6a09ca19345f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Velocity VS MF", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676067035427*^9}, {3.8986761528510475`*^9, 
  3.898676156229147*^9}},ExpressionUUID->"82cb850a-3b92-4205-b973-\
52c41a22e494"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dualAxesLabelsVelocity", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", "\"\<v_x, ~\\\\mu m / s\>\"", ",", 
         "\"\<\\\\sin{(2 \\\\alpha_y)}\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", "\"\<v_y, ~\\\\mu m / s\>\"", ",", 
         "\"\<\\\\sin{(2 \\\\alpha_x)}\>\""}], "}"}]}], "\[IndentingNewLine]",
       "}"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dualAxesPlotOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "75"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotRangeOffsetScaleTwoAxis", "=", "0.55"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldIDs", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8985939765261803`*^9, 3.8985939873049927`*^9}, {
   3.8985941455342436`*^9, 3.89859416885956*^9}, {3.898594234830408*^9, 
   3.898594290503089*^9}, {3.898594373519801*^9, 3.898594373599333*^9}, {
   3.898594405575328*^9, 3.898594411125588*^9}, {3.8985944527081404`*^9, 
   3.898594495166823*^9}, {3.898597914307908*^9, 3.8985979326931214`*^9}, {
   3.8986230063128233`*^9, 3.8986230243860655`*^9}, {3.8986740455179515`*^9, 
   3.8986741060145326`*^9}, {3.898674976360115*^9, 3.898674980736599*^9}, {
   3.898675619728263*^9, 3.8986756261391244`*^9}, 3.89867593863755*^9, {
   3.898676442147967*^9, 3.898676452195609*^9}, {3.8987426682829924`*^9, 
   3.898742669521597*^9}, 3.898742726057741*^9, {3.9031991635827613`*^9, 
   3.9031991722865696`*^9}, 3.903199292728819*^9, {3.903199342536827*^9, 
   3.903199344566481*^9}, {3.9032021459913726`*^9, 3.9032021905836525`*^9}, {
   3.903202243224204*^9, 3.9032022777195435`*^9}, {3.9032025240540276`*^9, 
   3.903202524430153*^9}, {3.903202750821556*^9, 3.903202820799604*^9}, {
   3.903202858757059*^9, 3.903202896405727*^9}, 3.9033482907220683`*^9, {
   3.903367313997806*^9, 3.9033673670944986`*^9}, {3.909435342050088*^9, 
   3.9094353665548334`*^9}, {3.909436151185877*^9, 3.9094361515479097`*^9}, {
   3.909436886077448*^9, 3.9094368869050255`*^9}, {3.9094395943224087`*^9, 
   3.9094396336103773`*^9}, 3.909440396296693*^9, 3.909504281317786*^9, {
   3.9095046403427873`*^9, 3.909504687137659*^9}, {3.909506677128521*^9, 
   3.9095066850234113`*^9}, {3.909507686024558*^9, 3.909507696144578*^9}, {
   3.91012067935421*^9, 3.9101206813671803`*^9}, {3.9101208236310396`*^9, 
   3.9101208453758955`*^9}, {3.922414208789729*^9, 3.922414211478199*^9}},
 CellLabel->
  "In[2692]:=",ExpressionUUID->"df2adb57-517a-4d6a-ab38-b6cc4b66bebd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmVelocityComponentsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"frameDurationSeconds", ",", 
            RowBox[{"pixelSizeMicroMeters", "/", "frameDurationSeconds"}]}], 
           "}"}], "*", 
          RowBox[{"Transpose", "@", "#"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "#"}], "&"}], "/@", 
     "swarmVelocityComponentsFiltered"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotVelocityMF", "=", 
    RowBox[{"getAllComponentPlotsErrors", "[", "\[IndentingNewLine]", 
     RowBox[{
     "swarmVelocityComponentsPhysical", ",", "dualAxesLabelsVelocity"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"plotVelocityMF", ",", 
   RowBox[{"ImageSize", "\[Rule]", "1500"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "0"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.909434985310771*^9, 3.909435092136547*^9}, {
  3.9094352470601335`*^9, 3.909435317013934*^9}, {3.909435372076614*^9, 
  3.9094355072586765`*^9}, {3.9094359321829877`*^9, 3.909435995264948*^9}, {
  3.9094362014048157`*^9, 3.909436211800033*^9}, {3.909436287180253*^9, 
  3.909436298018798*^9}, {3.909486171680139*^9, 3.9094861839680743`*^9}, {
  3.9094862505043955`*^9, 3.9094862527913527`*^9}, {3.909505306943135*^9, 
  3.90950530775432*^9}, {3.910967025078765*^9, 3.910967053565894*^9}, {
  3.910988471328761*^9, 3.9109884786650176`*^9}, {3.910988568105504*^9, 
  3.910988574444318*^9}},
 CellLabel->
  "In[2697]:=",ExpressionUUID->"8b2578c4-68f6-407b-bdf4-e876e855803c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotVelocityMF", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"\"\<Velocity vs MF Swarm \>\"", "<>", 
       RowBox[{"ToString", "@", "#"}]}], ",", "Automatic"}], 
     "\[IndentingNewLine]", "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "plotVelocityMF"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[524]:=",ExpressionUUID->"d5f1de6b-3021-4b1b-9288-ee632226ab6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity Interval Means", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
   3.8986760039148507`*^9, 3.898676067035427*^9}, {3.8986761528510475`*^9, 
   3.898676156229147*^9}, {3.9101318200547075`*^9, 3.9101318228784213`*^9}, {
   3.910135418950343*^9, 3.9101354307999983`*^9}, 
   3.9108925528962145`*^9},ExpressionUUID->"7df839f5-6180-4a46-8a1d-\
f87c21a12d6e"],

Cell["\<\
2019_11_13__8all:

velocityRangeLimiters={{0,10000},{0,0},{0,0}};
  --------------------------------------------------
2019_11_13_9all:

velocityRangeLimiters={{185,425},{0,135}};
 --------------------------------------------------
2019_11_13_10all:

velocityRangeLimiters={{0,10000}};
>> velocityRangeLimiters={{5,260}}; <<
  --------------------------------------------------
2019_11_13_11all:

velocityRangeLimiters={{15,10000},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}};
  --------------------------------------------------
intervalLengthThreshold=15;\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, {3.898277400950271*^9, 
   3.898277426859791*^9}, {3.89859864696354*^9, 3.8985986620304103`*^9}, {
   3.898763117266157*^9, 3.8987631198158092`*^9}, {3.9006694827888894`*^9, 
   3.900669520230598*^9}, {3.903191616181514*^9, 3.9031916301657963`*^9}, 
   3.903191987598387*^9, 3.9031997062702055`*^9, {3.9032030968702493`*^9, 
   3.903203103493866*^9}, {3.903346269546822*^9, 3.903346282220359*^9}, {
   3.9033481715280437`*^9, 3.9033481758725777`*^9}, {3.9033542130517173`*^9, 
   3.903354245579875*^9}, {3.9109640393794394`*^9, 3.910964101884325*^9}, {
   3.910964228445239*^9, 3.910964249076523*^9}, {3.9109659843565435`*^9, 
   3.910966006100197*^9}, {3.910966090934032*^9, 3.910966114683586*^9}, 
   3.9109667635422897`*^9, {3.9109675052451715`*^9, 3.910967538238149*^9}, 
   3.910983891421586*^9, 3.9109846611898623`*^9, 3.9109870454973354`*^9, {
   3.9109891568585825`*^9, 3.910989169539901*^9}, 3.9116787688408346`*^9, 
   3.9116798558495717`*^9, 3.91168022481963*^9, 3.911682413001412*^9, 
   3.9117366085786247`*^9, {3.9117471700809484`*^9, 3.9117471846366277`*^9}, 
   3.911752680026119*^9, {3.916478054868432*^9, 
   3.9164780559723587`*^9}},ExpressionUUID->"c144d9c9-135b-4e16-8668-\
b384e2ab8f81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldIDcombos", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"Reverse", "@", "#"}]}], "}"}], "&"}], "@", "fieldIDs"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervalLengthThreshold", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"velocityRangeLimiters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"15", ",", "10000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9101323677185698`*^9, 3.91013236852494*^9}, {
   3.9101324666565514`*^9, 3.910132515671155*^9}, 3.9101327529197793`*^9, 
   3.9101335415367765`*^9, {3.910893536487836*^9, 3.910893539982418*^9}, 
   3.9108935834469123`*^9, {3.9109434563861203`*^9, 3.9109434651580663`*^9}, {
   3.9109480653329086`*^9, 3.910948074212752*^9}, {3.9109482026058884`*^9, 
   3.9109482039467764`*^9}, 3.9109594726250706`*^9, {3.910968429678896*^9, 
   3.9109684457639756`*^9}, 3.9109762328849816`*^9, 3.910983895694992*^9, 
   3.91098421719825*^9, {3.910984506196704*^9, 3.910984506595991*^9}, 
   3.9109845379089394`*^9, {3.9109846104936004`*^9, 3.9109846105555477`*^9}, {
   3.910986491684102*^9, 3.91098649536327*^9}, {3.9109866539473906`*^9, 
   3.91098668305173*^9}, {3.9109890007805443`*^9, 3.9109890047814665`*^9}, {
   3.910989038925212*^9, 3.910989039344098*^9}, 3.91098908142754*^9, {
   3.910989145469306*^9, 3.91098914571548*^9}, {3.9116783985468006`*^9, 
   3.9116784079630375`*^9}, {3.9116787737062016`*^9, 3.911678851298145*^9}, {
   3.911678926961584*^9, 3.911678933657365*^9}, 3.911679000518543*^9, {
   3.911679036459346*^9, 3.9116790475004363`*^9}, {3.9116796126194935`*^9, 
   3.9116797045305552`*^9}, 3.9116798480457487`*^9, {3.911679939821254*^9, 
   3.911679988690634*^9}, {3.911680925148615*^9, 3.9116809277944202`*^9}, {
   3.911682010298067*^9, 3.911682011458741*^9}, {3.911682162049903*^9, 
   3.9116821650247955`*^9}, {3.9116822212443585`*^9, 
   3.9116822224450254`*^9}, {3.9116823786909633`*^9, 3.911682379713291*^9}, 
   3.9117347571995015`*^9, {3.911735358201887*^9, 3.9117353584664016`*^9}, {
   3.9117354239788113`*^9, 3.9117354486517773`*^9}, {3.9117393472756577`*^9, 
   3.9117393478576913`*^9}, 3.9117441888439107`*^9, 3.9117448676591454`*^9, {
   3.9117469800273314`*^9, 3.911746980513673*^9}, 3.911750646582123*^9, 
   3.9117512553959384`*^9, {3.9117518113941994`*^9, 3.91175181975543*^9}, {
   3.911751928099313*^9, 3.9117519283785105`*^9}, {3.9117519621548967`*^9, 
   3.911751962232924*^9}, {3.911752043586455*^9, 3.911752045497141*^9}, {
   3.9117526355638037`*^9, 3.9117526562989736`*^9}, 3.9117530688278294`*^9, 
   3.9164293583303013`*^9, {3.9164779206839447`*^9, 3.9164779230767384`*^9}, {
   3.9164780581415844`*^9, 3.916478059332555*^9}, {3.9164794878889384`*^9, 
   3.916479490959199*^9}, 3.921659785053114*^9, 3.9216777059921036`*^9, 
   3.9216781603209624`*^9, 3.9216835372283955`*^9, 3.921683664852358*^9, {
   3.921747715946311*^9, 3.921747718709241*^9}, {3.9302970577153077`*^9, 
   3.9302970602546806`*^9}, 3.930297288658223*^9, {3.9303009473290243`*^9, 
   3.930300949797423*^9}, 3.930302231889308*^9, {3.930302451878523*^9, 
   3.9303024545084877`*^9}, 3.930302634198717*^9, {3.930303016039215*^9, 
   3.9303030270437326`*^9}},
 CellLabel->
  "In[2700]:=",ExpressionUUID->"99adb719-4196-4c03-9738-9facb66b3b3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fieldValueIntervals", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Subtract", "@@", "#"}], "]"}], ">", 
                   "intervalLengthThreshold"}], "&"}]}], "]"}], "&"}], "@", 
              RowBox[{"partitionRagged", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"Length", "@", "#"}], "-", "1"}], ",", "1"}], 
               "]"}]}], "&"}], "@", 
            RowBox[{"Sort", "@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MinMax", "@", 
                 RowBox[{"First", "@", 
                  RowBox[{"Transpose", "@", "#1"}]}]}], ",", 
                RowBox[{"getFieldSwitchTimings", "@", "#2"}]}], 
               "\[IndentingNewLine]", "}"}]}]}]}], "&"}], "@@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"swarmVelocityComponentsPhysical", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "#"}], "]"}], "]"}], "&"}], "@", "#1"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"alphaSinDouble", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", "#2"}]}], 
           "\[IndentingNewLine]", "}"}]}], "&"}], ",", "fieldIDcombos"}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "swarmVelocityComponentsPhysical"}]}], "}"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Reverse", "/@", "fieldValueIntervals"}], "//", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"#", ",", 
      RowBox[{"TableSpacing", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", " ", "5"}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.910131954908075*^9, 3.910132087953351*^9}, {
   3.91013219516965*^9, 3.9101322630888977`*^9}, {3.910132327266255*^9, 
   3.910132448006078*^9}, {3.9101325272475567`*^9, 3.910132578396311*^9}, {
   3.910132644976116*^9, 3.9101327467683344`*^9}, {3.9101333680963154`*^9, 
   3.910133400926573*^9}, {3.9101338413531165`*^9, 3.91013390985494*^9}, {
   3.910891979129223*^9, 3.9108919882461414`*^9}, {3.9109402019746494`*^9, 
   3.9109402029333615`*^9}, {3.9109474234250417`*^9, 3.91094744550193*^9}, 
   3.9109480778160257`*^9, {3.9109482694540634`*^9, 3.9109482929893103`*^9}, 
   3.9109488350529337`*^9, 3.9109809133973875`*^9, 3.911679887132615*^9},
 CellLabel->
  "In[2703]:=",ExpressionUUID->"762e014b-474b-45a5-aaae-697246733e4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intervalAlphaSinDoubleVelocityMeans", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], "&"}], 
        "/@", "#"}], "&"}], "/@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"#", ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Head", "@", "#"}], "\[Equal]", " ", "Mean"}], 
                   "&"}], ")"}]}]}], "]"}], "&"}], "@", "#"}]}], "]"}], "&"}],
          "/@", 
         RowBox[{"getIntervalMeansVelocityMF", "[", 
          RowBox[{"swarmID", ",", "componentID"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"swarmID", ",", "1", ",", 
          RowBox[{"Length", "@", "swarmVelocityComponentsPhysical"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"componentID", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervalAlphaSinDoubleVelocityMeans", "//", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"#", ",", 
      RowBox[{"TableSpacing", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", " ", "5"}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.910889962587171*^9, 3.910889970198374*^9}, {
   3.910890162352089*^9, 3.91089019662406*^9}, {3.9108902351204643`*^9, 
   3.910890312864328*^9}, {3.910890351199136*^9, 3.9108903992527976`*^9}, {
   3.9108904583912506`*^9, 3.9108904587417707`*^9}, 3.9108911224623456`*^9, {
   3.9108911615451717`*^9, 3.910891166582079*^9}, 3.9108913573185496`*^9, {
   3.910891805326487*^9, 3.9108919171520643`*^9}, 3.9108919918722787`*^9, {
   3.9108922429758835`*^9, 3.9108922767682257`*^9}, {3.9108923168972263`*^9, 
   3.910892352062977*^9}, {3.9109401781662436`*^9, 3.9109401985738044`*^9}, {
   3.9109562505750093`*^9, 3.9109562518777995`*^9}, {3.9109571157114058`*^9, 
   3.9109571285634875`*^9}, {3.9109572009270315`*^9, 3.910957291093892*^9}, 
   3.9109573591652646`*^9, {3.9109577701746845`*^9, 3.910957836471204*^9}, {
   3.910957886662382*^9, 3.910957897547619*^9}, {3.9109579407340717`*^9, 
   3.9109579459610443`*^9}, 3.910957996031221*^9, 3.9109763685319915`*^9, {
   3.910979074108097*^9, 3.910979094878386*^9}, {3.9109792041830654`*^9, 
   3.9109792354889975`*^9}, 3.9109793902819138`*^9, {3.9109794432574835`*^9, 
   3.910979495254649*^9}, {3.911679979989244*^9, 3.9116799811721497`*^9}},
 CellLabel->
  "In[2705]:=",ExpressionUUID->"bcebd0db-79ba-4188-b257-4f9a36d2fc85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", 
     "\"\<Sin(2a) Velocity Interval Means.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "intervalAlphaSinDoubleVelocityMeans"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.910893645990801*^9, 3.910893731345605*^9}, {
  3.9108947841191072`*^9, 3.910894785469654*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"e29eb6f4-44b5-460f-af63-29a31e7d1e13"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deviations from theory LHR VS MF", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676067035427*^9}, {3.8986761528510475`*^9, 
  3.898676156229147*^9}, {3.8986856954638596`*^9, 3.898685697910928*^9}, {
  3.930294331017793*^9, 
  3.930294345077278*^9}},ExpressionUUID->"528ce22e-f55e-4b23-a0ab-\
34c0d788d495"],

Cell[BoxData[
 RowBox[{"fieldSwitchIntervalsGlobal", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Interval", "/@", 
          RowBox[{"partitionRagged", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"Length", "@", "#"}], "-", "1"}], ",", "1"}], "]"}]}], 
         "&"}], "@", "\[IndentingNewLine]", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Sort", "@", 
          RowBox[{"Append", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{"First", "@", 
             RowBox[{"Last", "@", 
              RowBox[{"First", "@", "alphaSinDouble"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "&"}], "@", 
      RowBox[{"Prepend", "[", 
       RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{"getFieldSwitchTimings", "/@", "alphaSinDouble"}], 
     "\[IndentingNewLine]", "]"}]}], "//", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"MinMax", "@", "#"}]}], "]"}], ">", 
        "intervalLengthThreshold"}], "&"}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.930216594880848*^9, 3.9302165952880883`*^9}, {
   3.9302166479451475`*^9, 3.9302166699831934`*^9}, {3.9302172939594717`*^9, 
   3.93021732866557*^9}, {3.9302174975047483`*^9, 3.9302175192742386`*^9}, {
   3.9302176145336823`*^9, 3.93021761687914*^9}, {3.9302176902547445`*^9, 
   3.930217698310541*^9}, {3.9302177571870637`*^9, 3.930217765385225*^9}, {
   3.930217833449692*^9, 3.9302178441201725`*^9}, {3.930217894689593*^9, 
   3.930217976323365*^9}, 3.9302943547553425`*^9, {3.9303013604545813`*^9, 
   3.9303013681580453`*^9}, 3.930301425190259*^9, {3.9303024881645317`*^9, 
   3.930302488916136*^9}},
 CellLabel->
  "In[2708]:=",ExpressionUUID->"dbf3359a-755d-490c-ae0b-59ce2bd353a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"intervalInPlaneFieldMeanGlobal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Median", "/@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Last", "/@", 
          RowBox[{"Select", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"IntervalMemberQ", "[", 
              RowBox[{
               RowBox[{"fieldSwitchIntervalsGlobal", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"First", "@", "#"}]}], "]"}], "&"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "fieldSwitchIntervalsGlobal"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
     RowBox[{"magneticFieldTimeSeriesPhysical", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "//", "Transpose"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intervalInPlaneFieldMagnitude", "=", 
    RowBox[{"Norm", "/@", "intervalInPlaneFieldMeanGlobal"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"intervalVerticalFieldMagnitude", "=", 
    RowBox[{"Abs", "@", 
     RowBox[{"Median", "@", 
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Last", "@", "magneticFieldTimeSeriesPhysical"}]}]}]}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intervalFieldMagnitude", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"#", ",", "intervalVerticalFieldMagnitude"}], "}"}], "]"}], 
      "&"}], "/@", "intervalInPlaneFieldMagnitude"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"intervalAlphaSin", ",", "intervalAlphaCos"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "/", "intervalFieldMagnitude"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "intervalInPlaneFieldMagnitude", ",", 
       "intervalVerticalFieldMagnitude"}], "\[IndentingNewLine]", "}"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"intervalAlphaSinDouble", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"Times", "@@", "#"}]}], "&"}], "/@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"intervalAlphaSin", ",", "intervalAlphaCos"}], 
     "}"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.9302195881138473`*^9, 3.9302196206885633`*^9}, {
   3.930221057264368*^9, 3.9302211547977047`*^9}, {3.9302214793027325`*^9, 
   3.9302215554924936`*^9}, {3.930223207020459*^9, 3.930223225035343*^9}, {
   3.930225549348584*^9, 3.9302255624571977`*^9}, {3.9302287035365553`*^9, 
   3.9302287038596992`*^9}, 3.930290868033184*^9, {3.930290913038058*^9, 
   3.9302909187800837`*^9}, {3.9302943860347843`*^9, 3.9302943966430387`*^9}, 
   3.930297423770601*^9},
 CellLabel->
  "In[2709]:=",ExpressionUUID->"911e6b45-dd4d-4d93-97a2-59e6846fa380"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"allTracksWithTimestamps", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"frameDurationSeconds", "*", "#1"}], ",", "#2"}], "}"}], 
        "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackTimestamps", ",", "swarmTracksClean"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allTrackFragmentsFieldIntervals", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"IntervalMemberQ", "[", 
             RowBox[{
              RowBox[{"fieldSwitchIntervalsGlobal", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"First", "@", "#"}]}], "]"}], "&"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "fieldSwitchIntervalsGlobal"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     "allTracksWithTimestamps"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLinePlot", "@", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "&"}], "@", 
  RowBox[{"allTrackFragmentsFieldIntervals", "[", 
   RowBox[{"[", "testID", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.930229977227626*^9, 3.930229988711302*^9}, {
   3.9302300961676517`*^9, 3.9302301426667323`*^9}, {3.9302301853075914`*^9, 
   3.930230259214013*^9}, {3.9302304046564045`*^9, 3.930230411026168*^9}, {
   3.930230707142808*^9, 3.9302307115565825`*^9}, {3.930230751174795*^9, 
   3.9302307519419785`*^9}, {3.9302310497269077`*^9, 
   3.9302310505831585`*^9}, {3.930231208734575*^9, 3.930231209325733*^9}, {
   3.9302341333971095`*^9, 3.9302341354206166`*^9}, {3.930235952951004*^9, 
   3.930235964851926*^9}, {3.9302923754289274`*^9, 3.9302923926282606`*^9}, 
   3.9302924900524654`*^9, 3.9302933481959987`*^9, {3.9302944309766755`*^9, 
   3.93029444279537*^9}},
 CellLabel->
  "In[2715]:=",ExpressionUUID->"5d9bd8fb-506d-4131-9fe5-11ff718491b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trackID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testData", "=", 
   RowBox[{"allTrackFragmentsFieldIntervals", "[", 
    RowBox[{"[", 
     RowBox[{"trackID", ",", "testID"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testModel", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"LinearModelFit", "[", 
      RowBox[{"#", ",", "x", ",", "x"}], "]"}], "&"}], "@", "testData"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFitFunction", "[", "x_", "]"}], "=", 
   RowBox[{"Normal", "@", "testModel"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testReferencePoints", "=", 
    RowBox[{"getFarthestPoints", "@", "testData"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testReferenceModel", "=", 
   RowBox[{"LinearModelFit", "[", 
    RowBox[{"testReferencePoints", ",", "x", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testReferenceFitFunction", "[", "x_", "]"}], "=", 
    RowBox[{"Normal", "@", "testReferenceModel"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Lighter", "@", "Gray"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"testFitFunction", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Min", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "#"}]}]}], ",", 
            RowBox[{"Max", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "#"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Thick", ",", "Dashed"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"testReferenceFitFunction", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Min", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "#"}]}]}], ",", 
            RowBox[{"Max", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Transpose", "@", "#"}]}]}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "@", "Green"}], ",", "Thick", ",", "Dashed"}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "}"}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
     "]"}], "&"}], "@", "testData"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFitResults", "=", 
    RowBox[{
     RowBox[{"First", "/@", 
      RowBox[{"Last", "/@", 
       RowBox[{"Normal", "/@", 
        RowBox[{"{", 
         RowBox[{"testModel", ",", "testReferenceModel"}], "}"}]}]}]}], "//", 
     "Mean"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"testMotionAngle", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Around", "@@", 
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"#", "*", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Last", "@", 
           RowBox[{"testModel", "[", "\"\<ParameterErrors\>\"", "]"}]}], "/", 
          RowBox[{"First", "@", 
           RowBox[{"Last", "@", 
            RowBox[{"Normal", "@", "testModel"}]}]}]}], "]"}]}]}], "}"}]}], 
    "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"180", "*", 
     RowBox[{
      RowBox[{"ArcTan", "@", "testFitResults"}], "/", "\[Pi]"}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.9302308705693064`*^9, 3.930230875575852*^9}, 
   3.9302309331275268`*^9, {3.930230998590905*^9, 3.9302310705508485`*^9}, {
   3.9302313605209894`*^9, 3.930231366670201*^9}, {3.9302313971192026`*^9, 
   3.9302314571678777`*^9}, {3.930231516231711*^9, 3.930231562754999*^9}, {
   3.93023160717575*^9, 3.930231792135622*^9}, {3.9302318799062552`*^9, 
   3.9302319786069765`*^9}, {3.93023200950362*^9, 3.9302320160629406`*^9}, {
   3.930232293903263*^9, 3.9302323390696344`*^9}, {3.9302324326060314`*^9, 
   3.930232474151712*^9}, {3.93023250899172*^9, 3.9302325709121485`*^9}, {
   3.930233576542012*^9, 3.930233592349511*^9}, {3.9302364413803177`*^9, 
   3.9302364414985895`*^9}, 3.930236479821094*^9, 3.9302365473749056`*^9, 
   3.930236657389577*^9, {3.9302372778435535`*^9, 3.930237394628677*^9}, {
   3.930279374659336*^9, 3.930279383101405*^9}, {3.930279417838516*^9, 
   3.9302794242049932`*^9}, {3.9302808158956633`*^9, 
   3.9302809196990943`*^9}, {3.930285225139346*^9, 3.9302852284610386`*^9}, {
   3.930286322962101*^9, 3.930286325376122*^9}, {3.930288460681843*^9, 
   3.9302884632577524`*^9}, {3.930288642672371*^9, 3.93028882786383*^9}, {
   3.930288919705657*^9, 3.930288929687907*^9}, {3.930289698990819*^9, 
   3.9302897429352393`*^9}, {3.9302898142363453`*^9, 3.930289823521704*^9}, {
   3.9302898759744153`*^9, 3.9302899446422653`*^9}, {3.9302899850901012`*^9, 
   3.930289996215762*^9}, {3.93029005984649*^9, 3.9302900600295258`*^9}, {
   3.9302900979328747`*^9, 3.930290106903393*^9}, 3.9302904180902095`*^9, {
   3.930290448757373*^9, 3.930290462935318*^9}, {3.930291622383794*^9, 
   3.9302917117171574`*^9}, {3.9302917868630657`*^9, 3.930291875853984*^9}, {
   3.930292398438202*^9, 3.9302924213334336`*^9}, {3.930292499620907*^9, 
   3.9302925177958956`*^9}, {3.930294452126466*^9, 3.930294456592902*^9}, 
   3.930297087020709*^9, {3.930297465713245*^9, 3.930297547823615*^9}, 
   3.9302975810015116`*^9, {3.9303010128838096`*^9, 3.9303011201741533`*^9}, {
   3.930302275853573*^9, 3.9303022799009123`*^9}, 3.9303025003583403`*^9, 
   3.930302675719367*^9},
 CellLabel->
  "In[2719]:=",ExpressionUUID->"dfb290fa-597a-4bc3-878c-b1c28d78d957"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allTrackFragmentMotionAngles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], ">", "2"}], ",", 
         RowBox[{"getEffectiveMotionAngle", "@", "#"}], ",", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
      "#"}], "&"}], "/@", "allTrackFragmentsFieldIntervals"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldInPlaneAngles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", "/", "\[Pi]"}], ")"}], "*", 
      RowBox[{"Chop", "@", 
       RowBox[{"ArcTan", "@", 
        RowBox[{"Tan", "@", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", "#"}], "]"}]}]}]}]}], "&"}], 
    "/@", "intervalInPlaneFieldMeanGlobal"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deviationAnglesLHR", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"intervalAlphaSinDouble", ",", "#"}], "}"}]}], "&"}], "@", 
        RowBox[{"Abs", "[", "\[IndentingNewLine]", 
         RowBox[{"90", "-", 
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", "fieldInPlaneAngles"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
      "allTrackFragmentMotionAngles"}], "//", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "@", 
          RowBox[{"Last", "@", "#"}]}], "\[Equal]", "Around"}], "&"}]}], 
      "]"}], "&"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "@", "deviationAnglesLHR"}]}], "Input",
 CellChangeTimes->{{3.9302904805349956`*^9, 3.9302905358935237`*^9}, {
   3.930290567527429*^9, 3.9302906717883143`*^9}, {3.93029071427199*^9, 
   3.930290718180855*^9}, {3.930290800598282*^9, 3.9302908045056953`*^9}, {
   3.9302908432221675`*^9, 3.930290843283307*^9}, {3.9302919693515744`*^9, 
   3.9302921286194506`*^9}, {3.9302921877089415`*^9, 3.930292214836069*^9}, {
   3.9302922804122553`*^9, 3.930292286475353*^9}, 3.930292359730307*^9, 
   3.930292729575833*^9, {3.930292938283964*^9, 3.9302929391717467`*^9}, {
   3.9302931536442385`*^9, 3.930293165394956*^9}, 3.9302933955011783`*^9, 
   3.930293856605671*^9, {3.930294179116605*^9, 3.9302941813901973`*^9}, {
   3.9302944856204348`*^9, 3.9302944954978046`*^9}, 3.9303017229089603`*^9, 
   3.9303017561249075`*^9, {3.9303022978002176`*^9, 3.9303023095865173`*^9}, {
   3.930302700052473*^9, 3.9303027005256085`*^9}, {3.930303094158251*^9, 
   3.9303031014772005`*^9}, {3.930303302971793*^9, 3.930303303341813*^9}, 
   3.9303033454935617`*^9},ExpressionUUID->"4fab3728-165b-4dcc-9fa3-\
281cbd4ffd61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", 
     "\"\<Sin(2a) Deviation Angles LHR.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "deviationAnglesLHR"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9302948821723404`*^9, 3.930294883271675*^9}, {
  3.9302966681445026`*^9, 3.930296671927945*^9}, {3.9302967070330467`*^9, 
  3.9302967166640863`*^9}, {3.9302967586349745`*^9, 3.9302967655042286`*^9}, {
  3.93030205761306*^9, 3.9303020588853545`*^9}},
 CellLabel->
  "In[2776]:=",ExpressionUUID->"46df5a12-d2dc-47e6-92b2-be76f68235bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Displacements VS MF", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676067035427*^9}, {3.8986761528510475`*^9, 
  3.898676156229147*^9}, {3.8986856954638596`*^9, 
  3.898685697910928*^9}},ExpressionUUID->"556010c6-1ffd-4ead-989e-\
fcb219559cde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dualAxesLabelsDisplacements", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<t, ~s\>\"", ",", "\"\<s_x, ~\\\\mu m\>\"", ",", 
        "\"\<\\\\sin{(2 \\\\alpha_y)}\>\""}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<t, ~s\>\"", ",", "\"\<s_y, ~\\\\mu m\>\"", ",", 
        "\"\<\\\\sin{(2 \\\\alpha_x)}\>\""}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8987427753529525`*^9, 3.8987428019739037`*^9}, {
  3.9095049277272143`*^9, 3.9095049312388506`*^9}, {3.909506006905217*^9, 
  3.9095060249262037`*^9}, {3.9101206672975826`*^9, 3.910120669946045*^9}, {
  3.9101209038049154`*^9, 3.910120911633355*^9}},
 CellLabel->
  "In[533]:=",ExpressionUUID->"3104037c-d9f2-4560-82be-da2bdde1a190"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmAccumulatedDisplacementsTimeStamps", "=", 
    RowBox[{
    "getAccumulatedDisplacementSeries", "@", 
     "swarmTrackVelocityTimestampsClean"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmAccumulatedDisplacementsTimeStampsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"frameDurationSeconds", ",", "pixelSizeMicroMeters"}], 
           "}"}], "*", 
          RowBox[{"Transpose", "@", "#"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "#"}], "&"}], "/@", 
     "swarmAccumulatedDisplacementsTimeStamps"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotDisplacementsMF", "=", 
    RowBox[{"getAllComponentPlots", "[", "\[IndentingNewLine]", 
     RowBox[{
     "swarmAccumulatedDisplacementsTimeStampsPhysical", ",", 
      "dualAxesLabelsDisplacements"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{"plotDisplacementsMF", ",", 
   RowBox[{"ImageSize", "\[Rule]", "1500"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "0"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8986857111212015`*^9, 3.898685723058674*^9}, {
   3.898709567402011*^9, 3.8987096016802797`*^9}, {3.8987096405867014`*^9, 
   3.8987099145197277`*^9}, {3.8987099775194893`*^9, 3.898709995919655*^9}, {
   3.8987100448663073`*^9, 3.8987100762340956`*^9}, {3.89876372796842*^9, 
   3.8987637770963907`*^9}, 3.903199441080248*^9, 3.909504954549507*^9, 
   3.909505013766646*^9, {3.909505168518875*^9, 3.909505170573763*^9}, {
   3.909505520526503*^9, 3.909505526591449*^9}, {3.9095078089694777`*^9, 
   3.909507812266514*^9}, {3.911746832932764*^9, 3.9117468345704393`*^9}},
 CellLabel->
  "In[534]:=",ExpressionUUID->"9159a50b-1d64-4839-9dc8-2d19247c9548"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotDisplacementsMF", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"\"\<Displacements vs MF Swarm \>\"", "<>", 
       RowBox[{"ToString", "@", "#"}]}], ",", "Automatic"}], 
     "\[IndentingNewLine]", "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "plotDisplacementsMF"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.909504809317527*^9, 3.909504878246711*^9}, {
  3.909505705471507*^9, 3.909505714934314*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"adb514ba-f702-41b0-ab51-f0e614d46dd6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dualAxesLabelsAbsDisplacements", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", "\"\<\\\\lvert {s_x} \\\\rvert, ~\\\\mu m\>\"", 
         ",", "\"\<\\\\sin{(2 \\\\alpha_y)}\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", "\"\<\\\\lvert {s_y} \\\\rvert, ~\\\\mu m\>\"", 
         ",", "\"\<\\\\sin{(2 \\\\alpha_x)}\>\""}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8987427753529525`*^9, 3.8987428019739037`*^9}, {
   3.898759020784358*^9, 3.898759065902239*^9}, {3.8987592232976246`*^9, 
   3.8987592538204317`*^9}, {3.9095062252794237`*^9, 
   3.9095062528085794`*^9}, {3.910120743415522*^9, 3.9101208155602975`*^9}, 
   3.9109668291663027`*^9},
 CellLabel->
  "In[539]:=",ExpressionUUID->"5e0f3b65-57f5-436c-8b4d-ca41a6c568fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"swarmAccumulatedAbsDisplacementsTimeStamps", "=", 
    RowBox[{"getAccumulatedDisplacementSeries", "@", 
     RowBox[{"Abs", "@", "swarmTrackVelocityTimestampsClean"}]}]}], ";", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"swarmAccumulatedAbsDisplacementsTimeStampsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"frameDurationSeconds", ",", "pixelSizeMicroMeters"}], 
           "}"}], "*", 
          RowBox[{"Transpose", "@", "#"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "#"}], "&"}], "/@", 
     "swarmAccumulatedAbsDisplacementsTimeStamps"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"plotAbsDisplacementsMF", "=", 
    RowBox[{"getAllComponentPlots", "[", "\[IndentingNewLine]", 
     RowBox[{
     "swarmAccumulatedAbsDisplacementsTimeStampsPhysical", ",", 
      "dualAxesLabelsAbsDisplacements"}], "\[IndentingNewLine]", "]"}]}], ";",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
    RowBox[{"plotAbsDisplacementsMF", ",", 
     RowBox[{"ImageSize", "\[Rule]", "1500"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "0"}], ",", 
     RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.8986857111212015`*^9, 3.898685723058674*^9}, {
   3.898709567402011*^9, 3.8987096016802797`*^9}, {3.8987096405867014`*^9, 
   3.8987099145197277`*^9}, {3.8987099775194893`*^9, 3.898709995919655*^9}, {
   3.8987100448663073`*^9, 3.8987100762340956`*^9}, {3.8987589534731336`*^9, 
   3.8987589822569065`*^9}, {3.8987606697552986`*^9, 
   3.8987606807294364`*^9}, {3.898763798297455*^9, 3.8987638069769464`*^9}, 
   3.9032029923696365`*^9, {3.9095061977021112`*^9, 3.9095062182717857`*^9}, 
   3.9109668322811313`*^9},
 CellLabel->
  "In[540]:=",ExpressionUUID->"b9d61981-91a4-4004-a9e2-28b162f95c01"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Swarm Displacement Components >>", "Subsubsection",
 CellChangeTimes->{{3.894621178899432*^9, 3.894621204919121*^9}, {
  3.8986760039148507`*^9, 3.898676047100078*^9}, {3.9033608193887224`*^9, 
  3.9033608371250944`*^9}, {3.903360963428008*^9, 3.903360964337104*^9}, {
  3.9033620374202995`*^9, 
  3.90336204342797*^9}},ExpressionUUID->"1ddc216f-07f4-42c4-b4ec-\
227881748377"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmDisplacementComponentsExport", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"First", "@", "#"}]}], ",", 
           RowBox[{"Last", "@", 
            RowBox[{"First", "@", "#"}]}], ",", 
           RowBox[{"Last", "@", 
            RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}], 
         "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"Transpose", "/@", "#"}], ")"}]}], "&"}], "/@", 
     "swarmAccumulatedDisplacementsTimeStamps"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dataCSVfolder", "<>", "\"\<Displacement_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<_(t,Sx,Sy).csv\>\""}], ",", 
      RowBox[{"swarmDisplacementComponentsExport", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<CSV\>\""}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "swarmDisplacementComponentsExport"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9033616613213854`*^9, 3.90336172804629*^9}, {
   3.903361794718576*^9, 3.903361801900568*^9}, {3.903361884797722*^9, 
   3.903361921533622*^9}, {3.9033632558707237`*^9, 3.903363348884994*^9}, 
   3.910120963727137*^9},
 CellLabel->
  "In[541]:=",ExpressionUUID->"2cf0dcd2-01e9-4895-90ad-27f269e4d262"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accretion Bacteria Metrics & Statistics", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 3.8468307830344753`*^9}, {3.8852951251696224`*^9, 
  3.885295127082173*^9}, {3.889042301650259*^9, 3.8890423160585136`*^9}, {
  3.8890423778257504`*^9, 3.889042384505704*^9}, {3.889641809228165*^9, 
  3.8896418322718515`*^9}},ExpressionUUID->"8ad86480-474e-440f-8bd8-\
4195c436c7cb"],

Cell[CellGroupData[{

Cell["Generate Elliptic Masks", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900527497713842`*^9, 
  3.8900527514278126`*^9}, {3.890055849461161*^9, 3.890055855962562*^9}, {
  3.890056958222869*^9, 3.8900569663704796`*^9}, {3.8935004810972085`*^9, 
  3.8935004811883345`*^9}, {3.8940913500803013`*^9, 3.8940913505979166`*^9}, {
  3.8996226366245604`*^9, 
  3.899622642290779*^9}},ExpressionUUID->"77ae0bdd-4dff-4190-a1cc-\
4a7bb0060c86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ellipseRulesets", "=", 
       RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"getEllipseRulesets", "/@", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Last", "/@", 
               RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Centroid\>\"", ",", "\"\<SemiAxes\>\"", ",", 
                   "\"\<Orientation\>\""}], "}"}]}], "\[IndentingNewLine]", 
                "]"}]}]}]}]}], ")"}], "&"}], ",", "globalSwarmCoreSegments"}],
         "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "globalSwarmCoreSegments"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"globalEllipseMasks", "=", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"getEllipticMaskAlternative", "@", "#"}]}], ")"}], "&"}], 
        ",", "ellipseRulesets"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "ellipseRulesets"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.899622315681904*^9, 3.899622333567719*^9}, 
   3.899622583217607*^9},
 CellLabel->
  "In[244]:=",ExpressionUUID->"ff62a270-4319-4cde-a60d-ae66a369198b"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Global Ellipse Masks >>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 
  3.889281702495319*^9}},ExpressionUUID->"5ac8e20f-d91a-4902-a8db-\
c66342a89093"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"compressedGlobalEllipseMasks", "=", 
    RowBox[{
     RowBox[{"Compress", "/@", "globalEllipseMasks"}], "//", 
     "Parallelize"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalEllipseMaskFolder", "=", 
   RowBox[{"output", "<>", "\"\<2 Global Ellipse Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "globalEllipseMaskFolder"}], ";"}], "//", 
   "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "compressedGlobalEllipseMasks", ",", "globalEllipseMaskFolder", ",", 
     "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
  3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
  3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
  3.8899823107674785`*^9, 3.8899823272756615`*^9}, {3.8905273675904617`*^9, 
  3.8905273678406887`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"33611bab-2561-41d7-96d3-dbcfa111dadb"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Global Ellipse Masks <<", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
  3.8892820855119534`*^9}},ExpressionUUID->"9909a735-b261-4450-a413-\
48580e1bcf39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"globalEllipseMaskFolder", "=", 
    RowBox[{"output", "<>", "\"\<2 Global Ellipse Masks\\\\\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "globalEllipseMaskFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"globalEllipseMasks", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"globalEllipseMaskFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896255885199213`*^9, 3.8896255896557426`*^9}, {3.8905273625651274`*^9, 
   3.8905273628452773`*^9}, {3.8934059531208344`*^9, 3.8934059794775257`*^9}, 
   3.896440842874364*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"8d76e890-bf20-4725-9a52-7db2bef4699a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Window Ellipses, Corner Cutoff Masks & Particle Zone Masks", \
"Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900527497713842`*^9, 
  3.8900527514278126`*^9}, {3.890055849461161*^9, 3.890055855962562*^9}, {
  3.890056958222869*^9, 3.8900569663704796`*^9}, {3.8935004810972085`*^9, 
  3.8935004811883345`*^9}, {3.8940913500803013`*^9, 3.8940913505979166`*^9}, {
  3.9002774634642143`*^9, 3.9002774667672434`*^9}, {3.909848602852767*^9, 
  3.90984861210468*^9}},ExpressionUUID->"01ccb8b5-f08a-4a17-a7e8-\
ac9be1e9686a"],

Cell[CellGroupData[{

Cell["Get Swarm Window Central Masks", "Subsubsection",
 CellChangeTimes->{{3.9098485510073943`*^9, 
  3.909848563895068*^9}},ExpressionUUID->"ff089379-fa52-4d5b-8df6-\
2cc473827110"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scaleBoxFactor", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"placeholderSize", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placeholderBias", "=", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"placeholderSW", "=", 
   RowBox[{"Image", "[", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{"placeholderBias", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "placeholderSize"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "placeholderSize"}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.751367533932418*^9}, 3.7513678787540135`*^9, {3.751368682841755*^9, 
   3.751368710653499*^9}, {3.7513689560071154`*^9, 3.751368969333048*^9}, {
   3.7513702998183403`*^9, 3.7513703169215965`*^9}, {3.751370787710986*^9, 
   3.7513707969726477`*^9}, {3.751694728455764*^9, 3.7516947508282638`*^9}, {
   3.7516956463966684`*^9, 3.751695664837387*^9}, {3.7517117899960823`*^9, 
   3.751711790208119*^9}, {3.751715307345482*^9, 3.7517153142250805`*^9}, {
   3.751717768351387*^9, 3.7517178095255127`*^9}, {3.7517178904197807`*^9, 
   3.751717892263572*^9}, {3.751718021858073*^9, 3.7517180449997435`*^9}, 
   3.7517958177090473`*^9, {3.7517962384460444`*^9, 3.751796247771106*^9}, {
   3.751798356897586*^9, 3.751798359319228*^9}, {3.7518003178915434`*^9, 
   3.751800322200385*^9}, {3.7518054063190494`*^9, 3.751805413644461*^9}, {
   3.7518090738015766`*^9, 3.7518090780190587`*^9}, {3.751809128739005*^9, 
   3.7518091377363367`*^9}, {3.751809633506062*^9, 3.7518097128353043`*^9}, {
   3.751809747610074*^9, 3.751809763471615*^9}, {3.7518098013434286`*^9, 
   3.7518098312315564`*^9}, 3.75181018092091*^9, {3.751810440182747*^9, 
   3.7518104638003564`*^9}, {3.7518104975231147`*^9, 
   3.7518105003860273`*^9}, {3.7518706948423195`*^9, 
   3.7518706950687003`*^9}, {3.7518710217670946`*^9, 
   3.7518710268604765`*^9}, {3.751879180640204*^9, 3.751879198671009*^9}, {
   3.751954609915016*^9, 3.7519546122218122`*^9}, {3.7519574350255146`*^9, 
   3.7519574378918285`*^9}, {3.751957531661088*^9, 3.75195753194832*^9}, 
   3.7519739381155186`*^9, {3.751974564149325*^9, 3.7519745737382736`*^9}, {
   3.7519746061642714`*^9, 3.7519746074588327`*^9}, {3.7519863533188334`*^9, 
   3.7519863536130424`*^9}, {3.751986413477455*^9, 3.7519864235716724`*^9}, {
   3.7519870974555826`*^9, 3.7519871318905077`*^9}, {3.7520039790994835`*^9, 
   3.75200399610083*^9}, 3.752050298923599*^9, {3.7520514591520195`*^9, 
   3.752051513645871*^9}, {3.7520515810146384`*^9, 3.7520516070481863`*^9}, {
   3.7520517026397276`*^9, 3.7520517030814557`*^9}, {3.752051745263569*^9, 
   3.7520517836363487`*^9}, 3.752071268552267*^9, 3.7522119243556566`*^9, {
   3.760172950640916*^9, 3.760172954195407*^9}, {3.7601730596555715`*^9, 
   3.7601730603896136`*^9}, {3.760173095951811*^9, 3.7601731098661714`*^9}, {
   3.7601732070097156`*^9, 3.760173207577176*^9}, {3.7608967010022516`*^9, 
   3.760896713375206*^9}, {3.760929196843571*^9, 3.760929229387312*^9}, 
   3.7609305771199694`*^9, {3.76093208087411*^9, 3.760932116185805*^9}, {
   3.76093218508365*^9, 3.7609322280421505`*^9}, {3.760932258883037*^9, 
   3.7609322613026257`*^9}, {3.7609324644993386`*^9, 3.760932476353635*^9}, 
   3.760948494764584*^9, {3.760954822229915*^9, 3.760954828183131*^9}, {
   3.760957174116322*^9, 3.7609571745322294`*^9}, {3.760957895235751*^9, 
   3.760957921379594*^9}, {3.7609651595617104`*^9, 3.7609651654958453`*^9}, {
   3.7613977902309713`*^9, 3.7613977942121305`*^9}, {3.7614005950165224`*^9, 
   3.761400595718647*^9}, 3.766941086103475*^9, {3.766941253319908*^9, 
   3.766941267420458*^9}, {3.7669413812977057`*^9, 3.7669413828107724`*^9}, {
   3.766991390999523*^9, 3.7669913930191407`*^9}, 3.767012354908183*^9, 
   3.781935806390972*^9, 3.781936033385374*^9, 3.7819360705919476`*^9, 
   3.781936103022912*^9, {3.7819364081089644`*^9, 3.781936410955409*^9}, {
   3.7819367452987604`*^9, 3.7819367622895584`*^9}, {3.7819368721284275`*^9, 
   3.7819368997005873`*^9}, {3.78256209209163*^9, 3.782562093890131*^9}, {
   3.844257799340705*^9, 3.844257813457425*^9}, {3.8553920078497667`*^9, 
   3.855392012814232*^9}, {3.856250191201414*^9, 3.856250232703102*^9}, {
   3.8562520431182947`*^9, 3.856252141381493*^9}, {3.856252203719722*^9, 
   3.856252255915289*^9}, {3.856252300863139*^9, 3.856252305392064*^9}, {
   3.856252352196966*^9, 3.8562523888538857`*^9}, {3.856252446343231*^9, 
   3.8562524895773783`*^9}, {3.8562553818556347`*^9, 3.856255409433647*^9}, {
   3.856256366655346*^9, 3.856256382108848*^9}, {3.856257008256236*^9, 
   3.856257010794084*^9}, {3.856257303136685*^9, 3.856257354834614*^9}, {
   3.856257774714705*^9, 3.8562579213044643`*^9}, {3.856257994277404*^9, 
   3.856258020270615*^9}, {3.856258089739832*^9, 3.856258132265641*^9}, {
   3.8562581913408937`*^9, 3.856258237797119*^9}, {3.856258271983555*^9, 
   3.856258295413122*^9}, {3.856258365182643*^9, 3.8562583752102213`*^9}, {
   3.856258687450672*^9, 3.85625876406513*^9}, {3.856259620096257*^9, 
   3.856259683887211*^9}, 3.8562708470666122`*^9, {3.859021745750124*^9, 
   3.8590217499397583`*^9}, {3.859103445801277*^9, 3.859103491056922*^9}, {
   3.859103596619948*^9, 3.8591035975827913`*^9}, {3.8591036326916313`*^9, 
   3.859103638582407*^9}, {3.859451511333824*^9, 3.859451515423167*^9}, {
   3.859451592850288*^9, 3.85945160401833*^9}, {3.859451850580456*^9, 
   3.859451879730114*^9}, 3.859451950169718*^9, 3.859452522522209*^9, 
   3.86004606069128*^9, {3.86004610376902*^9, 3.8600461477185793`*^9}, {
   3.860046448959958*^9, 3.860046558255125*^9}, 3.860046606719643*^9, {
   3.8600466743704977`*^9, 3.86004668326213*^9}, {3.8600467713400106`*^9, 
   3.860046771813838*^9}, {3.86004708146483*^9, 3.860047094976729*^9}, {
   3.860050046917284*^9, 3.860050144811077*^9}, {3.8600591063930283`*^9, 
   3.860059111141946*^9}, {3.860059144816346*^9, 3.860059154307877*^9}, {
   3.860059189230633*^9, 3.860059198471508*^9}, {3.8600593175543013`*^9, 
   3.860059380249292*^9}, {3.8600594380314627`*^9, 3.860059456766239*^9}, {
   3.860059508947998*^9, 3.860059522156027*^9}, 3.860078446986199*^9, 
   3.860741938210567*^9, {3.860742677818672*^9, 3.860742680045698*^9}, {
   3.860742903361553*^9, 3.860742919820343*^9}, {3.860744409385338*^9, 
   3.8607444399598227`*^9}, 3.8607444720057163`*^9, 3.8629475255316467`*^9, {
   3.8692993412799187`*^9, 3.869299398279628*^9}, {3.869299471886497*^9, 
   3.869299519895006*^9}, {3.870788594259224*^9, 3.8707886433076973`*^9}, {
   3.870789036708892*^9, 3.8707890735065117`*^9}, 3.8707898968360634`*^9, {
   3.8707901752169447`*^9, 3.870790177837435*^9}, {3.8707902417937965`*^9, 
   3.870790243755803*^9}, {3.8853797814032106`*^9, 3.885379795030085*^9}, {
   3.885379850477587*^9, 3.8853798645388393`*^9}, {3.885380274764432*^9, 
   3.885380288147811*^9}, {3.885385903360512*^9, 3.8853859143694797`*^9}, 
   3.8854058777353487`*^9, {3.8854107307240386`*^9, 3.885410784715227*^9}, {
   3.885410893492056*^9, 3.885410913404173*^9}, 3.885412592010369*^9, {
   3.889040014704732*^9, 3.889040075741843*^9}, 3.8929090641901193`*^9, {
   3.8929099110718365`*^9, 3.8929099217503443`*^9}, 3.8994565540217333`*^9, {
   3.899828390408118*^9, 3.899828391532455*^9}, {3.8999209408387446`*^9, 
   3.8999209572591867`*^9}, {3.899921693751095*^9, 3.8999216940746737`*^9}, {
   3.9163154969368553`*^9, 3.9163154973638334`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"8edc3b55-9289-4479-8bee-84ba4f6db654"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"widthPixels", ",", "heightPixels"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "@", 
       RowBox[{"ImageDimensions", "@", 
        RowBox[{"First", "@", "globalEllipseMasks"}]}]}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"First", ",", "Last"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"swarmBoxes", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"newBox", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}]}]}], "&"}], "/@", "#"}], "&"}], "/@",
     "swarmData"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"swarmBoxCenters", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"boxCenter", "/@", "#"}], "&"}], "/@", "swarmBoxes"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmWindowEllipseMasks", "=", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#2", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"ImageTrim", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", "placeholderSW"}], "]"}], 
        "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"globalEllipseMasks", ",", "swarmBoxes"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"swarmWindowEllipseMasksUnified", "=", 
   RowBox[{"Flatten", "@", "swarmWindowEllipseMasks"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"swarmWindowCentralMasks", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"getCentralEllipseSW", "@", "#"}]}], ")"}], "&"}], "/@", 
       "swarmWindowEllipseMasksUnified"}], "//", "Parallelize"}]}], ";"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "swarmWindowEllipseMasksUnified"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.899622814903014*^9, 3.8996228825184107`*^9}, 
   3.8996237795655136`*^9, 3.899623966727433*^9, {3.8999208122026825`*^9, 
   3.8999208234712234`*^9}, {3.900251641660082*^9, 3.9002516549623084`*^9}, {
   3.900264247331432*^9, 3.9002642534188623`*^9}, {3.9095121724370437`*^9, 
   3.909512178560477*^9}, 3.9095123453657312`*^9, 3.9095126167033796`*^9, {
   3.909512786554167*^9, 3.9095128054391193`*^9}, {3.9097621846037097`*^9, 
   3.909762185135364*^9}, 3.9098480492158017`*^9, {3.909848207370317*^9, 
   3.9098482132236676`*^9}, {3.916312868328575*^9, 3.916312873080516*^9}, 
   3.9163153415264816`*^9, 3.9163155264555473`*^9},
 CellLabel->
  "In[172]:=",ExpressionUUID->"6aefceca-6ef8-48f1-a9a3-7921485ff678"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Edge Cutoff Masks & Particle Zone Masks", "Subsubsection",
 CellChangeTimes->{{3.9098485510073943`*^9, 
  3.909848599358863*^9}},ExpressionUUID->"62da8e51-d4ae-4919-8c8e-\
da73c4465ccb"],

Cell["\<\
Defaults :
   
ellipseDilationScaleFactor=0.4;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, {
   3.890210387568242*^9, 3.8902104019083776`*^9}},
 FontSize->16,ExpressionUUID->"f7e38252-4f76-4345-98c3-7d42d8748772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ellipseDilationScaleFactor", "=", "0.4"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890055915657237*^9, 3.8900559361240683`*^9}, {
  3.893595154161011*^9, 3.893595155335868*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"ccb8c7de-79a9-40fd-a38b-4a27fec79f60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"windowEdgeCutoffMasks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"Dilation", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"DiskMatrix", "@", 
                RowBox[{"Round", "[", 
                 RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
              RowBox[{"(", 
               RowBox[{"ellipseDilationScaleFactor", "*", 
                RowBox[{"Min", "@", 
                 RowBox[{"ImageDimensions", "@", "#"}]}]}], ")"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], "/@", 
        "swarmWindowCentralMasks"}], "//", "Parallelize"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "swarmWindowCentralMasks"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.899622814903014*^9, 3.8996228825184107`*^9}, 
   3.8996237795655136`*^9, 3.899623966727433*^9, {3.8999208122026825`*^9, 
   3.8999208234712234`*^9}, {3.900251641660082*^9, 3.9002516549623084`*^9}, {
   3.900264247331432*^9, 3.9002642534188623`*^9}, {3.9095121724370437`*^9, 
   3.909512178560477*^9}, 3.9095123453657312`*^9, 3.9095126167033796`*^9, {
   3.909512786554167*^9, 3.9095128054391193`*^9}, {3.9097621846037097`*^9, 
   3.909762185135364*^9}, {3.9098480492158017`*^9, 3.9098480565515585`*^9}, {
   3.9098481963962994`*^9, 3.909848197551793*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"c491eec3-12d1-41d6-b756-8b4d3cffcd9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"windowParticleZones", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"ImageDifference", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "windowEdgeCutoffMasks", ",", "swarmWindowEllipseMasksUnified"}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "windowEdgeCutoffMasks"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"windowParticleZoneAreasPhysical", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", "conversionFactors"}], "*", 
         RowBox[{"Last", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Count\>\""}], "]"}]}]}]}], "&"}], "/@", 
       "windowParticleZones"}], "//", "Parallelize"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"windowParticleZonesCentral", "=", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"ImageDifference", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"windowEdgeCutoffMasks", ",", "swarmWindowCentralMasks"}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "windowEdgeCutoffMasks"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.899622814903014*^9, 3.8996228825184107`*^9}, 
   3.8996237795655136`*^9, 3.899623966727433*^9, {3.8999208122026825`*^9, 
   3.8999208234712234`*^9}, {3.900251641660082*^9, 3.9002516549623084`*^9}, 
   3.900264247331432*^9, {3.909566841733724*^9, 3.909566870418008*^9}, {
   3.9095704051303773`*^9, 3.909570429050175*^9}, 3.9095704689097977`*^9, {
   3.909762169071087*^9, 3.9097621749632425`*^9}, {3.909762215046261*^9, 
   3.909762215987814*^9}, {3.910791781315369*^9, 
   3.910791800268469*^9}},ExpressionUUID->"570ab375-f692-4121-8ae9-\
699982c3d355"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Zone Central Masks >>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8892816632713075`*^9, 3.889281702495319*^9}, {3.909762415771329*^9, 
  3.909762454578778*^9}},ExpressionUUID->"e9a0d3a6-1c02-45f5-b5ac-\
30b101360a13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"compressedWindowParticleZonesCentral", "=", 
    RowBox[{
     RowBox[{"Compress", "/@", "windowParticleZonesCentral"}], "//", 
     "Parallelize"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windowParticleZonesFolder", "=", 
   RowBox[{"output", "<>", "\"\<9 Bacteria Zone Central Masks\\\\\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateDirectory", "@", "windowParticleZonesFolder"}], ";"}], "//",
    "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportImageSequence", "[", "\[IndentingNewLine]", 
    RowBox[{
    "compressedWindowParticleZonesCentral", ",", "windowParticleZonesFolder", 
     ",", "\"\<.txt\>\"", ",", "0"}], "\[IndentingNewLine]", "]"}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8892817493431044`*^9, 3.8892817805519447`*^9}, {
  3.889281837143244*^9, 3.88928191320846*^9}, {3.8892819594009056`*^9, 
  3.889281979209507*^9}, {3.8892821229194517`*^9, 3.8892821513839016`*^9}, {
  3.8899823107674785`*^9, 3.8899823272756615`*^9}, {3.8905273675904617`*^9, 
  3.8905273678406887`*^9}, {3.909762463869049*^9, 3.909762497443473*^9}, {
  3.9097632057017326`*^9, 3.909763214012337*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"7c86c318-a920-42a5-bca9-6a5220c13d32"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Bacteria Zone Central Masks <<", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8892816632713075`*^9, 3.889281702495319*^9}, {3.889282074198844*^9, 
   3.8892820855119534`*^9}, 
   3.909763179228836*^9},ExpressionUUID->"58f0ff79-84f7-461c-95ee-\
52964238e667"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"windowParticleZonesFolder", "=", 
    RowBox[{"output", "<>", "\"\<9 Bacteria Zone Central Masks\\\\\>\""}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "windowParticleZonesFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"windowParticleZonesCentral", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"Uncompress", "@", 
           RowBox[{"Import", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"windowParticleZonesFolder", "<>", "#"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", "files"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
   RowBox[{"progress", "[", 
    RowBox[{"monitorCounter", ",", 
     RowBox[{"Length", "@", "files"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8892820955593147`*^9, {3.889282197215437*^9, 3.8892822021658034`*^9}, 
   3.8892822523833866`*^9, {3.889290279527408*^9, 3.889290280227514*^9}, {
   3.8896255885199213`*^9, 3.8896255896557426`*^9}, {3.8905273625651274`*^9, 
   3.8905273628452773`*^9}, {3.8934059531208344`*^9, 3.8934059794775257`*^9}, 
   3.896440842874364*^9, {3.909763553549733*^9, 3.909763580485857*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"6e2f7ce3-7a97-43eb-892e-6eedeb75df70"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Zone Areas >>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, 3.8996647430719233`*^9, {
   3.909566891066953*^9, 
   3.909566895105888*^9}},ExpressionUUID->"215d6e63-b38a-4600-8ead-\
cd1606cbf110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataCompressedfolder", "<>", "\"\<Particle Zone Areas.txt\>\""}],
     ",", 
    RowBox[{"Compress", "@", "windowParticleZoneAreasPhysical"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.890061706877673*^9, 3.8900617081040616`*^9}, {
   3.8900618367708845`*^9, 3.8900618754193554`*^9}, {3.909511046526021*^9, 
   3.9095110481323442`*^9}, {3.9095669182593126`*^9, 3.9095669521859627`*^9}, 
   3.9095704145247984`*^9, 3.9095704570906787`*^9},
 CellLabel->
  "In[348]:=",ExpressionUUID->"abb52478-eb65-4730-b9d8-33333b041803"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Bacteria Zone Areas <<", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, 3.899664740675277*^9, 
   3.9095669017314034`*^9},ExpressionUUID->"a91a13c4-7d4d-44bf-b1dd-\
b6eeccd9c70e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"windowParticleZoneAreasPhysical", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Particle Zone Areas.txt\>\""}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8900676927201595`*^9, 3.8900677082192945`*^9}, {
   3.8900678623903418`*^9, 3.8900678748825235`*^9}, {3.9095110564484177`*^9, 
   3.90951106038449*^9}, {3.9095669395160427`*^9, 3.9095669494910917`*^9}, 
   3.9095704605899878`*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"86e25612-e0f5-424b-b174-e4ffb7d3811b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview Corner Cutoff ]]", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900527497713842`*^9, 
  3.8900527514278126`*^9}, {3.890055849461161*^9, 3.890055855962562*^9}, {
  3.890056063435522*^9, 
  3.8900560729143496`*^9}},ExpressionUUID->"2f5c0fd4-4d51-42da-b9bf-\
2c41209a731a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viewImage", "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"getMaskOverlays", "[", 
               RowBox[{"#", ",", 
                RowBox[{"swarmWindowEllipseMasksUnified", "[", 
                 RowBox[{"[", "testID", "]"}], "]"}], ",", "Red", ",", "2"}], 
               "]"}], "&"}], "@", 
             RowBox[{"getMaskOverlays", "[", 
              RowBox[{"#", ",", 
               RowBox[{"swarmWindowCoreMasksUnified", "[", 
                RowBox[{"[", "testID", "]"}], "]"}], ",", "Orange", ",", 
               "2"}], "]"}]}], "&"}], "@", 
           RowBox[{"getMaskOverlays", "[", 
            RowBox[{"#", ",", 
             RowBox[{"windowEdgeCutoffMasks", "[", 
              RowBox[{"[", "testID", "]"}], "]"}], ",", "Red", ",", "5"}], 
            "]"}]}], "&"}], "@", 
         RowBox[{"trueWindowParticleMasks", "[", 
          RowBox[{"[", 
           RowBox[{"testID", ",", "branch"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getMaskOverlays", "[", 
             RowBox[{"#", ",", 
              RowBox[{"swarmWindowCoreMasksUnified", "[", 
               RowBox[{"[", "testID", "]"}], "]"}], ",", "Orange", ",", "2"}],
              "]"}], "&"}], "@", 
           RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ColorReplace", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
              RowBox[{"ImageDifference", "[", "\[IndentingNewLine]", 
               RowBox[{"#", ",", 
                RowBox[{"trueWindowParticleMasks", "[", 
                 RowBox[{"[", 
                  RowBox[{"testID", ",", "branch"}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "&"}], "@", 
         RowBox[{"DeleteBorderComponents", "@", 
          RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ColorNegate", "@", 
             RowBox[{"windowEdgeCutoffMasks", "[", 
              RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"trueWindowParticleMasks", "[", 
             RowBox[{"[", 
              RowBox[{"testID", ",", "branch"}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}],
      "//", 
     RowBox[{
      RowBox[{"ImageCollage", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", "3"}], ",", 
        RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], "&"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"branch", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "//", 
  RowBox[{
   RowBox[{"TableForm", "[", 
    RowBox[{"#", ",", 
     RowBox[{"TableDirections", "\[Rule]", "Column"}]}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.890054416462963*^9, 3.8900544213951006`*^9}, {
   3.8900555096115017`*^9, 3.8900555258994303`*^9}, {3.8900555899722986`*^9, 
   3.8900556853891077`*^9}, {3.8900566751790113`*^9, 3.890056826937849*^9}, {
   3.8900568935402107`*^9, 3.890056893828503*^9}, {3.890058814629009*^9, 
   3.8900588264474955`*^9}, {3.8934265869442143`*^9, 
   3.8934266128214607`*^9}, {3.8934787777872186`*^9, 3.893478778089753*^9}, {
   3.8934788195245185`*^9, 3.8934788206990733`*^9}, {3.8934842199302855`*^9, 
   3.8934842201673307`*^9}, {3.89962434879806*^9, 3.899624357740604*^9}, {
   3.899624419134097*^9, 3.8996245569430585`*^9}, {3.899624602542246*^9, 
   3.8996246594784193`*^9}, {3.8996246941816573`*^9, 3.899624760206809*^9}, {
   3.899624844718421*^9, 3.8996249408290443`*^9}, {3.899625010954685*^9, 
   3.899625012124979*^9}, {3.899650875725134*^9, 3.8996510050548115`*^9}, 
   3.8996510386014347`*^9, {3.900260480407306*^9, 3.9002605033342943`*^9}, {
   3.9002638835102835`*^9, 3.9002638941966343`*^9}, 3.900264009036953*^9},
 CellLabel->
  "In[349]:=",ExpressionUUID->"2e072508-f2a4-400a-ac2d-fe6dde6c29e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Remove Window Corner Bias", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900527497713842`*^9, 
  3.8900527514278126`*^9}, {3.8900569860022974`*^9, 
  3.89005699225113*^9}},ExpressionUUID->"27e6a761-f266-4829-96f5-\
39b96cde6069"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleMasksUnbiased", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Parallelize", "@", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{"DeleteBorderComponents", "@", 
                RowBox[{"ImageAdd", "[", 
                 RowBox[{
                  RowBox[{"ColorNegate", "@", "#1"}], ",", "#2"}], "]"}]}]}], 
              ")"}], "&"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"windowEdgeCutoffMasks", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "branch", "]"}], "]"}], "&"}], "@", 
               RowBox[{"Transpose", "@", "trueWindowParticleMasks"}]}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"branch", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"2", "*", 
       RowBox[{"Length", "@", "trueWindowParticleMasks"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8900570054522142`*^9, 3.8900570725565796`*^9}, {
  3.890059241972185*^9, 3.890059249412191*^9}, {3.8934378744966626`*^9, 
  3.8934379135256596`*^9}, {3.899625051060968*^9, 3.8996251667088842`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"d6f07c6d-0c78-443d-aedc-206895a50286"]
}, Closed]],

Cell[CellGroupData[{

Cell["Accretion Bacteria Centroids", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900527497713842`*^9, 
  3.8900527514278126`*^9}},ExpressionUUID->"1549ad55-176e-4776-b551-\
fcb95bc03269"],

Cell["\<\
Defaults :

powerHullShape=1.75;
powerHullSize=1;
powerAspectRatio=0.2;
powerCircularity=1;
criticalFactorDark=350;
criticalFactorBright=3500;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, {3.8994635369885664`*^9, 
   3.8994635410540743`*^9}, {3.8994680642651815`*^9, 3.899468124697826*^9}, {
   3.8994856886448145`*^9, 3.8994857433334675`*^9}, 3.8994937685625105`*^9, {
   3.899493813803657*^9, 3.899493817225876*^9}, {3.899494397408998*^9, 
   3.899494398808589*^9}, {3.8994950707293105`*^9, 3.899495075114184*^9}, {
   3.8996272206445384`*^9, 3.8996272428670597`*^9}, {3.899631807674167*^9, 
   3.899631808178875*^9}, {3.899665141352126*^9, 3.8996651431923723`*^9}, 
   3.899665753706248*^9},
 FontSize->16,ExpressionUUID->"76f6a56f-1b2e-4f05-8de1-2f4ebd953150"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"powerHullShape", "=", "1.75"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"powerHullSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"powerAspectRatio", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"powerCircularity", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalFactorDark", "=", "450"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalFactorBright", "=", "3500"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.899626160124734*^9, 3.8996261656040993`*^9}, {
   3.899627400168703*^9, 3.899627401234852*^9}, {3.899628382253008*^9, 
   3.8996283958123493`*^9}, 3.8996290128431635`*^9, 3.899631031947092*^9, {
   3.8996316464509754`*^9, 3.8996316574979663`*^9}, {3.899631692059452*^9, 
   3.899631692218028*^9}, {3.8996317322508965`*^9, 3.899631757073693*^9}, {
   3.8996318373867583`*^9, 3.8996318553314857`*^9}, {3.8996320729623117`*^9, 
   3.8996320846263895`*^9}, 3.899632196611288*^9, 3.89963239961875*^9, {
   3.899632919330682*^9, 3.8996329322107296`*^9}, {3.899633026643217*^9, 
   3.8996330658184314`*^9}, 3.899633102186788*^9, {3.8996331373151855`*^9, 
   3.8996331375535507`*^9}, {3.899633187305814*^9, 3.8996331895667686`*^9}, {
   3.899633265698366*^9, 3.8996333317211905`*^9}, {3.899633489954643*^9, 
   3.899633565434251*^9}, {3.8996336157387543`*^9, 3.8996336296348114`*^9}, {
   3.899633686426062*^9, 3.899633686706312*^9}, {3.8996337306740108`*^9, 
   3.8996337629136353`*^9}, {3.899633807850531*^9, 3.8996338102501144`*^9}, 
   3.8996339858194118`*^9, {3.899634191170165*^9, 3.8996342000028677`*^9}, 
   3.899635117983535*^9, {3.8996353153784857`*^9, 3.899635327010293*^9}, {
   3.899635905130625*^9, 3.899635926409794*^9}, {3.899635958225634*^9, 
   3.8996359671946487`*^9}, 3.899653650644392*^9, {3.899653738315935*^9, 
   3.8996537413869658`*^9}, {3.8996539615166545`*^9, 3.899653971986916*^9}, {
   3.8996545540772495`*^9, 3.899654555435633*^9}, {3.8996655571915894`*^9, 
   3.89966563051188*^9}, {3.899703604933195*^9, 3.899703605011866*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"01ca5c88-3f4c-4f7c-9466-a8e8b2fae922"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"windowParticlesRaw", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteDuplicates", "@", 
                 RowBox[{"Flatten", "@", "#"}]}], "\[Equal]", 
                RowBox[{"{", "1.", "}"}]}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"Join", "@@", "#"}]}], "\[IndentingNewLine]", "]"}], 
             "&"}], "@", 
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"findEligibleParticlesTwoLevelsets", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"criticalFactorDark", ",", "criticalFactorBright"}], 
                 "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ")"}], 
         "&"}], "/@", "particleMasksUnbiased"}], "//", "Parallelize"}]}], 
     ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "particleMasksUnbiased"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8896421163251076`*^9, 3.889642159047395*^9}, {
   3.8896421938533154`*^9, 3.8896422133896217`*^9}, {3.889642387390415*^9, 
   3.8896423895652795`*^9}, {3.8896440520621243`*^9, 3.88964414702785*^9}, {
   3.8896442953907046`*^9, 3.8896443245521526`*^9}, {3.889644363383194*^9, 
   3.889644394748231*^9}, {3.8896444851878204`*^9, 3.8896446392510204`*^9}, {
   3.8896446693725276`*^9, 3.8896447711878276`*^9}, 3.889644808418925*^9, {
   3.8896448788874736`*^9, 3.889645055138863*^9}, {3.889645097795417*^9, 
   3.889645103514489*^9}, 3.8899863272055893`*^9, {3.890048899969629*^9, 
   3.8900489407414427`*^9}, {3.890050693105029*^9, 3.890050729387968*^9}, {
   3.8900509182127953`*^9, 3.890050922779817*^9}, {3.890051632444045*^9, 
   3.8900516563885517`*^9}, {3.8900516983678403`*^9, 3.890051802169104*^9}, {
   3.8900519172378426`*^9, 3.8900519202748814`*^9}, 3.890059303765057*^9, {
   3.8908793259421525`*^9, 3.890879407355675*^9}, {3.8934379544322867`*^9, 
   3.893437965384099*^9}, {3.8996267586216516`*^9, 3.899626760812745*^9}, 
   3.899626821163473*^9, {3.899660479882594*^9, 3.8996604802728524`*^9}, {
   3.9000667086976404`*^9, 3.900066718997719*^9}, 3.9000669358613124`*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"cbefafaf-c71d-46a5-84bc-5f79be3ff338"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Filtered Centroids ]]", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900519105812635`*^9, 
  3.8900519115310163`*^9}, {3.8900520667230473`*^9, 3.890052077707133*^9}, {
  3.899664459991109*^9, 
  3.8996644670476832`*^9}},ExpressionUUID->"506399a2-d52b-4311-9e70-\
84de70ec435e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageCollage", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "3"}]}], "]"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reducedSwarmWindowsUnified", "[", 
       RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"getFilteredWindowParticleOverlayAlternative", "@@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "windowParticlesRaw", ",", "particleMasksUnbiased", ",", 
           "windowEdgeCutoffMasks", ",", "\[IndentingNewLine]", 
           "reducedSwarmWindowsUnified", ",", "swarmWindowCoreMasksUnified"}],
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "windowParticlesRaw"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8896421163251076`*^9, 3.889642159047395*^9}, {
   3.8896421938533154`*^9, 3.8896422133896217`*^9}, {3.889642387390415*^9, 
   3.8896423895652795`*^9}, {3.8896440520621243`*^9, 3.88964414702785*^9}, {
   3.8896442953907046`*^9, 3.8896443245521526`*^9}, {3.889644363383194*^9, 
   3.889644394748231*^9}, {3.8896444851878204`*^9, 3.8896446392510204`*^9}, {
   3.8896446693725276`*^9, 3.8896447711878276`*^9}, 3.889644808418925*^9, {
   3.8896448788874736`*^9, 3.889645055138863*^9}, {3.889645097795417*^9, 
   3.889645103514489*^9}, 3.8899863272055893`*^9, {3.890048899969629*^9, 
   3.8900489407414427`*^9}, {3.890050693105029*^9, 3.890050729387968*^9}, {
   3.8900509182127953`*^9, 3.890050922779817*^9}, {3.890051632444045*^9, 
   3.8900516563885517`*^9}, {3.8900516983678403`*^9, 
   3.8900517813086357`*^9}, {3.890051837628164*^9, 3.890051841875868*^9}, {
   3.8900519285181885`*^9, 3.8900519392385626`*^9}, {3.890052053617483*^9, 
   3.8900520561080894`*^9}, 3.890059331640267*^9, {3.890059409750144*^9, 
   3.890059475828264*^9}, {3.89005962042146*^9, 3.8900596756936855`*^9}, {
   3.8900597471503663`*^9, 3.8900598061165037`*^9}, {3.8900603704059763`*^9, 
   3.890060385622409*^9}, {3.890062619198077*^9, 3.8900626204092584`*^9}, {
   3.8934380466324453`*^9, 3.8934380483835316`*^9}, {3.8996272781727037`*^9, 
   3.899627342880883*^9}, 3.899627482221852*^9, 3.8996275422921457`*^9, 
   3.8996557471268873`*^9, {3.899660492940338*^9, 3.8996604956198597`*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"6aed3037-60cb-4ca1-9485-c8beca849681"]
}, Closed]],

Cell[CellGroupData[{

Cell["Resolve Overlapping Centroids", "Subsection",
 CellChangeTimes->{{3.899664417851312*^9, 3.89966442455923*^9}, {
  3.899664546423684*^9, 
  3.8996645546045933`*^9}},ExpressionUUID->"08568a50-7abe-4a86-b8f7-\
99be1d745285"],

Cell["\<\
Defaults :

distanceThreshold=15;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, {3.893140255196779*^9, 3.893140258154046*^9}, {
   3.89314057715535*^9, 3.8931405794252276`*^9}, {3.8994635369885664`*^9, 
   3.8994635410540743`*^9}, {3.8994680642651815`*^9, 3.899468124697826*^9}, {
   3.8994856886448145`*^9, 3.8994857433334675`*^9}, 3.8994937685625105`*^9, {
   3.899493813803657*^9, 3.899493817225876*^9}, {3.899494397408998*^9, 
   3.899494398808589*^9}, {3.8994950707293105`*^9, 3.899495075114184*^9}, {
   3.8996272206445384`*^9, 3.8996272428670597`*^9}, {3.899631807674167*^9, 
   3.899631808178875*^9}, {3.899665141352126*^9, 3.8996651431923723`*^9}, 
   3.899665291409052*^9, 3.8997101695693793`*^9},
 FontSize->16,ExpressionUUID->"5bd1a88b-fe3e-4f97-8a7a-d2135e87a021"],

Cell[BoxData[
 RowBox[{
  RowBox[{"distanceThreshold", "=", "15"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8161853964135866`*^9, 3.816185420751525*^9}, {
   3.8161855098638287`*^9, 3.81618551761458*^9}, 3.816185666510646*^9, {
   3.816185717310423*^9, 3.8161857350141993`*^9}, {3.8161860854616613`*^9, 
   3.8161861633668857`*^9}, {3.8161888690039887`*^9, 3.816188921102762*^9}, {
   3.8161914702891245`*^9, 3.8161914716093693`*^9}, {3.8161917790565968`*^9, 
   3.8161917972914605`*^9}, 3.816200860834503*^9, {3.816201848346488*^9, 
   3.8162018628573008`*^9}, {3.8996549366194725`*^9, 3.899654968220787*^9}, {
   3.899655327812086*^9, 3.899655327890174*^9}, {3.899660248169446*^9, 
   3.8996602484976077`*^9}, {3.8996602819437914`*^9, 3.899660282905958*^9}, {
   3.899703638026312*^9, 3.8997036390211134`*^9}, {3.9002613720452247`*^9, 
   3.90026137293264*^9}, {3.9002630931081753`*^9, 3.9002630933884263`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"58defced-3784-4edf-805b-3752b1fae05a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"windowParticles", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getResolvedParticles", "[", 
      RowBox[{"#", ",", "distanceThreshold"}], "]"}], "&"}], "@", 
    "windowParticlesRaw"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{"windowParticles", ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "\[Equal]", 
       RowBox[{"{", "}"}]}], "&"}], ")"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8996590198413563`*^9, 3.8996590567583027`*^9}, {
  3.899660542003524*^9, 3.8996605470859346`*^9}, {3.9002613813014603`*^9, 
  3.9002613815926723`*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"bcdb6478-f07c-4839-a29e-335bfa8a0422"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Bacteria/Centroid Overlays ]]", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
  3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
  3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
  3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
  3.889985467213833*^9, 3.889985468964223*^9}, {3.889986052789494*^9, 
  3.889986058717814*^9}, {3.8899861527978463`*^9, 3.8899861683656096`*^9}, {
  3.8899862984133396`*^9, 3.8899863110733376`*^9}, {3.8900519105812635`*^9, 
  3.8900519115310163`*^9}, {3.8900520667230473`*^9, 3.890052077707133*^9}, {
  3.890060523611374*^9, 3.8900605280823097`*^9}, {3.8996645388077354`*^9, 
  3.8996645430870476`*^9}},ExpressionUUID->"e51fb8b1-4e71-4d0e-aa50-\
d3135f338533"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getFilteredWindowParticleOverlayAlternative", "@@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
             "#", ",", "particleMasksUnbiased", ",", "windowEdgeCutoffMasks", 
              ",", "\[IndentingNewLine]", "reducedSwarmWindowsUnified", ",", 
              "swarmWindowCoreMasksUnified"}], "\[IndentingNewLine]", "}"}]}],
            ")"}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"windowParticlesRaw", ",", "windowParticles"}], "}"}]}], "//", 
       RowBox[{
        RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "3"}]}], "\[IndentingNewLine]", 
         "]"}], "&"}]}], ",", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"reducedSwarmWindowsUnified", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"getMaskOverlays", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"swarmWindowCoreMasksUnified", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "Orange", ",", "2"}],
                     "]"}], "&"}], "@", "\[IndentingNewLine]", 
                  RowBox[{"getMaskOverlays", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"windowEdgeCutoffMasks", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "Green", ",", "3"}], 
                   "]"}]}], "&"}], "@", 
                RowBox[{"reducedSwarmWindowsUnified", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], ",", "#"}], 
              "\[IndentingNewLine]", "]"}], "&"}], "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ImageMarker", "[", 
               RowBox[{"#", ",", "\"\<Circle\>\"", ",", "7.5"}], "]"}], ",", 
              RowBox[{"ImageMarker", "[", 
               RowBox[{"#", ",", "\"\<Arrow\>\"", ",", "15"}], "]"}]}], 
             "}"}]}], "&"}], "@", 
          RowBox[{"windowParticles", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "//", 
       RowBox[{
        RowBox[{"ImageCollage", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "3"}]}], "]"}], "&"}]}]}], 
     "\[IndentingNewLine]", "}"}], "//", 
    RowBox[{
     RowBox[{"TableForm", "[", 
      RowBox[{"#", ",", 
       RowBox[{"TableDirections", "\[Rule]", "Column"}]}], "]"}], "&"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "windowParticlesRaw"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8996579254180965`*^9, 3.89965800824306*^9}, 
   3.8996580587640557`*^9, {3.899658183982058*^9, 3.899658237603484*^9}, {
   3.899658275407265*^9, 3.899658416714875*^9}, {3.8996605628112946`*^9, 
   3.899660578786209*^9}, {3.8996651999230947`*^9, 3.8996652088572392`*^9}, {
   3.8997090030326047`*^9, 3.8997090793595133`*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"554e7a3a-3b8e-4a77-8f15-543350f620fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Data  >>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, 
   3.8996647430719233`*^9},ExpressionUUID->"4137c1d9-dd85-4762-ae20-\
2b6438b8273f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Window Particle Data.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "windowParticles"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.890061706877673*^9, 3.8900617081040616`*^9}, {
  3.8900618367708845`*^9, 3.8900618754193554`*^9}, {3.909511046526021*^9, 
  3.9095110481323442`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"e7aa0efc-f21e-49c4-8140-15875f00d4cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clear Unneeded Data from Memory", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
  3.8905085279958*^9, 3.8905085456415696`*^9}, {3.8929183936404963`*^9, 
  3.8929184140097203`*^9}},ExpressionUUID->"2aa47129-42d8-4f6e-b7eb-\
63e281584a9f"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "windowEdgeCutoffMasks", ",", "particleMasksUnbiased", ",", 
      "globalEllipseMasks", ",", "windowParticlesRaw", ",", 
      "\[IndentingNewLine]", "swarmWindowEllipseMasks", ",", "swarmBoxes", 
      ",", "swarmBoxCenters", ",", "trueWindowParticleMasks"}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, 
   3.8933587173424263`*^9, 3.8933587609259243`*^9, {3.8964413464251966`*^9, 
   3.8964413610482225`*^9}, {3.896441585092701*^9, 3.896441593352274*^9}, 
   3.896441639450981*^9, {3.899710203032984*^9, 3.8997102034891853`*^9}, {
   3.8997102376792502`*^9, 3.8997102406953807`*^9}, {3.8997102729041715`*^9, 
   3.899710278123267*^9}, {3.899710342497698*^9, 3.8997103428573165`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"7119dbf1-d6dd-491e-9640-13df2fa7c62e"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Bacteria Data <<", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, 
   3.899664740675277*^9},ExpressionUUID->"81f908b3-3e9b-48a1-8957-\
b9caa46334d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"windowParticles", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Window Particle Data.txt\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8900676927201595`*^9, 3.8900677082192945`*^9}, {
  3.8900678623903418`*^9, 3.8900678748825235`*^9}, {3.9095110564484177`*^9, 
  3.90951106038449*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"beaf9ea6-4ab9-4cc9-b6b4-06467a712478"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accretion Bacteria Number Density", "Subsection",
 CellChangeTimes->{{3.890725526047301*^9, 3.890725547807936*^9}, {
  3.90984876509529*^9, 
  3.909848778608775*^9}},ExpressionUUID->"a67b5c01-d552-462b-9ed9-\
44063294ba3b"],

Cell["\<\
Defaults :

numberDensityThresholds={0,1};
outlierMedianFilterRadius=50;
outlierMedianFilterIterations=5;
outlierDeviationFactors={5,5,5};
outlierDeviationFactorsDefault=ConstantArray[5,Length@swarmTracksClean];\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.9095819407394953`*^9},
 FontSize->16,ExpressionUUID->"7d0cd3a6-8b16-41d9-bba1-c8284002e221"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numberDensityThresholds", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierMedianFilterRadius", "=", "50"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierMedianFilterIterations", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierDeviationFactors", "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outlierDeviationFactorsDefault", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"5", ",", 
     RowBox[{"Length", "@", "swarmTracksClean"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909581162598835*^9, 3.909581173562889*^9}, {
  3.909581907868473*^9, 3.909581908108333*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"c7219b5e-3fb9-47c8-8569-d580aebc6a02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swarmParticleNumberDensityPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", "#"}], ">", 
           RowBox[{"First", "@", "numberDensityThresholds"}]}], "&&", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Last", "@", "#"}], "<", 
           RowBox[{"Last", "@", "numberDensityThresholds"}]}]}], "&"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"frameDurationSeconds", "*", 
           RowBox[{"swarmTrackTimestamps", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "/", "#2"}], "&"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "&"}], "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "/@", 
                   RowBox[{"windowParticles", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
                 "swarmTrackDataIDs"}], ")"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "&"}], "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"windowParticleZoneAreasPhysical", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                 "swarmTrackDataIDs"}], ")"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swarmParticleNumberDensityNoOutliers", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"Transpose", "@", "#1"}]}], ",", 
         RowBox[{"removeOutliers", "[", 
          RowBox[{
           RowBox[{"Last", "@", 
            RowBox[{"Transpose", "@", "#1"}]}], ",", "#2"}], "]"}]}], "}"}]}],
       "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "swarmParticleNumberDensityPhysical", ",", 
       "outlierDeviationFactorsDefault"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.909570242470975*^9, 3.9095703587472396`*^9}, {
   3.9095705076112475`*^9, 3.9095705356587744`*^9}, {3.9095705754504433`*^9, 
   3.9095705954908504`*^9}, {3.909570724957888*^9, 3.9095707265864744`*^9}, {
   3.909581107722172*^9, 3.9095811180186634`*^9}, {3.909581177923134*^9, 
   3.9095812099939814`*^9}, {3.909582117187537*^9, 3.909582119923149*^9}, {
   3.9095823902541685`*^9, 3.909582413058871*^9}, 3.9095829940916414`*^9, {
   3.909583064546612*^9, 3.9095830659313407`*^9}, 3.909663069188119*^9},
 CellLabel->
  "In[249]:=",ExpressionUUID->"d555e557-3e7a-4bdd-811d-a2a97091af02"],

Cell["\<\
Defaults :

upperThreshold=0.95;
lowerThreshold=1-upperThreshold;
sizeFactor=0.05;
splineOrder=3;
controlValueFactor=0.125;
envelopeRegularization=0.5;

binScale=10*10^-3;
dataMeanFilterScale=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.9095819407394953`*^9, 3.9095836491862817`*^9},
 FontSize->16,ExpressionUUID->"4354891b-73c0-4845-99f5-b7f376eb68a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upperThreshold", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerThreshold", "=", 
   RowBox[{"1", "-", "upperThreshold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeFactor", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineOrder", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"controlValueFactor", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeRegularization", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binScale", "=", 
   RowBox[{"10", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataMeanFilterScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, 
   3.808647297464489*^9, {3.9077965118293796`*^9, 3.907796531988535*^9}, 
   3.9077966480270514`*^9, 3.9077972558054156`*^9, {3.907797307011591*^9, 
   3.907797317119295*^9}, 3.9077980032270746`*^9, 3.9077984785156126`*^9, 
   3.9093950991298914`*^9, {3.909395135307577*^9, 3.909395136219387*^9}, {
   3.9093990231939173`*^9, 3.909399052122301*^9}, {3.909399085858489*^9, 
   3.909399136218475*^9}, {3.9093994321780243`*^9, 3.9093994330097466`*^9}, {
   3.90940472574874*^9, 3.909404747904615*^9}, {3.909405209555008*^9, 
   3.9094052214074855`*^9}, 3.9094054341479125`*^9, 3.9095084219658012`*^9, {
   3.9095836712022996`*^9, 3.9095836876114807`*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"428b19bf-5c02-493f-90e9-4ca0036471b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"swarmParticleNumberDensityQSEfiltered", "=", 
     RowBox[{
     "getFilteredDataQSE", "/@", "swarmParticleNumberDensityNoOutliers"}]}], 
    ";"}], "//", "AbsoluteTiming"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"swarmParticleNumberDensityMeansDeviations", "=", 
   RowBox[{
   "getMeansDeviations", "/@", "swarmParticleNumberDensityQSEfiltered"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.909394957533396*^9, 3.9093949766652946`*^9}, {
   3.9093950562833123`*^9, 3.9093950573468366`*^9}, {3.9093958358104196`*^9, 
   3.9093958426185026`*^9}, {3.909398907738665*^9, 3.9093989172898307`*^9}, {
   3.909399019401739*^9, 3.909399040458167*^9}, 3.909399091225165*^9, 
   3.909400922570504*^9, {3.909508614608651*^9, 3.909508625320763*^9}, {
   3.9095830275412655`*^9, 3.9095830426768646`*^9}, 3.9095831326619434`*^9, {
   3.9096631011178265`*^9, 3.9096631095807657`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"18619049-394e-4543-bdfc-e80cc44c03ce"],

Cell["\<\
Defaults :

timeSeriesPlotRanges={All};
areaPlotRanges=ConstantArray[All,Length@swarmTrackTimestamps];
errorBandOpacity=0.30;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, {3.9094008801385665`*^9, 3.90940091084125*^9}, {
   3.9094047346900177`*^9, 3.90940476714608*^9}, {3.910793761345507*^9, 
   3.9107937912831116`*^9}},
 FontSize->16,ExpressionUUID->"1cf8e299-d22f-4687-a086-ab9c9ccf74c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axesLabelsNumberDensitySeries", "=", 
    RowBox[{"getLatexStyling", "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<t, ~s\>\"", ",", "\"\<n, ~{\\\\mu m}^{-2}\>\""}], 
      "}"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeSeriesPlotRange", "=", "All"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberDensitySeriesPlotRanges", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"All", ",", 
     RowBox[{"Length", "@", "swarmTrackTimestamps"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorBandOpacity", "=", "0.30"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909403686538426*^9, 3.909403696583669*^9}, {
   3.9094038050426455`*^9, 3.909403832090814*^9}, 3.909403867273486*^9, {
   3.9094039092121863`*^9, 3.9094039234813843`*^9}, {3.9094123383824396`*^9, 
   3.9094123803212967`*^9}, {3.9095073942938404`*^9, 
   3.9095074136966915`*^9}, {3.909508293926628*^9, 3.9095083011285768`*^9}, 
   3.9095097900371947`*^9, {3.9095837825412235`*^9, 3.9095838234421873`*^9}, {
   3.9095838638031254`*^9, 3.909583907585796*^9}, {3.9095839786207714`*^9, 
   3.9095839824825296`*^9}, {3.9101248105513935`*^9, 
   3.9101248114317923`*^9}, {3.9104679640597086`*^9, 3.91046796421329*^9}, {
   3.9106132203328247`*^9, 3.9106132204925594`*^9}, {3.9107937473234434`*^9, 
   3.9107937522281537`*^9}, 3.910793796004573*^9},
 CellLabel->
  "In[297]:=",ExpressionUUID->"2e3c5e30-2107-4031-9f82-aa9ef1c358b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotParticleNumberDensitySeries", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#1", ",", 
         RowBox[{"FrameLabel", "\[Rule]", "axesLabelsNumberDensitySeries"}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", "#2"}], ",", 
         RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", 
          RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "swarmParticleNumberDensityMeansDeviations", ",", 
        "numberDensitySeriesPlotRanges"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"plotParticleNumberDensitySeries", "//", 
   RowBox[{
    RowBox[{"TableForm", "[", 
     RowBox[{"#", ",", 
      RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotParticleNumberDensitySeriesAll", "=", 
  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
   RowBox[{"swarmParticleNumberDensityMeansDeviations", ",", 
    RowBox[{"FrameLabel", "\[Rule]", "axesLabelsNumberDensitySeries"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "timeSeriesPlotRange"}], ",", 
    RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
    RowBox[{"IntervalMarkersStyle", "\[Rule]", 
     RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9095835348363886`*^9, 3.9095835422106285`*^9}, 
   3.909583586917511*^9, {3.90958361952386*^9, 3.9095836625154963`*^9}, {
   3.9095838537475734`*^9, 3.9095839544605455`*^9}, {3.9095840037353363`*^9, 
   3.9095840072594504`*^9}, 3.909584040669332*^9, {3.9095843570127993`*^9, 
   3.9095843771306276`*^9}, {3.9096522869586053`*^9, 3.909652356158386*^9}, 
   3.909835206677749*^9, 3.9107933696445637`*^9},
 CellLabel->
  "In[302]:=",ExpressionUUID->"3788c78e-c0b1-4ea1-9d92-86613d8e48d8"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", 
     RowBox[{
     "plotParticleNumberDensitySeriesAll", ",", 
      "\"\<Bacteria Number Density All\>\"", ",", "100"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"exportImagesTwoFormat", "[", 
       RowBox[{
        RowBox[{"plotParticleNumberDensitySeries", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"\"\<Bacteria Number Density \>\"", "<>", 
         RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "plotParticleNumberDensitySeries"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9095835348363886`*^9, 3.9095835422106285`*^9}, 
   3.909583586917511*^9, {3.90958361952386*^9, 3.9095836625154963`*^9}, {
   3.9095838537475734`*^9, 3.9095839544605455`*^9}, {3.9095840037353363`*^9, 
   3.9095840072594504`*^9}, 3.909584040669332*^9, {3.9095843570127993`*^9, 
   3.9095843771306276`*^9}, {3.9096522869586053`*^9, 3.909652356158386*^9}, 
   3.909835206677749*^9, 3.9107933696445637`*^9},
 CellLabel->
  "In[305]:=",ExpressionUUID->"a8a76e69-90fa-4925-8bff-b312777dfa34"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Inter-Bacteria & Bacteria-Core Distances", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8908802269766808`*^9, 3.8908802364647446`*^9}, {3.893447561988504*^9, 
   3.8934475734261603`*^9}, 
   3.894119862825429*^9},ExpressionUUID->"c6760d95-5bed-4918-b213-\
e98fe8b274e5"],

Cell[CellGroupData[{

Cell["Generate Swarm Core Regions", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 
  3.8934474660289726`*^9}},ExpressionUUID->"75b4786f-364e-4f96-81b3-\
653583ef7363"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"swarmWindowCentralMasksCores", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"getCentralEllipseSW", "@", "#"}]}], ")"}], "&"}], "/@", 
         "swarmWindowCoreMasksUnified"}], "//", "Parallelize"}]}], ";"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "swarmWindowCoreMasksUnified"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"windowCoreRegions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"segmentRegion", "@", "#"}]}], ")"}], "&"}], "/@", 
         "swarmWindowCentralMasksCores"}], "//", "Parallelize"}]}], ";"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "swarmWindowCentralMasks"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"windowCoreRegionsFull", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"segmentRegion", "@", "#"}]}], ")"}], "&"}], "/@", 
        "swarmWindowCoreMasksUnified"}], "//", "Parallelize"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "swarmWindowEllipseMasksUnified"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.899710923272582*^9, 3.8997109329028015`*^9}, {
  3.8997110739994197`*^9, 3.8997110913272505`*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"4d72f73d-fbdf-4213-9b20-ab1555fd54d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Distances to Surface", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 
   3.8946333828558035`*^9},ExpressionUUID->"fecc8f05-a2b0-4018-9391-\
be176b17962e"],

Cell["\<\
Defaults :
   
splineOrder=10;
upsamplingFactor=2;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9},
 FontSize->16,ExpressionUUID->"64659252-6c0a-4259-97c7-6c36563e7633"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"splineOrder", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upsamplingFactor", "=", "2"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8946296548874764`*^9, 3.8946296842842813`*^9}, {
  3.8946297921989894`*^9, 3.8946297997986565`*^9}, {3.8946298511472225`*^9, 
  3.894629870086791*^9}, {3.8946304245419593`*^9, 3.8946304501825476`*^9}, {
  3.8946316015916815`*^9, 3.8946316182790127`*^9}, {3.8946318321369047`*^9, 
  3.894631854405827*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"6ecf14da-f6da-4fad-9146-1ff79ed18974"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleToCoreDistances", "=", 
      RowBox[{"Parallelize", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"getParticleToSurfaceDistances", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"swarmWindowCentralMasksCores", ",", "windowParticles"}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "windowParticles"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8946338247049704`*^9, 3.8946339542829275`*^9}, {
   3.89463399282834*^9, 3.8946341209343843`*^9}, {3.894634154261055*^9, 
   3.894634161372403*^9}, {3.8946342528576994`*^9, 3.894634339622902*^9}, {
   3.894634379514533*^9, 3.894634390749549*^9}, {3.894643283420931*^9, 
   3.894643293951292*^9}, 3.899711126200307*^9},
 CellLabel->
  "In[319]:=",ExpressionUUID->"a23a7dd5-a532-4a67-a864-2385a68c69ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Particle to Surface Distances >>", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.899712450797326*^9, 
   3.899712461077155*^9}},ExpressionUUID->"292664d4-6538-424f-80d2-\
a619276ab15f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Particle to Core Distances.txt\>\""}], 
    ",", 
    RowBox[{"Compress", "@", "particleToCoreDistances"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8997118859500647`*^9, 3.899711891030279*^9}, {
  3.899712552477557*^9, 3.89971256065301*^9}, {3.9095111253189416`*^9, 
  3.9095111411195073`*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"8ab873d2-7b4f-4999-9ce3-7162565287ec"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Particle to Surface Distances <<", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.899712450797326*^9, 
   3.899712478013977*^9}},ExpressionUUID->"244717d1-494f-4a0c-9c56-\
cb3296eba1fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particleToCoreDistances", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Particle to Core Distances.txt\>\""}],
      "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.899711884470009*^9, 3.899711893223356*^9}, {
  3.899712573454232*^9, 3.8997125811267047`*^9}, {3.9095111300026817`*^9, 
  3.909511135669237*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"cb97d043-b63b-4b73-bc34-3115744f2570"]
}, Closed]],

Cell[CellGroupData[{

Cell["Distance to Surface Stats", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.8946377034807544`*^9, 
   3.8946377078070807`*^9}},ExpressionUUID->"346f6cf6-4e02-425c-8f0e-\
973920929e27"],

Cell["\<\
Defaults :
   
histogramInterpolationOrder=2;
histogramBinningMethod=\[CloseCurlyDoubleQuote]FreedmanDiaconis\
\[CloseCurlyDoubleQuote];\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.8947200071652517`*^9, 3.894720034802435*^9}, 3.9096500518620863`*^9},
 FontSize->16,ExpressionUUID->"231bba11-949a-4e93-806a-7520a76f37fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"histogramInterpolationOrder", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coreDistancePlotLabels", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<d_{\\\\text{core}}, ~\\\\mu m\>\"", ",", "\"\<\\\\rho\>\""}], 
     "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.894634913891376*^9, 3.894634916780822*^9}, {
   3.894638603525313*^9, 3.8946386335227222`*^9}, {3.8946391751345463`*^9, 
   3.894639229681097*^9}, 3.894705733758725*^9, {3.8947057791661205`*^9, 
   3.894705793461455*^9}, {3.909585179971184*^9, 3.909585181674474*^9}, {
   3.9095853424580374`*^9, 3.909585383713892*^9}, 3.909650048478141*^9, 
   3.9101247814731336`*^9},
 CellLabel->
  "In[322]:=",ExpressionUUID->"20ef97d7-7a9c-4a53-b1a9-7a6a362d6829"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"particleToCoreDistanceBins", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getDataBins", "@", 
         RowBox[{"HistogramList", "[", 
          RowBox[{"#", ",", "histogramBinningMethod"}], "]"}]}], "&"}], "@", 
       RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"particleToCoreDistances", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "swarmTrackDataIDs"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"particleToCoreDistanceBinsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pixelSizeMicroMeters", ",", "1"}], "}"}], "*", 
        RowBox[{"Transpose", "@", "#"}]}], "]"}], "&"}], "/@", 
     "particleToCoreDistanceBins"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"plotSurfaceDistanceStats", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getBinPlot", "[", 
       RowBox[{"#", ",", "coreDistancePlotLabels", ",", "All"}], "]"}], "&"}],
      "/@", "particleToCoreDistanceBinsPhysical"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotSurfaceDistanceStats", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "plotSurfaceDistanceStats"}], ",", "1"}], "}"}]}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.894643302398311*^9, {3.8947156237015824`*^9, 3.894715625641488*^9}, {
   3.9095853072516365`*^9, 3.9095853077373867`*^9}, {3.909585356116129*^9, 
   3.9095853742593017`*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"8d8bf178-2c84-41c9-a810-3e2829c310e5"],

Cell[BoxData[
 RowBox[{"plotSurfaceDistanceStatsAll", "=", 
  RowBox[{"getBinPlot", "[", 
   RowBox[{
   "particleToCoreDistanceBinsPhysical", ",", "coreDistancePlotLabels", ",", 
    "All"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8946347545784445`*^9, 3.8946347559476547`*^9}, {
   3.894634828074498*^9, 3.894634901371554*^9}, {3.894634983134549*^9, 
   3.89463499948383*^9}, {3.8946367120005713`*^9, 3.8946368072425528`*^9}, {
   3.8946368747475243`*^9, 3.8946369498865414`*^9}, 3.894636999597148*^9, 
   3.8946392335956197`*^9, {3.894642940245322*^9, 3.8946429596016946`*^9}, {
   3.8946432468431945`*^9, 3.8946432486609545`*^9}, {3.909585406220337*^9, 
   3.909585414052085*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"9b673a28-0c34-4620-87ab-c31357ae6dda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{
    "plotSurfaceDistanceStatsAll", ",", "\"\<Bacteria-core Distance All\>\"", 
     ",", "100"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", 
     RowBox[{
      RowBox[{"plotSurfaceDistanceStats", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"\"\<Bacteria-core Distance \>\"", "<>", 
       RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "plotSurfaceDistanceStats"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9095863127003813`*^9, 3.9095863427083178`*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"5906a9f5-e103-4cf4-8612-867e3097fad8"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Inter-Bacteria Distance Calculation ]]", "Subsubsection",
 CellChangeTimes->{{3.8941298222796745`*^9, 3.894129828462428*^9}, {
   3.8946213271186275`*^9, 3.894621330024131*^9}, 
   3.8996647347281885`*^9},ExpressionUUID->"f5210b9d-4a27-475b-88d0-\
3941ac6b8e22"],

Cell[CellGroupData[{

Cell["Get the number of clusters (?)", "Item",
 CellChangeTimes->{{3.899713460057332*^9, 3.899713485407633*^9}, {
  3.9002773173311706`*^9, 3.900277372360981*^9}},
 FontSize->24,ExpressionUUID->"a3d65857-60a9-46be-9d6f-be9069d2d56c"],

Cell["Get cluster sizes (?)", "Item",
 CellChangeTimes->{{3.899713460057332*^9, 3.899713485407633*^9}, {
  3.9002773173311706`*^9, 3.9002773690158367`*^9}},
 FontSize->24,ExpressionUUID->"78e63ec3-d774-42a4-b828-4157bce7cd2b"]
}, Open  ]],

Cell["\<\
Defaults :
   
pointSeedSize=0.005;
growthIterations=25;
growthIncrement=2;
maskDownscaleFactor=3/5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.894720062199687*^9}},
 FontSize->16,ExpressionUUID->"b8a22846-37c8-4b8f-ae31-3b5f783a4069"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointSeedSize", "=", "0.005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"growthIterations", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"growthIncrement", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maskDownscaleFactor", "=", 
   RowBox[{"3", "/", "5"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.894129868963631*^9, 3.8941298779564795`*^9}, {
   3.89413014068471*^9, 3.8941301806993904`*^9}, {3.89464344424356*^9, 
   3.8946434485845065`*^9}, {3.8947158564902244`*^9, 3.8947158680084133`*^9}, 
   3.8947290072761774`*^9, 3.8947290636592984`*^9, {3.894729127010838*^9, 
   3.8947291289693947`*^9}, {3.8947292385275626`*^9, 3.8947292492913303`*^9}, 
   3.894729681760516*^9, 3.8947297176875935`*^9, {3.8947299005431433`*^9, 
   3.894729930235104*^9}, {3.8947744059324493`*^9, 3.894774406148164*^9}, {
   3.8947747887623963`*^9, 3.8947747900558434`*^9}, 3.8947750887100573`*^9, 
   3.89477635673201*^9, {3.8997112791827564`*^9, 3.8997112796784787`*^9}, {
   3.8997113705449586`*^9, 3.8997113707339015`*^9}, {3.8997115317823963`*^9, 
   3.8997115319179497`*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"ab86b0fe-f4d4-4c67-9c1c-3a3894b57286"],

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"windowParticles", ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "\[Equal]", 
       RowBox[{"{", "}"}]}], "&"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.900278942148271*^9, 3.900278952967331*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"da2371fa-2b4c-4f4e-8df2-5f3e6f5690d8"],

Cell["Write the code below as a Module[] for testing", "Item",
 CellChangeTimes->{{3.900277279604184*^9, 3.90027731019184*^9}, {
  3.9002790009423695`*^9, 3.9002790009423695`*^9}},
 FontSize->18,ExpressionUUID->"48cd7c4a-3279-4d6b-8059-80ef90aa3550"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testGrowthMask", "=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"windowParticles", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ImagePad", "[", 
         RowBox[{"#", ",", "5", ",", "0"}], "]"}], "&"}], "@", 
       "placeholderSW"}], ",", "\[IndentingNewLine]", 
      RowBox[{"getPointGrowthMask", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"swarmWindowCoreMasksUnified", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], ",", 
        RowBox[{"windowParticles", "[", 
         RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testParticleClusterComponents", "=", 
     RowBox[{"growPointClusters", "@", "testGrowthMask"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testConnectedComponents", "=", 
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Colorize", "@", "testParticleClusterComponents"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"windowParticles", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "White"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testParticleComponentDataCorrected", "=", 
    RowBox[{"getParticleConnectivity", "[", "\[IndentingNewLine]", 
     RowBox[{"testParticleClusterComponents", ",", 
      RowBox[{"windowParticles", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testParticleGraph", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Graph", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "@@", 
            RowBox[{"Thread", "/@", 
             RowBox[{
              RowBox[{"KeyValueMap", "[", "UndirectedEdge", "]"}], "@", 
              "#Neighbors"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"VertexCoordinates", "\[Rule]", 
          RowBox[{"Normal", "@", "#Centroid"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.05"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Red", ",", 
            RowBox[{"Thickness", "@", "0.0045"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"ImageDimensions", "@", "testGrowthMask"}]}], "}"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Prolog", "\[Rule]", 
          RowBox[{"Inset", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Dilation", "[", 
               RowBox[{"#", ",", 
                RowBox[{"DiskMatrix", "@", "2"}]}], "]"}], "&"}], "@", 
             "testGrowthMask"}], ",", "\[IndentingNewLine]", "Automatic", ",",
             "Automatic", ",", 
            RowBox[{"Scaled", "@", "1"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", 
      "testParticleComponentDataCorrected"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testParticleGraphVisuals", "=", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"windowParticles", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", "4", ",", "0"}], "]"}], "&"}], "@", 
        "placeholderSW"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"swarmWindowCoreMasksUnified", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"RasterSize", "\[Rule]", 
              RowBox[{"ImageDimensions", "@", 
               RowBox[{"swarmWindowCoreMasksUnified", "[", 
                RowBox[{"[", "testID", "]"}], "]"}]}]}]}], "]"}], "&"}], "@", 
          RowBox[{"Image", "@", "testParticleGraph"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sort", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"swarmWindowCoreMasksUnified", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Dilation", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "1"}]}], "]"}], "&"}], "@", 
          "testGrowthMask"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "testConnectedComponents", ",", "testParticleGraphVisuals"}], 
      "\[IndentingNewLine]", "}"}]}], ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Rows\>\""}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"testParticleConnections", ",", "testParticleCentroids"}], 
      "}"}], "=", 
     RowBox[{
     "getConnectionsCentroids", "@", "testParticleComponentDataCorrected"}]}],
     ";"}], "//", "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testParticleNeigborDistances", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"Subtract", "@@", "#"}], "]"}], "&"}], "@", " ", 
          RowBox[{"testParticleCentroids", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", "#"}], "&"}], "/@", 
      RowBox[{"testParticleConnections", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "All"}], "]"}], "]"}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SmoothHistogram", "[", "\[IndentingNewLine]", 
  RowBox[{"testParticleNeigborDistances", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<SheatherJones\>\"", ",", "\"\<Epanechnikov\>\""}], "}"}], 
   ",", "\"\<Intensity\>\""}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.894110564854948*^9, 3.8941107145904207`*^9}, {
   3.894110769583019*^9, 3.8941107726619782`*^9}, {3.8941108354477425`*^9, 
   3.894110836397998*^9}, {3.8941111783829784`*^9, 3.8941111887666483`*^9}, {
   3.894111269726762*^9, 3.8941112851591854`*^9}, {3.894111479663502*^9, 
   3.894111485702306*^9}, {3.89411472368673*^9, 3.8941147680714808`*^9}, 
   3.8941148877189713`*^9, {3.8941152548763576`*^9, 3.8941152885030355`*^9}, 
   3.8941201927302713`*^9, {3.894121779466936*^9, 3.8941217962168603`*^9}, {
   3.894121832337696*^9, 3.8941218354653406`*^9}, {3.8941218869443274`*^9, 
   3.894121940073451*^9}, 3.8941220180823607`*^9, {3.894122073113014*^9, 
   3.894122118314191*^9}, {3.894122156561265*^9, 3.894122176153131*^9}, 
   3.8941222173141036`*^9, {3.8941222654257574`*^9, 3.894122269072544*^9}, {
   3.894122302441931*^9, 3.894122323386488*^9}, {3.8941223566430674`*^9, 
   3.894122439776385*^9}, {3.894129847767116*^9, 3.894129918725704*^9}, 
   3.8941299929754443`*^9, {3.8941300415824165`*^9, 3.894130042004361*^9}, 
   3.89413008494156*^9, 3.8941301242125797`*^9, {3.894130211221706*^9, 
   3.894130211660632*^9}, {3.8941302537374563`*^9, 3.894130272837721*^9}, {
   3.8941303462320805`*^9, 3.894130385116501*^9}, {3.894130424527461*^9, 
   3.89413046682034*^9}, {3.8941304986876297`*^9, 3.8941305235801344`*^9}, 
   3.8941306137581544`*^9, {3.894131415157439*^9, 3.894131415179391*^9}, 
   3.8941314688625607`*^9, {3.8941337322283955`*^9, 3.8941337537690206`*^9}, 
   3.8946213841777*^9, {3.8946446578317623`*^9, 3.8946446592457504`*^9}, {
   3.8946447911587687`*^9, 3.894644824996022*^9}, 3.894644915505866*^9, {
   3.8946453380588217`*^9, 3.8946453750305448`*^9}, {3.8946457126992855`*^9, 
   3.8946457787163215`*^9}, {3.894652220994953*^9, 3.8946522219642406`*^9}, 
   3.8946523272324233`*^9, {3.8946523696450005`*^9, 3.894652378602128*^9}, {
   3.8946524179219913`*^9, 3.894652420087475*^9}, {3.8946524951312666`*^9, 
   3.894652530970515*^9}, 3.8946525689622774`*^9, {3.89465263897061*^9, 
   3.8946526512166963`*^9}, {3.894652732250325*^9, 3.894652736532054*^9}, {
   3.894652771338426*^9, 3.8946528057502127`*^9}, {3.8946528400518627`*^9, 
   3.894652892180191*^9}, 3.8946529248075175`*^9, {3.8946529691583405`*^9, 
   3.894652975354084*^9}, {3.8946531172980547`*^9, 3.894653118150759*^9}, {
   3.8946531647305593`*^9, 3.894653269308591*^9}, {3.894653349546792*^9, 
   3.8946533557318783`*^9}, {3.894653420380596*^9, 3.894653441191016*^9}, 
   3.894653494665967*^9, {3.894653580273855*^9, 3.8946535863932486`*^9}, {
   3.894653637413529*^9, 3.894653639034109*^9}, {3.8946536884107933`*^9, 
   3.8946536908435144`*^9}, {3.894653734301964*^9, 3.8946537350610857`*^9}, {
   3.894653795298605*^9, 3.894653798691625*^9}, {3.894653845429387*^9, 
   3.8946538951469417`*^9}, {3.89465396068281*^9, 3.8946539641494193`*^9}, {
   3.8946541659406843`*^9, 3.894654191746208*^9}, {3.8946542552202168`*^9, 
   3.89465425595495*^9}, {3.894654616395371*^9, 3.894654654204587*^9}, {
   3.8946547826203413`*^9, 3.8946548155516186`*^9}, {3.894655891167035*^9, 
   3.894655891908807*^9}, {3.8946560907344313`*^9, 3.8946560960249467`*^9}, {
   3.8947159188915215`*^9, 3.8947159349255133`*^9}, {3.8947219641063194`*^9, 
   3.8947219642541475`*^9}, {3.8947284431807785`*^9, 
   3.8947284469784966`*^9}, {3.8947289332278247`*^9, 3.8947289534371595`*^9}, 
   3.8947290613628473`*^9, {3.8947300288694625`*^9, 3.8947300418916574`*^9}, {
   3.8947304649934645`*^9, 3.894730467126116*^9}, 3.8947325545658607`*^9, {
   3.8997113333457727`*^9, 3.899711358049432*^9}, {3.899711393112404*^9, 
   3.899711483527466*^9}, {3.899712716606267*^9, 3.8997127177652826`*^9}, 
   3.89971434686169*^9, {3.900277195666622*^9, 3.9002772659536676`*^9}, {
   3.90027895956164*^9, 3.900278971770162*^9}, {3.900279027186222*^9, 
   3.9002790272550344`*^9}, {3.900279076657197*^9, 3.900279079511509*^9}, {
   3.90027922929489*^9, 3.9002793074991064`*^9}, {3.9002793943608356`*^9, 
   3.900279421662799*^9}, 3.9002797237515526`*^9, {3.9002797876070538`*^9, 
   3.9002798359693556`*^9}, 3.9002798918896046`*^9, {3.900280072128984*^9, 
   3.9002800756865206`*^9}, 3.900280224558601*^9, 3.9002805033373165`*^9, 
   3.9002805754395156`*^9, {3.9101251609441233`*^9, 3.9101251668471136`*^9}, 
   3.9101253392557526`*^9, {3.9104712654052787`*^9, 3.910471336812838*^9}, {
   3.9104713703344975`*^9, 3.910471432958452*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"b2a0c94e-7e00-4048-bd41-2dbb23adf771"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute Inter-Bacteria Distances", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, {3.8941200322730665`*^9, 
   3.894120036794924*^9}, 
   3.89966473672991*^9},ExpressionUUID->"5df2cadd-fb00-4f68-a7c7-\
862c0b1c76f7"],

Cell[BoxData[{
 RowBox[{"memoryCheck", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"growthMasks", "=", 
      RowBox[{"Parallelize", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#2", "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"ImagePad", "[", 
                 RowBox[{"#", ",", "5", ",", "0"}], "]"}], "&"}], "@", 
               "placeholderSW"}], ",", "\[IndentingNewLine]", 
              RowBox[{"getPointGrowthMask", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ")"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"swarmWindowCoreMasksUnified", ",", "windowParticles"}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "windowParticles"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.8946458400452085`*^9, {3.8946459073748846`*^9, 3.8946460076339626`*^9}, 
   3.894654832698408*^9, {3.8946548964706984`*^9, 3.8946548986831093`*^9}, {
   3.8946550671609697`*^9, 3.8946550746614485`*^9}, {3.894773279012512*^9, 
   3.894773287523332*^9}, 3.894774046384348*^9, 3.894780443495957*^9, {
   3.896441770143953*^9, 3.896441772159975*^9}, 3.8997128815461097`*^9, {
   3.900279901396123*^9, 3.9002799079506445`*^9}, {3.900279974016199*^9, 
   3.9002799835428333`*^9}, 3.900280080705098*^9, 3.9002805246314173`*^9},
 CellLabel->
  "In[348]:=",ExpressionUUID->"3bc2781c-e122-4ebe-8cea-586d14b5775d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"growthInitialComponents", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"getInitialComponents", "@", "#"}]}], "\[IndentingNewLine]",
          ")"}], "&"}], "/@", "growthMasks"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "growthMasks"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.8946458400452085`*^9, {3.8946459073748846`*^9, 3.8946460076339626`*^9}, 
   3.894654832698408*^9, {3.8946548964706984`*^9, 3.8946548986831093`*^9}, {
   3.8946550671609697`*^9, 3.8946550746614485`*^9}, {3.894656659758507*^9, 
   3.894656704186104*^9}, {3.8946567415275655`*^9, 3.8946567804086246`*^9}, {
   3.8946568151941338`*^9, 3.8946568173613267`*^9}, {3.8946568706502795`*^9, 
   3.8946568712300205`*^9}, {3.8947381886097183`*^9, 3.8947381946629276`*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"953df9bb-386d-469e-b9c1-fb82f73eebb6"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{
    "{", "\[IndentingNewLine]", "growthMasks", "\[IndentingNewLine]", "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{
  3.8946458400452085`*^9, {3.8946459073748846`*^9, 3.8946460076339626`*^9}, 
   3.894654832698408*^9, {3.8946548964706984`*^9, 3.8946548986831093`*^9}, {
   3.8946550671609697`*^9, 3.8946550746614485`*^9}, {3.894656659758507*^9, 
   3.894656704186104*^9}, {3.8946567415275655`*^9, 3.8946567804086246`*^9}, {
   3.8946568151941338`*^9, 3.8946568173613267`*^9}, {3.8946568706502795`*^9, 
   3.8946568712300205`*^9}, {3.8947381886097183`*^9, 
   3.8947381967103443`*^9}, {3.8964417819725266`*^9, 3.8964417903707666`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"9ae2d298-4da4-4c6b-ba62-c91dbcd993fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleClusterComponents", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"growInitializedPointClusters", "@", "#"}]}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", 
        "growthInitialComponents"}], "//", "Parallelize"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "growthInitialComponents"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.8946458400452085`*^9, {3.8946459073748846`*^9, 3.8946460076339626`*^9}, 
   3.8946551268915277`*^9, {3.8946552420903006`*^9, 3.8946553731192136`*^9}, {
   3.89465541076486*^9, 3.8946554129519176`*^9}, {3.894655443516947*^9, 
   3.894655443795221*^9}, 3.8946555238104205`*^9, {3.894655561003674*^9, 
   3.89465558370621*^9}, {3.8946561344627433`*^9, 3.8946561532339115`*^9}, 
   3.8946563209999647`*^9, {3.8946571983844147`*^9, 3.8946572169853554`*^9}, {
   3.89465728688095*^9, 3.894657306632159*^9}, {3.8946576053926992`*^9, 
   3.894657630593295*^9}, {3.8946578422664785`*^9, 3.894657849496754*^9}, 
   3.894657879984068*^9, 3.8946579100681677`*^9, {3.89465805059792*^9, 
   3.894658060545161*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"09eb2baa-6f75-40d9-993d-e36b5f38e655"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{
    "{", "\[IndentingNewLine]", "growthInitialComponents", 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, {
   3.894737851687699*^9, 3.8947378523358727`*^9}, {3.8947378865619993`*^9, 
   3.8947379063365316`*^9}, {3.8964417955128655`*^9, 3.8964418020120397`*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"d7dc38dc-2cc0-4586-8e4c-3823c67c2bcf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleComponentData", "=", 
      RowBox[{"Parallelize", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"getParticleConnectivity", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"particleClusterComponents", ",", "windowParticles"}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "windowParticles"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.8946458400452085`*^9, {3.8946459073748846`*^9, 3.8946460076339626`*^9}, 
   3.894654832698408*^9, {3.8946548964706984`*^9, 3.8946548986831093`*^9}, {
   3.8946550671609697`*^9, 3.8946550746614485`*^9}, {3.8946582194269967`*^9, 
   3.8946582444939613`*^9}, {3.894658443457079*^9, 3.8946584448668275`*^9}, {
   3.8947278351258574`*^9, 3.894727836348037*^9}, {3.8947287178351917`*^9, 
   3.8947287400330067`*^9}, 3.8947304960920153`*^9, {3.8947305476360006`*^9, 
   3.894730550859259*^9}, {3.8947762622877245`*^9, 3.8947762674528136`*^9}, 
   3.894780454400679*^9},
 CellLabel->
  "In[361]:=",ExpressionUUID->"861d63fa-2ad3-4e2a-84da-43d0b0f5f2df"],

Cell[BoxData[{
 RowBox[{"memoryCleanupStart", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "/@", 
   RowBox[{"Unevaluated", "[", 
    RowBox[{
    "{", "\[IndentingNewLine]", "particleClusterComponents", 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"memoryCleanupFinalize", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.892917893520851*^9, 3.8929179065851145`*^9}, 
   3.8929179831703787`*^9, 3.8929181245155263`*^9, {3.892918216001194*^9, 
   3.8929182550107403`*^9}, {3.892918458720956*^9, 3.8929185189383583`*^9}, {
   3.892919978921705*^9, 3.8929200424338474`*^9}, {3.892920095104007*^9, 
   3.8929201191521463`*^9}, {3.8929201857200437`*^9, 
   3.8929201897801323`*^9}, {3.8929202239208803`*^9, 3.892920226628641*^9}, {
   3.8929203129437065`*^9, 3.8929203170402956`*^9}, {3.8929203528802633`*^9, 
   3.8929203549710903`*^9}, {3.8929583987803106`*^9, 
   3.8929584157121534`*^9}, {3.892958472947974*^9, 3.8929584749167557`*^9}, {
   3.8929585078671913`*^9, 3.8929585428591676`*^9}, {3.8929773095060277`*^9, 
   3.892977312651637*^9}, {3.8930952081784463`*^9, 3.89309521646329*^9}, {
   3.89313895136123*^9, 3.893138973505024*^9}, 3.893139516966937*^9, 
   3.893143288320285*^9, {3.8931433575390224`*^9, 3.8931433805197034`*^9}, {
   3.894737851687699*^9, 3.8947378523358727`*^9}, {3.8947378865619993`*^9, 
   3.8947379265684834`*^9}, {3.896441805369852*^9, 3.896441812860406*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"359790d1-161f-4819-8f8d-87ecb9ce5305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "particleNetworkConnections", ",", "particleNetworkCentroids"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"getConnectionsCentroids", "@", "#"}]}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", 
        "particleComponentData"}], "//", "Transpose"}]}], ";"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "particleComponentData"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8946585821229506`*^9, 3.8946586044749784`*^9}, {
  3.8946586353223915`*^9, 3.8946587158770695`*^9}, {3.8946587559248123`*^9, 
  3.894658778001781*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"64fb45e7-0b4b-4d31-9649-c8486e5f62cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"particleNeigborDistances", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"Subtract", "@@", "#"}], "]"}], "&"}], "@", " ", 
              RowBox[{"particleNetworkCentroids", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "#"}], "]"}], "]"}]}], "&"}], "@", "#"}], 
           "&"}], "/@", 
          RowBox[{"particleNetworkConnections", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "particleNetworkConnections"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "particleNetworkConnections"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8946585821229506`*^9, 3.894658592386324*^9}, {
  3.894658809645751*^9, 3.894658960339017*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"b5736cdb-d4fe-45b1-965b-89fc8539575f"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Particle Neighbor Distances >>", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.8946377034807544`*^9, 3.8946377078070807`*^9}, {3.8946886299621487`*^9, 
   3.894688635395152*^9}, {3.8997115889022636`*^9, 
   3.8997115993584223`*^9}},ExpressionUUID->"81767aba-4766-4bc6-bb09-\
84ab3522e9d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Particle Neigbor Distances.txt\>\""}], 
    ",", 
    RowBox[{"Compress", "@", "particleNeigborDistances"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.899711602674571*^9, {3.899712755774853*^9, 3.899712759084684*^9}, {
   3.899712804521181*^9, 3.8997128124563255`*^9}, {3.909511145159717*^9, 
   3.90951114831174*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"3b1071b6-478e-41d9-b6e9-656e657781b0"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Particle Neighbor Distances <<", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.8946377034807544`*^9, 3.8946377078070807`*^9}, {3.8946886299621487`*^9, 
   3.894688635395152*^9}, {3.8997115889022636`*^9, 
   3.899711622581544*^9}},ExpressionUUID->"77b6c950-4e49-4608-96cd-\
3d52011c1570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"particleNeigborDistances", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "dataCompressedfolder", "<>", "\"\<Particle Neigbor Distances.txt\>\""}],
      "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.899711602674571*^9, 3.89971276103657*^9, {3.899712807286216*^9, 
   3.8997128165903645`*^9}, {3.9095111503700275`*^9, 3.909511152862437*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"37c6f2d3-b2f4-4551-8bd1-642d3bbd9fdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Inter-Bacteria Distance Stats", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.8946377034807544`*^9, 3.8946377078070807`*^9}, {3.8946886299621487`*^9, 
   3.894688635395152*^9}},ExpressionUUID->"d4fd85c8-7b0c-4dd3-92bf-\
9f96d5ce0468"],

Cell["\<\
Defaults :
   
histogramInterpolationOrder=2;
histogramBinningMethod=\[CloseCurlyDoubleQuote]FreedmanDiaconis\
\[CloseCurlyDoubleQuote];\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947200763092165`*^9}, 
   3.909650044370126*^9},
 FontSize->16,ExpressionUUID->"a6f99998-cd35-41f9-8129-3c3d37992123"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"histogramInterpolationOrder", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particleDistancePlotLabels", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<d_{\\\\text{bacteria}}, ~\\\\mu m\>\"", ",", "\"\<\\\\rho\>\""}], 
     "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.894634913891376*^9, 3.894634916780822*^9}, {
   3.894638603525313*^9, 3.8946386335227222`*^9}, {3.8946391751345463`*^9, 
   3.894639229681097*^9}, {3.8946883381192045`*^9, 3.894688376386072*^9}, 
   3.8947058660853925`*^9, {3.9095869531314683`*^9, 3.9095869578261814`*^9}, {
   3.9096045404893875`*^9, 3.9096045639292183`*^9}, 3.9096500415655713`*^9, 
   3.909843474688789*^9, {3.909843538457507*^9, 3.909843555216817*^9}, 
   3.910127233095662*^9},
 CellLabel->
  "In[371]:=",ExpressionUUID->"47c5dc17-4c7d-4828-aed6-34ff15fbba26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"particleNeigborDistanceBins", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getDataBins", "@", 
         RowBox[{"HistogramList", "[", 
          RowBox[{"#", ",", "histogramBinningMethod"}], "]"}]}], "&"}], "@", 
       RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"particleNeigborDistances", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "swarmTrackDataIDs"}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"particleNeigborDistanceBinsPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pixelSizeMicroMeters", ",", "1"}], "}"}], "*", 
        RowBox[{"Transpose", "@", "#"}]}], "]"}], "&"}], "/@", 
     "particleNeigborDistanceBins"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotParticleDistanceStats", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getBinPlot", "[", 
       RowBox[{"#", ",", "particleDistancePlotLabels", ",", "All"}], "]"}], 
      "&"}], "/@", "particleNeigborDistanceBinsPhysical"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotParticleDistanceStats", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "plotParticleDistanceStats"}], ",", "1"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.894643302398311*^9, {3.894688078323408*^9, 3.8946880895058823`*^9}, {
   3.894715998483796*^9, 3.8947160005375757`*^9}, {3.9095869336672287`*^9, 
   3.909586942187219*^9}, 3.909604566628497*^9, {3.909604649371101*^9, 
   3.909604664898614*^9}, 3.909604695011306*^9, {3.9098434508413916`*^9, 
   3.9098435328575172`*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"e4e58a4a-1318-496f-83fc-e63731327900"],

Cell[BoxData[
 RowBox[{"plotParticleDistanceStatsAll", "=", "\[IndentingNewLine]", 
  RowBox[{"getBinPlot", "[", 
   RowBox[{
   "particleNeigborDistanceBinsPhysical", ",", "particleDistancePlotLabels", 
    ",", "All"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8946347545784445`*^9, 3.8946347559476547`*^9}, {
   3.894634828074498*^9, 3.894634901371554*^9}, {3.894634983134549*^9, 
   3.89463499948383*^9}, {3.8946367120005713`*^9, 3.8946368072425528`*^9}, {
   3.8946368747475243`*^9, 3.8946369498865414`*^9}, 3.894636999597148*^9, 
   3.8946392335956197`*^9, {3.894642940245322*^9, 3.8946429596016946`*^9}, {
   3.8946432468431945`*^9, 3.8946432486609545`*^9}, {3.894688467604136*^9, 
   3.894688475203948*^9}, 3.900281919725114*^9, 3.909604782067141*^9},
 CellLabel->
  "In[378]:=",ExpressionUUID->"af5210c7-df6a-4ace-bee5-7751b3cc7f79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{
    "plotParticleDistanceStatsAll", ",", 
     "\"\<Inter-Bacteria Distance All\>\"", ",", "100"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exportImagesTwoFormat", "[", 
     RowBox[{
      RowBox[{"plotParticleDistanceStats", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"\"\<Inter-Bacteria Distance \>\"", "<>", 
       RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "plotParticleDistanceStats"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9095863127003813`*^9, 3.9095863427083178`*^9}, {
  3.9095870685891523`*^9, 3.909587086027439*^9}},
 CellLabel->
  "In[385]:=",ExpressionUUID->"81dccc74-3ed0-4683-b3cf-ebddc770e9d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Inter-Bacteria & Bacteria-Core Distance Dynamics", "Subsubsection",
 CellChangeTimes->{{3.8934474512200613`*^9, 3.893447505027046*^9}, {
   3.8934475423800135`*^9, 3.8934475465661025`*^9}, 3.8946333828558035`*^9, {
   3.8946377034807544`*^9, 3.8946377078070807`*^9}, {3.8946886299621487`*^9, 
   3.894688635395152*^9}, {3.8947048379154167`*^9, 3.8947048394990387`*^9}, {
   3.894708375507879*^9, 
   3.894708380501373*^9}},ExpressionUUID->"e8d4f778-742b-485b-9054-\
f4f248b80e94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"particleToCoreDistancesPhysical", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"frameDurationSeconds", "*", "#1"}], ",", 
          RowBox[{"pixelSizeMicroMeters", "*", "#2"}]}], "}"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackTimestamps", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"particleToCoreDistances", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         "swarmTrackDataIDs"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"particleToCoreDistanceMetrics", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getTimeSeriesMetric", "[", 
         RowBox[{"#", ",", "metric"}], "]"}], "&"}], "/@", 
       "particleToCoreDistancesPhysical"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"metric", ",", 
        RowBox[{"{", 
         RowBox[{"Mean", ",", "StandardDeviation", ",", "Skewness"}], "}"}]}],
        "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"particleNeigborDistancesPhysical", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"frameDurationSeconds", "*", "#1"}], ",", 
          RowBox[{"pixelSizeMicroMeters", "*", "#2"}]}], "}"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"swarmTrackTimestamps", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"particleNeigborDistances", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         "swarmTrackDataIDs"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"particleNeigborDistanceMetrics", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getTimeSeriesMetric", "[", 
        RowBox[{"#", ",", "metric"}], "]"}], "&"}], "/@", 
      "particleNeigborDistancesPhysical"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"metric", ",", 
       RowBox[{"{", 
        RowBox[{"Mean", ",", "StandardDeviation", ",", "Skewness"}], "}"}]}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9096026728211627`*^9, 3.9096028035375566`*^9}, 
   3.9096034552344904`*^9, {3.9096051607657237`*^9, 3.909605169953551*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"10fb5a25-95c2-471e-9856-14488afc7587"],

Cell["\<\
Defaults :

upperThreshold=0.95;
lowerThreshold=1-upperThreshold;
sizeFactor=0.05;
splineOrder=3;
controlValueFactor=0.125;
envelopeRegularization=0.5;

binScale=7.5*10^-3;
dataMeanFilterScale=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.9095819407394953`*^9, 3.9095836491862817`*^9, 
   3.9096503211350555`*^9},
 FontSize->16,ExpressionUUID->"f25df869-9274-49ec-81da-91deb69ea18d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upperThreshold", "=", "0.95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerThreshold", "=", 
   RowBox[{"1", "-", "upperThreshold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeFactor", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineOrder", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"controlValueFactor", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeRegularization", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binScale", "=", 
   RowBox[{"7.5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataMeanFilterScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, 
   3.808647297464489*^9, {3.9077965118293796`*^9, 3.907796531988535*^9}, 
   3.9077966480270514`*^9, 3.9077972558054156`*^9, {3.907797307011591*^9, 
   3.907797317119295*^9}, 3.9077980032270746`*^9, 3.9077984785156126`*^9, 
   3.9093950991298914`*^9, {3.909395135307577*^9, 3.909395136219387*^9}, {
   3.9093990231939173`*^9, 3.909399052122301*^9}, {3.909399085858489*^9, 
   3.909399136218475*^9}, {3.9093994321780243`*^9, 3.9093994330097466`*^9}, {
   3.90940472574874*^9, 3.909404747904615*^9}, {3.909405209555008*^9, 
   3.9094052214074855`*^9}, 3.9094054341479125`*^9, 3.9095084219658012`*^9, {
   3.9095836712022996`*^9, 3.9095836876114807`*^9}, 3.9096503174788036`*^9},
 CellLabel->
  "In[391]:=",ExpressionUUID->"a8bd2de3-62c3-4a2a-8843-ce8749eb13e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "particleToCoreDistanceMetricsQSEfiltered", ",", 
       "particleNeigborDistanceMetricsQSEfiltered"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getFilteredDataQSE", "/@", "#"}], "&"}], "/@", "#"}], "&"}],
       "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "particleToCoreDistanceMetrics", ",", 
        "particleNeigborDistanceMetrics"}], "\[IndentingNewLine]", "}"}]}]}], 
    ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "particleToCoreDistanceMetricsMeansDeviations", ",", 
     "particleNeigborDistanceMetricsMeansDeviations"}], "}"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getMeansDeviations", "/@", "#"}], "&"}], "/@", "#"}], "&"}], "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "particleToCoreDistanceMetricsQSEfiltered", ",", 
      "particleNeigborDistanceMetricsQSEfiltered"}], "\[IndentingNewLine]", 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.909651062997447*^9, 3.90965109087112*^9}, {
   3.90965137885573*^9, 3.9096513963960247`*^9}, 3.910797838547494*^9, 
   3.910799860771496*^9},ExpressionUUID->"dd071b1a-de3c-4a30-8413-\
a713de927e5f"],

Cell["\<\
Defaults :
   
particleDistanceSeriesPlotRanges={All,All,All,All,All,All}
errorBandOpacity=0.30;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947200859371843`*^9}, 
   3.9096543577263527`*^9, {3.909654850802925*^9, 3.909654867157977*^9}},
 FontSize->16,ExpressionUUID->"8cc5c578-24cb-4420-9223-d7f4fb249ef5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"particleDistanceSeriesPlotLabels", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getLatexStyling", "/@", "#"}], "&"}], "/@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\langle d_{\\\\text{bacteria}} \\\\rangle, ~\\\\mu m\>\""}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\sigma \\\\left( d_{\\\\text{bacteria}} \\\\right), ~\\\\mu \
m\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\gamma \\\\left( d_{\\\\text{bacteria}} \\\\right)\>\""}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\langle d_{\\\\text{core}} \\\\rangle, ~\\\\mu m\>\""}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\sigma \\\\left( d_{\\\\text{core}} \\\\right), ~\\\\mu \
m\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t, ~s\>\"", ",", 
         "\"\<\\\\gamma \\\\left( d_{\\\\text{core}} \\\\right)\>\""}], 
        "}"}]}], "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"particleDistanceSeriesPlotRanges", "=", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", "1.95"}], "}"}], ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "All"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorBandOpacity", "=", "0.30"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ7eMcuLWf5a3j93DP7SB6171g2QlAusfzpjqIljzp
qwei0xxNjUH0B+ElHBOB9CGdBbwgulpk9atJQLrlXssbEL1jcoLAZCC9dLa7
KIg+FnpefhqQLvHuUATR2R+shH8pvHUsfHleEUTrbNLaJqj41rHIyRdMzwrU
Pw+iTWoZL4LoHG+VOyD6ULImmO74vu0RiPZgtnoCooOCVL+CaJ6Fk7+B6ANX
Zu0WAtL77907AKID3ZlfgmgzO75XIFrtiQa/MJCeuHwVmP5yoEcdRL/0/QWm
182I5PkFpM+lnOcF0d2fvhUvUgKGR29RCYgurrslvxlIsxhaKoBozv5Vrc+B
dMTN7WB66qE6kxdAWqF5rhmIvndH/reD8lvHBc93/gHRHV/9eB2BtPuCWjBd
t9PA0Qkk/sDPC0QDADXzt8U=
  "],
 CellLabel->
  "In[805]:=",ExpressionUUID->"8f3cd5fc-b814-410e-8e32-090745ddebd6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotParticleDistanceMetricsAll", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"preventPlotErrors", "@", "#1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
         RowBox[{"IntervalMarkersStyle", "\[Rule]", 
          RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "#2"}], ",", 
         RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "#3"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Catenate", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "particleNeigborDistanceMetricsMeansDeviations", ",", 
           "particleToCoreDistanceMetricsMeansDeviations"}], 
          "\[IndentingNewLine]", "}"}]}], ",", 
        "particleDistanceSeriesPlotRanges", ",", 
        "particleDistanceSeriesPlotLabels"}], "\[IndentingNewLine]", "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotParticleDistanceMetricsAllGrid", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
     "plotParticleDistanceMetricsAll"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.909651728897949*^9, 3.909651911597674*^9}, {
   3.9096519426610713`*^9, 3.9096520849820027`*^9}, {3.909652130013606*^9, 
   3.909652242766045*^9}, {3.9096524354297433`*^9, 3.9096524825819902`*^9}, {
   3.9096525177022934`*^9, 3.90965257592673*^9}, {3.9096539376880293`*^9, 
   3.9096539641020117`*^9}, {3.909654452461311*^9, 3.909654454589619*^9}, 
   3.9096545217427225`*^9, {3.909654604944764*^9, 3.9096546068306775`*^9}, {
   3.909662901395667*^9, 3.9096629036865435`*^9}, {3.9100338767499313`*^9, 
   3.9100338777146907`*^9}, {3.9107997036771584`*^9, 3.910799707715953*^9}, {
   3.9108002242144074`*^9, 3.9108002251232076`*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"eb236031-eed6-4773-b4fe-31d282d4e012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotParticleDistanceMetrics", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "@", 
                RowBox[{"Head", "@", "#"}]}], "\[NotEqual]", "\"\<List\>\""}],
               ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", "#"}], "]"}], 
            "&"}], "@", 
           RowBox[{"#1", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
          RowBox[{"IntervalMarkersStyle", "\[Rule]", 
           RowBox[{"Opacity", "@", "errorBandOpacity"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", "#2"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "2"}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "#1"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Catenate", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "particleNeigborDistanceMetricsMeansDeviations", ",", 
          "particleToCoreDistanceMetricsMeansDeviations"}], 
         "\[IndentingNewLine]", "}"}]}], ",", 
       "particleDistanceSeriesPlotLabels"}], "\[IndentingNewLine]", "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9096550393993177`*^9, 3.909655240826874*^9}, {
   3.9096552798872643`*^9, 3.9096553417018943`*^9}, {3.9096553986466904`*^9, 
   3.909655417462468*^9}, {3.910800254512737*^9, 3.9108002556690845`*^9}, 
   3.91080029322584*^9, {3.910800327435111*^9, 3.9108003722991266`*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"69d014ca-77bd-4151-983c-2e1931434c1e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plotParticleDistanceMetrics", "[", 
     RowBox[{"[", "metricID", "]"}], "]"}], "//", 
    RowBox[{
     RowBox[{"TableForm", "[", 
      RowBox[{"#", ",", 
       RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"metricID", ",", "1", ",", 
     RowBox[{"Length", "@", "plotParticleDistanceMetrics"}], ",", "1"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.909656147665524*^9, 3.909656221543316*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"85052f41-0f8d-40e9-a5c6-bcb9361f9bfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageNamesParticleDistanceMetrics", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Inter Bacteria Distance Mean \>\"", ",", "\[IndentingNewLine]", 
     "\"\<Inter Bacteria Distance Deviation \>\"", ",", 
     "\[IndentingNewLine]", "\"\<Inter Bacteria Distance Skewness \>\"", ",", 
     "\[IndentingNewLine]", "\"\<Bacteria Core Distance Mean \>\"", ",", 
     "\[IndentingNewLine]", "\"\<Bacteria Core Distance Deviation \>\"", ",", 
     "\[IndentingNewLine]", "\"\<Bacteria Core Distance Skewness \>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9096554952762737`*^9, 3.9096556186901407`*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"093336f8-92e2-4f6e-a949-12f841096e97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exportImagesTwoFormat", "[", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", 
          RowBox[{"#2", "<>", 
           RowBox[{"ToString", "@", "k"}]}], ",", "100"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "#1"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "plotParticleDistanceMetrics", ",", 
       "imageNamesParticleDistanceMetrics"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotParticleDistanceMetricsAllGrid", ",", 
    "\"\<Bacteria Distance Dynamics\>\"", ",", "1000"}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9096554482170925`*^9, 3.9096554827487707`*^9}, {
  3.9096556465748158`*^9, 3.9096556978293624`*^9}, {3.90965579229615*^9, 
  3.9096558655430307`*^9}, {3.910033882506734*^9, 3.910033884610404*^9}},
 CellLabel->
  "In[828]:=",ExpressionUUID->"3ec9ad4e-a4da-4172-89c0-2adb853c3df7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Bacteria Number Density Maps", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.8907228477237883`*^9}, {3.890880060126388*^9, 3.890880063380888*^9}, {
   3.890880124765503*^9, 3.8908801386136947`*^9}, 
   3.899664729212761*^9},ExpressionUUID->"64e65153-295f-428a-a2fc-\
8afc6ecc4aca"],

Cell["\<\
Defaults :
   
densityPlotRecursion=2;
densityPlotLegendSize=300;
plotPointCount=50;
densityMapBinKernelMethods={\[OpenCurlyDoubleQuote]SheatherJones\
\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]Epanechnikov\
\[CloseCurlyDoubleQuote]};\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}},
 FontSize->16,ExpressionUUID->"94e7f6dc-bb7d-4575-9e61-e2e6d1b6a0f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"densityPlotRecursion", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"densityPlotLegendSize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotPointCount", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"densityMapBinKernelMethods", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Scott\>\"", ",", "\"\<Gaussian\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"densityPlotSize", "=", "Automatic"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"densityPlotLabelSize", "=", "13"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"colorScheme", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.8907229230706444`*^9, 
   3.890722923613117*^9}, {3.8934788534985437`*^9, 3.8934788586315804`*^9}, 
   3.899713391285178*^9, {3.899713657567227*^9, 3.8997136803964653`*^9}, 
   3.899713757151433*^9, {3.8997138004614725`*^9, 3.8997138023493795`*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"4d38a6b5-0bec-400e-820a-599b194f4e57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"testPlotWindowParticleDensity", "=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"windowParticles", "[", 
      RowBox[{"[", "testID", "]"}], "]"}], "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", "placeholderSW", ",", "\[IndentingNewLine]", 
    RowBox[{"getParticleDensityPlot", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "windowParticles", ",", "windowCoreRegionsFull", ",", 
         "swarmWindowEllipseMasksUnified"}], "\[IndentingNewLine]", "}"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.890722940131611*^9, 
   3.8907229478065453`*^9}, {3.891022130116411*^9, 3.8910221335139647`*^9}, 
   3.892918772218336*^9, {3.8934484782583847`*^9, 3.893448478651349*^9}, {
   3.893478437400139*^9, 3.893478443741674*^9}, {3.8934788343332987`*^9, 
   3.8934788385999002`*^9}, {3.8934788847701006`*^9, 3.893478898143983*^9}, {
   3.8935289528246946`*^9, 3.893528953053363*^9}, 3.8940882057825985`*^9, {
   3.8940912924094796`*^9, 3.8940912964489927`*^9}, {3.8997133691584997`*^9, 
   3.8997134329009695`*^9}, 3.9002828469433236`*^9, {3.900282879950243*^9, 
   3.900282986038047*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"e00e790a-e118-4d62-89a4-7c1c3c468fad"],

Cell[CellGroupData[{

Cell["Processing Cell", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902087006748176`*^9}, {3.894090869999564*^9, 
   3.8940908841108284`*^9}},ExpressionUUID->"81c22dae-4c0f-48a7-b670-\
35da00f79d50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotWindowParticleDensity", "=", 
      RowBox[{"Parallelize", "@", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"monitorCounter", "++"}], ";", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#1", "\[Equal]", 
               RowBox[{"{", "}"}]}], ",", "placeholderSW", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"getParticleDensityPlot", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "windowParticles", ",", "windowCoreRegionsFull", ",", 
           "swarmWindowEllipseMasksUnified"}], "}"}]}], "\[IndentingNewLine]",
         "]"}]}]}], ";"}], ",", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "windowParticles"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.890077676514511*^9, 3.890077815658077*^9}, {
   3.890117239309292*^9, 3.890117256720119*^9}, 3.890117410268838*^9, 
   3.892918779426166*^9, {3.8934790031695147`*^9, 3.8934790408286853`*^9}, {
   3.8934791303660245`*^9, 3.8934791314869204`*^9}, 3.8997136002620525`*^9, {
   3.9002829379015837`*^9, 3.9002829467080297`*^9}, {3.9002830004298735`*^9, 
   3.900283000708129*^9}},
 CellLabel->
  "In[850]:=",ExpressionUUID->"64566998-6960-4498-90d2-9e18f31ccdcc"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotWindowParticleDensity", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "plotWindowParticleDensity"}], ",", "1"}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890117771157239*^9, 3.890117787867345*^9}},
 CellLabel->
  "In[548]:=",ExpressionUUID->"8171e5f0-e7fd-403a-bc27-66ea71c03cd1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export Bacteria Density Maps >>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902087006748176`*^9}, {3.8902090401395407`*^9, 
   3.8902090442760887`*^9}, 
   3.899664731288333*^9},ExpressionUUID->"6aa5ce15-1805-4633-8d8b-\
27146d1fc06c"],

Cell["\<\
Defaults :
   
plotExportFormat=\[CloseCurlyDoubleQuote].png\[CloseCurlyDoubleQuote];
plotExportCompression=0.75;
plotExportResolution=125;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, {
   3.890210387568242*^9, 3.8902104019083776`*^9}, 3.8948271610627813`*^9},
 FontSize->16,ExpressionUUID->"6885016c-1918-4149-9e9c-acdc8897b4a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotExportFormat", "=", "\"\<.png\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotExportCompression", "=", "0.75"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotExportResolution", "=", "125"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8902028338241005`*^9, 3.890202902465522*^9}, {
  3.890203145588498*^9, 3.890203146697358*^9}, {3.8902034972914596`*^9, 
  3.8902034984843597`*^9}, {3.8902035310356627`*^9, 3.890203658757702*^9}, {
  3.8902039299612865`*^9, 3.890203935578224*^9}, {3.8935275328960266`*^9, 
  3.8935275335991483`*^9}},
 CellLabel->
  "In[860]:=",ExpressionUUID->"98aeadc4-5deb-42a3-a381-751567515765"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotArraysParticleDensity", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"plotWindowParticleDensity", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "swarmTrackDataIDs"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"exportSwarmDensityPlots", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"plotArraysParticleDensity", ",", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", "swarmTrackDataIDs"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.890157019705381*^9, 3.890157024591357*^9}, {
  3.890161519855068*^9, 3.890161548129835*^9}, {3.8902011505046663`*^9, 
  3.890201161530648*^9}, {3.8902014915727544`*^9, 3.89020149290357*^9}, {
  3.8902034135958605`*^9, 3.890203415344162*^9}, {3.890208711860918*^9, 
  3.8902087522555647`*^9}},
 CellLabel->
  "In[863]:=",ExpressionUUID->"095b52ad-64a9-4645-afd3-f30d820a6184"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Compute Angular/Radial Histograms for Bacteria Number Density \
\>", "Subsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.8907228477237883`*^9}, {3.890880060126388*^9, 3.890880120933292*^9}, {
   3.894713197140295*^9, 3.8947131980321617`*^9}, 
   3.8996650731208596`*^9},ExpressionUUID->"3d7ed118-f045-494d-ba76-\
d73f7a091c4c"],

Cell[CellGroupData[{

Cell["Angular Number Density", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902087006748176`*^9}, {3.894090869999564*^9, 
   3.8940908841108284`*^9}, {3.8947131913781877`*^9, 
   3.8947132158877745`*^9}},ExpressionUUID->"a7855937-40b0-4e1f-add2-\
bc920a6ed3fc"],

Cell["\<\
Defaults :
   
binResolutionAngular=32;
binMeanFilterRadiusAngular=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, 
   3.9100830297950397`*^9},
 FontSize->16,ExpressionUUID->"8389d202-90bf-4dcc-8f09-39ac12e8ffc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binResolutionAngular", "=", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binMeanFilterRadiusAngular", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"binRadialRange", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"ImageDimensions", "@", "#"}]}], "&"}], "/@", 
    "swarmWindowEllipseMasksUnified"}], "//", 
   "Max"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleLimitsIncrement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
     RowBox[{"\[Pi]", "/", "binResolutionAngular"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleCheckpoints", "=", 
   RowBox[{"Range", "@@", "angleLimitsIncrement"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.890722940131611*^9, 
   3.890722978326665*^9}, {3.89072301053677*^9, 3.8907231037388287`*^9}, {
   3.8907253719312773`*^9, 3.890725373185581*^9}, {3.890725437613538*^9, 
   3.890725437705981*^9}, {3.890756344682596*^9, 3.890756353958099*^9}, {
   3.8907564292256947`*^9, 3.890756460009802*^9}, {3.890810374592606*^9, 
   3.890810377826006*^9}, {3.8908104205283227`*^9, 3.890810438575717*^9}, {
   3.890824794016307*^9, 3.8908247940960903`*^9}, {3.8908320628782845`*^9, 
   3.890832063467767*^9}, {3.8908320950291367`*^9, 3.890832097710477*^9}, {
   3.893870332976453*^9, 3.89387033326686*^9}, {3.893871392695088*^9, 
   3.893871392790832*^9}, {3.893872079609949*^9, 3.893872103414771*^9}, {
   3.894088099860732*^9, 3.894088116417624*^9}, {3.8940881687652626`*^9, 
   3.894088179378937*^9}, 3.894091234459692*^9, {3.8940956758796234`*^9, 
   3.894095677879466*^9}, {3.8941096463673215`*^9, 3.894109654239214*^9}, {
   3.9098635700660996`*^9, 3.909863600282157*^9}, {3.9098637303046722`*^9, 
   3.9098637512259417`*^9}, 3.909950340166282*^9, {3.90995491601394*^9, 
   3.909954934253763*^9}, 3.909954972460476*^9, {3.910083038380258*^9, 
   3.910083039364231*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"69d7ceef-71b5-48be-96a0-dddcfa82d519"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"windowParticlesCenteredPolar", "=", 
       RowBox[{
        RowBox[{"Parallelize", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{"getCenteredPolarCoordinates", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}]}], ")"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "windowParticles", ",", "swarmWindowEllipseMasksUnified"}], 
            "}"}]}], "\[IndentingNewLine]", "]"}]}], "/.", 
        RowBox[{
         RowBox[{"{", "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "}"}]}]}]}], ";"}], ",", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "windowParticles"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"errorCasesNoParticles", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Position", "[", "\[IndentingNewLine]", 
      RowBox[{"windowParticlesCenteredPolar", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[Equal]", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "&"}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "errorCasesNoParticles"}], "/", 
      RowBox[{"Length", "@", "windowParticlesCenteredPolar"}]}], "//", "N"}], 
    "//", "PercentForm"}], "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angularCountBins", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"MovingAverage", "[", 
             RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
          "angleCheckpoints"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"MeanFilter", "[", 
             RowBox[{"#", ",", "binMeanFilterRadiusAngular"}], "]"}]}], "&"}],
           "@", 
          RowBox[{"Last", "@", 
           RowBox[{"BinCounts", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "binRadialRange", ",", "binRadialRange"}], 
              "}"}], ",", "angleLimitsIncrement"}], "\[IndentingNewLine]", 
            "]"}]}]}]}], "}"}]}], "&"}], "/@", 
     "windowParticlesCenteredPolar"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.890722940131611*^9, 
   3.890722978326665*^9}, {3.89072301053677*^9, 3.8907231037388287`*^9}, {
   3.8907253719312773`*^9, 3.890725373185581*^9}, {3.890725437613538*^9, 
   3.890725437705981*^9}, {3.890756344682596*^9, 3.890756353958099*^9}, {
   3.8907564292256947`*^9, 3.890756460009802*^9}, {3.890810374592606*^9, 
   3.890810377826006*^9}, {3.8908104205283227`*^9, 3.890810438575717*^9}, {
   3.8908106114157257`*^9, 3.890810643290712*^9}, {3.890824716384942*^9, 
   3.890824745767765*^9}, {3.890824806656805*^9, 3.890824828412658*^9}, 
   3.8908248850549994`*^9, 3.8908249169500065`*^9, {3.8908303701347933`*^9, 
   3.8908303737333255`*^9}, 3.890832070788571*^9, {3.890832104383483*^9, 
   3.8908321323230715`*^9}, 3.892918787905734*^9, 3.8938481100381327`*^9, {
   3.893848165673482*^9, 3.89384819509826*^9}, {3.8938482354467106`*^9, 
   3.8938482458625617`*^9}, {3.8940882472363367`*^9, 3.894088252907381*^9}, {
   3.8940909452042646`*^9, 3.894090945408611*^9}, {3.8947133087670836`*^9, 
   3.8947133116962166`*^9}, {3.9003100936013327`*^9, 3.9003101025364313`*^9}, 
   3.9003102723121552`*^9, {3.900310308043784*^9, 3.9003103113988113`*^9}, {
   3.9096569462456126`*^9, 3.909656980096116*^9}, 3.909905535784461*^9, {
   3.909905632424511*^9, 3.909905643286463*^9}, {3.909955038313201*^9, 
   3.9099550453816414`*^9}, {3.9099939939730573`*^9, 3.9099940341238565`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"6fad76ea-351c-42bc-8852-531bc73da06f"],

Cell["\<\
Defaults :
   
sectorSegmentThreshold=0.85;
sectorSegmentSizeThreshold=5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, 
   3.909764375976205*^9, 3.909858203994176*^9},
 FontSize->16,ExpressionUUID->"1182181f-2ede-4357-a456-ea620a9b6912"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angleDiscretizationLines", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Line", "@", 
        RowBox[{"AnglePath", "[", 
         RowBox[{"{", "#", "}"}], "]"}]}], "&"}], "/@", "angleCheckpoints"}], 
     "//", "Graphics"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sectorSegmentLuminanceThreshold", "=", "0.85"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sectorSegmentSizeThreshold", "=", "5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909829837866622*^9, 3.909829848232849*^9}, {
   3.909858198912056*^9, 3.9098581991054487`*^9}, 3.909858414746689*^9, 
   3.909858464041754*^9, {3.909863849606305*^9, 3.9098638601915874`*^9}, {
   3.910801505172344*^9, 3.910801506416545*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"5c394791-aff0-4daa-b5f2-6e612a568b5e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sectorAreasOrdered", ",", "sectorAspectRatios"}], "}"}], 
        "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{
               RowBox[{"getOrderedZoneSectorAreas", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], "//", "Quiet"}]}], ")"}], 
            "&"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "swarmWindowCentralMasks", ",", "windowParticleZonesCentral"}], 
            "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
      RowBox[{"progress", "[", 
       RowBox[{"monitorCounter", ",", 
        RowBox[{"Length", "@", "swarmWindowCentralMasks"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], "//", 
    RowBox[{"AbsoluteTiming", "\n", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "dataCompressedfolder", "<>", 
        "\"\<Number Density Sector Data.txt\>\""}], ",", 
       RowBox[{"Compress", "@", 
        RowBox[{"{", 
         RowBox[{"sectorAreasOrdered", ",", "sectorAspectRatios"}], "}"}]}]}],
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.90976593302776*^9, 3.9097660109635305`*^9}, {
   3.909830078690755*^9, 3.909830081793459*^9}, {3.9098301130646324`*^9, 
   3.9098302115477285`*^9}, {3.90983026488163*^9, 3.909830335929533*^9}, {
   3.9098335175066714`*^9, 3.909833536000696*^9}, {3.9098337602905684`*^9, 
   3.909833772115409*^9}, 3.9098338283909283`*^9, {3.909843830147622*^9, 
   3.9098438712558746`*^9}, {3.909848250047555*^9, 3.909848278096944*^9}, {
   3.9098582399979253`*^9, 3.9098582516645308`*^9}, {3.9098582877152767`*^9, 
   3.909858307202837*^9}, 3.909858614334956*^9, {3.909861249689275*^9, 
   3.9098612531915255`*^9}, 3.9098613111945*^9, {3.909862788979496*^9, 
   3.909862790045238*^9}, {3.9098628303873463`*^9, 3.9098628605843983`*^9}, {
   3.909864219329162*^9, 3.9098642356327467`*^9}, {3.909864546664694*^9, 
   3.9098645521449995`*^9}, {3.909909176524046*^9, 3.909909178174094*^9}, {
   3.909909339270071*^9, 3.909909373890854*^9}, {3.9099551627228303`*^9, 
   3.9099551664184055`*^9}, {3.9100757896268225`*^9, 
   3.9100757915518975`*^9}, {3.910081343232729*^9, 3.910081343682876*^9}, {
   3.910082870923066*^9, 3.910082873632744*^9}, 
   3.9109698274270296`*^9},ExpressionUUID->"22c0c6ca-d809-42e1-b545-\
1d44af82d7ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sectorAreasOrdered", ",", "sectorAspectRatios"}], "}"}], "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{
      "dataCompressedfolder", "<>", 
       "\"\<Number Density Sector Data.txt\>\""}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "//", "Quiet"}]], "Input",
 CellChangeTimes->{{3.9100828827367043`*^9, 3.910082917363446*^9}, {
   3.9102621113835335`*^9, 3.9102621146107674`*^9}, 3.9105069988756313`*^9, 
   3.9109698299784875`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"b0188f0f-7b7a-4418-9d75-9f81611a9a86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expectedSectorCount", "=", 
   RowBox[{
    RowBox[{"Length", "@", "angleCheckpoints"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", 
  RowBox[{"{", 
   RowBox[{
   "angularCountBins", ",", "sectorAreasOrdered", ",", "sectorAspectRatios", 
    ",", "windowParticles"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sectorAreaListLength", "=", 
   RowBox[{"Length", "/@", "sectorAreasOrdered"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sectorGroupLengths", "=", 
  RowBox[{"Length", "/@", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"sectorAreaListLength", ",", 
     RowBox[{
      RowBox[{"#", "\[Equal]", "expectedSectorCount"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Last", "@", "sectorGroupLengths"}], "/", 
     RowBox[{"Length", "@", "sectorAreasOrdered"}]}], "//", "N"}], "//", 
   "PercentForm"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorCasesMissingSectors", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"Position", "[", 
       RowBox[{"#", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "expectedSectorCount"}], "&"}], 
          ")"}]}]}], "]"}]}], "&"}], "@", "sectorAreaListLength"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"errorCasesAll", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"errorCasesNoParticles", ",", "errorCasesMissingSectors"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9098495391072297`*^9, 3.909849540391538*^9}, {
   3.9098495932162766`*^9, 3.909849623218708*^9}, {3.909849659943568*^9, 
   3.9098496954474707`*^9}, {3.9098584872834516`*^9, 3.909858488888156*^9}, 
   3.909858607884861*^9, {3.909864573633443*^9, 3.9098645804266815`*^9}, {
   3.9099043970482836`*^9, 3.909904433981709*^9}, 3.9099091605756845`*^9, {
   3.909909260463813*^9, 3.909909319729602*^9}, {3.909909386144828*^9, 
   3.9099094366152315`*^9}, {3.9099551251611524`*^9, 
   3.9099551386520805`*^9}, {3.909955268772544*^9, 3.9099552773735456`*^9}, {
   3.909994088156289*^9, 3.9099940887337446`*^9}, {3.910020831725777*^9, 
   3.910020833812741*^9}, {3.9100208973649874`*^9, 3.9100209196381655`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"1b8a7cfa-28e9-4572-9ecd-84ca53ac1865"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "angularCountBinsClean", ",", "sectorAreasClean", ",", 
     "sectorAspectRatiosClean"}], "}"}], "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dataset", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{"#", ",", "errorCasesAll"}], "]"}], "&"}], "/@", 
        "swarmTrackDataIDs"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"dataset", ",", 
       RowBox[{"{", 
        RowBox[{
        "angularCountBins", ",", "sectorAreasOrdered", ",", 
         "sectorAspectRatios"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9098495391072297`*^9, 3.909849540391538*^9}, {
   3.9098495932162766`*^9, 3.909849623218708*^9}, {3.909849659943568*^9, 
   3.9098496954474707`*^9}, {3.9098584872834516`*^9, 3.909858488888156*^9}, 
   3.909858607884861*^9, {3.909864573633443*^9, 3.9098645804266815`*^9}, {
   3.9099043970482836`*^9, 3.909904433981709*^9}, 3.9099091605756845`*^9, {
   3.909909260463813*^9, 3.909909319729602*^9}, {3.909909386144828*^9, 
   3.9099094366152315`*^9}, {3.9099551251611524`*^9, 3.9099551386520805`*^9}, 
   3.909955268772544*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"f4dea082-471d-48b4-a9c0-0ad87d006ebf"],

Cell["\<\
Defaults :
   
contrastThresholdAspectRatio=0.2;
contrastThresholdArea=0.5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, 
   3.909764375976205*^9, 3.909858203994176*^9, 3.9099492215817657`*^9, 
   3.9099546102146406`*^9, {3.909993863499908*^9, 3.909993863812064*^9}},
 FontSize->16,ExpressionUUID->"2a7e9c9d-847c-4120-8874-ddf6fea15d3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"contrastThresholdAspectRatio", "=", "0.2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contrastThresholdArea", "=", "0.5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.90994728021117*^9, 3.9099473002122693`*^9}, 
   3.909954612325468*^9, {3.90999386143578*^9, 3.909993861866273*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"45966800-d1b5-40d5-926f-167c79bbc75d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"contrastArea", ",", "contrastAspectRatio"}], "}"}], "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"checkMetricContrast", "/@", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sectorAreasClean", ",", "sectorAspectRatiosClean"}], "}"}]}],
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"checkEligibleEntries", "[", 
        RowBox[{"#", ",", "contrastThresholdArea"}], "]"}], "&"}], "/@", 
      "contrastArea"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"checkEligibleEntries", "[", 
        RowBox[{"#", ",", "contrastThresholdAspectRatio"}], "]"}], "&"}], "/@",
       "contrastAspectRatio"}]}], "\[IndentingNewLine]", "}"}], "//", 
   "TableForm"}], "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9099483752481956`*^9, 3.9099483764844723`*^9}, 
   3.909948660384349*^9, {3.909948804645395*^9, 3.9099488389885855`*^9}, {
   3.9099490409400997`*^9, 3.9099490707761025`*^9}, {3.909951712480384*^9, 
   3.9099517146616683`*^9}, {3.909954041407959*^9, 3.9099540432880898`*^9}, 
   3.9099553610158*^9, {3.9099975176173477`*^9, 3.9099975250197325`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"a44da16c-c6aa-4f67-8884-7007fd9fb540"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angularNumberDensityBinsPhysical", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#1"}], ",", 
            RowBox[{
             RowBox[{"Last", "@", "#1"}], "/", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"First", "@", "conversionFactors"}], "*", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", "<", "contrastThresholdAspectRatio"}], ",", 
                 "#3", ",", 
                 RowBox[{"Median", "@", "#3"}]}], "]"}]}], 
              "\[IndentingNewLine]", ")"}]}]}], "}"}]}], "&"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "/@", 
           RowBox[{"angularCountBinsClean", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"contrastAspectRatio", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", 
          RowBox[{"sectorAreasClean", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "angularCountBinsClean"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"angularNumberDensityBinsMean", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"First", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", 
            RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "#"}], "//", 
         "Mean"}]}], "\[IndentingNewLine]", "}"}]}], "&"}], "/@", 
    "angularNumberDensityBinsPhysical"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9099483752481956`*^9, 3.9099483764844723`*^9}, 
   3.909948660384349*^9, {3.909948804645395*^9, 3.9099488389885855`*^9}, {
   3.9099490409400997`*^9, 3.9099490707761025`*^9}, {3.909951712480384*^9, 
   3.9099517146616683`*^9}, {3.909954041407959*^9, 3.9099540432880898`*^9}, {
   3.9099553610158*^9, 3.9099553673329096`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"0641886d-be88-49bf-bfa4-efb73fe73346"],

Cell["\<\
Defaults :
   
polarPlotRangeFactor=ConstantArray[1.65,Length@swarmTrackDataIDs];\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, 
   3.8947201421930146`*^9, 3.894827191862523*^9, 3.9003252153461294`*^9, {
   3.9108015338597364`*^9, 3.9108015400924125`*^9}, 3.91080157874044*^9},
 FontSize->16,ExpressionUUID->"82101ca1-806b-445e-be75-a48b5a5942dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"radianConversion", "=", 
   RowBox[{"(", 
    RowBox[{"180", " ", 
     RowBox[{"Degree", "/", "\[Pi]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polarPlotLegends", "=", 
    RowBox[{
     RowBox[{"getLatexStyling", "/@", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "angularNumberDensityBinsMean"}]}]}], "//", 
     "SwatchLegend"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarPlotRangeFactor", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.65", ",", 
     RowBox[{"Length", "@", "swarmTrackDataIDs"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902086900138836`*^9}, {3.8907227930962863`*^9, 
   3.890722840532838*^9}, 3.89072288470811*^9, {3.890722940131611*^9, 
   3.890722978326665*^9}, {3.89072301053677*^9, 3.8907231037388287`*^9}, {
   3.8907253719312773`*^9, 3.890725373185581*^9}, {3.890725437613538*^9, 
   3.890725437705981*^9}, {3.890756344682596*^9, 3.890756353958099*^9}, {
   3.8907564292256947`*^9, 3.890756460009802*^9}, {3.890810374592606*^9, 
   3.890810377826006*^9}, {3.8908104205283227`*^9, 3.890810438575717*^9}, {
   3.8908106114157257`*^9, 3.8908106392573986`*^9}, {3.8908110324665575`*^9, 
   3.8908110390035095`*^9}, {3.8908111839956293`*^9, 3.89081119616576*^9}, {
   3.890824403040081*^9, 3.890824442073497*^9}, {3.8908245450175343`*^9, 
   3.8908246961526155`*^9}, {3.890824844305875*^9, 3.8908248720198307`*^9}, {
   3.8908249479685864`*^9, 3.890825092586218*^9}, {3.8908255139600863`*^9, 
   3.8908255195143003`*^9}, {3.8908255618984985`*^9, 
   3.8908256223291135`*^9}, {3.890830402195592*^9, 3.890830449505243*^9}, {
   3.890830951174642*^9, 3.8908310535999975`*^9}, {3.890831096947695*^9, 
   3.890831123766009*^9}, {3.8908311637012568`*^9, 3.8908311721248274`*^9}, {
   3.890831233102127*^9, 3.8908313313546486`*^9}, {3.890831361965969*^9, 
   3.8908313979010954`*^9}, {3.8908314307929974`*^9, 3.890831551749014*^9}, {
   3.890831608479491*^9, 3.8908316126152806`*^9}, {3.8908316532705035`*^9, 
   3.890831682421214*^9}, {3.8908317322879925`*^9, 3.8908317466446905`*^9}, {
   3.890831808819172*^9, 3.8908318173004303`*^9}, {3.890831860878606*^9, 
   3.8908319159175916`*^9}, {3.8908319493827767`*^9, 
   3.8908319602312098`*^9}, {3.89083214710148*^9, 3.8908321823565555`*^9}, {
   3.8908322261101694`*^9, 3.8908322479561567`*^9}, {3.8910221768880444`*^9, 
   3.8910222032449083`*^9}, {3.8934846320876675`*^9, 
   3.8934846321585984`*^9}, {3.8938718401509027`*^9, 3.893871847167708*^9}, {
   3.8940870307204075`*^9, 3.894087038918182*^9}, {3.8940950653751802`*^9, 
   3.8940950659988565`*^9}, {3.894095288704253*^9, 3.8940952957343583`*^9}, {
   3.8940954473277006`*^9, 3.8940954473663416`*^9}, {3.894107775920949*^9, 
   3.8941077926721544`*^9}, 3.894621474098075*^9, {3.894659028087032*^9, 
   3.8946590398744197`*^9}, {3.894719725193185*^9, 3.8947197470684032`*^9}, {
   3.894803328933282*^9, 3.8948033793896055`*^9}, 3.8997142217254057`*^9, {
   3.9003099772304087`*^9, 3.9003099783205605`*^9}, {3.9003103361620398`*^9, 
   3.900310385038885*^9}, {3.900310563550679*^9, 3.900310569846895*^9}, {
   3.9003106162957115`*^9, 3.9003106405121684`*^9}, {3.9003252189155803`*^9, 
   3.900325223781582*^9}, {3.9098375892142577`*^9, 3.9098375918030005`*^9}, {
   3.9099540474693527`*^9, 3.90995417363694*^9}, {3.909954632809466*^9, 
   3.909954640205289*^9}, {3.909997540054679*^9, 3.9099975509655113`*^9}, {
   3.9105197193062468`*^9, 3.9105197537088385`*^9}, {3.910620128078761*^9, 
   3.910620128203395*^9}, 3.910807369714196*^9, {3.910807421962122*^9, 
   3.910807527641386*^9}, 3.9109704747411423`*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"85727459-b59b-4b31-99db-ec6ca212b602"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotMeanAngularBins", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getAngularBinPlot", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"angularNumberDensityBinsMean", ",", "polarPlotRangeFactor"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotMeanAngularBins", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "plotMeanAngularBins"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8938692368771615`*^9, 3.893869467840592*^9}, {
   3.893869530946742*^9, 3.8938695781389446`*^9}, {3.8938697422899694`*^9, 
   3.893869755680667*^9}, 3.893869983369763*^9, {3.893870020681969*^9, 
   3.8938700234326153`*^9}, {3.8938702175208235`*^9, 3.893870222725625*^9}, {
   3.8938702809143476`*^9, 3.8938702944397964`*^9}, {3.8938703793686705`*^9, 
   3.893870398972267*^9}, {3.8938704666330395`*^9, 3.8938704908583946`*^9}, {
   3.893870897540636*^9, 3.8938709574724283`*^9}, {3.8938711023765745`*^9, 
   3.8938711696326065`*^9}, {3.893871266432988*^9, 3.8938713506639214`*^9}, 
   3.893871381666374*^9, {3.8938714177919936`*^9, 3.893871433914175*^9}, {
   3.893871544609367*^9, 3.893871576111889*^9}, {3.8938716162667155`*^9, 
   3.893871617515425*^9}, {3.893871653354415*^9, 3.893871775387999*^9}, {
   3.8938719015599794`*^9, 3.8938719277918863`*^9}, {3.8938720559226465`*^9, 
   3.893872067728419*^9}, 3.8940880530559216`*^9, 3.8940907644907527`*^9, {
   3.8940950795046654`*^9, 3.894095091377907*^9}, {3.894095269568551*^9, 
   3.894095334054398*^9}, {3.8940953910461674`*^9, 3.894095406599077*^9}, {
   3.894095457848031*^9, 3.8940956356378098`*^9}, {3.8940963481435175`*^9, 
   3.894096357702664*^9}, {3.900310364687358*^9, 3.9003103657764554`*^9}, 
   3.9099539816402836`*^9},
 CellLabel->
  "In[470]:=",ExpressionUUID->"38172093-d0f6-4175-bfed-434a478608ea"],

Cell[BoxData[
 RowBox[{"plotMeanAngularBinsAll", "=", 
  RowBox[{"getAngularBinPlotAll", "[", "\[IndentingNewLine]", 
   RowBox[{"angularNumberDensityBinsMean", ",", 
    RowBox[{"Max", "@", "polarPlotRangeFactor"}], ",", 
    RowBox[{"Length", "@", "polarPlotRangeFactor"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.894101697284685*^9, 3.89410188445345*^9}, {
   3.894101972494067*^9, 3.894102020203576*^9}, {3.8941021598548822`*^9, 
   3.8941021887007055`*^9}, {3.894102356454488*^9, 3.8941023739400682`*^9}, {
   3.894621597275894*^9, 3.894621597398965*^9}, 3.8946590785164657`*^9, {
   3.8947197640228157`*^9, 3.8947197642678976`*^9}, {3.8948033895190334`*^9, 
   3.894803401383009*^9}, {3.899714300030037*^9, 3.8997143178995094`*^9}, {
   3.900310410326413*^9, 3.9003104115472*^9}, {3.9099544048826375`*^9, 
   3.909954433062746*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"0faacdbd-6975-481e-9868-dfc7ba4f511d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotMeanAngularBins", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"\"\<Mean n(phi) \>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", "\"\<.pdf\>\""}], ",", "100"}], 
      "\[IndentingNewLine]", "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "plotMeanAngularBins"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotMeanAngularBinsAll", ",", "\"\<Mean n(phi) All\>\"", ",", "100"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.909954457620543*^9, 3.909954489029438*^9}, {
  3.9100338133565364`*^9, 3.9100338139222383`*^9}},
 CellLabel->
  "In[953]:=",ExpressionUUID->"35c48eb2-815d-4af9-b5d5-df7732f234f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radial Number Density", "Subsubsection",
 CellChangeTimes->{{3.8887785211319776`*^9, 3.8887785266060743`*^9}, {
   3.8887786164829764`*^9, 3.888778618650774*^9}, {3.8892760628955135`*^9, 
   3.889276065072398*^9}, {3.889628390683049*^9, 3.8896283956833787`*^9}, {
   3.8896285968261137`*^9, 3.8896286009554386`*^9}, {3.889641541647766*^9, 
   3.8896415505643635`*^9}, {3.889985412126751*^9, 3.889985418077324*^9}, {
   3.889985467213833*^9, 3.889985468964223*^9}, 3.8900487651154733`*^9, {
   3.8900616301155753`*^9, 3.890061637662985*^9}, {3.890061675500922*^9, 
   3.8900616766197996`*^9}, 3.89006755525869*^9, {3.8900675871437874`*^9, 
   3.8900675989231453`*^9}, {3.8900682732591524`*^9, 3.890068293299039*^9}, {
   3.8902086702147055`*^9, 3.8902087006748176`*^9}, {3.894090869999564*^9, 
   3.8940908841108284`*^9}, {3.8947131913781877`*^9, 
   3.8947132261070766`*^9}},ExpressionUUID->"7642b22a-5a79-4e98-adf6-\
0abe9359fd46"],

Cell["\<\
Defaults :
   
binResolutionRadial=5;
binMeanFilterRadiusRadial=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, {
   3.8947201421930146`*^9, 3.894720153362093*^9}, 3.9100830185287533`*^9},
 FontSize->16,ExpressionUUID->"3df2c468-2ac0-4353-921c-8a826e9b8d33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binResolutionRadial", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binMeanFilterRadiusRadial", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radialCheckpoints", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "binRadialRange", ",", "binResolutionRadial"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radialBinCenters", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MovingAverage", "[", 
      RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", "radialCheckpoints"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radialIntervals", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"partitionRagged", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Length", "@", "#"}], "-", "1"}], ",", "1"}], "]"}], "&"}], 
    "@", "radialCheckpoints"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89135312977429*^9, 3.8913531349654565`*^9}, {
   3.8913532370142765`*^9, 3.891353240988996*^9}, {3.891353458512865*^9, 
   3.891353674807547*^9}, {3.8913706531474223`*^9, 3.8913706559985304`*^9}, {
   3.8913707397939963`*^9, 3.8913707732629895`*^9}, {3.8913708468157997`*^9, 
   3.891371031482095*^9}, {3.891371078221285*^9, 3.8913712695917435`*^9}, 
   3.894096485607415*^9, {3.89409671225527*^9, 3.89409672226945*^9}, {
   3.9100119676843977`*^9, 3.9100119677943926`*^9}, {3.9100137780260687`*^9, 
   3.910013810044517*^9}, {3.9100153962423587`*^9, 3.910015400191383*^9}, {
   3.9100159243153133`*^9, 3.910015924687552*^9}, {3.9100229909006596`*^9, 
   3.910022999079564*^9}, {3.9100262435412383`*^9, 3.910026248364626*^9}, {
   3.9100283467851477`*^9, 3.9100283486710925`*^9}, {3.910030805330826*^9, 
   3.910030806459754*^9}, 3.9100308384917097`*^9, 3.9100330519644885`*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"e08e79c4-89cf-4ec2-a694-c94967eac549"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coreRegionEffectiveRadii", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Total", "@", "#"}], "/", "\[Pi]"}], "]"}], "&"}], "/@", 
       "swarmWindowCentralMasks"}], "//", "Parallelize"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"windowParticlesCenteredPolarCoreOffset", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"Transpose", "@", "#1"}]}], "-", "#2"}], ",", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "#1"}]}]}], "}"}]}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "windowParticlesCenteredPolar", ",", "coreRegionEffectiveRadii"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radialBinRingAreasPhysical", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"First", "@", "conversionFactors"}], "*", "\[Pi]", "*", 
       RowBox[{"Differences", "[", 
        RowBox[{"#", "^", "2"}], "]"}]}], "&"}], "@", "\[IndentingNewLine]", 
     "radialCheckpoints"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radialBinRingAreasShifted", "=", 
    RowBox[{
     RowBox[{
     "getMappedRadialBinRingAreas", "/@", "coreRegionEffectiveRadii"}], "//", 
     "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.909999835106862*^9, 3.9099998586469717`*^9}, {
  3.910032526253951*^9, 3.9100325304108133`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"97115551-dc94-4050-9d01-e778c163406f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"radialCountBins", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"MovingAverage", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "binRadialRange", ",", "binResolutionRadial"}], 
            "]"}]}], ",", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"MeanFilter", "[", 
              RowBox[{"#", ",", "binMeanFilterRadiusRadial"}], "]"}]}], "&"}],
            "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"BinCounts", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
               "0", ",", "binRadialRange", ",", "binResolutionRadial"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
                RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "\[IndentingNewLine]",
              "]"}]}]}]}], "}"}]}], "&"}], "/@", 
      "windowParticlesCenteredPolarCoreOffset"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"radialCountBinsPhysical", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pixelSizeMicroMeters", ",", 
           RowBox[{"1", "/", "#1"}]}], "}"}], "*", 
         RowBox[{"Transpose", "@", "#2"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"radialBinRingAreasShifted", ",", "radialCountBins"}], "}"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"meanBinsByTrackRadial", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"radialBinCenters", "*", "pixelSizeMicroMeters"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"Last", "/@", "#"}], "]"}], "&"}], "@", "#"}], "&"}], "/@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", 
               RowBox[{"1", ";;", "All"}]}], "]"}], "]"}]}]}], "&"}], "@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"radialCountBinsPhysical", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{"#", ",", "errorCasesAll"}], "]"}], "&"}], "/@", 
             "swarmTrackDataIDs"}], "\[IndentingNewLine]", ")"}]}], ")"}]}]}],
        "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "swarmTrackDataIDs"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89135312977429*^9, 3.8913531349654565`*^9}, {
   3.8913532370142765`*^9, 3.891353240988996*^9}, {3.891353458512865*^9, 
   3.891353674807547*^9}, {3.8913706531474223`*^9, 3.8913706559985304`*^9}, {
   3.8913707397939963`*^9, 3.8913707732629895`*^9}, {3.8913708468157997`*^9, 
   3.891371031482095*^9}, {3.891371078221285*^9, 3.8913712695917435`*^9}, {
   3.894096485607415*^9, 3.894096491015766*^9}, {3.894096803942482*^9, 
   3.8940968302795334`*^9}, {3.894096920277427*^9, 3.894096944318574*^9}, {
   3.894099090174487*^9, 3.89409917138135*^9}, {3.8941014231252937`*^9, 
   3.8941014848734894`*^9}, {3.8941097108979793`*^9, 3.894109733025124*^9}, {
   3.894110182937275*^9, 3.8941101846398897`*^9}, 3.8946216722432585`*^9, {
   3.894713345562978*^9, 3.894713348097371*^9}, 3.9099994391712456`*^9, 
   3.9100022634317837`*^9, 3.910011440284655*^9, 3.9100307535728283`*^9, {
   3.9100325155731077`*^9, 3.910032519626379*^9}, 3.910033014108696*^9, 
   3.910033157006712*^9, 3.9100333207033167`*^9},
 CellLabel->
  "In[221]:=",ExpressionUUID->"4715e084-db46-44e9-b72c-15687ccfce65"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]], "Input",
 CellChangeTimes->{{3.916336681953549*^9, 
  3.9163366843442535`*^9}},ExpressionUUID->"6ae9a6a0-bffc-424f-9d92-\
401f6cf6c7c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deviationBinsByTrackRadial", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"radialBinCenters", "*", "pixelSizeMicroMeters"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StandardDeviation", "[", 
                RowBox[{"Last", "/@", "#"}], "]"}], "&"}], "@", "#"}], "&"}], 
            "/@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", 
                RowBox[{"1", ";;", "All"}]}], "]"}], "]"}]}]}], "&"}], "@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"radialCountBinsPhysical", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Complement", "[", 
                RowBox[{"#", ",", "errorCasesAll"}], "]"}], "&"}], "/@", 
              "swarmTrackDataIDs"}], "\[IndentingNewLine]", ")"}]}], 
           ")"}]}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "swarmTrackDataIDs"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meansDeviationsByTrackRadial", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"Transpose", "@", "#1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Around", "@@", "#"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"meanBinsByTrackRadial", ",", "deviationBinsByTrackRadial"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{"meansDeviationsByTrackRadial", ",", 
   RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.055"}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9163159575674677`*^9, 3.9163159744950476`*^9}, {
  3.916336889849701*^9, 3.916336891830021*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"62f1a59d-6865-4b9b-8931-b4d326a267a7"],

Cell[BoxData[
 RowBox[{"peakRadialNumberDensityErrors", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Last", "@", 
     RowBox[{"First", "@", 
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Last", "@", "#"}], "&"}]}], "]"}]}]}], "&"}], "/@", 
   "meansDeviationsByTrackRadial"}]}]], "Input",
 CellChangeTimes->{{3.9163363842469416`*^9, 3.916336445413807*^9}, {
  3.9163365953826194`*^9, 3.916336596476265*^9}, {3.91633673616121*^9, 
  3.916336744120469*^9}, {3.9163369251123257`*^9, 3.916336926311531*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"2aedee8b-88d1-4b65-ac53-e4ca4bb985fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", 
     "\"\<Peak Radial Number Density With Errors.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "peakRadialNumberDensityErrors"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9108947354267826`*^9, 3.9108947513991766`*^9}, {
  3.9108948042306824`*^9, 3.910894824158559*^9}, {3.9163369351559615`*^9, 
  3.916336943654688*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"c28200ca-0b9a-48db-80b4-27c6fbec66d4"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]], "Input",
 CellChangeTimes->{{3.916336681953549*^9, 
  3.9163366843442535`*^9}},ExpressionUUID->"130d3889-ee63-4906-8c7b-\
a1ebabe30e44"],

Cell["\<\
Defaults :
   
radialPlotRangeFactor=0.35;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, 
   3.8947200071652517`*^9, {3.894720046305896*^9, 3.8947201000252852`*^9}, {
   3.8947201421930146`*^9, 3.894720153362093*^9}, 3.9100830185287533`*^9, 
   3.9100831042178955`*^9},
 FontSize->16,ExpressionUUID->"b41d8359-ff12-46ef-916a-9df0738b9c24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"radialPlotRangeFactor", "=", "0.35"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radialPlotRange", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "\[IndentingNewLine]", 
        RowBox[{
        "radialPlotRangeFactor", "*", "pixelSizeMicroMeters", "*", 
         "binRadialRange"}]}], "}"}], ",", "\[IndentingNewLine]", "All"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsRadialNumberDensity", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<r-r_0, ~\\\\mu m\>\"", ",", 
      "\"\<\\\\boldsymbol{\\\\langle n_{\\\\varphi}(r-r_0) \\\\rangle, \
~{\\\\mu m}^{-2}}\>\""}], "\[IndentingNewLine]", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.910032557158803*^9, 3.9100325618265934`*^9}, {
  3.9100326214985914`*^9, 3.910032647470543*^9}, {3.9100327387137394`*^9, 
  3.910032799644786*^9}, {3.910032858290699*^9, 3.9100328959054527`*^9}, {
  3.9100333330915794`*^9, 3.910033355075946*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"422f06c8-7ed9-4891-8e70-a0e96472bc20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotMeanRadialBins", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"PlotRange", "\[Rule]", "radialPlotRange"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", "axesLabelsRadialNumberDensity"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", "meanBinsByTrackRadial"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"plotMeanRadialBins", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "plotMeanRadialBins"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.910032841963171*^9, 3.910032852497696*^9}, 
   3.910032905123783*^9, {3.910033576482827*^9, 3.9100335979452815`*^9}, {
   3.91003364726695*^9, 3.910033652650113*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"8e254f21-e1e7-4da6-806e-fe0619a14073"],

Cell[BoxData[
 RowBox[{"plotMeanRadialBinsAll", "=", 
  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
   RowBox[{"meanBinsByTrackRadial", ",", 
    RowBox[{"PlotRange", "\[Rule]", "radialPlotRange"}], ",", 
    RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "polarPlotLegends"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", "axesLabelsRadialNumberDensity"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.89135312977429*^9, 3.8913531349654565`*^9}, {
   3.8913532370142765`*^9, 3.891353240988996*^9}, {3.891353458512865*^9, 
   3.891353674807547*^9}, {3.8913706531474223`*^9, 3.8913706559985304`*^9}, {
   3.8913707397939963`*^9, 3.8913707732629895`*^9}, {3.8913708468157997`*^9, 
   3.891371031482095*^9}, {3.891371078221285*^9, 3.8913712695917435`*^9}, {
   3.894096485607415*^9, 3.894096491015766*^9}, {3.894096803942482*^9, 
   3.8940968302795334`*^9}, {3.894096920277427*^9, 3.894096944318574*^9}, {
   3.894099090174487*^9, 3.8940991191575346`*^9}, {3.8941016121406927`*^9, 
   3.894101615828001*^9}, {3.8941052363637943`*^9, 3.894105245737163*^9}, {
   3.8941080144659224`*^9, 3.8941080295792117`*^9}, {3.894110196638838*^9, 
   3.8941102973608794`*^9}, {3.894713357930447*^9, 3.8947134179969273`*^9}, {
   3.8947134640975494`*^9, 3.894713583515133*^9}, {3.9003107209368973`*^9, 
   3.9003108296168685`*^9}, {3.900310896191518*^9, 3.900310897379342*^9}, 
   3.9100023202035656`*^9, 3.910011146902505*^9, {3.9100111843563566`*^9, 
   3.9100112178433714`*^9}, {3.9100322627967596`*^9, 3.910032288013164*^9}, {
   3.910032332876439*^9, 3.910032382353959*^9}, {3.9100326361294813`*^9, 
   3.9100326697265167`*^9}, {3.9100327280129366`*^9, 3.91003273448359*^9}, 
   3.9100327813491955`*^9, 3.9100329084049006`*^9},
 CellLabel->
  "In[528]:=",ExpressionUUID->"05ad4044-5e78-4afd-89da-c632cb196757"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"exportImagesTwoFormat", "[", 
      RowBox[{
       RowBox[{"plotMeanRadialBins", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"\"\<Mean n(r) \>\"", "<>", 
        RowBox[{"ToString", "@", "#"}]}], ",", "100"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "plotMeanRadialBins"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{
   "plotMeanRadialBinsAll", ",", "\"\<Mean n(r) All\>\"", ",", "100"}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.910034011879938*^9, 3.91003415352183*^9}},
 CellLabel->
  "In[973]:=",ExpressionUUID->"fab51b0e-0547-44f3-aef7-bf59807a5c72"],

Cell[BoxData[
 RowBox[{"peakRadialNumberDensity", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Last", "@", 
     RowBox[{"First", "@", 
      RowBox[{"ReverseSortBy", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Last", "@", "#"}], "&"}]}], "]"}]}]}], "&"}], "/@", 
   "meanBinsByTrackRadial"}]}]], "Input",
 CellChangeTimes->{{3.910894630712106*^9, 3.9108946311589713`*^9}, {
  3.910894670815569*^9, 3.910894730318941*^9}},
 CellLabel->
  "In[525]:=",ExpressionUUID->"5ed7e7f4-1bf2-4c50-87e2-5c8f73ce8b23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataCompressedfolder", "<>", "\"\<Peak Radial Number Density.txt\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "peakRadialNumberDensity"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9108947354267826`*^9, 3.9108947513991766`*^9}, {
  3.9108948042306824`*^9, 3.910894824158559*^9}},
 CellLabel->
  "In[534]:=",ExpressionUUID->"e0ccdadb-578c-4efb-a97f-0a3902b06f25"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 
  3.89020905769811*^9}},ExpressionUUID->"93c9fc29-acf4-4338-8c9c-\
325c12df66e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notebookID", "=", "7"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"output", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "output"}], "<>", "\"\<_Run_\>\"", "<>", 
     RowBox[{"ToString", "@", "notebookID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "\[IndentingNewLine]", "notebookSnapshot"}], "\[IndentingNewLine]", "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
   3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
   3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}, {
   3.88928857082766*^9, 3.8892885935714035`*^9}, {3.889300824400525*^9, 
   3.889300826019042*^9}, {3.8900794555092363`*^9, 3.8900794592661676`*^9}, 
   3.8902083844570394`*^9, 3.890209069048913*^9, 3.8902093067789917`*^9, {
   3.8905940957431183`*^9, 3.890594096652687*^9}, 3.8905942440505*^9, {
   3.8941325023793926`*^9, 3.8941325032889395`*^9}, {3.89469919779359*^9, 
   3.894699197823932*^9}, {3.8947136469968*^9, 3.8947136482268553`*^9}, 
   3.8948274270813093`*^9, 3.8948275185738883`*^9, 3.896442076226533*^9, 
   3.900598590743739*^9, {3.900615341286237*^9, 3.900615343204318*^9}, {
   3.909506316654804*^9, 3.9095063167089677`*^9}, 3.909508043208419*^9, {
   3.90951102902489*^9, 3.909511029117587*^9}, 3.909954748711573*^9, 
   3.910339317940569*^9, 3.910428879197675*^9, 3.910457767648204*^9, 
   3.910467734245775*^9, 3.910506895277712*^9, 3.910527284679409*^9, {
   3.910612993687834*^9, 3.910612993735763*^9}, 3.9108011727476115`*^9, {
   3.9108013700277014`*^9, 3.91080137120875*^9}, 3.9108081916198754`*^9, 
   3.910970583025391*^9, 3.910984840276794*^9, 3.910986472285715*^9, 
   3.910987081604142*^9, 3.9216740077293625`*^9, {3.921677815279481*^9, 
   3.921677815358303*^9}, 3.9216833432754617`*^9, 3.9216837089878016`*^9, 
   3.9217478287885847`*^9},
 CellLabel->
  "In[543]:=",ExpressionUUID->"21243291-7e3b-429f-82ed-c359d62b4b52"]
}, Open  ]]
},
WindowSize->{762., 795.5999999999999},
WindowMargins->{{-4.8, Automatic}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>0.95,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a661dfb2-a768-45c6-9cb0-a8f7d3359124"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 131, 1, 26, "Input",ExpressionUUID->"eaa15933-ff6d-454c-9e36-e34ce6855e99"],
Cell[692, 23, 228, 3, 68, "Abstract",ExpressionUUID->"85a38af9-58c5-43d3-9e34-8120044bb540"],
Cell[CellGroupData[{
Cell[945, 30, 337, 4, 33, "Item",ExpressionUUID->"e1a32138-3224-4874-b488-0be1d4a5ddbb"],
Cell[1285, 36, 443, 5, 33, "Item",ExpressionUUID->"f96edd96-ab5c-459e-a2fe-f3c7f533a76a"]
}, Open  ]],
Cell[1743, 44, 1431, 44, 26, "Input",ExpressionUUID->"ca3397bc-5709-49fd-a0ab-46d2041d3aff"],
Cell[CellGroupData[{
Cell[3199, 92, 510, 8, 33, "Item",ExpressionUUID->"06e3f137-27a9-44f4-b0f1-6943497e4690"],
Cell[3712, 102, 488, 6, 33, "Item",ExpressionUUID->"43844e1a-4b91-43da-901b-4c09a89aeb74"],
Cell[4203, 110, 547, 7, 33, "Item",ExpressionUUID->"397d964f-2d0c-4b26-8f90-71384d24e604"]
}, Open  ]],
Cell[4765, 120, 1431, 44, 26, "Input",ExpressionUUID->"a62c43ea-4ef4-4a44-9937-b9eead14884e"],
Cell[CellGroupData[{
Cell[6221, 168, 1153, 15, 33, "Item",ExpressionUUID->"74679866-0d47-47a9-a607-eda88f4398b0"],
Cell[7377, 185, 1160, 15, 33, "Item",ExpressionUUID->"b2be387e-8fb0-4471-8282-17aa0f0e0453"],
Cell[8540, 202, 1172, 15, 33, "Item",ExpressionUUID->"e8a046fd-5a3a-4a08-9cd6-1c2dd48bad12"]
}, Open  ]],
Cell[9727, 220, 331, 5, 68, "Abstract",ExpressionUUID->"c52e37fd-3f2b-4d23-814a-deca0cc62aa9"],
Cell[CellGroupData[{
Cell[10083, 229, 591, 9, 63, "Section",ExpressionUUID->"0a7902ba-3100-4679-9380-02b3076e63e9"],
Cell[10677, 240, 9830, 217, 1284, "Input",ExpressionUUID->"ab188b0e-0b8c-4d83-8dbe-6e47cf17a532",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[20544, 462, 564, 8, 50, "Section",ExpressionUUID->"80fd0985-c1c7-4fcd-9f0d-048ce9507304"],
Cell[21111, 472, 1618, 32, 402, "Abstract",ExpressionUUID->"e17462da-ef85-4e1c-b3d9-cfe80af1f5b0"],
Cell[22732, 506, 12744, 229, 672, "Input",ExpressionUUID->"f2df995a-561c-4dcc-83ed-057b4b0b65b1",
 InitializationCell->True],
Cell[35479, 737, 1848, 42, 225, "Input",ExpressionUUID->"a4efabc0-6431-4664-b053-de608be82619"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37364, 784, 517, 8, 63, "Section",ExpressionUUID->"a6c1a855-d2ce-4ce7-8e77-3002edfcfd56"],
Cell[37884, 794, 232, 3, 68, "Abstract",ExpressionUUID->"20e40580-43f6-4c5f-853c-559b2bb054ce"],
Cell[CellGroupData[{
Cell[38141, 801, 192, 2, 55, "Subsection",ExpressionUUID->"0e5b0001-b41e-4467-b3f9-0da9893d8598"],
Cell[38336, 805, 29618, 722, 3714, "Input",ExpressionUUID->"beaec6fc-29f0-4523-aef2-66cb9807b124",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67991, 1532, 503, 7, 40, "Subsection",ExpressionUUID->"8030b3f9-704c-4f14-a34c-1c106b3f9c9a"],
Cell[68497, 1541, 116780, 2764, 16512, "Input",ExpressionUUID->"25de1078-bc4a-4399-9c4b-3250768822a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[185314, 4310, 516, 7, 40, "Subsection",ExpressionUUID->"79f94e50-5c8b-4fab-b397-bdcb801b3455"],
Cell[185833, 4319, 56326, 1331, 6810, "Input",ExpressionUUID->"ae9e466b-1b82-4bc9-8437-553d8b171e20",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242208, 5656, 665, 10, 63, "Section",ExpressionUUID->"6f2a1bc0-34e9-4b61-a42e-db38886ab52b"],
Cell[CellGroupData[{
Cell[242898, 5670, 617, 8, 55, "Subsection",ExpressionUUID->"9c3a8cec-c23b-43a9-b13c-5dc24224a498"],
Cell[243518, 5680, 1159, 26, 117, "Input",ExpressionUUID->"1ea10bda-d7ad-42b8-b0e4-58111a06e837"],
Cell[244680, 5708, 580, 11, 105, "Abstract",ExpressionUUID->"366c78d8-5688-454c-93c7-a2923ffec2a2"],
Cell[245263, 5721, 1783, 28, 60, "Input",ExpressionUUID->"91bf1d76-cd45-48e4-b713-d9c9f1d0a50e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[247083, 5754, 735, 10, 40, "Subsection",ExpressionUUID->"490656a1-7045-4adf-b8e6-76f1cabd2196"],
Cell[247821, 5766, 822, 15, 41, "Input",ExpressionUUID->"a552173d-c230-4776-9277-63c03c42bb2e",
 InitializationCell->True],
Cell[248646, 5783, 3630, 87, 315, "Input",ExpressionUUID->"cf94c8d2-4c96-4099-bebf-978587dcc2a1"],
Cell[252279, 5872, 582, 13, 99, "Input",ExpressionUUID->"618dcf84-9348-40fc-ae54-deccf99e2127"],
Cell[252864, 5887, 782, 16, 63, "Input",ExpressionUUID->"b5a77385-f1a1-4586-a749-76e001a1deed"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[253695, 5909, 616, 9, 63, "Section",ExpressionUUID->"80421e6f-dc59-4fad-a1f7-61515f3a16d5"],
Cell[CellGroupData[{
Cell[254336, 5922, 906, 12, 55, "Subsection",ExpressionUUID->"f5b4f863-00fd-4acd-a714-72745e72fdf2"],
Cell[255245, 5936, 2179, 53, 225, "Input",ExpressionUUID->"ce1f7044-5da6-4ddd-bb7e-51dd7fa71c15"],
Cell[257427, 5991, 1076, 22, 81, "Input",ExpressionUUID->"c47cd5a2-931d-4c7b-a32c-7edcf50dd322"]
}, Closed]],
Cell[CellGroupData[{
Cell[258540, 6018, 863, 11, 40, "Subsection",ExpressionUUID->"b6573177-44ef-402d-917c-b44cd250e387"],
Cell[259406, 6031, 536, 12, 151, "Abstract",ExpressionUUID->"4aac670b-3e93-4c62-b4cf-11425d7f137e"],
Cell[259945, 6045, 640, 12, 41, "Input",ExpressionUUID->"34ef7084-673a-4a52-93c7-d5fa92d9fe2c",
 InitializationCell->True],
Cell[260588, 6059, 2398, 55, 297, "Input",ExpressionUUID->"e8bad021-ca43-48a2-8238-3c57eaa115ac"]
}, Closed]],
Cell[CellGroupData[{
Cell[263023, 6119, 819, 11, 40, "Subsection",ExpressionUUID->"65bd0a82-eb4e-479f-8914-0109fdde88b3"],
Cell[CellGroupData[{
Cell[263867, 6134, 425, 6, 42, "Subsubsection",ExpressionUUID->"156730bf-d3ab-40cc-bae7-dc3580cd0008"],
Cell[264295, 6142, 433, 11, 174, "Abstract",ExpressionUUID->"06b1812c-024c-49ce-94a3-ab5924f58f60"],
Cell[264731, 6155, 2772, 44, 96, "Input",ExpressionUUID->"b9917ff4-93bf-48f4-887c-9fda1bcab963",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[267540, 6204, 385, 6, 34, "Subsubsection",ExpressionUUID->"4310fa75-dc33-41df-b749-f864d9816d52"],
Cell[267928, 6212, 2880, 69, 315, "Input",ExpressionUUID->"ce7184cf-8ecc-4f38-898f-08a3a0d6bc20"]
}, Closed]],
Cell[CellGroupData[{
Cell[270845, 6286, 170, 3, 34, "Subsubsection",ExpressionUUID->"29fb3c44-0d17-4611-9065-d782a5b85ec0"],
Cell[271018, 6291, 1312, 29, 135, "Input",ExpressionUUID->"755bc11b-164d-4458-8b7f-704acf3414d3"],
Cell[272333, 6322, 604, 13, 81, "Input",ExpressionUUID->"01fab233-02d3-47b7-aeb8-a5b8e5be58b0"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[272986, 6341, 829, 11, 40, "Subsection",ExpressionUUID->"a58d7667-9468-4620-8f3c-768adb31aa20"],
Cell[CellGroupData[{
Cell[273840, 6356, 375, 6, 42, "Subsubsection",ExpressionUUID->"624a3541-d102-4336-af01-99900049504e"],
Cell[274218, 6364, 1004, 28, 425, "Abstract",ExpressionUUID->"297cca5e-2a34-4594-8573-bf93d62388dc"],
Cell[275225, 6394, 1785, 37, 204, "Input",ExpressionUUID->"014f406b-9f5f-401c-9579-5630965a3f68",
 InitializationCell->True],
Cell[277013, 6433, 1751, 38, 132, "Input",ExpressionUUID->"26af7b87-e63b-4377-8d18-5906194d1267",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[278801, 6476, 438, 6, 34, "Subsubsection",ExpressionUUID->"ed56756a-635d-44c7-85e4-6f0ca5dc9758"],
Cell[279242, 6484, 699, 14, 174, "Abstract",ExpressionUUID->"2201ad87-a4e5-4f54-82d7-176e1dac79f6"],
Cell[279944, 6500, 3849, 102, 459, "Input",ExpressionUUID->"ef177435-1427-466b-8b38-a832bbb47551"]
}, Closed]],
Cell[CellGroupData[{
Cell[283830, 6607, 170, 3, 34, "Subsubsection",ExpressionUUID->"bc788cf6-b802-4bbf-84a2-242ec27da5c2"],
Cell[284003, 6612, 756, 14, 151, "Abstract",ExpressionUUID->"28fa8f5c-3d6c-4090-b6b6-819b89a08b49"],
Cell[284762, 6628, 3809, 74, 315, "Input",ExpressionUUID->"91badf37-71f2-4744-880d-2accfba6ebb1"],
Cell[288574, 6704, 751, 17, 99, "Input",ExpressionUUID->"7917da1d-adb9-4619-8b45-7960ac16809e"],
Cell[289328, 6723, 1136, 31, 117, "Input",ExpressionUUID->"5fddb8eb-3329-47f4-a2b1-5787c64dd4e4"]
}, Closed]],
Cell[CellGroupData[{
Cell[290501, 6759, 427, 6, 34, "Subsubsection",ExpressionUUID->"a69f70d3-c714-492a-8453-3d6b0302df17"],
Cell[290931, 6767, 703, 14, 81, "Input",ExpressionUUID->"6ecd30b4-2bdd-4681-a4a6-2714607505c2"],
Cell[291637, 6783, 3413, 63, 153, "Input",ExpressionUUID->"8bda878b-02ec-43f1-a907-3fe3aba1f348"]
}, Closed]],
Cell[CellGroupData[{
Cell[295087, 6851, 371, 5, 34, "Subsubsection",ExpressionUUID->"06bffdd9-68e2-465f-a381-8ab4cf9e1a56"],
Cell[295461, 6858, 1794, 37, 171, "Input",ExpressionUUID->"630a9c56-02e2-4302-a470-902c86a8b117"]
}, Closed]],
Cell[CellGroupData[{
Cell[297292, 6900, 184, 3, 34, "Subsubsection",ExpressionUUID->"293a8743-6d19-4512-b792-a827a00c0276"],
Cell[297479, 6905, 744, 15, 117, "Input",ExpressionUUID->"3f747777-23a1-4e03-92f4-9be2e6b590be"]
}, Closed]],
Cell[CellGroupData[{
Cell[298260, 6925, 371, 5, 34, "Subsubsection",ExpressionUUID->"b926cddd-ec58-4f47-ac7b-86375e28345d"],
Cell[298634, 6932, 2786, 62, 351, "Input",ExpressionUUID->"c2276ca9-3457-465a-a722-7e56077054a5"]
}, Closed]],
Cell[CellGroupData[{
Cell[301457, 6999, 567, 8, 34, "Subsubsection",ExpressionUUID->"8ea8472c-c055-4acf-9129-8aaabaadad13"],
Cell[302027, 7009, 1406, 32, 153, "Input",ExpressionUUID->"ca8b2b7d-838a-4658-a4b4-ee9c6846cd4c"]
}, Closed]],
Cell[CellGroupData[{
Cell[303470, 7046, 591, 9, 34, "Subsubsection",ExpressionUUID->"6d71c612-967c-4a01-8f02-7a62df9184f6"],
Cell[304064, 7057, 381, 10, 151, "Abstract",ExpressionUUID->"69dbffd9-5560-45d5-957b-2dcc63ec7b19"],
Cell[304448, 7069, 1078, 19, 78, "Input",ExpressionUUID->"6f423e92-fe88-4e5c-894c-09afeb5bb34e",
 InitializationCell->True],
Cell[305529, 7090, 3363, 93, 387, "Input",ExpressionUUID->"cb4af84d-c83c-498f-8882-4ba27aedc10c"]
}, Closed]],
Cell[CellGroupData[{
Cell[308929, 7188, 460, 7, 34, "Subsubsection",ExpressionUUID->"fc705d55-8490-4495-bbf2-5b527c43254a"],
Cell[309392, 7197, 971, 21, 153, "Input",ExpressionUUID->"375ee098-115f-4c8e-9923-e7d7500965ab"],
Cell[310366, 7220, 1372, 31, 153, "Input",ExpressionUUID->"fd24a8b3-3a71-4499-a88d-e678505acbc2"]
}, Closed]],
Cell[CellGroupData[{
Cell[311775, 7256, 612, 9, 34, "Subsubsection",ExpressionUUID->"cbfe937e-eb24-4ae0-b305-1a59ddedb499"],
Cell[312390, 7267, 1929, 35, 99, "Input",ExpressionUUID->"69338457-030e-485a-be62-9a65cdbfe1e1"],
Cell[314322, 7304, 557, 12, 81, "Input",ExpressionUUID->"97452b9d-7bc3-4e2d-88fa-17e55b362638"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[314940, 7323, 675, 10, 63, "Section",ExpressionUUID->"a4feb96b-f813-4ed0-9703-152c70302f67"],
Cell[CellGroupData[{
Cell[315640, 7337, 662, 9, 55, "Subsection",ExpressionUUID->"65ddd956-59c6-4606-af76-2ec71aac41ad"],
Cell[CellGroupData[{
Cell[316327, 7350, 321, 5, 42, "Subsubsection",ExpressionUUID->"848f22b3-b78c-4a5c-b3fd-56311c3b8dd3"],
Cell[316651, 7357, 429, 9, 105, "Abstract",ExpressionUUID->"721042db-fe5d-4457-89cd-2d8c4b3449c4"],
Cell[317083, 7368, 561, 9, 41, "Input",ExpressionUUID->"5bc38f90-9c67-43ff-8e7c-251bcf1d41de",
 InitializationCell->True],
Cell[317647, 7379, 2377, 47, 207, "Input",ExpressionUUID->"19ff30c8-0e68-4f25-9f0d-be9f6755ab5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[320061, 7431, 375, 6, 34, "Subsubsection",ExpressionUUID->"cfa6506c-bb76-4ea0-9f4f-d9b123603093"],
Cell[320439, 7439, 383, 9, 26, "Input",ExpressionUUID->"726b809b-1550-47de-8488-33af34305527"]
}, Closed]],
Cell[CellGroupData[{
Cell[320859, 7453, 373, 6, 34, "Subsubsection",ExpressionUUID->"52ae6d21-144f-4d16-aab2-cbfe3d63be5c"],
Cell[321235, 7461, 448, 10, 26, "Input",ExpressionUUID->"ade5766a-721d-43f6-8888-3f92aa7eb1f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321720, 7476, 313, 5, 42, "Subsubsection",ExpressionUUID->"2d050de6-b383-407b-a556-9f5a489177d4"],
Cell[322036, 7483, 378, 9, 105, "Abstract",ExpressionUUID->"61eba5b6-6516-42a6-948b-31c932e97030"],
Cell[322417, 7494, 8736, 137, 204, "Input",ExpressionUUID->"cf1db522-56de-4ffb-a04b-a1dd6e966d3f",
 InitializationCell->True],
Cell[331156, 7633, 7530, 157, 477, "Input",ExpressionUUID->"fb59b98a-5240-48ac-a458-a8baeb98b2b8"]
}, Closed]],
Cell[CellGroupData[{
Cell[338723, 7795, 267, 4, 34, "Subsubsection",ExpressionUUID->"d2ed447b-66b6-42d2-bb09-10fc31081c03"],
Cell[338993, 7801, 4182, 68, 117, "Input",ExpressionUUID->"2d8c8d6d-8088-44fe-8635-687289f56583"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[343224, 7875, 825, 11, 55, "Subsection",ExpressionUUID->"2eb9755c-0953-470f-8eef-1e8f96cc1e2a"],
Cell[CellGroupData[{
Cell[344074, 7890, 227, 4, 42, "Subsubsection",ExpressionUUID->"e6ba94ff-4ab3-4354-b7ef-2e4bbf70b147"],
Cell[344304, 7896, 749, 16, 219, "Abstract",ExpressionUUID->"7a27d2ae-2e06-4dd7-8679-13a03fd7793c"],
Cell[345056, 7914, 2928, 68, 258, "Input",ExpressionUUID->"37b1a085-5d0d-47d9-a0ba-6b0867a3e667",
 InitializationCell->True],
Cell[347987, 7984, 7365, 186, 837, "Input",ExpressionUUID->"7299f3a6-ae53-4562-8d3f-17cb4fc896d0"]
}, Closed]],
Cell[CellGroupData[{
Cell[355389, 8175, 285, 4, 34, "Subsubsection",ExpressionUUID->"51eb650a-04a7-448c-becf-8ded4bb2e375"],
Cell[355677, 8181, 1988, 32, 153, "Input",ExpressionUUID->"d80a5dba-309c-4abb-8a11-dd2fa82d9745"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[357714, 8219, 246, 3, 55, "Subsection",ExpressionUUID->"fd50a93f-856c-46a9-92c1-3f8f2622bf93"],
Cell[CellGroupData[{
Cell[357985, 8226, 375, 6, 42, "Subsubsection",ExpressionUUID->"de9ebaef-de39-499f-8788-dbdbfbdc5e42"],
Cell[358363, 8234, 620, 17, 288, "Abstract",ExpressionUUID->"3ec1c225-40bc-43a4-9b0d-2e3fd6f6bbea"],
Cell[358986, 8253, 2459, 45, 186, "Input",ExpressionUUID->"ce6c91c0-6267-4620-83b5-032efc520b6e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[361482, 8303, 337, 5, 34, "Subsubsection",ExpressionUUID->"cc2a5f39-5c04-4a05-a29d-dcce48b7ba5e"],
Cell[361822, 8310, 16863, 375, 2508, "Input",ExpressionUUID->"75598def-fb35-45ba-bde3-97e95d1ff0ee",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[378722, 8690, 326, 5, 34, "Subsubsection",ExpressionUUID->"845d2580-6ff6-444e-9cb4-f1dfabaa3f50"],
Cell[379051, 8697, 1010, 27, 425, "Abstract",ExpressionUUID->"d62049fd-a1f0-4604-aa3e-a9070563b322"],
Cell[380064, 8726, 5268, 89, 294, "Input",ExpressionUUID->"ea7efe56-c01f-4356-82c5-9437ce3e3cd2",
 InitializationCell->True],
Cell[385335, 8817, 7648, 114, 99, "Input",ExpressionUUID->"7c2e42f0-a649-4f62-ad9f-fbbe96a9fe5e"],
Cell[392986, 8933, 829, 18, 219, "Abstract",ExpressionUUID->"77a753c5-0a66-4814-9030-59af54289881"],
Cell[393818, 8953, 902, 21, 132, "Input",ExpressionUUID->"bf50e466-86c0-4a41-8df5-400de1b7c16d",
 InitializationCell->True],
Cell[394723, 8976, 9653, 163, 495, "Input",ExpressionUUID->"8a13446f-3cc2-47b6-a288-f6621100d89f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[404425, 9145, 205, 3, 40, "Subsection",ExpressionUUID->"5ddb74a0-d46e-474d-9a1a-9fc13d2d2c29"],
Cell[404633, 9150, 398, 9, 128, "Abstract",ExpressionUUID->"ae5ccf1a-a2a5-4207-8ded-bf96e0a6aff0"],
Cell[405034, 9161, 1219, 21, 60, "Input",ExpressionUUID->"6ea43299-1b48-4720-b4b7-360261b41542",
 InitializationCell->True],
Cell[406256, 9184, 893, 18, 117, "Input",ExpressionUUID->"111037de-8438-45ba-bca9-96d5960c8ec8"]
}, Closed]],
Cell[CellGroupData[{
Cell[407186, 9207, 335, 4, 40, "Subsection",ExpressionUUID->"5aa81d14-3073-4136-b4a5-50c59d720c51"],
Cell[407524, 9213, 29910, 582, 3699, "Input",ExpressionUUID->"a67e0e43-830c-4889-a367-4fdb8f456dbd"]
}, Closed]],
Cell[CellGroupData[{
Cell[437471, 9800, 387, 5, 40, "Subsection",ExpressionUUID->"862814e2-aac2-4211-9e28-53e5cecaac71"],
Cell[CellGroupData[{
Cell[437883, 9809, 827, 12, 42, "Subsubsection",ExpressionUUID->"d6b5bf13-81e8-44d4-bdf5-ff8b430ea634"],
Cell[438713, 9823, 2730, 61, 351, "Input",ExpressionUUID->"baa9fcca-a033-48bd-96d0-c52a629f2419"]
}, Closed]],
Cell[CellGroupData[{
Cell[441480, 9889, 228, 4, 34, "Subsubsection",ExpressionUUID->"c89b5c2d-e0ad-49c1-9665-794361ccfafb"],
Cell[441711, 9895, 474, 10, 128, "Abstract",ExpressionUUID->"15c2f1c3-77e0-4905-a6fd-f03be35f4df4"],
Cell[442188, 9907, 1277, 22, 60, "Input",ExpressionUUID->"5dc4640c-72d8-444a-af09-b2e208a8e795",
 InitializationCell->True],
Cell[443468, 9931, 1162, 25, 135, "Input",ExpressionUUID->"c4762a14-7087-4395-b106-1a1fb87bb692"]
}, Closed]],
Cell[CellGroupData[{
Cell[444667, 9961, 305, 5, 34, "Subsubsection",ExpressionUUID->"f6c3cc98-b811-4733-a57d-acace75667c9"],
Cell[444975, 9968, 7962, 170, 1143, "Input",ExpressionUUID->"b2707f9f-f171-4f0e-b908-168b45f36c2b"]
}, Closed]],
Cell[CellGroupData[{
Cell[452974, 10143, 334, 5, 34, "Subsubsection",ExpressionUUID->"e7310513-bfe5-422e-b331-487727a8c8fe"],
Cell[453311, 10150, 2269, 56, 369, "Input",ExpressionUUID->"488d72b5-0213-4b24-af04-a5a390d88665"]
}, Closed]],
Cell[CellGroupData[{
Cell[455617, 10211, 319, 5, 34, "Subsubsection",ExpressionUUID->"60a24408-439f-4417-8e45-3fdb0d4308ad"],
Cell[455939, 10218, 391, 10, 128, "Abstract",ExpressionUUID->"3b42f1b4-f869-4c6f-8d50-d762f6bcd132"],
Cell[456333, 10230, 349, 9, 60, "Input",ExpressionUUID->"f402f353-1389-46ff-b918-17679e7e8440",
 InitializationCell->True],
Cell[456685, 10241, 1722, 43, 171, "Input",ExpressionUUID->"937f0267-0d7b-4356-84d1-5ac1bc044895"]
}, Closed]],
Cell[CellGroupData[{
Cell[458444, 10289, 380, 6, 34, "Subsubsection",ExpressionUUID->"1df61aac-ba0a-4ec7-be4b-23a9ba3214a2"],
Cell[458827, 10297, 3258, 68, 243, "Input",ExpressionUUID->"4dba5d06-0dd3-4686-8a89-d49c995d4db6"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[462134, 10371, 543, 7, 40, "Subsection",ExpressionUUID->"212bbe3a-1484-4378-816c-05fab6277fe3"],
Cell[CellGroupData[{
Cell[462702, 10382, 377, 6, 42, "Subsubsection",ExpressionUUID->"ebb40c1d-cc2d-47d0-9a53-edc87e520b55"],
Cell[463082, 10390, 13358, 267, 1410, "Input",ExpressionUUID->"8a01896e-e080-4625-a5ea-fa1409f70ccd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[476477, 10662, 332, 5, 34, "Subsubsection",ExpressionUUID->"a795e655-90bd-4db3-a740-90584a21d980"],
Cell[476812, 10669, 2566, 38, 41, "Input",ExpressionUUID->"183df332-4cea-4bbf-87cd-8d4d02b77a05",
 InitializationCell->True],
Cell[479381, 10709, 3701, 51, 26, "Input",ExpressionUUID->"723cd10a-e7ff-40f3-8194-2483d79a14d4"]
}, Closed]],
Cell[CellGroupData[{
Cell[483119, 10765, 373, 6, 34, "Subsubsection",ExpressionUUID->"43b50310-13f9-4cb4-9794-f4b2ab715bb1"],
Cell[483495, 10773, 11043, 254, 1143, "Input",ExpressionUUID->"1b856a0e-ec21-466a-8430-3480b3500e6e"]
}, Closed]],
Cell[CellGroupData[{
Cell[494575, 11032, 285, 4, 34, "Subsubsection",ExpressionUUID->"38bc1c47-249a-40ad-b73b-92919eb8487e"],
Cell[494863, 11038, 1763, 29, 117, "Input",ExpressionUUID->"5b48f1e9-68e3-454c-a2b1-b88e346a9c7c"]
}, Closed]],
Cell[CellGroupData[{
Cell[496663, 11072, 527, 7, 34, "Subsubsection",ExpressionUUID->"cb9cb365-5d95-4cf3-be6e-e7e5f57e1f38"],
Cell[497193, 11081, 1639, 37, 171, "Input",ExpressionUUID->"6fe10b9f-c9a2-4ce3-9826-837148d395ad"]
}, Closed]],
Cell[CellGroupData[{
Cell[498869, 11123, 525, 7, 34, "Subsubsection",ExpressionUUID->"468840de-c5d9-467d-9cd0-b8a2cda4e9db"],
Cell[499397, 11132, 1633, 39, 135, "Input",ExpressionUUID->"2c8d9ccc-7fe0-4965-ba55-2481c318708d"],
Cell[501033, 11173, 776, 18, 81, "Input",ExpressionUUID->"0b34abd2-77b3-4af7-be1d-624e87e48e7d"]
}, Closed]],
Cell[CellGroupData[{
Cell[501846, 11196, 698, 10, 34, "Subsubsection",ExpressionUUID->"9914d55c-4689-4ec6-92da-90a460f47a35"],
Cell[502547, 11208, 1599, 32, 117, "Input",ExpressionUUID->"695572eb-64b3-4c70-b088-9cb8c00d0bb6"]
}, Closed]],
Cell[CellGroupData[{
Cell[504183, 11245, 285, 4, 34, "Subsubsection",ExpressionUUID->"76d3641c-15ef-4437-8606-68d75d24c532"],
Cell[504471, 11251, 1587, 26, 99, "Input",ExpressionUUID->"409d9484-40dd-4a74-9d0d-91d3442f2269"]
}, Closed]],
Cell[CellGroupData[{
Cell[506095, 11282, 721, 10, 34, "Subsubsection",ExpressionUUID->"fc2f9c25-b75a-4812-b622-3251c08b970d"],
Cell[506819, 11294, 2312, 56, 369, "Input",ExpressionUUID->"3f61d063-e1eb-4de2-bfad-2d6c24b55ef3"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[509192, 11357, 714, 10, 63, "Section",ExpressionUUID->"fdfbaa42-ba02-4943-a7e0-e0f311d48a9f"],
Cell[CellGroupData[{
Cell[509931, 11371, 169, 2, 51, "Subsection",ExpressionUUID->"fc172672-e836-4f70-b13f-2f62b1fbf290"],
Cell[510103, 11375, 558, 11, 105, "Abstract",ExpressionUUID->"8b5c0137-095b-4b8b-8c1e-1ea74eae8360"],
Cell[510664, 11388, 3070, 44, 41, "Input",ExpressionUUID->"b0a3a0f8-fdc3-4d40-b272-a7b37f6d4816",
 InitializationCell->True],
Cell[513737, 11434, 4063, 82, 207, "Input",ExpressionUUID->"6d28f2bf-3816-4dc2-84c2-2ec4805e2670"]
}, Closed]],
Cell[CellGroupData[{
Cell[517837, 11521, 227, 4, 36, "Subsection",ExpressionUUID->"1369174f-b343-4f40-94cb-e02bdb44da07"],
Cell[518067, 11527, 910, 20, 219, "Abstract",ExpressionUUID->"87d53ac9-644e-4866-9358-6a6fb72a8236"],
Cell[518980, 11549, 2388, 44, 132, "Input",ExpressionUUID->"d9e19acd-600e-4002-957f-4c43cc9c18cf",
 InitializationCell->True],
Cell[521371, 11595, 2266, 49, 189, "Input",ExpressionUUID->"95721ba8-2caa-40d4-ab8d-b8cd9c914aa1"],
Cell[523640, 11646, 661, 12, 105, "Abstract",ExpressionUUID->"0efc279a-8592-4c13-9be8-c138e4cce637"],
Cell[524304, 11660, 1457, 22, 41, "Input",ExpressionUUID->"32856db7-80b1-4b51-8025-dbc733069e3e",
 InitializationCell->True],
Cell[525764, 11684, 1819, 40, 153, "Input",ExpressionUUID->"7df6dadb-652c-4b81-a18b-0c8dd2a94c49"],
Cell[CellGroupData[{
Cell[527608, 11728, 370, 6, 42, "Subsubsection",ExpressionUUID->"328a5ed3-6445-4def-ab8b-382f16f7330b"],
Cell[527981, 11736, 698, 13, 105, "Abstract",ExpressionUUID->"fc1dce01-5299-44f4-83b5-6f8cabe82142"],
Cell[528682, 11751, 765, 19, 78, "Input",ExpressionUUID->"04d5e1bf-cdde-4a70-ab9b-c2518e429cdc",
 InitializationCell->True],
Cell[529450, 11772, 2144, 61, 117, "Input",ExpressionUUID->"b8bbc80c-e9a4-4327-ab99-c8b2fbebb82c"],
Cell[531597, 11835, 390, 13, 242, "Abstract",ExpressionUUID->"d9b4e6fe-d7c7-49ab-ad35-7af77c345a6b"],
Cell[531990, 11850, 1026, 22, 96, "Input",ExpressionUUID->"c2778ef1-ee56-402b-b62a-86062fed4009",
 InitializationCell->True],
Cell[533019, 11874, 1469, 40, 189, "Input",ExpressionUUID->"08ef12d2-6ca2-40ff-846b-205232769570"],
Cell[534491, 11916, 1104, 29, 153, "Input",ExpressionUUID->"e6775987-482b-4f68-9370-1bb9cffcff92"],
Cell[535598, 11947, 3009, 78, 243, "Input",ExpressionUUID->"4108188a-4b2c-4e6a-983c-02eb609923e7"]
}, Closed]],
Cell[CellGroupData[{
Cell[538644, 12030, 304, 5, 34, "Subsubsection",ExpressionUUID->"7d97bb9d-2c89-4423-aa9e-06eda306b642"],
Cell[538951, 12037, 1118, 16, 56, "Item",ExpressionUUID->"abd17d36-794b-474c-81d3-6964517dc8a7"],
Cell[540072, 12055, 2553, 58, 204, "Input",ExpressionUUID->"2688c274-ed53-4829-8a41-e9c7aaf672f5",
 InitializationCell->True],
Cell[542628, 12115, 1458, 32, 153, "Input",ExpressionUUID->"d5c9f29e-2344-4e67-b745-395ad8f8a229"],
Cell[544089, 12149, 1533, 28, 356, "Abstract",ExpressionUUID->"f8f4de95-b1a5-4a3b-af0f-abff05be3076"],
Cell[545625, 12179, 752, 17, 41, "Input",ExpressionUUID->"e158e063-fbaa-4c82-ac3d-9fd6393f0314",
 InitializationCell->True],
Cell[546380, 12198, 1427, 38, 153, "Input",ExpressionUUID->"784fdb97-9e99-4b41-a2ee-06a5ae64a3bb"],
Cell[547810, 12238, 1042, 18, 128, "Abstract",ExpressionUUID->"27d20490-22f5-4fc3-8e9f-9aa792efff55"],
Cell[548855, 12258, 347, 8, 41, "Input",ExpressionUUID->"8705f587-0195-4813-bfd1-fafa5723a3c5",
 InitializationCell->True],
Cell[549205, 12268, 2073, 56, 207, "Input",ExpressionUUID->"8fb2a058-9326-4f30-ad6a-11cfc374d40e"],
Cell[551281, 12326, 2267, 55, 207, "Input",ExpressionUUID->"9b6596de-38a9-42b5-9150-04542e25f45c"],
Cell[553551, 12383, 2180, 61, 261, "Input",ExpressionUUID->"851eade4-430b-4dc5-a9a8-96ec76baac55"],
Cell[555734, 12446, 516, 11, 41, "Input",ExpressionUUID->"34613086-630a-446f-b9fe-a3469563498b",
 InitializationCell->True],
Cell[556253, 12459, 1515, 36, 135, "Input",ExpressionUUID->"aa6eab42-b08e-43d6-8248-ba7e300f374d"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[557817, 12501, 295, 4, 36, "Subsection",ExpressionUUID->"ec0bffac-0189-4cd8-8b13-e680daa8635e"],
Cell[558115, 12507, 837, 19, 81, "Input",ExpressionUUID->"7e269dec-8ebd-4cff-ad88-28205f45858e"]
}, Closed]],
Cell[CellGroupData[{
Cell[558989, 12531, 290, 4, 36, "Subsection",ExpressionUUID->"66cf69b4-8ee6-48a1-8106-23563610a9d4"],
Cell[559282, 12537, 733, 17, 45, "Input",ExpressionUUID->"52a58390-4d58-4736-8044-b252cf95edc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[560052, 12559, 279, 4, 51, "Subsection",ExpressionUUID->"29dcc2fe-38a4-4c1e-a199-eeb5e7b5428d"],
Cell[560334, 12565, 1174, 30, 135, "Input",ExpressionUUID->"0084b5ee-ddf5-4d7d-8eb0-88defd092d01"]
}, Closed]],
Cell[CellGroupData[{
Cell[561545, 12600, 210, 4, 36, "Subsection",ExpressionUUID->"f34c4e08-a1ab-4da4-aede-f4f94aae5846"],
Cell[561758, 12606, 658, 16, 219, "Abstract",ExpressionUUID->"91d7572e-d9e7-40ca-976c-0cd236791f3a"],
Cell[562419, 12624, 2618, 52, 168, "Input",ExpressionUUID->"79a3b4b4-8b31-4610-9fde-2b09973d3ea6",
 InitializationCell->True],
Cell[565040, 12678, 2894, 64, 225, "Input",ExpressionUUID->"04ba33e9-6311-4cb4-83fd-a0db744ef49e"],
Cell[567937, 12744, 713, 16, 197, "Abstract",ExpressionUUID->"fc92713b-470e-4c3d-82c6-5b619a60a05d"],
Cell[568653, 12762, 1106, 25, 132, "Input",ExpressionUUID->"aa6292f0-2d0c-4b2a-b228-0c7528b0be5e",
 InitializationCell->True],
Cell[569762, 12789, 3340, 90, 351, "Input",ExpressionUUID->"6fd4424d-45ef-4c6e-b669-2f90073c7e81"],
Cell[573105, 12881, 678, 18, 81, "Input",ExpressionUUID->"50e669fd-2480-4d1e-be2b-dc2b39c93f51"],
Cell[573786, 12901, 268, 5, 59, "Abstract",ExpressionUUID->"f653f1e0-1842-45d5-8d3f-e6d3aa1a979f"],
Cell[574057, 12908, 430, 12, 41, "Input",ExpressionUUID->"692c7efe-0a1e-4cc1-91a2-86084caa3160",
 InitializationCell->True],
Cell[574490, 12922, 4604, 94, 297, "Input",ExpressionUUID->"2f65ba80-23b9-44c6-a0d9-5b54b69eed96"]
}, Closed]],
Cell[CellGroupData[{
Cell[579131, 13021, 265, 4, 36, "Subsection",ExpressionUUID->"7c86bc33-3a9b-4a48-b1a5-a12d9a507d4b"],
Cell[579399, 13027, 827, 15, 128, "Abstract",ExpressionUUID->"c7c7b8c9-c014-4d44-b29f-dded484b1302"],
Cell[580229, 13044, 2704, 46, 132, "Input",ExpressionUUID->"eb1f4baa-47c3-4b43-8469-801058e8b919",
 InitializationCell->True],
Cell[582936, 13092, 8036, 186, 765, "Input",ExpressionUUID->"7d3d4fe9-3937-4337-8bad-d5f1b7223f66"]
}, Closed]],
Cell[CellGroupData[{
Cell[591009, 13283, 214, 4, 36, "Subsection",ExpressionUUID->"307459fc-d5fa-4230-90e3-fdec5a5b9a4d"],
Cell[591226, 13289, 4292, 106, 387, "Input",ExpressionUUID->"3dcaf8da-9b50-4f17-a677-9a13793cceb2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595555, 13400, 259, 4, 51, "Subsection",ExpressionUUID->"858cc32f-929b-44b5-96d4-605c1c35c0ad"],
Cell[595817, 13406, 1156, 24, 288, "Abstract",ExpressionUUID->"d1d8372e-deb0-4df5-ba00-076128409311"],
Cell[596976, 13432, 4094, 83, 348, "Input",ExpressionUUID->"8b5fb3c2-5bf7-452c-9e24-f9ba97766897",
 InitializationCell->True],
Cell[601073, 13517, 2933, 73, 351, "Input",ExpressionUUID->"7145aba5-457e-43d5-ac2e-45aa91958d8f"],
Cell[604009, 13592, 1034, 23, 288, "Abstract",ExpressionUUID->"2cabacb7-dee0-4c77-b382-53288f3acb41"],
Cell[605046, 13617, 2112, 41, 186, "Input",ExpressionUUID->"73163447-ec1e-4c6e-bbb1-b9283c127ce5",
 InitializationCell->True],
Cell[607161, 13660, 924, 21, 81, "Input",ExpressionUUID->"14a42249-7e5e-4f03-ad46-d94d11041c9d"],
Cell[608088, 13683, 906, 17, 151, "Abstract",ExpressionUUID->"8e75b9c6-2b1e-4e19-93c2-a1213f915a8c"],
Cell[608997, 13702, 1255, 26, 78, "Input",ExpressionUUID->"0784dbd7-ae18-45c7-a4c1-8cce0e9a0db3",
 InitializationCell->True],
Cell[610255, 13730, 3280, 71, 405, "Input",ExpressionUUID->"0b816731-f2ae-4cab-951d-7fabd36ea8e9"],
Cell[613538, 13803, 1335, 29, 99, "Input",ExpressionUUID->"e092479d-b7eb-49da-ac64-f7079286b2da"],
Cell[CellGroupData[{
Cell[614898, 13836, 382, 6, 42, "Subsubsection",ExpressionUUID->"d2b3a83d-1fa5-4f07-8fcd-f71a6d4b89cb"],
Cell[615283, 13844, 1246, 32, 135, "Input",ExpressionUUID->"52b61d30-4898-4944-a300-cbda10b7f4c7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[616578, 13882, 307, 5, 36, "Subsection",ExpressionUUID->"8bf01a32-89e4-4c7e-89ef-62c034762773"],
Cell[CellGroupData[{
Cell[616910, 13891, 314, 5, 42, "Subsubsection",ExpressionUUID->"866361f6-9c23-4f59-ba9f-7be61042f360"],
Cell[617227, 13898, 3079, 59, 654, "Abstract",ExpressionUUID->"813df443-73b6-4b64-8dad-66f4dc6af49a"],
Cell[620309, 13959, 7154, 129, 132, "Input",ExpressionUUID->"2deb2b02-b0e3-41a7-aba7-ac801b3f5ad1",
 InitializationCell->True],
Cell[627466, 14090, 1532, 35, 117, "Input",ExpressionUUID->"02fcbe69-f165-4b31-871c-9f0bb99c20d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[629035, 14130, 249, 4, 42, "Subsubsection",ExpressionUUID->"a1176c37-7270-47ce-972a-ef04b415b1e8"],
Cell[629287, 14136, 2146, 46, 539, "Abstract",ExpressionUUID->"a852991f-2473-4d78-a914-c0524be3ddf5"],
Cell[631436, 14184, 2623, 44, 96, "Input",ExpressionUUID->"ea52a271-0224-4176-a985-b2b4eab29e3a",
 InitializationCell->True],
Cell[634062, 14230, 1503, 32, 153, "Input",ExpressionUUID->"a39a196d-506c-418f-92b5-c50aa5c0beb9"],
Cell[635568, 14264, 981, 23, 78, "Input",ExpressionUUID->"a116c67e-2eb5-494d-8264-64ff1c49cb2f",
 InitializationCell->True],
Cell[636552, 14289, 3938, 88, 351, "Input",ExpressionUUID->"175ccaab-2b09-4912-9fe4-76f04eb5eac2"],
Cell[640493, 14379, 1560, 27, 45, "Input",ExpressionUUID->"dc9b4a7c-aa83-4d8e-8772-b20b2b796cd3"],
Cell[642056, 14408, 584, 13, 41, "Input",ExpressionUUID->"096b3c11-2ffc-46b3-bbc9-709179b2d228",
 InitializationCell->True],
Cell[642643, 14423, 4063, 102, 351, "Input",ExpressionUUID->"51cd338e-78c8-4655-a82f-f818b3cc9e4e"],
Cell[646709, 14527, 1070, 18, 26, "Input",ExpressionUUID->"124d05cb-df29-4605-99ca-87638c72ec18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[647816, 14550, 331, 5, 42, "Subsubsection",ExpressionUUID->"09a11bdb-599d-4128-8ca6-4afa4f014b72"],
Cell[648150, 14557, 527, 11, 26, "Input",ExpressionUUID->"2052b9e8-4553-4ad8-beef-6e6c128e2ef3"]
}, Closed]],
Cell[CellGroupData[{
Cell[648714, 14573, 220, 4, 34, "Subsubsection",ExpressionUUID->"f960c329-9585-45fd-b6c5-d8e98d5810b9"],
Cell[648937, 14579, 759, 14, 128, "Abstract",ExpressionUUID->"dc9ff0dd-9f9d-483b-8b48-a82f91596828"],
Cell[649699, 14595, 1779, 27, 60, "Input",ExpressionUUID->"e08c32e2-7af0-49d9-bf68-af882e10dec3",
 InitializationCell->True],
Cell[651481, 14624, 1905, 42, 225, "Input",ExpressionUUID->"fc1226d1-8d6e-4c3c-84d4-5c58fdad56ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[653423, 14671, 231, 4, 42, "Subsubsection",ExpressionUUID->"b34878bb-6a6a-47a7-86b7-81bbf9f4f890"],
Cell[653657, 14677, 3937, 103, 531, "Input",ExpressionUUID->"c810184b-5739-4be0-b913-a2f72a884319"]
}, Open  ]],
Cell[CellGroupData[{
Cell[657631, 14785, 294, 4, 42, "Subsubsection",ExpressionUUID->"395e076c-4dd8-4a9f-8e2c-877951e8abed"],
Cell[657928, 14791, 1634, 41, 153, "Input",ExpressionUUID->"b4b7f8cf-802c-4fb2-8758-4cd2bf7834ab"]
}, Closed]],
Cell[CellGroupData[{
Cell[659599, 14837, 234, 4, 34, "Subsubsection",ExpressionUUID->"0d4321dc-2683-4ce9-981b-6f3052b2ff12"],
Cell[659836, 14843, 1059, 24, 288, "Abstract",ExpressionUUID->"1cbcba8e-b51d-44af-b1d2-fd36d2c36324"],
Cell[660898, 14869, 2480, 47, 186, "Input",ExpressionUUID->"983dfd0e-cc5d-487f-84c7-1914f314c805",
 InitializationCell->True],
Cell[663381, 14918, 3307, 70, 261, "Input",ExpressionUUID->"c4b7ea0b-46ce-4aaf-ad90-45dca811ce9b"],
Cell[666691, 14990, 1247, 27, 81, "Input",ExpressionUUID->"7ce266c6-3685-4dc1-adc5-c246e0b10561"]
}, Open  ]],
Cell[CellGroupData[{
Cell[667975, 15022, 348, 5, 42, "Subsubsection",ExpressionUUID->"8a6eb74b-e2a3-45fe-8367-d9d4d2d95327"],
Cell[668326, 15029, 1730, 46, 153, "Input",ExpressionUUID->"e7c1b683-f3a3-4e36-b962-6a09ca19345f"]
}, Closed]],
Cell[CellGroupData[{
Cell[670093, 15080, 264, 4, 34, "Subsubsection",ExpressionUUID->"82cb850a-3b92-4205-b973-52c41a22e494"],
Cell[670360, 15086, 3137, 64, 204, "Input",ExpressionUUID->"df2adb57-517a-4d6a-ab38-b6cc4b66bebd",
 InitializationCell->True],
Cell[673500, 15152, 1831, 41, 171, "Input",ExpressionUUID->"8b2578c4-68f6-407b-bdf4-e876e855803c"],
Cell[675334, 15195, 551, 14, 63, "Input",ExpressionUUID->"d5f1de6b-3021-4b1b-9288-ee632226ab6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[675922, 15214, 405, 6, 42, "Subsubsection",ExpressionUUID->"7df839f5-6180-4a46-8a1d-f87c21a12d6e"],
Cell[676330, 15222, 2579, 47, 448, "Abstract",ExpressionUUID->"c144d9c9-135b-4e16-8668-b384e2ab8f81"],
Cell[678912, 15271, 3773, 69, 96, "Input",ExpressionUUID->"99adb719-4196-4c03-9738-9facb66b3b3c",
 InitializationCell->True],
Cell[682688, 15342, 3195, 75, 261, "Input",ExpressionUUID->"762e014b-474b-45a5-aaae-697246733e4c"],
Cell[685886, 15419, 3124, 71, 153, "Input",ExpressionUUID->"bcebd0db-79ba-4188-b257-4f9a36d2fc85"],
Cell[689013, 15492, 515, 12, 81, "Input",ExpressionUUID->"e29eb6f4-44b5-460f-af63-29a31e7d1e13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[689565, 15509, 382, 6, 42, "Subsubsection",ExpressionUUID->"528ce22e-f55e-4b23-a0ab-34c0d788d495"],
Cell[689950, 15517, 2008, 47, 117, "Input",ExpressionUUID->"dbf3359a-755d-490c-ae0b-59ce2bd353a2"],
Cell[691961, 15566, 3099, 81, 351, "Input",ExpressionUUID->"911e6b45-dd4d-4d93-97a2-59e6846fa380"],
Cell[695063, 15649, 2513, 59, 243, "Input",ExpressionUUID->"5d9bd8fb-506d-4131-9fe5-11ff718491b7"],
Cell[697579, 15710, 6454, 150, 549, "Input",ExpressionUUID->"dfb290fa-597a-4bc3-878c-b1c28d78d957"],
Cell[704036, 15862, 3045, 73, 243, "Input",ExpressionUUID->"4fab3728-165b-4dcc-9fa3-281cbd4ffd61"],
Cell[707084, 15937, 601, 13, 45, "Input",ExpressionUUID->"46df5a12-d2dc-47e6-92b2-be76f68235bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[707722, 15955, 320, 5, 42, "Subsubsection",ExpressionUUID->"556010c6-1ffd-4ead-989e-fcb219559cde"],
Cell[708045, 15962, 987, 24, 96, "Input",ExpressionUUID->"3104037c-d9f2-4560-82be-da2bdde1a190",
 InitializationCell->True],
Cell[709035, 15988, 2070, 47, 261, "Input",ExpressionUUID->"9159a50b-1d64-4839-9dc8-2d19247c9548"],
Cell[711108, 16037, 681, 16, 63, "Input",ExpressionUUID->"adb514ba-f702-41b0-ab51-f0e614d46dd6"],
Cell[711792, 16055, 1106, 26, 96, "Input",ExpressionUUID->"5e0f3b65-57f5-436c-8b4d-ca41a6c568fa",
 InitializationCell->True],
Cell[712901, 16083, 2060, 42, 261, "Input",ExpressionUUID->"b9d61981-91a4-4004-a9e2-28b162f95c01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[714998, 16130, 393, 6, 42, "Subsubsection",ExpressionUUID->"1ddc216f-07f4-42c4-b4ec-227881748377"],
Cell[715394, 16138, 1532, 39, 135, "Input",ExpressionUUID->"2cf0dcd2-01e9-4895-90ad-27f269e4d262"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[716987, 16184, 734, 10, 63, "Section",ExpressionUUID->"8ad86480-474e-440f-8bd8-4195c436c7cb"],
Cell[CellGroupData[{
Cell[717746, 16198, 980, 14, 51, "Subsection",ExpressionUUID->"77ae0bdd-4dff-4190-a1cc-4a7bb0060c86"],
Cell[718729, 16214, 2266, 57, 333, "Input",ExpressionUUID->"ff62a270-4319-4cde-a60d-ae66a369198b"]
}, Closed]],
Cell[CellGroupData[{
Cell[721032, 16276, 236, 4, 36, "Subsection",ExpressionUUID->"5ac8e20f-d91a-4902-a8db-c66342a89093"],
Cell[721271, 16282, 1263, 30, 153, "Input",ExpressionUUID->"33611bab-2561-41d7-96d3-dbcfa111dadb"]
}, Closed]],
Cell[CellGroupData[{
Cell[722571, 16317, 284, 4, 36, "Subsection",ExpressionUUID->"9909a735-b261-4450-a413-48580e1bcf39"],
Cell[722858, 16323, 2169, 53, 351, "Input",ExpressionUUID->"8d76e890-bf20-4725-9a52-7db2bef4699a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[725064, 16381, 1064, 15, 51, "Subsection",ExpressionUUID->"01ccb8b5-f08a-4a17-a7e8-ac9be1e9686a"],
Cell[CellGroupData[{
Cell[726153, 16400, 183, 3, 42, "Subsubsection",ExpressionUUID->"ff089379-fa52-4d5b-8df6-2cc473827110"],
Cell[726339, 16405, 8515, 129, 168, "Input",ExpressionUUID->"8edc3b55-9289-4479-8bee-84ba4f6db654",
 InitializationCell->True],
Cell[734857, 16536, 3183, 85, 351, "Input",ExpressionUUID->"6aefceca-6ef8-48f1-a9a3-7921485ff678"]
}, Open  ]],
Cell[CellGroupData[{
Cell[738077, 16626, 201, 3, 42, "Subsubsection",ExpressionUUID->"62da8e51-d4ae-4919-8c8e-da73c4465ccb"],
Cell[738281, 16631, 490, 10, 105, "Abstract",ExpressionUUID->"f7e38252-4f76-4345-98c3-7d42d8748772"],
Cell[738774, 16643, 321, 7, 41, "Input",ExpressionUUID->"ccb8c7de-79a9-40fd-a38b-4a27fec79f60",
 InitializationCell->True],
Cell[739098, 16652, 1919, 43, 153, "Input",ExpressionUUID->"c491eec3-12d1-41d6-b756-8b4d3cffcd9a"],
Cell[741020, 16697, 3039, 76, 387, "Input",ExpressionUUID->"570ab375-f692-4121-8ae9-699982c3d355"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[744108, 16779, 289, 4, 51, "Subsection",ExpressionUUID->"e9a0d3a6-1c02-45f5-b5ac-30b101360a13"],
Cell[744400, 16785, 1397, 31, 153, "Input",ExpressionUUID->"7c86c318-a920-42a5-bca9-6a5220c13d32"]
}, Closed]],
Cell[CellGroupData[{
Cell[745834, 16821, 319, 5, 36, "Subsection",ExpressionUUID->"58f0ff79-84f7-461c-95ee-52964238e667"],
Cell[746156, 16828, 2237, 53, 351, "Input",ExpressionUUID->"6e2f7ce3-7a97-43eb-892e-6eedeb75df70"]
}, Closed]],
Cell[CellGroupData[{
Cell[748430, 16886, 762, 11, 36, "Subsection",ExpressionUUID->"215d6e63-b38a-4600-8ead-cd1606cbf110"],
Cell[749195, 16899, 652, 13, 81, "Input",ExpressionUUID->"abb52478-eb65-4730-b9d8-33333b041803"]
}, Closed]],
Cell[CellGroupData[{
Cell[749884, 16917, 788, 11, 36, "Subsection",ExpressionUUID->"a91a13c4-7d4d-44bf-b1dd-b6eeccd9c70e"],
Cell[750675, 16930, 635, 13, 63, "Input",ExpressionUUID->"86e25612-e0f5-424b-b174-e4ffb7d3811b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[751347, 16948, 830, 12, 51, "Subsection",ExpressionUUID->"2f5c0fd4-4d51-42da-b9bf-2c41209a731a"],
Cell[752180, 16962, 4628, 104, 369, "Input",ExpressionUUID->"2e072508-f2a4-400a-ac2d-fe6dde6c29e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[756845, 17071, 778, 11, 36, "Subsection",ExpressionUUID->"27e6a761-f266-4829-96f5-39b96cde6069"],
Cell[757626, 17084, 1963, 47, 189, "Input",ExpressionUUID->"d6f07c6d-0c78-443d-aedc-206895a50286"]
}, Closed]],
Cell[CellGroupData[{
Cell[759626, 17136, 731, 10, 36, "Subsection",ExpressionUUID->"1549ad55-176e-4776-b551-fcb95bc03269"],
Cell[760360, 17148, 941, 20, 219, "Abstract",ExpressionUUID->"76f6a56f-1b2e-4f05-8de1-2f4ebd953150"],
Cell[761304, 17170, 2177, 36, 132, "Input",ExpressionUUID->"01ca5c88-3f4c-4f7c-9466-a8e8b2fae922",
 InitializationCell->True],
Cell[763484, 17208, 3007, 61, 225, "Input",ExpressionUUID->"cbefafaf-c71d-46a5-84bc-5f79be3ff338"]
}, Closed]],
Cell[CellGroupData[{
Cell[766528, 17274, 837, 12, 36, "Subsection",ExpressionUUID->"506399a2-d52b-4311-9e70-84de70ec435e"],
Cell[767368, 17288, 2826, 51, 207, "Input",ExpressionUUID->"6aed3037-60cb-4ca1-9485-c8beca849681"]
}, Closed]],
Cell[CellGroupData[{
Cell[770231, 17344, 227, 4, 36, "Subsection",ExpressionUUID->"08568a50-7abe-4a86-b8f7-99be1d745285"],
Cell[770461, 17350, 856, 15, 105, "Abstract",ExpressionUUID->"5bd1a88b-fe3e-4f97-8a7a-d2135e87a021"],
Cell[771320, 17367, 1022, 16, 41, "Input",ExpressionUUID->"58defced-3784-4edf-805b-3752b1fae05a",
 InitializationCell->True],
Cell[772345, 17385, 725, 19, 45, "Input",ExpressionUUID->"bcdb6478-f07c-4839-a29e-335bfa8a0422"]
}, Closed]],
Cell[CellGroupData[{
Cell[773107, 17409, 895, 12, 36, "Subsection",ExpressionUUID->"e51fb8b1-4e71-4d0e-aa50-d3135f338533"],
Cell[774005, 17423, 3854, 87, 369, "Input",ExpressionUUID->"554e7a3a-3b8e-4a77-8f15-543350f620fa"]
}, Closed]],
Cell[CellGroupData[{
Cell[777896, 17515, 707, 10, 36, "Subsection",ExpressionUUID->"4137c1d9-dd85-4762-ae20-2b6438b8273f"],
Cell[778606, 17527, 483, 11, 26, "Input",ExpressionUUID->"e7aa0efc-f21e-49c4-8140-15875f00d4cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[779126, 17543, 282, 4, 36, "Subsection",ExpressionUUID->"2aa47129-42d8-4f6e-b7eb-63e281584a9f"],
Cell[779411, 17549, 2006, 32, 117, "Input",ExpressionUUID->"7119dbf1-d6dd-491e-9640-13df2fa7c62e"]
}, Closed]],
Cell[CellGroupData[{
Cell[781454, 17586, 758, 11, 36, "Subsection",ExpressionUUID->"81f908b3-3e9b-48a1-8957-b9caa46334d6"],
Cell[782215, 17599, 494, 12, 26, "Input",ExpressionUUID->"beaf9ea6-4ab9-4cc9-b6b4-06467a712478"]
}, Open  ]],
Cell[CellGroupData[{
Cell[782746, 17616, 229, 4, 51, "Subsection",ExpressionUUID->"a67b5c01-d552-462b-9ed9-44063294ba3b"],
Cell[782978, 17622, 1099, 20, 197, "Abstract",ExpressionUUID->"7d0cd3a6-8b16-41d9-bba1-c8284002e221"],
Cell[784080, 17644, 918, 24, 114, "Input",ExpressionUUID->"c7219b5e-3fb9-47c8-8569-d580aebc6a02",
 InitializationCell->True],
Cell[785001, 17670, 3636, 86, 333, "Input",ExpressionUUID->"d555e557-3e7a-4bdd-811d-a2a97091af02"],
Cell[788640, 17758, 1106, 24, 288, "Abstract",ExpressionUUID->"4354891b-73c0-4845-99f5-b7f376eb68a0"],
Cell[789749, 17784, 2166, 42, 186, "Input",ExpressionUUID->"428b19bf-5c02-493f-90e9-4ca0036471b6",
 InitializationCell->True],
Cell[791918, 17828, 1013, 21, 99, "Input",ExpressionUUID->"18619049-394e-4543-bdfc-e80cc44c03ce"],
Cell[792934, 17851, 991, 18, 151, "Abstract",ExpressionUUID->"1cf8e299-d22f-4687-a086-ab9c9ccf74c4"],
Cell[793928, 17871, 1614, 33, 132, "Input",ExpressionUUID->"2e3c5e30-2107-4031-9f82-aa9ef1c358b4",
 InitializationCell->True],
Cell[795545, 17906, 2459, 50, 297, "Input",ExpressionUUID->"3788c78e-c0b1-4ea1-9d92-86613d8e48d8"],
Cell[798007, 17958, 1255, 28, 135, "Input",ExpressionUUID->"a8a76e69-90fa-4925-8bff-b312777dfa34"]
}, Closed]],
Cell[CellGroupData[{
Cell[799299, 17991, 934, 13, 36, "Subsection",ExpressionUUID->"c6760d95-5bed-4918-b213-e98fe8b274e5"],
Cell[CellGroupData[{
Cell[800258, 18008, 182, 3, 42, "Subsubsection",ExpressionUUID->"75b4786f-364e-4f96-81b3-653583ef7363"],
Cell[800443, 18013, 2671, 74, 423, "Input",ExpressionUUID->"4d72f73d-fbdf-4213-9b20-ab1555fd54d0"]
}, Closed]],
Cell[CellGroupData[{
Cell[803151, 18092, 260, 4, 34, "Subsubsection",ExpressionUUID->"fecc8f05-a2b0-4018-9391-be176b17962e"],
Cell[803414, 18098, 618, 13, 128, "Abstract",ExpressionUUID->"64659252-6c0a-4259-97c7-6c36563e7633"],
Cell[804035, 18113, 601, 12, 60, "Input",ExpressionUUID->"6ecf14da-f6da-4fad-9146-1ff79ed18974",
 InitializationCell->True],
Cell[804639, 18127, 1439, 33, 153, "Input",ExpressionUUID->"a23a7dd5-a532-4a67-a864-2385a68c69ea"]
}, Closed]],
Cell[CellGroupData[{
Cell[806115, 18165, 324, 5, 34, "Subsubsection",ExpressionUUID->"292664d4-6538-424f-80d2-a619276ab15f"],
Cell[806442, 18172, 549, 13, 81, "Input",ExpressionUUID->"8ab873d2-7b4f-4999-9ce3-7162565287ec"]
}, Closed]],
Cell[CellGroupData[{
Cell[807028, 18190, 324, 5, 34, "Subsubsection",ExpressionUUID->"244717d1-494f-4a0c-9c56-cb3296eba1fc"],
Cell[807355, 18197, 549, 12, 63, "Input",ExpressionUUID->"cb97d043-b63b-4b73-bc34-3115744f2570"]
}, Closed]],
Cell[CellGroupData[{
Cell[807941, 18214, 311, 5, 34, "Subsubsection",ExpressionUUID->"346f6cf6-4e02-425c-8f0e-973920929e27"],
Cell[808255, 18221, 752, 14, 128, "Abstract",ExpressionUUID->"231bba11-949a-4e93-806a-7520a76f37fe"],
Cell[809010, 18237, 993, 23, 96, "Input",ExpressionUUID->"20ef97d7-7a9c-4a53-b1a9-7a6a362d6829",
 InitializationCell->True],
Cell[810006, 18262, 1888, 51, 243, "Input",ExpressionUUID->"8d8bf178-2c84-41c9-a810-3e2829c310e5"],
Cell[811897, 18315, 769, 14, 45, "Input",ExpressionUUID->"9b673a28-0c34-4620-87ab-c31357ae6dda"],
Cell[812669, 18331, 827, 21, 99, "Input",ExpressionUUID->"5906a9f5-e103-4cf4-8612-867e3097fad8"]
}, Closed]],
Cell[CellGroupData[{
Cell[813533, 18357, 279, 4, 34, "Subsubsection",ExpressionUUID->"f5210b9d-4a27-475b-88d0-3941ac6b8e22"],
Cell[CellGroupData[{
Cell[813837, 18365, 233, 3, 40, "Item",ExpressionUUID->"a3d65857-60a9-46be-9d6f-be9069d2d56c"],
Cell[814073, 18370, 226, 3, 40, "Item",ExpressionUUID->"78e63ec3-d774-42a4-b828-4157bce7cd2b"]
}, Open  ]],
Cell[814314, 18376, 714, 15, 174, "Abstract",ExpressionUUID->"b8a22846-37c8-4b8f-ae31-3b5f783a4069"],
Cell[815031, 18393, 1256, 23, 96, "Input",ExpressionUUID->"ab86b0fe-f4d4-4c67-9c1c-3a3894b57286",
 InitializationCell->True],
Cell[816290, 18418, 374, 10, 26, "Input",ExpressionUUID->"da2371fa-2b4c-4f4e-8df2-5f3e6f5690d8"],
Cell[816667, 18430, 250, 3, 33, "Item",ExpressionUUID->"48cd7c4a-3279-4d6b-8059-80ef90aa3550"],
Cell[816920, 18435, 11857, 244, 1215, "Input",ExpressionUUID->"b2a0c94e-7e00-4048-bd41-2dbb23adf771"]
}, Closed]],
Cell[CellGroupData[{
Cell[828814, 18684, 313, 5, 34, "Subsubsection",ExpressionUUID->"5df2cadd-fb00-4f68-a7c7-862c0b1c76f7"],
Cell[829130, 18691, 2081, 46, 207, "Input",ExpressionUUID->"3bc2781c-e122-4ebe-8cea-586d14b5775d"],
Cell[831214, 18739, 1314, 29, 135, "Input",ExpressionUUID->"953df9bb-386d-469e-b9c1-fb82f73eebb6"],
Cell[832531, 18770, 966, 18, 99, "Input",ExpressionUUID->"9ae2d298-4da4-4c6b-ba62-c91dbcd993fa"],
Cell[833500, 18790, 1670, 36, 153, "Input",ExpressionUUID->"09eb2baa-6f75-40d9-993d-e36b5f38e655"],
Cell[835173, 18828, 1532, 25, 99, "Input",ExpressionUUID->"d7dc38dc-2cc0-4586-8e4c-3823c67c2bcf"],
Cell[836708, 18855, 1674, 37, 153, "Input",ExpressionUUID->"861d63fa-2ad3-4e2a-84da-43d0b0f5f2df"],
Cell[838385, 18894, 1530, 25, 99, "Input",ExpressionUUID->"359790d1-161f-4819-8f8d-87ecb9ce5305"],
Cell[839918, 18921, 1202, 32, 153, "Input",ExpressionUUID->"64fb45e7-0b4b-4d31-9649-c8486e5f62cf"],
Cell[841123, 18955, 1574, 39, 189, "Input",ExpressionUUID->"b5736cdb-d4fe-45b1-965b-89fc8539575f"]
}, Closed]],
Cell[CellGroupData[{
Cell[842734, 18999, 428, 6, 34, "Subsubsection",ExpressionUUID->"81767aba-4766-4bc6-bb09-84ab3522e9d5"],
Cell[843165, 19007, 573, 14, 81, "Input",ExpressionUUID->"3b1071b6-478e-41d9-b6e9-656e657781b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[843775, 19026, 426, 6, 34, "Subsubsection",ExpressionUUID->"77b6c950-4e49-4608-96cd-3d52011c1570"],
Cell[844204, 19034, 548, 12, 63, "Input",ExpressionUUID->"37c6f2d3-b2f4-4551-8bd1-642d3bbd9fdb"]
}, Closed]],
Cell[CellGroupData[{
Cell[844789, 19051, 363, 5, 34, "Subsubsection",ExpressionUUID->"d4fd85c8-7b0c-4dd3-92bf-9f96d5ce0468"],
Cell[845155, 19058, 778, 15, 128, "Abstract",ExpressionUUID->"a6f99998-cd35-41f9-8129-3c3d37992123"],
Cell[845936, 19075, 1081, 24, 114, "Input",ExpressionUUID->"47c5dc17-4c7d-4828-aed6-34ff15fbba26",
 InitializationCell->True],
Cell[847020, 19101, 2049, 53, 243, "Input",ExpressionUUID->"e4e58a4a-1318-496f-83fc-e63731327900"],
Cell[849072, 19156, 842, 14, 45, "Input",ExpressionUUID->"af5210c7-df6a-4ace-bee5-7751b3cc7f79"],
Cell[849917, 19172, 883, 22, 99, "Input",ExpressionUUID->"81dccc74-3ed0-4683-b3cf-ebddc770e9d0"]
}, Closed]],
Cell[CellGroupData[{
Cell[850837, 19199, 486, 7, 34, "Subsubsection",ExpressionUUID->"e8d4f778-742b-485b-9054-f4f248b80e94"],
Cell[851326, 19208, 2825, 74, 351, "Input",ExpressionUUID->"10fb5a25-95c2-471e-9856-14488afc7587"],
Cell[854154, 19284, 1135, 25, 288, "Abstract",ExpressionUUID->"f25df869-9274-49ec-81da-91deb69ea18d"],
Cell[855292, 19311, 2191, 42, 186, "Input",ExpressionUUID->"a8bd2de3-62c3-4a2a-8843-ce8749eb13e5",
 InitializationCell->True],
Cell[857486, 19355, 1410, 40, 189, "Input",ExpressionUUID->"dd071b1a-de3c-4a30-8413-a713de927e5f"],
Cell[858899, 19397, 786, 14, 128, "Abstract",ExpressionUUID->"8cc5c578-24cb-4420-9223-d7f4fb249ef5"],
Cell[859688, 19413, 2602, 68, 258, "Input",ExpressionUUID->"8f3cd5fc-b814-410e-8e32-090745ddebd6",
 InitializationCell->True],
Cell[862293, 19483, 2547, 51, 297, "Input",ExpressionUUID->"eb236031-eed6-4773-b4fe-31d282d4e012"],
Cell[864843, 19536, 2277, 52, 243, "Input",ExpressionUUID->"69d014ca-77bd-4151-983c-2e1931434c1e"],
Cell[867123, 19590, 696, 17, 81, "Input",ExpressionUUID->"85052f41-0f8d-40e9-a5c6-bcb9361f9bfe"],
Cell[867822, 19609, 800, 15, 168, "Input",ExpressionUUID->"093336f8-92e2-4f6e-a949-12f841096e97",
 InitializationCell->True],
Cell[868625, 19626, 1343, 33, 171, "Input",ExpressionUUID->"3ec9ad4e-a4da-4172-89c0-2adb853c3df7"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[870017, 19665, 1023, 14, 36, "Subsection",ExpressionUUID->"64e65153-295f-428a-a2fc-8afc6ecc4aca"],
Cell[871043, 19681, 708, 15, 174, "Abstract",ExpressionUUID->"94e7f6dc-bb7d-4575-9e61-e2e6d1b6a0f2"],
Cell[871754, 19698, 1942, 38, 168, "Input",ExpressionUUID->"4d38a6b5-0bec-400e-820a-599b194f4e57",
 InitializationCell->True],
Cell[873699, 19738, 2330, 43, 153, "Input",ExpressionUUID->"e00e790a-e118-4d62-89a4-7c1c3c468fad"],
Cell[CellGroupData[{
Cell[876054, 19785, 878, 12, 42, "Subsubsection",ExpressionUUID->"81c22dae-4c0f-48a7-b670-35da00f79d50"],
Cell[876935, 19799, 1826, 42, 207, "Input",ExpressionUUID->"64566998-6960-4498-90d2-9e18f31ccdcc"],
Cell[878764, 19843, 511, 11, 81, "Input",ExpressionUUID->"8171e5f0-e7fd-403a-bc27-66ea71c03cd1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[879324, 19860, 922, 13, 36, "Subsection",ExpressionUUID->"6aa5ce15-1805-4633-8d8b-27146d1fc06c"],
Cell[880249, 19875, 607, 12, 151, "Abstract",ExpressionUUID->"6885016c-1918-4149-9e9c-acdc8897b4a4"],
Cell[880859, 19889, 713, 16, 78, "Input",ExpressionUUID->"98aeadc4-5deb-42a3-a381-751567515765",
 InitializationCell->True],
Cell[881575, 19907, 1144, 27, 117, "Input",ExpressionUUID->"095b52ad-64a9-4645-afd3-f30d820a6184"]
}, Closed]],
Cell[CellGroupData[{
Cell[882756, 19939, 1058, 16, 36, "Subsection",ExpressionUUID->"3d7ed118-f045-494d-ba76-d73f7a091c4c"],
Cell[CellGroupData[{
Cell[883839, 19959, 939, 13, 42, "Subsubsection",ExpressionUUID->"a7855937-40b0-4e1f-add2-bc920a6ed3fc"],
Cell[884781, 19974, 713, 14, 128, "Abstract",ExpressionUUID->"8389d202-90bf-4dcc-8f09-39ac12e8ffc9"],
Cell[885497, 19990, 2898, 54, 132, "Input",ExpressionUUID->"69d7ceef-71b5-48be-96a0-dddcfa82d519",
 InitializationCell->True],
Cell[888398, 20046, 5409, 118, 387, "Input",ExpressionUUID->"6fad76ea-351c-42bc-8852-531bc73da06f"],
Cell[893810, 20166, 737, 14, 128, "Abstract",ExpressionUUID->"1182181f-2ede-4357-a456-ea620a9b6912"],
Cell[894550, 20182, 909, 23, 96, "Input",ExpressionUUID->"5c394791-aff0-4daa-b5f2-6e612a568b5e",
 InitializationCell->True],
Cell[895462, 20207, 2845, 59, 243, "Input",ExpressionUUID->"22c0c6ca-d809-42e1-b545-1d44af82d7ae"],
Cell[898310, 20268, 660, 16, 63, "Input",ExpressionUUID->"b0188f0f-7b7a-4418-9d75-9f81611a9a86"],
Cell[898973, 20286, 2363, 58, 171, "Input",ExpressionUUID->"1b8a7cfa-28e9-4572-9ecd-84ca53ac1865"],
Cell[901339, 20346, 1460, 35, 81, "Input",ExpressionUUID->"f4dea082-471d-48b4-a9c0-0ad87d006ebf"],
Cell[902802, 20383, 837, 15, 128, "Abstract",ExpressionUUID->"2a7e9c9d-847c-4120-8874-ddf6fea15d3e"],
Cell[903642, 20400, 439, 10, 60, "Input",ExpressionUUID->"45966800-d1b5-40d5-926f-167c79bbc75d",
 InitializationCell->True],
Cell[904084, 20412, 1661, 40, 171, "Input",ExpressionUUID->"a44da16c-c6aa-4f67-8884-7007fd9fb540"],
Cell[905748, 20454, 2572, 61, 261, "Input",ExpressionUUID->"0641886d-be88-49bf-bfa4-efb73fe73346"],
Cell[908323, 20517, 846, 14, 105, "Abstract",ExpressionUUID->"82101ca1-806b-445e-be75-a48b5a5942dc"],
Cell[909172, 20533, 4482, 73, 114, "Input",ExpressionUUID->"85727459-b59b-4b31-99db-ec6ca212b602",
 InitializationCell->True],
Cell[913657, 20608, 2190, 40, 153, "Input",ExpressionUUID->"38172093-d0f6-4175-bfed-434a478608ea"],
Cell[915850, 20650, 951, 16, 63, "Input",ExpressionUUID->"0faacdbd-6975-481e-9868-dfc7ba4f511d"],
Cell[916804, 20668, 919, 23, 99, "Input",ExpressionUUID->"35c48eb2-815d-4af9-b5d5-df7732f234f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[917760, 20696, 938, 13, 42, "Subsubsection",ExpressionUUID->"7642b22a-5a79-4e98-adf6-0abe9359fd46"],
Cell[918701, 20711, 758, 14, 128, "Abstract",ExpressionUUID->"3df2c468-2ac0-4353-921c-8a826e9b8d33"],
Cell[919462, 20727, 1923, 42, 132, "Input",ExpressionUUID->"e08e79c4-89cf-4ec2-a694-c94967eac549",
 InitializationCell->True],
Cell[921388, 20771, 1891, 53, 243, "Input",ExpressionUUID->"97115551-dc94-4050-9d01-e778c163406f"],
Cell[923282, 20826, 4463, 106, 351, "Input",ExpressionUUID->"4715e084-db46-44e9-b72c-15687ccfce65"],
Cell[927748, 20934, 1061, 34, 26, "Input",ExpressionUUID->"6ae9a6a0-bffc-424f-9d92-401f6cf6c7c4"],
Cell[928812, 20970, 3043, 77, 351, "Input",ExpressionUUID->"62f1a59d-6865-4b9b-8931-b4d326a267a7"],
Cell[931858, 21049, 636, 15, 45, "Input",ExpressionUUID->"2aedee8b-88d1-4b65-ac53-e4ca4bb985fd"],
Cell[932497, 21066, 599, 14, 81, "Input",ExpressionUUID->"c28200ca-0b9a-48db-80b4-27c6fbec66d4"],
Cell[933099, 21082, 1061, 34, 26, "Input",ExpressionUUID->"130d3889-ee63-4906-8c7b-a1ebabe30e44"],
Cell[934163, 21118, 762, 14, 105, "Abstract",ExpressionUUID->"b41d8359-ff12-46ef-916a-9df0738b9c24"],
Cell[934928, 21134, 1262, 30, 204, "Input",ExpressionUUID->"422f06c8-7ed9-4891-8e70-a0e96472bc20",
 InitializationCell->True],
Cell[936193, 21166, 1306, 28, 171, "Input",ExpressionUUID->"8e254f21-e1e7-4da6-806e-fe0619a14073"],
Cell[937502, 21196, 2029, 31, 99, "Input",ExpressionUUID->"05ad4044-5e78-4afd-89da-c632cb196757"],
Cell[939534, 21229, 782, 21, 81, "Input",ExpressionUUID->"fab51b0e-0547-44f3-aef7-bf59807a5c72"],
Cell[940319, 21252, 525, 14, 26, "Input",ExpressionUUID->"5ed7e7f4-1bf2-4c50-87e2-5c8f73ce8b23"],
Cell[940847, 21268, 524, 12, 81, "Input",ExpressionUUID->"e0ccdadb-578c-4efb-a97f-0a3902b06f25"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[941432, 21287, 622, 9, 50, "Section",ExpressionUUID->"93c9fc29-acf4-4338-8c9c-325c12df66e1"],
Cell[942057, 21298, 2650, 54, 207, "Input",ExpressionUUID->"21243291-7e3b-429f-82ed-c359d62b4b52"]
}, Open  ]]
}
]
*)

